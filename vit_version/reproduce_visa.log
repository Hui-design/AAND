training Advanced Teacher...
candle
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:54<1:29:13, 54.08s/it]epoch [1/100], focal_loss:0.0665	, anomaly_loss:0.5620	fnorm_loss:0.0559, a_fnorm_loss:0.0146P:0.00, R:0.00
normal: 0.2004 0.2035  anomaly: 0.2007 0.2035	P:0.00, R:0.00
Pixel Auroc:0.759, Sample Auroc0.599, Pixel Aupro0.0
test_fnorm_loss: 0.0472 test_afnorm_loss: 0.0150
  2%|▏         | 2/100 [01:15<57:14, 35.05s/it]  epoch [2/100], focal_loss:0.0509	, anomaly_loss:0.6047	fnorm_loss:0.0424, a_fnorm_loss:0.0114P:0.00, R:0.00
  3%|▎         | 3/100 [01:38<47:48, 29.57s/it]epoch [3/100], focal_loss:0.0480	, anomaly_loss:0.5579	fnorm_loss:0.0374, a_fnorm_loss:0.0208P:0.04, R:0.17
  4%|▍         | 4/100 [02:01<42:37, 26.64s/it]epoch [4/100], focal_loss:0.0381	, anomaly_loss:0.4900	fnorm_loss:0.0281, a_fnorm_loss:0.0354P:0.11, R:0.33
  5%|▌         | 5/100 [02:51<55:47, 35.24s/it]epoch [5/100], focal_loss:0.0300	, anomaly_loss:0.4170	fnorm_loss:0.0215, a_fnorm_loss:0.0415P:0.29, R:0.66
normal: 0.0931 0.2194  anomaly: 0.0971 0.4431	P:0.04, R:0.05
Pixel Auroc:0.958, Sample Auroc0.872, Pixel Aupro0.0
test_fnorm_loss: 0.0176 test_afnorm_loss: 0.0176
  6%|▌         | 6/100 [03:14<48:28, 30.94s/it]epoch [6/100], focal_loss:0.0193	, anomaly_loss:0.3597	fnorm_loss:0.0166, a_fnorm_loss:0.0462P:0.43, R:0.88
  7%|▋         | 7/100 [03:35<43:10, 27.86s/it]epoch [7/100], focal_loss:0.0140	, anomaly_loss:0.3297	fnorm_loss:0.0140, a_fnorm_loss:0.0475P:0.49, R:0.94
  8%|▊         | 8/100 [03:58<40:05, 26.15s/it]epoch [8/100], focal_loss:0.0128	, anomaly_loss:0.3282	fnorm_loss:0.0125, a_fnorm_loss:0.0473P:0.53, R:0.95
  9%|▉         | 9/100 [04:19<37:33, 24.76s/it]epoch [9/100], focal_loss:0.0120	, anomaly_loss:0.3272	fnorm_loss:0.0113, a_fnorm_loss:0.0489P:0.56, R:0.94
 10%|█         | 10/100 [05:07<47:41, 31.80s/it]epoch [10/100], focal_loss:0.0100	, anomaly_loss:0.3166	fnorm_loss:0.0103, a_fnorm_loss:0.0503P:0.56, R:0.96
normal: 0.0413 0.1899  anomaly: 0.0416 0.4832	P:0.07, R:0.06
Pixel Auroc:0.963, Sample Auroc0.846, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0162
 11%|█         | 11/100 [05:30<43:02, 29.02s/it]epoch [11/100], focal_loss:0.0155	, anomaly_loss:0.3617	fnorm_loss:0.0110, a_fnorm_loss:0.0485P:0.47, R:0.80
 12%|█▏        | 12/100 [05:52<39:36, 27.01s/it]epoch [12/100], focal_loss:0.0115	, anomaly_loss:0.3322	fnorm_loss:0.0098, a_fnorm_loss:0.0496P:0.52, R:0.92
 13%|█▎        | 13/100 [06:14<36:56, 25.48s/it]epoch [13/100], focal_loss:0.0092	, anomaly_loss:0.3167	fnorm_loss:0.0089, a_fnorm_loss:0.0511P:0.57, R:0.96
 14%|█▍        | 14/100 [06:36<35:02, 24.44s/it]epoch [14/100], focal_loss:0.0085	, anomaly_loss:0.3124	fnorm_loss:0.0084, a_fnorm_loss:0.0529P:0.59, R:0.96
 15%|█▌        | 15/100 [07:23<44:05, 31.13s/it]epoch [15/100], focal_loss:0.0086	, anomaly_loss:0.3080	fnorm_loss:0.0081, a_fnorm_loss:0.0521P:0.58, R:0.96
normal: 0.0312 0.1555  anomaly: 0.0323 0.5028	P:0.06, R:0.06
Pixel Auroc:0.970, Sample Auroc0.877, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0202
 16%|█▌        | 16/100 [07:45<39:52, 28.48s/it]epoch [16/100], focal_loss:0.0099	, anomaly_loss:0.3172	fnorm_loss:0.0082, a_fnorm_loss:0.0493P:0.60, R:0.95
 17%|█▋        | 17/100 [08:07<36:51, 26.65s/it]epoch [17/100], focal_loss:0.0242	, anomaly_loss:0.3949	fnorm_loss:0.0081, a_fnorm_loss:0.0482P:0.37, R:0.65
 18%|█▊        | 18/100 [08:30<34:41, 25.38s/it]epoch [18/100], focal_loss:0.0112	, anomaly_loss:0.3353	fnorm_loss:0.0074, a_fnorm_loss:0.0514P:0.53, R:0.89
 19%|█▉        | 19/100 [08:52<32:58, 24.43s/it]epoch [19/100], focal_loss:0.0093	, anomaly_loss:0.3166	fnorm_loss:0.0072, a_fnorm_loss:0.0532P:0.57, R:0.95
 20%|██        | 20/100 [09:45<43:59, 33.00s/it]epoch [20/100], focal_loss:0.0086	, anomaly_loss:0.3115	fnorm_loss:0.0070, a_fnorm_loss:0.0528P:0.60, R:0.96
normal: 0.0326 0.2342  anomaly: 0.0357 0.6168	P:0.07, R:0.09
Pixel Auroc:0.977, Sample Auroc0.891, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0262
 21%|██        | 21/100 [10:08<39:32, 30.03s/it]epoch [21/100], focal_loss:0.0079	, anomaly_loss:0.3063	fnorm_loss:0.0068, a_fnorm_loss:0.0539P:0.61, R:0.96
 22%|██▏       | 22/100 [10:30<35:56, 27.65s/it]epoch [22/100], focal_loss:0.0078	, anomaly_loss:0.3052	fnorm_loss:0.0066, a_fnorm_loss:0.0540P:0.62, R:0.96
 23%|██▎       | 23/100 [10:52<33:24, 26.04s/it]epoch [23/100], focal_loss:0.0079	, anomaly_loss:0.3098	fnorm_loss:0.0066, a_fnorm_loss:0.0541P:0.60, R:0.96
 24%|██▍       | 24/100 [11:14<31:25, 24.81s/it]epoch [24/100], focal_loss:0.0069	, anomaly_loss:0.3056	fnorm_loss:0.0064, a_fnorm_loss:0.0554P:0.63, R:0.97
 25%|██▌       | 25/100 [12:02<39:25, 31.54s/it]epoch [25/100], focal_loss:0.0076	, anomaly_loss:0.3083	fnorm_loss:0.0064, a_fnorm_loss:0.0540P:0.62, R:0.96
normal: 0.1204 0.3327  anomaly: 0.1512 0.5842	P:0.05, R:0.09
Pixel Auroc:0.964, Sample Auroc0.862, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0243
 26%|██▌       | 26/100 [12:25<35:43, 28.97s/it]epoch [26/100], focal_loss:0.0076	, anomaly_loss:0.3137	fnorm_loss:0.0063, a_fnorm_loss:0.0543P:0.61, R:0.96
 27%|██▋       | 27/100 [12:46<32:39, 26.85s/it]epoch [27/100], focal_loss:0.0072	, anomaly_loss:0.3104	fnorm_loss:0.0062, a_fnorm_loss:0.0552P:0.61, R:0.96
 28%|██▊       | 28/100 [13:09<30:43, 25.61s/it]epoch [28/100], focal_loss:0.0067	, anomaly_loss:0.3026	fnorm_loss:0.0061, a_fnorm_loss:0.0551P:0.64, R:0.96
 29%|██▉       | 29/100 [13:31<29:06, 24.60s/it]epoch [29/100], focal_loss:0.0077	, anomaly_loss:0.3103	fnorm_loss:0.0061, a_fnorm_loss:0.0549P:0.64, R:0.96
 30%|███       | 30/100 [14:24<38:34, 33.06s/it]epoch [30/100], focal_loss:0.0079	, anomaly_loss:0.3119	fnorm_loss:0.0061, a_fnorm_loss:0.0546P:0.62, R:0.95
normal: 0.0250 0.1515  anomaly: 0.0267 0.5631	P:0.07, R:0.07
Pixel Auroc:0.974, Sample Auroc0.897, Pixel Aupro0.0
test_fnorm_loss: 0.0053 test_afnorm_loss: 0.0189
 31%|███       | 31/100 [14:47<34:21, 29.87s/it]epoch [31/100], focal_loss:0.0067	, anomaly_loss:0.3058	fnorm_loss:0.0060, a_fnorm_loss:0.0552P:0.64, R:0.97
 32%|███▏      | 32/100 [15:09<31:17, 27.60s/it]epoch [32/100], focal_loss:0.0085	, anomaly_loss:0.3198	fnorm_loss:0.0062, a_fnorm_loss:0.0536P:0.61, R:0.93
 33%|███▎      | 33/100 [15:32<29:10, 26.12s/it]epoch [33/100], focal_loss:0.0072	, anomaly_loss:0.3083	fnorm_loss:0.0060, a_fnorm_loss:0.0549P:0.62, R:0.97
 34%|███▍      | 34/100 [15:55<27:48, 25.27s/it]epoch [34/100], focal_loss:0.0072	, anomaly_loss:0.3025	fnorm_loss:0.0059, a_fnorm_loss:0.0553P:0.65, R:0.97
 35%|███▌      | 35/100 [16:47<36:00, 33.23s/it]epoch [35/100], focal_loss:0.0063	, anomaly_loss:0.3081	fnorm_loss:0.0058, a_fnorm_loss:0.0552P:0.63, R:0.97
normal: 0.0246 0.2556  anomaly: 0.0304 0.6330	P:0.08, R:0.09
Pixel Auroc:0.979, Sample Auroc0.897, Pixel Aupro0.0
test_fnorm_loss: 0.0053 test_afnorm_loss: 0.0274
 36%|███▌      | 36/100 [17:09<31:53, 29.90s/it]epoch [36/100], focal_loss:0.0077	, anomaly_loss:0.3169	fnorm_loss:0.0058, a_fnorm_loss:0.0553P:0.63, R:0.95
 37%|███▋      | 37/100 [17:31<28:54, 27.52s/it]epoch [37/100], focal_loss:0.0071	, anomaly_loss:0.3112	fnorm_loss:0.0058, a_fnorm_loss:0.0549P:0.62, R:0.97
 38%|███▊      | 38/100 [17:53<26:44, 25.88s/it]epoch [38/100], focal_loss:0.0071	, anomaly_loss:0.3100	fnorm_loss:0.0059, a_fnorm_loss:0.0557P:0.65, R:0.96
 39%|███▉      | 39/100 [18:15<25:08, 24.74s/it]epoch [39/100], focal_loss:0.0062	, anomaly_loss:0.3065	fnorm_loss:0.0057, a_fnorm_loss:0.0561P:0.66, R:0.97
 40%|████      | 40/100 [19:08<33:10, 33.17s/it]epoch [40/100], focal_loss:0.0065	, anomaly_loss:0.3039	fnorm_loss:0.0057, a_fnorm_loss:0.0558P:0.64, R:0.97
normal: 0.0232 0.1699  anomaly: 0.0264 0.5718	P:0.08, R:0.08
Pixel Auroc:0.979, Sample Auroc0.895, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0182
 41%|████      | 41/100 [19:30<29:24, 29.91s/it]epoch [41/100], focal_loss:0.0062	, anomaly_loss:0.3046	fnorm_loss:0.0057, a_fnorm_loss:0.0560P:0.66, R:0.97
 42%|████▏     | 42/100 [19:52<26:38, 27.56s/it]epoch [42/100], focal_loss:0.0063	, anomaly_loss:0.3046	fnorm_loss:0.0056, a_fnorm_loss:0.0564P:0.65, R:0.97
 43%|████▎     | 43/100 [20:14<24:39, 25.96s/it]epoch [43/100], focal_loss:0.0064	, anomaly_loss:0.3012	fnorm_loss:0.0057, a_fnorm_loss:0.0562P:0.66, R:0.97
 44%|████▍     | 44/100 [20:37<23:14, 24.89s/it]epoch [44/100], focal_loss:0.0061	, anomaly_loss:0.2998	fnorm_loss:0.0056, a_fnorm_loss:0.0559P:0.64, R:0.97
 45%|████▌     | 45/100 [21:21<28:14, 30.80s/it]epoch [45/100], focal_loss:0.0066	, anomaly_loss:0.3053	fnorm_loss:0.0057, a_fnorm_loss:0.0553P:0.64, R:0.97
normal: 0.0305 0.1716  anomaly: 0.0354 0.5462	P:0.07, R:0.08
Pixel Auroc:0.976, Sample Auroc0.899, Pixel Aupro0.0
test_fnorm_loss: 0.0052 test_afnorm_loss: 0.0228
 46%|████▌     | 46/100 [21:43<25:15, 28.07s/it]epoch [46/100], focal_loss:0.0062	, anomaly_loss:0.3046	fnorm_loss:0.0056, a_fnorm_loss:0.0561P:0.65, R:0.97
 47%|████▋     | 47/100 [22:06<23:23, 26.47s/it]epoch [47/100], focal_loss:0.0072	, anomaly_loss:0.3096	fnorm_loss:0.0057, a_fnorm_loss:0.0557P:0.64, R:0.95
 48%|████▊     | 48/100 [22:28<21:41, 25.02s/it]epoch [48/100], focal_loss:0.0068	, anomaly_loss:0.3055	fnorm_loss:0.0057, a_fnorm_loss:0.0550P:0.64, R:0.97
 49%|████▉     | 49/100 [22:50<20:33, 24.19s/it]epoch [49/100], focal_loss:0.0067	, anomaly_loss:0.3065	fnorm_loss:0.0057, a_fnorm_loss:0.0551P:0.64, R:0.96
 50%|█████     | 50/100 [23:34<25:15, 30.31s/it]epoch [50/100], focal_loss:0.0065	, anomaly_loss:0.3033	fnorm_loss:0.0057, a_fnorm_loss:0.0552P:0.63, R:0.97
normal: 0.0318 0.1739  anomaly: 0.0375 0.5875	P:0.08, R:0.08
Pixel Auroc:0.976, Sample Auroc0.913, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0216
 51%|█████     | 51/100 [23:56<22:37, 27.70s/it]epoch [51/100], focal_loss:0.0061	, anomaly_loss:0.3057	fnorm_loss:0.0056, a_fnorm_loss:0.0554P:0.63, R:0.97
 52%|█████▏    | 52/100 [24:18<20:43, 25.91s/it]epoch [52/100], focal_loss:0.0060	, anomaly_loss:0.2996	fnorm_loss:0.0056, a_fnorm_loss:0.0568P:0.66, R:0.97
 53%|█████▎    | 53/100 [24:39<19:19, 24.67s/it]epoch [53/100], focal_loss:0.0073	, anomaly_loss:0.3168	fnorm_loss:0.0056, a_fnorm_loss:0.0553P:0.64, R:0.94
 54%|█████▍    | 54/100 [25:01<18:14, 23.79s/it]epoch [54/100], focal_loss:0.0063	, anomaly_loss:0.3011	fnorm_loss:0.0056, a_fnorm_loss:0.0563P:0.65, R:0.97
 55%|█████▌    | 55/100 [25:46<22:31, 30.04s/it]epoch [55/100], focal_loss:0.0061	, anomaly_loss:0.2993	fnorm_loss:0.0056, a_fnorm_loss:0.0565P:0.65, R:0.98
normal: 0.0257 0.1712  anomaly: 0.0293 0.5849	P:0.08, R:0.08
Pixel Auroc:0.977, Sample Auroc0.885, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0191
 56%|█████▌    | 56/100 [26:08<20:15, 27.63s/it]epoch [56/100], focal_loss:0.0077	, anomaly_loss:0.3211	fnorm_loss:0.0058, a_fnorm_loss:0.0546P:0.65, R:0.93
 57%|█████▋    | 57/100 [26:30<18:35, 25.94s/it]epoch [57/100], focal_loss:0.0063	, anomaly_loss:0.3047	fnorm_loss:0.0056, a_fnorm_loss:0.0563P:0.62, R:0.97
 58%|█████▊    | 58/100 [26:52<17:25, 24.89s/it]epoch [58/100], focal_loss:0.0086	, anomaly_loss:0.3202	fnorm_loss:0.0060, a_fnorm_loss:0.0545P:0.61, R:0.94
 59%|█████▉    | 59/100 [27:14<16:26, 24.07s/it]epoch [59/100], focal_loss:0.0060	, anomaly_loss:0.3065	fnorm_loss:0.0056, a_fnorm_loss:0.0561P:0.66, R:0.97
 60%|██████    | 60/100 [27:59<20:09, 30.23s/it]epoch [60/100], focal_loss:0.0064	, anomaly_loss:0.3075	fnorm_loss:0.0056, a_fnorm_loss:0.0560P:0.65, R:0.97
normal: 0.0227 0.0822  anomaly: 0.0233 0.5547	P:0.07, R:0.07
Pixel Auroc:0.974, Sample Auroc0.914, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0184
 61%|██████    | 61/100 [28:21<18:03, 27.78s/it]epoch [61/100], focal_loss:0.0060	, anomaly_loss:0.3036	fnorm_loss:0.0055, a_fnorm_loss:0.0564P:0.65, R:0.97
 62%|██████▏   | 62/100 [28:43<16:32, 26.11s/it]epoch [62/100], focal_loss:0.0059	, anomaly_loss:0.3009	fnorm_loss:0.0056, a_fnorm_loss:0.0565P:0.64, R:0.97
 63%|██████▎   | 63/100 [29:05<15:22, 24.92s/it]epoch [63/100], focal_loss:0.0060	, anomaly_loss:0.3076	fnorm_loss:0.0056, a_fnorm_loss:0.0566P:0.65, R:0.97
 64%|██████▍   | 64/100 [29:27<14:17, 23.81s/it]epoch [64/100], focal_loss:0.0070	, anomaly_loss:0.3101	fnorm_loss:0.0056, a_fnorm_loss:0.0557P:0.64, R:0.95
 65%|██████▌   | 65/100 [30:12<17:39, 30.28s/it]epoch [65/100], focal_loss:0.0063	, anomaly_loss:0.3036	fnorm_loss:0.0056, a_fnorm_loss:0.0559P:0.65, R:0.97
normal: 0.0284 0.2014  anomaly: 0.0400 0.6104	P:0.07, R:0.08
Pixel Auroc:0.978, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0209
 66%|██████▌   | 66/100 [30:34<15:49, 27.93s/it]epoch [66/100], focal_loss:0.0060	, anomaly_loss:0.2975	fnorm_loss:0.0056, a_fnorm_loss:0.0561P:0.67, R:0.97
 67%|██████▋   | 67/100 [30:57<14:24, 26.19s/it]epoch [67/100], focal_loss:0.0057	, anomaly_loss:0.3007	fnorm_loss:0.0055, a_fnorm_loss:0.0571P:0.68, R:0.97
 68%|██████▊   | 68/100 [31:19<13:24, 25.14s/it]epoch [68/100], focal_loss:0.0061	, anomaly_loss:0.3019	fnorm_loss:0.0056, a_fnorm_loss:0.0560P:0.65, R:0.97
 69%|██████▉   | 69/100 [31:41<12:30, 24.21s/it]epoch [69/100], focal_loss:0.0056	, anomaly_loss:0.2964	fnorm_loss:0.0055, a_fnorm_loss:0.0573P:0.66, R:0.98
 70%|███████   | 70/100 [32:28<15:31, 31.05s/it]epoch [70/100], focal_loss:0.0063	, anomaly_loss:0.3066	fnorm_loss:0.0056, a_fnorm_loss:0.0556P:0.63, R:0.97
normal: 0.0381 0.4598  anomaly: 0.0970 0.7218	P:0.06, R:0.11
Pixel Auroc:0.975, Sample Auroc0.901, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0308
 71%|███████   | 71/100 [32:51<13:45, 28.45s/it]epoch [71/100], focal_loss:0.0061	, anomaly_loss:0.2978	fnorm_loss:0.0056, a_fnorm_loss:0.0561P:0.64, R:0.97
 72%|███████▏  | 72/100 [33:13<12:25, 26.64s/it]epoch [72/100], focal_loss:0.0057	, anomaly_loss:0.3004	fnorm_loss:0.0055, a_fnorm_loss:0.0568P:0.67, R:0.98
 73%|███████▎  | 73/100 [33:36<11:26, 25.41s/it]epoch [73/100], focal_loss:0.0062	, anomaly_loss:0.3003	fnorm_loss:0.0056, a_fnorm_loss:0.0566P:0.66, R:0.97
 74%|███████▍  | 74/100 [33:58<10:33, 24.36s/it]epoch [74/100], focal_loss:0.0059	, anomaly_loss:0.2985	fnorm_loss:0.0055, a_fnorm_loss:0.0565P:0.66, R:0.97
 75%|███████▌  | 75/100 [34:44<12:52, 30.91s/it]epoch [75/100], focal_loss:0.0058	, anomaly_loss:0.3038	fnorm_loss:0.0055, a_fnorm_loss:0.0565P:0.66, R:0.96
normal: 0.1283 0.4318  anomaly: 0.1594 0.7296	P:0.04, R:0.14
Pixel Auroc:0.980, Sample Auroc0.865, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0433
 76%|███████▌  | 76/100 [35:06<11:16, 28.20s/it]epoch [76/100], focal_loss:0.0064	, anomaly_loss:0.3008	fnorm_loss:0.0057, a_fnorm_loss:0.0566P:0.65, R:0.97
 77%|███████▋  | 77/100 [35:28<10:06, 26.35s/it]epoch [77/100], focal_loss:0.0058	, anomaly_loss:0.3004	fnorm_loss:0.0055, a_fnorm_loss:0.0566P:0.67, R:0.97
 78%|███████▊  | 78/100 [35:50<09:15, 25.25s/it]epoch [78/100], focal_loss:0.0060	, anomaly_loss:0.2978	fnorm_loss:0.0056, a_fnorm_loss:0.0567P:0.67, R:0.97
 79%|███████▉  | 79/100 [36:12<08:28, 24.21s/it]epoch [79/100], focal_loss:0.0059	, anomaly_loss:0.3034	fnorm_loss:0.0055, a_fnorm_loss:0.0570P:0.66, R:0.97
 80%|████████  | 80/100 [36:58<10:15, 30.76s/it]epoch [80/100], focal_loss:0.0058	, anomaly_loss:0.2928	fnorm_loss:0.0055, a_fnorm_loss:0.0568P:0.66, R:0.98
normal: 0.0224 0.2079  anomaly: 0.0277 0.5991	P:0.08, R:0.09
Pixel Auroc:0.973, Sample Auroc0.917, Pixel Aupro0.0
test_fnorm_loss: 0.0049 test_afnorm_loss: 0.0169
 81%|████████  | 81/100 [37:20<08:55, 28.17s/it]epoch [81/100], focal_loss:0.0057	, anomaly_loss:0.2985	fnorm_loss:0.0055, a_fnorm_loss:0.0568P:0.66, R:0.98
 82%|████████▏ | 82/100 [37:43<07:57, 26.51s/it]epoch [82/100], focal_loss:0.0057	, anomaly_loss:0.3045	fnorm_loss:0.0055, a_fnorm_loss:0.0569P:0.64, R:0.97
 83%|████████▎ | 83/100 [38:05<07:06, 25.12s/it]epoch [83/100], focal_loss:0.0053	, anomaly_loss:0.3007	fnorm_loss:0.0055, a_fnorm_loss:0.0575P:0.67, R:0.98
 84%|████████▍ | 84/100 [38:26<06:24, 24.06s/it]epoch [84/100], focal_loss:0.0054	, anomaly_loss:0.2998	fnorm_loss:0.0055, a_fnorm_loss:0.0569P:0.67, R:0.98
 85%|████████▌ | 85/100 [39:12<07:39, 30.60s/it]epoch [85/100], focal_loss:0.0055	, anomaly_loss:0.3011	fnorm_loss:0.0055, a_fnorm_loss:0.0578P:0.69, R:0.98
normal: 0.0229 0.1385  anomaly: 0.0278 0.6020	P:0.07, R:0.07
Pixel Auroc:0.971, Sample Auroc0.934, Pixel Aupro0.0
test_fnorm_loss: 0.0049 test_afnorm_loss: 0.0179
 86%|████████▌ | 86/100 [39:35<06:36, 28.35s/it]epoch [86/100], focal_loss:0.0055	, anomaly_loss:0.2964	fnorm_loss:0.0055, a_fnorm_loss:0.0572P:0.67, R:0.97
 87%|████████▋ | 87/100 [39:57<05:41, 26.30s/it]epoch [87/100], focal_loss:0.0056	, anomaly_loss:0.2978	fnorm_loss:0.0055, a_fnorm_loss:0.0571P:0.67, R:0.97
 88%|████████▊ | 88/100 [40:19<05:02, 25.17s/it]epoch [88/100], focal_loss:0.0052	, anomaly_loss:0.2963	fnorm_loss:0.0055, a_fnorm_loss:0.0576P:0.69, R:0.98
 89%|████████▉ | 89/100 [40:42<04:27, 24.31s/it]epoch [89/100], focal_loss:0.0055	, anomaly_loss:0.2999	fnorm_loss:0.0055, a_fnorm_loss:0.0580P:0.67, R:0.98
 90%|█████████ | 90/100 [41:28<05:08, 30.84s/it]epoch [90/100], focal_loss:0.0054	, anomaly_loss:0.3000	fnorm_loss:0.0055, a_fnorm_loss:0.0571P:0.66, R:0.98
normal: 0.0222 0.1303  anomaly: 0.0257 0.5971	P:0.07, R:0.08
Pixel Auroc:0.974, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0049 test_afnorm_loss: 0.0186
 91%|█████████ | 91/100 [41:49<04:12, 28.06s/it]epoch [91/100], focal_loss:0.0055	, anomaly_loss:0.3027	fnorm_loss:0.0055, a_fnorm_loss:0.0580P:0.68, R:0.98
 92%|█████████▏| 92/100 [42:12<03:31, 26.46s/it]epoch [92/100], focal_loss:0.0052	, anomaly_loss:0.2973	fnorm_loss:0.0054, a_fnorm_loss:0.0578P:0.67, R:0.98
 93%|█████████▎| 93/100 [42:34<02:56, 25.16s/it]epoch [93/100], focal_loss:0.0051	, anomaly_loss:0.2975	fnorm_loss:0.0054, a_fnorm_loss:0.0573P:0.68, R:0.98
 94%|█████████▍| 94/100 [42:56<02:25, 24.23s/it]epoch [94/100], focal_loss:0.0052	, anomaly_loss:0.2943	fnorm_loss:0.0054, a_fnorm_loss:0.0575P:0.68, R:0.98
 95%|█████████▌| 95/100 [43:45<02:38, 31.72s/it]epoch [95/100], focal_loss:0.0054	, anomaly_loss:0.2968	fnorm_loss:0.0055, a_fnorm_loss:0.0575P:0.68, R:0.98
normal: 0.0234 0.1490  anomaly: 0.0278 0.6114	P:0.07, R:0.08
Pixel Auroc:0.979, Sample Auroc0.917, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0210
 96%|█████████▌| 96/100 [44:09<01:56, 29.11s/it]epoch [96/100], focal_loss:0.0056	, anomaly_loss:0.3007	fnorm_loss:0.0055, a_fnorm_loss:0.0574P:0.68, R:0.97
 97%|█████████▋| 97/100 [44:31<01:20, 26.98s/it]epoch [97/100], focal_loss:0.0050	, anomaly_loss:0.2967	fnorm_loss:0.0054, a_fnorm_loss:0.0576P:0.68, R:0.98
 98%|█████████▊| 98/100 [44:53<00:51, 25.51s/it]epoch [98/100], focal_loss:0.0053	, anomaly_loss:0.2971	fnorm_loss:0.0055, a_fnorm_loss:0.0576P:0.68, R:0.98
 99%|█████████▉| 99/100 [45:15<00:24, 24.64s/it]epoch [99/100], focal_loss:0.0053	, anomaly_loss:0.2943	fnorm_loss:0.0055, a_fnorm_loss:0.0575P:0.68, R:0.98
100%|██████████| 100/100 [46:03<00:00, 31.57s/it]100%|██████████| 100/100 [46:03<00:00, 27.63s/it]
epoch [100/100], focal_loss:0.0054	, anomaly_loss:0.2993	fnorm_loss:0.0055, a_fnorm_loss:0.0577P:0.68, R:0.98
normal: 0.0224 0.1335  anomaly: 0.0251 0.6031	P:0.07, R:0.07
Pixel Auroc:0.978, Sample Auroc0.916, Pixel Aupro0.0
test_fnorm_loss: 0.0050 test_afnorm_loss: 0.0200
training Stubborn Student...
candle
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<32:01, 16.15s/it]epoch [1/120], kd_loss:3.6113
  2%|▏         | 2/120 [00:32<31:53, 16.22s/it]epoch [2/120], kd_loss:2.3151
  2%|▎         | 3/120 [00:48<31:45, 16.28s/it]epoch [3/120], kd_loss:1.9878
  3%|▎         | 4/120 [01:05<31:36, 16.35s/it]epoch [4/120], kd_loss:1.8187
  4%|▍         | 5/120 [01:21<31:21, 16.37s/it]epoch [5/120], kd_loss:1.8561
  5%|▌         | 6/120 [01:38<31:07, 16.38s/it]epoch [6/120], kd_loss:1.7361
  6%|▌         | 7/120 [01:54<30:55, 16.42s/it]epoch [7/120], kd_loss:1.5860
  7%|▋         | 8/120 [02:10<30:38, 16.42s/it]epoch [8/120], kd_loss:1.7017
  8%|▊         | 9/120 [02:27<30:22, 16.42s/it]epoch [9/120], kd_loss:1.5494
  8%|▊         | 10/120 [03:07<43:27, 23.71s/it]epoch [10/120], kd_loss:1.6358
normal: 0.9083 1.3451  anomaly: 0.9561 1.8303
thresh: 1.1075545345568314
fpr: 0.15 fnr 0.17
Pixel Auroc:0.946, Sample Auroc0.906, Pixel Aupro0.0
  9%|▉         | 11/120 [03:23<38:58, 21.45s/it]epoch [11/120], kd_loss:1.4893
 10%|█         | 12/120 [03:40<35:48, 19.89s/it]epoch [12/120], kd_loss:1.6668
 11%|█         | 13/120 [03:56<33:32, 18.81s/it]epoch [13/120], kd_loss:1.5479
 12%|█▏        | 14/120 [04:12<31:58, 18.10s/it]epoch [14/120], kd_loss:1.7764
 12%|█▎        | 15/120 [04:29<30:49, 17.62s/it]epoch [15/120], kd_loss:1.5205
 13%|█▎        | 16/120 [04:45<29:56, 17.28s/it]epoch [16/120], kd_loss:1.4716
 14%|█▍        | 17/120 [05:02<29:14, 17.04s/it]epoch [17/120], kd_loss:1.4260
 15%|█▌        | 18/120 [05:18<28:39, 16.86s/it]epoch [18/120], kd_loss:1.3797
 16%|█▌        | 19/120 [05:35<28:12, 16.75s/it]epoch [19/120], kd_loss:1.4414
 17%|█▋        | 20/120 [06:14<38:58, 23.38s/it]epoch [20/120], kd_loss:1.4233
normal: 0.8318 1.6054  anomaly: 0.9037 1.9264
thresh: 1.0748491072960236
fpr: 0.15 fnr 0.14
Pixel Auroc:0.967, Sample Auroc0.907, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:30<35:05, 21.27s/it]epoch [21/120], kd_loss:1.3590
 18%|█▊        | 22/120 [06:46<32:19, 19.79s/it]epoch [22/120], kd_loss:1.3316
 19%|█▉        | 23/120 [07:03<30:19, 18.76s/it]epoch [23/120], kd_loss:1.3164
 20%|██        | 24/120 [07:19<28:52, 18.05s/it]epoch [24/120], kd_loss:1.3288
 21%|██        | 25/120 [07:35<27:48, 17.57s/it]epoch [25/120], kd_loss:1.2880
 22%|██▏       | 26/120 [07:52<27:00, 17.24s/it]epoch [26/120], kd_loss:1.3065
 22%|██▎       | 27/120 [08:08<26:20, 17.00s/it]epoch [27/120], kd_loss:1.3038
 23%|██▎       | 28/120 [08:25<25:50, 16.86s/it]epoch [28/120], kd_loss:1.4287
 24%|██▍       | 29/120 [08:41<25:23, 16.74s/it]epoch [29/120], kd_loss:1.3133
 25%|██▌       | 30/120 [09:22<35:42, 23.80s/it]epoch [30/120], kd_loss:1.2630
normal: 0.7529 1.2992  anomaly: 0.7864 1.7311
thresh: 0.9927121484489789
fpr: 0.03 fnr 0.2
Pixel Auroc:0.959, Sample Auroc0.920, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:38<31:55, 21.52s/it]epoch [31/120], kd_loss:1.3576
 27%|██▋       | 32/120 [09:54<29:17, 19.97s/it]epoch [32/120], kd_loss:1.2778
 28%|██▊       | 33/120 [10:10<27:21, 18.87s/it]epoch [33/120], kd_loss:1.2665
 28%|██▊       | 34/120 [10:27<25:58, 18.13s/it]epoch [34/120], kd_loss:1.2730
 29%|██▉       | 35/120 [10:43<24:55, 17.60s/it]epoch [35/120], kd_loss:1.2425
 30%|███       | 36/120 [11:00<24:10, 17.27s/it]epoch [36/120], kd_loss:1.2185
 31%|███       | 37/120 [11:16<23:35, 17.06s/it]epoch [37/120], kd_loss:1.2265
 32%|███▏      | 38/120 [11:33<23:07, 16.92s/it]epoch [38/120], kd_loss:1.2185
 32%|███▎      | 39/120 [11:49<22:38, 16.78s/it]epoch [39/120], kd_loss:1.1651
 33%|███▎      | 40/120 [12:29<31:32, 23.66s/it]epoch [40/120], kd_loss:1.1451
normal: 0.6588 1.0875  anomaly: 0.7244 1.7948
thresh: 0.9863264009620292
fpr: 0.03 fnr 0.26
Pixel Auroc:0.970, Sample Auroc0.908, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:45<28:13, 21.44s/it]epoch [41/120], kd_loss:1.1385
 35%|███▌      | 42/120 [13:02<25:55, 19.94s/it]epoch [42/120], kd_loss:1.2964
 36%|███▌      | 43/120 [13:18<24:16, 18.92s/it]epoch [43/120], kd_loss:1.2195
 37%|███▋      | 44/120 [13:35<23:05, 18.23s/it]epoch [44/120], kd_loss:1.1993
 38%|███▊      | 45/120 [13:51<22:07, 17.70s/it]epoch [45/120], kd_loss:1.3032
 38%|███▊      | 46/120 [14:08<21:20, 17.30s/it]epoch [46/120], kd_loss:1.1732
 39%|███▉      | 47/120 [14:24<20:46, 17.07s/it]epoch [47/120], kd_loss:1.1749
 40%|████      | 48/120 [14:41<20:16, 16.89s/it]epoch [48/120], kd_loss:1.3370
 41%|████      | 49/120 [14:57<19:53, 16.81s/it]epoch [49/120], kd_loss:1.4817
 42%|████▏     | 50/120 [15:35<27:03, 23.19s/it]epoch [50/120], kd_loss:1.2405
normal: 0.7149 1.1576  anomaly: 0.7905 1.7098
thresh: 0.9738463315995526
fpr: 0.07 fnr 0.25
Pixel Auroc:0.963, Sample Auroc0.904, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:52<24:18, 21.13s/it]epoch [51/120], kd_loss:1.2038
 43%|████▎     | 52/120 [16:08<22:20, 19.71s/it]epoch [52/120], kd_loss:1.1952
 44%|████▍     | 53/120 [16:25<20:53, 18.71s/it]epoch [53/120], kd_loss:1.2903
 45%|████▌     | 54/120 [16:41<19:50, 18.04s/it]epoch [54/120], kd_loss:1.2952
 46%|████▌     | 55/120 [16:58<19:02, 17.57s/it]epoch [55/120], kd_loss:1.1845
 47%|████▋     | 56/120 [17:14<18:24, 17.26s/it]epoch [56/120], kd_loss:1.1995
 48%|████▊     | 57/120 [17:31<17:52, 17.02s/it]epoch [57/120], kd_loss:1.1652
 48%|████▊     | 58/120 [17:47<17:23, 16.82s/it]epoch [58/120], kd_loss:1.2596
 49%|████▉     | 59/120 [18:03<17:01, 16.75s/it]epoch [59/120], kd_loss:1.3882
 50%|█████     | 60/120 [18:41<22:57, 22.95s/it]epoch [60/120], kd_loss:1.1967
normal: 0.6881 1.1075  anomaly: 0.7368 1.7569
thresh: 0.9100207676423318
fpr: 0.14 fnr 0.19
Pixel Auroc:0.971, Sample Auroc0.906, Pixel Aupro0.0
 51%|█████     | 61/120 [18:57<20:37, 20.98s/it]epoch [61/120], kd_loss:1.1729
 52%|█████▏    | 62/120 [19:14<18:58, 19.62s/it]epoch [62/120], kd_loss:1.1553
 52%|█████▎    | 63/120 [19:30<17:44, 18.68s/it]epoch [63/120], kd_loss:1.2314
 53%|█████▎    | 64/120 [19:47<16:49, 18.03s/it]epoch [64/120], kd_loss:1.2302
 54%|█████▍    | 65/120 [20:03<16:04, 17.54s/it]epoch [65/120], kd_loss:1.2120
 55%|█████▌    | 66/120 [20:20<15:29, 17.22s/it]epoch [66/120], kd_loss:1.2380
 56%|█████▌    | 67/120 [20:36<15:01, 17.01s/it]epoch [67/120], kd_loss:1.1821
 57%|█████▋    | 68/120 [20:53<14:35, 16.84s/it]epoch [68/120], kd_loss:1.1597
 57%|█████▊    | 69/120 [21:09<14:12, 16.71s/it]epoch [69/120], kd_loss:1.1997
 58%|█████▊    | 70/120 [21:48<19:31, 23.42s/it]epoch [70/120], kd_loss:1.2607
normal: 0.7478 1.3443  anomaly: 0.7825 1.7897
thresh: 0.9480770438936095
fpr: 0.16 fnr 0.16
Pixel Auroc:0.963, Sample Auroc0.900, Pixel Aupro0.0
 59%|█████▉    | 71/120 [22:04<17:25, 21.33s/it]epoch [71/120], kd_loss:1.3336
 60%|██████    | 72/120 [22:21<15:52, 19.85s/it]epoch [72/120], kd_loss:1.2427
 61%|██████    | 73/120 [22:37<14:44, 18.81s/it]epoch [73/120], kd_loss:1.2082
 62%|██████▏   | 74/120 [22:54<13:53, 18.13s/it]epoch [74/120], kd_loss:1.1611
 62%|██████▎   | 75/120 [23:10<13:14, 17.66s/it]epoch [75/120], kd_loss:1.1391
 63%|██████▎   | 76/120 [23:27<12:40, 17.29s/it]epoch [76/120], kd_loss:1.1433
 64%|██████▍   | 77/120 [23:43<12:11, 17.02s/it]epoch [77/120], kd_loss:1.1265
 65%|██████▌   | 78/120 [24:00<11:47, 16.85s/it]epoch [78/120], kd_loss:1.1362
 66%|██████▌   | 79/120 [24:16<11:26, 16.75s/it]epoch [79/120], kd_loss:1.1038
 67%|██████▋   | 80/120 [24:53<15:13, 22.83s/it]epoch [80/120], kd_loss:1.1562
normal: 0.6704 1.2220  anomaly: 0.7581 1.7589
thresh: 0.8810177648695711
fpr: 0.22 fnr 0.14
Pixel Auroc:0.972, Sample Auroc0.901, Pixel Aupro0.0
 68%|██████▊   | 81/120 [25:10<13:34, 20.88s/it]epoch [81/120], kd_loss:1.4829
 68%|██████▊   | 82/120 [25:26<12:23, 19.56s/it]epoch [82/120], kd_loss:1.3789
 69%|██████▉   | 83/120 [25:42<11:29, 18.63s/it]epoch [83/120], kd_loss:1.3092
 70%|███████   | 84/120 [25:59<10:45, 17.92s/it]epoch [84/120], kd_loss:1.2993
 71%|███████   | 85/120 [26:15<10:11, 17.47s/it]epoch [85/120], kd_loss:1.5038
 72%|███████▏  | 86/120 [26:32<09:44, 17.18s/it]epoch [86/120], kd_loss:1.2689
 72%|███████▎  | 87/120 [26:48<09:20, 16.98s/it]epoch [87/120], kd_loss:1.2033
 73%|███████▎  | 88/120 [27:05<08:58, 16.84s/it]epoch [88/120], kd_loss:1.2141
 74%|███████▍  | 89/120 [27:21<08:38, 16.73s/it]epoch [89/120], kd_loss:1.1962
 75%|███████▌  | 90/120 [28:00<11:36, 23.22s/it]epoch [90/120], kd_loss:1.1849
normal: 0.6648 1.1087  anomaly: 0.7292 1.8105
thresh: 0.9403029954171296
fpr: 0.07 fnr 0.26
Pixel Auroc:0.973, Sample Auroc0.887, Pixel Aupro0.0
 76%|███████▌  | 91/120 [28:16<10:13, 21.14s/it]epoch [91/120], kd_loss:1.1636
 77%|███████▋  | 92/120 [28:32<09:11, 19.69s/it]epoch [92/120], kd_loss:1.1610
 78%|███████▊  | 93/120 [28:49<08:26, 18.76s/it]epoch [93/120], kd_loss:1.1458
 78%|███████▊  | 94/120 [29:05<07:51, 18.12s/it]epoch [94/120], kd_loss:1.2259
 79%|███████▉  | 95/120 [29:22<07:21, 17.66s/it]epoch [95/120], kd_loss:1.1587
 80%|████████  | 96/120 [29:38<06:54, 17.28s/it]epoch [96/120], kd_loss:1.1641
 81%|████████  | 97/120 [29:55<06:31, 17.04s/it]epoch [97/120], kd_loss:1.1431
 82%|████████▏ | 98/120 [30:11<06:11, 16.87s/it]epoch [98/120], kd_loss:1.1427
 82%|████████▎ | 99/120 [30:28<05:51, 16.76s/it]epoch [99/120], kd_loss:1.1451
 83%|████████▎ | 100/120 [31:06<07:41, 23.09s/it]epoch [100/120], kd_loss:1.1271
normal: 0.6584 1.2047  anomaly: 0.6832 1.7992
thresh: 0.9797095527426622
fpr: 0.05 fnr 0.26
Pixel Auroc:0.976, Sample Auroc0.905, Pixel Aupro0.0
 84%|████████▍ | 101/120 [31:22<06:40, 21.09s/it]epoch [101/120], kd_loss:1.1585
 85%|████████▌ | 102/120 [31:38<05:54, 19.70s/it]epoch [102/120], kd_loss:1.1293
 86%|████████▌ | 103/120 [31:55<05:18, 18.72s/it]epoch [103/120], kd_loss:1.1150
 87%|████████▋ | 104/120 [32:11<04:48, 18.03s/it]epoch [104/120], kd_loss:1.1126
 88%|████████▊ | 105/120 [32:28<04:23, 17.59s/it]epoch [105/120], kd_loss:1.1114
 88%|████████▊ | 106/120 [32:45<04:02, 17.30s/it]epoch [106/120], kd_loss:1.1081
 89%|████████▉ | 107/120 [33:01<03:41, 17.06s/it]epoch [107/120], kd_loss:1.1865
 90%|█████████ | 108/120 [33:18<03:22, 16.89s/it]epoch [108/120], kd_loss:1.1071
 91%|█████████ | 109/120 [33:34<03:04, 16.77s/it]epoch [109/120], kd_loss:1.0991
 92%|█████████▏| 110/120 [34:13<03:53, 23.31s/it]epoch [110/120], kd_loss:1.0977
normal: 0.6375 1.2283  anomaly: 0.6797 1.7732
thresh: 0.9152909633753323
fpr: 0.08 fnr 0.23
Pixel Auroc:0.974, Sample Auroc0.904, Pixel Aupro0.0
 92%|█████████▎| 111/120 [34:29<03:11, 21.22s/it]epoch [111/120], kd_loss:1.0962
 93%|█████████▎| 112/120 [34:45<02:38, 19.78s/it]epoch [112/120], kd_loss:1.0942
 94%|█████████▍| 113/120 [35:02<02:11, 18.77s/it]epoch [113/120], kd_loss:1.0929
 95%|█████████▌| 114/120 [35:18<01:48, 18.08s/it]epoch [114/120], kd_loss:1.0932
 96%|█████████▌| 115/120 [35:35<01:27, 17.60s/it]epoch [115/120], kd_loss:1.0911
 97%|█████████▋| 116/120 [35:51<01:08, 17.25s/it]epoch [116/120], kd_loss:1.0899
 98%|█████████▊| 117/120 [36:08<00:51, 17.00s/it]epoch [117/120], kd_loss:1.0900
 98%|█████████▊| 118/120 [36:24<00:33, 16.81s/it]epoch [118/120], kd_loss:1.0888
 99%|█████████▉| 119/120 [36:40<00:16, 16.69s/it]epoch [119/120], kd_loss:1.0878
100%|██████████| 120/120 [37:18<00:00, 22.95s/it]100%|██████████| 120/120 [37:18<00:00, 18.65s/it]
epoch [120/120], kd_loss:1.0882
normal: 0.6377 1.3053  anomaly: 0.6874 1.7713
thresh: 0.8122566205682769
fpr: 0.2 fnr 0.13
Pixel Auroc:0.976, Sample Auroc0.909, Pixel Aupro0.0
training Advanced Teacher...
capsules
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:35<58:33, 35.49s/it]epoch [1/100], focal_loss:0.0645	, anomaly_loss:0.5836	fnorm_loss:0.0557, a_fnorm_loss:0.0172P:0.00, R:0.01
normal: 0.2231 0.2301  anomaly: 0.2230 0.2299	P:0.00, R:0.00
Pixel Auroc:0.637, Sample Auroc0.582, Pixel Aupro0.0
test_fnorm_loss: 0.0496 test_afnorm_loss: 0.0164
  2%|▏         | 2/100 [00:50<38:40, 23.68s/it]epoch [2/100], focal_loss:0.0455	, anomaly_loss:0.6159	fnorm_loss:0.0446, a_fnorm_loss:0.0141P:0.00, R:0.00
  3%|▎         | 3/100 [01:05<31:24, 19.43s/it]epoch [3/100], focal_loss:0.0354	, anomaly_loss:0.6440	fnorm_loss:0.0367, a_fnorm_loss:0.0117P:0.00, R:0.00
  4%|▍         | 4/100 [01:20<28:19, 17.71s/it]epoch [4/100], focal_loss:0.0307	, anomaly_loss:0.6633	fnorm_loss:0.0321, a_fnorm_loss:0.0102P:0.00, R:0.00
  5%|▌         | 5/100 [01:54<37:17, 23.55s/it]epoch [5/100], focal_loss:0.0314	, anomaly_loss:0.6709	fnorm_loss:0.0300, a_fnorm_loss:0.0099P:0.00, R:0.01
normal: 0.1274 0.1293  anomaly: 0.1272 0.1295	P:0.00, R:0.00
Pixel Auroc:0.659, Sample Auroc0.614, Pixel Aupro0.0
test_fnorm_loss: 0.0293 test_afnorm_loss: 0.0101
  6%|▌         | 6/100 [02:08<32:01, 20.44s/it]epoch [6/100], focal_loss:0.0301	, anomaly_loss:0.6804	fnorm_loss:0.0284, a_fnorm_loss:0.0091P:0.00, R:0.00
  7%|▋         | 7/100 [02:23<28:44, 18.54s/it]epoch [7/100], focal_loss:0.0296	, anomaly_loss:0.6832	fnorm_loss:0.0276, a_fnorm_loss:0.0089P:0.00, R:0.00
  8%|▊         | 8/100 [02:37<26:27, 17.25s/it]epoch [8/100], focal_loss:0.0266	, anomaly_loss:0.6831	fnorm_loss:0.0271, a_fnorm_loss:0.0090P:0.00, R:0.00
  9%|▉         | 9/100 [02:52<24:53, 16.42s/it]epoch [9/100], focal_loss:0.0269	, anomaly_loss:0.5855	fnorm_loss:0.0260, a_fnorm_loss:0.0219P:0.06, R:0.22
 10%|█         | 10/100 [03:28<33:56, 22.63s/it]epoch [10/100], focal_loss:0.0243	, anomaly_loss:0.5343	fnorm_loss:0.0215, a_fnorm_loss:0.0340P:0.15, R:0.39
normal: 0.0863 0.1883  anomaly: 0.0863 0.2680	P:0.03, R:0.03
Pixel Auroc:0.871, Sample Auroc0.710, Pixel Aupro0.0
test_fnorm_loss: 0.0185 test_afnorm_loss: 0.0150
 11%|█         | 11/100 [03:43<29:47, 20.08s/it]epoch [11/100], focal_loss:0.0207	, anomaly_loss:0.5107	fnorm_loss:0.0185, a_fnorm_loss:0.0361P:0.14, R:0.50
 12%|█▏        | 12/100 [03:57<26:51, 18.32s/it]epoch [12/100], focal_loss:0.0197	, anomaly_loss:0.5010	fnorm_loss:0.0167, a_fnorm_loss:0.0375P:0.12, R:0.53
 13%|█▎        | 13/100 [04:11<24:51, 17.15s/it]epoch [13/100], focal_loss:0.0189	, anomaly_loss:0.4919	fnorm_loss:0.0152, a_fnorm_loss:0.0385P:0.16, R:0.55
 14%|█▍        | 14/100 [04:26<23:33, 16.44s/it]epoch [14/100], focal_loss:0.0188	, anomaly_loss:0.4829	fnorm_loss:0.0144, a_fnorm_loss:0.0385P:0.20, R:0.59
 15%|█▌        | 15/100 [05:05<33:01, 23.32s/it]epoch [15/100], focal_loss:0.0180	, anomaly_loss:0.4776	fnorm_loss:0.0135, a_fnorm_loss:0.0398P:0.21, R:0.60
normal: 0.1701 0.3320  anomaly: 0.1756 0.5430	P:0.08, R:0.11
Pixel Auroc:0.845, Sample Auroc0.661, Pixel Aupro0.0
test_fnorm_loss: 0.0129 test_afnorm_loss: 0.0225
 16%|█▌        | 16/100 [05:20<28:57, 20.69s/it]epoch [16/100], focal_loss:0.0172	, anomaly_loss:0.4632	fnorm_loss:0.0128, a_fnorm_loss:0.0399P:0.24, R:0.68
 17%|█▋        | 17/100 [05:35<26:05, 18.86s/it]epoch [17/100], focal_loss:0.0150	, anomaly_loss:0.4380	fnorm_loss:0.0120, a_fnorm_loss:0.0421P:0.26, R:0.79
 18%|█▊        | 18/100 [05:50<24:08, 17.67s/it]epoch [18/100], focal_loss:0.0148	, anomaly_loss:0.4369	fnorm_loss:0.0117, a_fnorm_loss:0.0426P:0.25, R:0.79
 19%|█▉        | 19/100 [06:04<22:40, 16.80s/it]epoch [19/100], focal_loss:0.0148	, anomaly_loss:0.4317	fnorm_loss:0.0113, a_fnorm_loss:0.0436P:0.27, R:0.79
 20%|██        | 20/100 [06:42<30:53, 23.17s/it]epoch [20/100], focal_loss:0.0134	, anomaly_loss:0.4295	fnorm_loss:0.0108, a_fnorm_loss:0.0451P:0.25, R:0.80
normal: 0.0993 0.3851  anomaly: 0.1232 0.5079	P:0.09, R:0.10
Pixel Auroc:0.897, Sample Auroc0.691, Pixel Aupro0.0
test_fnorm_loss: 0.0099 test_afnorm_loss: 0.0238
 21%|██        | 21/100 [06:57<27:04, 20.56s/it]epoch [21/100], focal_loss:0.0132	, anomaly_loss:0.4297	fnorm_loss:0.0105, a_fnorm_loss:0.0437P:0.28, R:0.80
 22%|██▏       | 22/100 [07:11<24:17, 18.69s/it]epoch [22/100], focal_loss:0.0123	, anomaly_loss:0.4184	fnorm_loss:0.0099, a_fnorm_loss:0.0473P:0.27, R:0.83
 23%|██▎       | 23/100 [07:26<22:25, 17.48s/it]epoch [23/100], focal_loss:0.0127	, anomaly_loss:0.4317	fnorm_loss:0.0098, a_fnorm_loss:0.0449P:0.28, R:0.80
 24%|██▍       | 24/100 [07:41<21:21, 16.87s/it]epoch [24/100], focal_loss:0.0126	, anomaly_loss:0.4115	fnorm_loss:0.0096, a_fnorm_loss:0.0464P:0.29, R:0.83
 25%|██▌       | 25/100 [08:20<29:26, 23.55s/it]epoch [25/100], focal_loss:0.0129	, anomaly_loss:0.4240	fnorm_loss:0.0094, a_fnorm_loss:0.0447P:0.29, R:0.81
normal: 0.0853 0.3566  anomaly: 0.0911 0.5490	P:0.11, R:0.10
Pixel Auroc:0.903, Sample Auroc0.700, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0232
 26%|██▌       | 26/100 [08:35<25:46, 20.90s/it]epoch [26/100], focal_loss:0.0126	, anomaly_loss:0.4359	fnorm_loss:0.0094, a_fnorm_loss:0.0445P:0.29, R:0.79
 27%|██▋       | 27/100 [08:49<22:58, 18.88s/it]epoch [27/100], focal_loss:0.0120	, anomaly_loss:0.4194	fnorm_loss:0.0089, a_fnorm_loss:0.0459P:0.27, R:0.83
 28%|██▊       | 28/100 [09:04<20:58, 17.48s/it]epoch [28/100], focal_loss:0.0115	, anomaly_loss:0.4133	fnorm_loss:0.0088, a_fnorm_loss:0.0465P:0.28, R:0.84
 29%|██▉       | 29/100 [09:18<19:32, 16.51s/it]epoch [29/100], focal_loss:0.0124	, anomaly_loss:0.4158	fnorm_loss:0.0089, a_fnorm_loss:0.0458P:0.30, R:0.81
 30%|███       | 30/100 [09:51<25:05, 21.51s/it]epoch [30/100], focal_loss:0.0122	, anomaly_loss:0.4287	fnorm_loss:0.0087, a_fnorm_loss:0.0448P:0.28, R:0.79
normal: 0.1179 0.3574  anomaly: 0.1132 0.5685	P:0.10, R:0.11
Pixel Auroc:0.906, Sample Auroc0.672, Pixel Aupro0.0
test_fnorm_loss: 0.0090 test_afnorm_loss: 0.0272
 31%|███       | 31/100 [10:05<22:15, 19.36s/it]epoch [31/100], focal_loss:0.0125	, anomaly_loss:0.4309	fnorm_loss:0.0087, a_fnorm_loss:0.0437P:0.29, R:0.77
 32%|███▏      | 32/100 [10:20<20:25, 18.03s/it]epoch [32/100], focal_loss:0.0127	, anomaly_loss:0.4321	fnorm_loss:0.0086, a_fnorm_loss:0.0439P:0.32, R:0.79
 33%|███▎      | 33/100 [10:35<18:58, 17.00s/it]epoch [33/100], focal_loss:0.0112	, anomaly_loss:0.4125	fnorm_loss:0.0083, a_fnorm_loss:0.0467P:0.30, R:0.82
 34%|███▍      | 34/100 [10:49<17:52, 16.25s/it]epoch [34/100], focal_loss:0.0116	, anomaly_loss:0.4182	fnorm_loss:0.0081, a_fnorm_loss:0.0469P:0.29, R:0.82
 35%|███▌      | 35/100 [11:22<22:59, 21.22s/it]epoch [35/100], focal_loss:0.0124	, anomaly_loss:0.4229	fnorm_loss:0.0082, a_fnorm_loss:0.0466P:0.31, R:0.79
normal: 0.0723 0.3460  anomaly: 0.0815 0.5567	P:0.10, R:0.09
Pixel Auroc:0.911, Sample Auroc0.707, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0176
 36%|███▌      | 36/100 [11:37<20:27, 19.18s/it]epoch [36/100], focal_loss:0.0111	, anomaly_loss:0.4140	fnorm_loss:0.0078, a_fnorm_loss:0.0473P:0.30, R:0.83
 37%|███▋      | 37/100 [11:51<18:38, 17.75s/it]epoch [37/100], focal_loss:0.0114	, anomaly_loss:0.4090	fnorm_loss:0.0078, a_fnorm_loss:0.0471P:0.29, R:0.84
 38%|███▊      | 38/100 [12:05<17:12, 16.65s/it]epoch [38/100], focal_loss:0.0102	, anomaly_loss:0.4022	fnorm_loss:0.0075, a_fnorm_loss:0.0481P:0.32, R:0.85
 39%|███▉      | 39/100 [12:20<16:16, 16.01s/it]epoch [39/100], focal_loss:0.0123	, anomaly_loss:0.4223	fnorm_loss:0.0079, a_fnorm_loss:0.0462P:0.31, R:0.80
 40%|████      | 40/100 [13:00<23:18, 23.31s/it]epoch [40/100], focal_loss:0.0106	, anomaly_loss:0.4081	fnorm_loss:0.0075, a_fnorm_loss:0.0472P:0.29, R:0.82
normal: 0.0482 0.3295  anomaly: 0.0462 0.5712	P:0.12, R:0.10
Pixel Auroc:0.933, Sample Auroc0.714, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0227
 41%|████      | 41/100 [13:15<20:23, 20.74s/it]epoch [41/100], focal_loss:0.0115	, anomaly_loss:0.4183	fnorm_loss:0.0077, a_fnorm_loss:0.0460P:0.29, R:0.81
 42%|████▏     | 42/100 [13:29<18:16, 18.91s/it]epoch [42/100], focal_loss:0.0111	, anomaly_loss:0.4149	fnorm_loss:0.0076, a_fnorm_loss:0.0478P:0.28, R:0.82
 43%|████▎     | 43/100 [13:44<16:43, 17.61s/it]epoch [43/100], focal_loss:0.0103	, anomaly_loss:0.4153	fnorm_loss:0.0074, a_fnorm_loss:0.0477P:0.28, R:0.82
 44%|████▍     | 44/100 [13:59<15:36, 16.73s/it]epoch [44/100], focal_loss:0.0101	, anomaly_loss:0.4059	fnorm_loss:0.0072, a_fnorm_loss:0.0484P:0.31, R:0.85
 45%|████▌     | 45/100 [14:34<20:28, 22.33s/it]epoch [45/100], focal_loss:0.0123	, anomaly_loss:0.4221	fnorm_loss:0.0074, a_fnorm_loss:0.0457P:0.33, R:0.80
normal: 0.4340 0.6439  anomaly: 0.3861 0.7157	P:0.03, R:0.24
Pixel Auroc:0.902, Sample Auroc0.639, Pixel Aupro0.0
test_fnorm_loss: 0.0163 test_afnorm_loss: 0.0401
 46%|████▌     | 46/100 [14:49<18:03, 20.07s/it]epoch [46/100], focal_loss:0.0148	, anomaly_loss:0.4660	fnorm_loss:0.0078, a_fnorm_loss:0.0436P:0.27, R:0.62
 47%|████▋     | 47/100 [15:03<16:14, 18.39s/it]epoch [47/100], focal_loss:0.0121	, anomaly_loss:0.4195	fnorm_loss:0.0076, a_fnorm_loss:0.0466P:0.30, R:0.80
 48%|████▊     | 48/100 [15:18<15:02, 17.36s/it]epoch [48/100], focal_loss:0.0102	, anomaly_loss:0.4076	fnorm_loss:0.0071, a_fnorm_loss:0.0475P:0.30, R:0.84
 49%|████▉     | 49/100 [15:32<13:57, 16.42s/it]epoch [49/100], focal_loss:0.0105	, anomaly_loss:0.4186	fnorm_loss:0.0074, a_fnorm_loss:0.0464P:0.28, R:0.81
 50%|█████     | 50/100 [16:07<18:15, 21.90s/it]epoch [50/100], focal_loss:0.0111	, anomaly_loss:0.4053	fnorm_loss:0.0070, a_fnorm_loss:0.0483P:0.32, R:0.85
normal: 0.2053 0.5305  anomaly: 0.1881 0.6541	P:0.09, R:0.17
Pixel Auroc:0.916, Sample Auroc0.708, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0281
 51%|█████     | 51/100 [16:22<16:08, 19.76s/it]epoch [51/100], focal_loss:0.0096	, anomaly_loss:0.4127	fnorm_loss:0.0070, a_fnorm_loss:0.0470P:0.29, R:0.83
 52%|█████▏    | 52/100 [16:37<14:36, 18.26s/it]epoch [52/100], focal_loss:0.0114	, anomaly_loss:0.4135	fnorm_loss:0.0073, a_fnorm_loss:0.0470P:0.30, R:0.81
 53%|█████▎    | 53/100 [16:51<13:19, 17.02s/it]epoch [53/100], focal_loss:0.0091	, anomaly_loss:0.3918	fnorm_loss:0.0068, a_fnorm_loss:0.0496P:0.33, R:0.87
 54%|█████▍    | 54/100 [17:05<12:29, 16.30s/it]epoch [54/100], focal_loss:0.0100	, anomaly_loss:0.3980	fnorm_loss:0.0068, a_fnorm_loss:0.0488P:0.29, R:0.86
 55%|█████▌    | 55/100 [17:40<16:27, 21.95s/it]epoch [55/100], focal_loss:0.0106	, anomaly_loss:0.4033	fnorm_loss:0.0068, a_fnorm_loss:0.0483P:0.30, R:0.83
normal: 0.0761 0.3394  anomaly: 0.0684 0.5645	P:0.12, R:0.10
Pixel Auroc:0.920, Sample Auroc0.676, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0215
 56%|█████▌    | 56/100 [17:55<14:26, 19.68s/it]epoch [56/100], focal_loss:0.0105	, anomaly_loss:0.4076	fnorm_loss:0.0068, a_fnorm_loss:0.0472P:0.35, R:0.84
 57%|█████▋    | 57/100 [18:10<13:04, 18.25s/it]epoch [57/100], focal_loss:0.0105	, anomaly_loss:0.4059	fnorm_loss:0.0068, a_fnorm_loss:0.0491P:0.32, R:0.84
 58%|█████▊    | 58/100 [18:25<12:03, 17.23s/it]epoch [58/100], focal_loss:0.0115	, anomaly_loss:0.4092	fnorm_loss:0.0071, a_fnorm_loss:0.0479P:0.33, R:0.84
 59%|█████▉    | 59/100 [18:39<11:15, 16.47s/it]epoch [59/100], focal_loss:0.0099	, anomaly_loss:0.4101	fnorm_loss:0.0067, a_fnorm_loss:0.0484P:0.32, R:0.83
 60%|██████    | 60/100 [19:14<14:34, 21.85s/it]epoch [60/100], focal_loss:0.0100	, anomaly_loss:0.4037	fnorm_loss:0.0066, a_fnorm_loss:0.0487P:0.32, R:0.83
normal: 0.1747 0.4737  anomaly: 0.1243 0.6444	P:0.10, R:0.14
Pixel Auroc:0.929, Sample Auroc0.628, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0357
 61%|██████    | 61/100 [19:28<12:43, 19.58s/it]epoch [61/100], focal_loss:0.0118	, anomaly_loss:0.4187	fnorm_loss:0.0070, a_fnorm_loss:0.0474P:0.34, R:0.80
 62%|██████▏   | 62/100 [19:43<11:31, 18.21s/it]epoch [62/100], focal_loss:0.0106	, anomaly_loss:0.4018	fnorm_loss:0.0068, a_fnorm_loss:0.0488P:0.33, R:0.85
 63%|██████▎   | 63/100 [19:58<10:38, 17.25s/it]epoch [63/100], focal_loss:0.0111	, anomaly_loss:0.4270	fnorm_loss:0.0069, a_fnorm_loss:0.0464P:0.33, R:0.77
 64%|██████▍   | 64/100 [20:13<09:53, 16.50s/it]epoch [64/100], focal_loss:0.0103	, anomaly_loss:0.4112	fnorm_loss:0.0068, a_fnorm_loss:0.0481P:0.32, R:0.83
 65%|██████▌   | 65/100 [20:47<12:43, 21.81s/it]epoch [65/100], focal_loss:0.0102	, anomaly_loss:0.4058	fnorm_loss:0.0067, a_fnorm_loss:0.0480P:0.33, R:0.83
normal: 0.1003 0.4345  anomaly: 0.1070 0.6459	P:0.12, R:0.12
Pixel Auroc:0.905, Sample Auroc0.730, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0247
 66%|██████▌   | 66/100 [21:02<11:09, 19.68s/it]epoch [66/100], focal_loss:0.0096	, anomaly_loss:0.3935	fnorm_loss:0.0065, a_fnorm_loss:0.0506P:0.31, R:0.87
 67%|██████▋   | 67/100 [21:16<10:00, 18.21s/it]epoch [67/100], focal_loss:0.0095	, anomaly_loss:0.3998	fnorm_loss:0.0066, a_fnorm_loss:0.0482P:0.31, R:0.84
 68%|██████▊   | 68/100 [21:31<09:07, 17.10s/it]epoch [68/100], focal_loss:0.0102	, anomaly_loss:0.4086	fnorm_loss:0.0066, a_fnorm_loss:0.0481P:0.32, R:0.83
 69%|██████▉   | 69/100 [21:46<08:30, 16.46s/it]epoch [69/100], focal_loss:0.0108	, anomaly_loss:0.4077	fnorm_loss:0.0067, a_fnorm_loss:0.0480P:0.30, R:0.82
 70%|███████   | 70/100 [22:26<11:43, 23.47s/it]epoch [70/100], focal_loss:0.0088	, anomaly_loss:0.4010	fnorm_loss:0.0064, a_fnorm_loss:0.0508P:0.33, R:0.86
normal: 0.0772 0.3702  anomaly: 0.0876 0.6463	P:0.12, R:0.13
Pixel Auroc:0.944, Sample Auroc0.727, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0283
 71%|███████   | 71/100 [22:40<10:01, 20.76s/it]epoch [71/100], focal_loss:0.0105	, anomaly_loss:0.4113	fnorm_loss:0.0067, a_fnorm_loss:0.0471P:0.32, R:0.82
 72%|███████▏  | 72/100 [22:56<08:56, 19.16s/it]epoch [72/100], focal_loss:0.0100	, anomaly_loss:0.3976	fnorm_loss:0.0066, a_fnorm_loss:0.0481P:0.29, R:0.86
 73%|███████▎  | 73/100 [23:11<08:02, 17.88s/it]epoch [73/100], focal_loss:0.0099	, anomaly_loss:0.3977	fnorm_loss:0.0063, a_fnorm_loss:0.0499P:0.31, R:0.86
 74%|███████▍  | 74/100 [23:25<07:16, 16.80s/it]epoch [74/100], focal_loss:0.0111	, anomaly_loss:0.4002	fnorm_loss:0.0065, a_fnorm_loss:0.0487P:0.33, R:0.84
 75%|███████▌  | 75/100 [23:58<09:03, 21.73s/it]epoch [75/100], focal_loss:0.0134	, anomaly_loss:0.4232	fnorm_loss:0.0068, a_fnorm_loss:0.0470P:0.30, R:0.75
normal: 0.1724 0.3936  anomaly: 0.1571 0.5098	P:0.07, R:0.11
Pixel Auroc:0.885, Sample Auroc0.698, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0292
 76%|███████▌  | 76/100 [24:12<07:48, 19.53s/it]epoch [76/100], focal_loss:0.0109	, anomaly_loss:0.4265	fnorm_loss:0.0066, a_fnorm_loss:0.0470P:0.27, R:0.75
 77%|███████▋  | 77/100 [24:27<06:54, 18.01s/it]epoch [77/100], focal_loss:0.0097	, anomaly_loss:0.4010	fnorm_loss:0.0064, a_fnorm_loss:0.0494P:0.29, R:0.86
 78%|███████▊  | 78/100 [24:41<06:12, 16.95s/it]epoch [78/100], focal_loss:0.0090	, anomaly_loss:0.3974	fnorm_loss:0.0062, a_fnorm_loss:0.0506P:0.31, R:0.89
 79%|███████▉  | 79/100 [24:56<05:38, 16.14s/it]epoch [79/100], focal_loss:0.0110	, anomaly_loss:0.4135	fnorm_loss:0.0066, a_fnorm_loss:0.0472P:0.28, R:0.82
 80%|████████  | 80/100 [25:30<07:09, 21.47s/it]epoch [80/100], focal_loss:0.0099	, anomaly_loss:0.4045	fnorm_loss:0.0064, a_fnorm_loss:0.0479P:0.29, R:0.84
normal: 0.1816 0.4925  anomaly: 0.1849 0.6397	P:0.08, R:0.16
Pixel Auroc:0.915, Sample Auroc0.705, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0311
 81%|████████  | 81/100 [25:45<06:11, 19.54s/it]epoch [81/100], focal_loss:0.0105	, anomaly_loss:0.4020	fnorm_loss:0.0067, a_fnorm_loss:0.0478P:0.29, R:0.86
 82%|████████▏ | 82/100 [25:59<05:26, 18.15s/it]epoch [82/100], focal_loss:0.0085	, anomaly_loss:0.3961	fnorm_loss:0.0062, a_fnorm_loss:0.0501P:0.30, R:0.85
 83%|████████▎ | 83/100 [26:14<04:49, 17.01s/it]epoch [83/100], focal_loss:0.0097	, anomaly_loss:0.3995	fnorm_loss:0.0063, a_fnorm_loss:0.0495P:0.28, R:0.84
 84%|████████▍ | 84/100 [26:28<04:19, 16.24s/it]epoch [84/100], focal_loss:0.0112	, anomaly_loss:0.3975	fnorm_loss:0.0065, a_fnorm_loss:0.0486P:0.29, R:0.85
 85%|████████▌ | 85/100 [27:03<05:25, 21.67s/it]epoch [85/100], focal_loss:0.0090	, anomaly_loss:0.3930	fnorm_loss:0.0063, a_fnorm_loss:0.0514P:0.33, R:0.87
normal: 0.0809 0.4017  anomaly: 0.0848 0.6339	P:0.12, R:0.12
Pixel Auroc:0.916, Sample Auroc0.741, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0264
 86%|████████▌ | 86/100 [27:17<04:34, 19.63s/it]epoch [86/100], focal_loss:0.0094	, anomaly_loss:0.3984	fnorm_loss:0.0062, a_fnorm_loss:0.0506P:0.31, R:0.86
 87%|████████▋ | 87/100 [27:32<03:56, 18.23s/it]epoch [87/100], focal_loss:0.0092	, anomaly_loss:0.3833	fnorm_loss:0.0063, a_fnorm_loss:0.0515P:0.33, R:0.87
 88%|████████▊ | 88/100 [27:47<03:26, 17.22s/it]epoch [88/100], focal_loss:0.0094	, anomaly_loss:0.4014	fnorm_loss:0.0064, a_fnorm_loss:0.0489P:0.29, R:0.84
 89%|████████▉ | 89/100 [28:02<03:01, 16.51s/it]epoch [89/100], focal_loss:0.0098	, anomaly_loss:0.3945	fnorm_loss:0.0064, a_fnorm_loss:0.0509P:0.32, R:0.86
 90%|█████████ | 90/100 [28:36<03:37, 21.80s/it]epoch [90/100], focal_loss:0.0099	, anomaly_loss:0.4068	fnorm_loss:0.0064, a_fnorm_loss:0.0491P:0.28, R:0.83
normal: 0.1159 0.4032  anomaly: 0.1044 0.6148	P:0.11, R:0.13
Pixel Auroc:0.921, Sample Auroc0.702, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0276
 91%|█████████ | 91/100 [28:51<02:56, 19.59s/it]epoch [91/100], focal_loss:0.0093	, anomaly_loss:0.3932	fnorm_loss:0.0066, a_fnorm_loss:0.0496P:0.30, R:0.86
 92%|█████████▏| 92/100 [29:05<02:24, 18.03s/it]epoch [92/100], focal_loss:0.0089	, anomaly_loss:0.3902	fnorm_loss:0.0063, a_fnorm_loss:0.0508P:0.33, R:0.87
 93%|█████████▎| 93/100 [29:20<01:59, 17.03s/it]epoch [93/100], focal_loss:0.0089	, anomaly_loss:0.3924	fnorm_loss:0.0063, a_fnorm_loss:0.0518P:0.30, R:0.88
 94%|█████████▍| 94/100 [29:35<01:37, 16.33s/it]epoch [94/100], focal_loss:0.0085	, anomaly_loss:0.3914	fnorm_loss:0.0062, a_fnorm_loss:0.0509P:0.31, R:0.87
 95%|█████████▌| 95/100 [30:07<01:46, 21.26s/it]epoch [95/100], focal_loss:0.0088	, anomaly_loss:0.3943	fnorm_loss:0.0063, a_fnorm_loss:0.0513P:0.30, R:0.86
normal: 0.0893 0.4014  anomaly: 0.0859 0.6335	P:0.11, R:0.13
Pixel Auroc:0.924, Sample Auroc0.728, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0277
 96%|█████████▌| 96/100 [30:22<01:17, 19.30s/it]epoch [96/100], focal_loss:0.0098	, anomaly_loss:0.4003	fnorm_loss:0.0063, a_fnorm_loss:0.0500P:0.33, R:0.85
 97%|█████████▋| 97/100 [30:36<00:53, 17.82s/it]epoch [97/100], focal_loss:0.0091	, anomaly_loss:0.3878	fnorm_loss:0.0063, a_fnorm_loss:0.0511P:0.32, R:0.88
 98%|█████████▊| 98/100 [30:51<00:33, 16.79s/it]epoch [98/100], focal_loss:0.0095	, anomaly_loss:0.3945	fnorm_loss:0.0063, a_fnorm_loss:0.0499P:0.30, R:0.85
 99%|█████████▉| 99/100 [31:05<00:16, 16.14s/it]epoch [99/100], focal_loss:0.0104	, anomaly_loss:0.3902	fnorm_loss:0.0065, a_fnorm_loss:0.0501P:0.31, R:0.85
100%|██████████| 100/100 [31:40<00:00, 21.55s/it]100%|██████████| 100/100 [31:40<00:00, 19.00s/it]
epoch [100/100], focal_loss:0.0090	, anomaly_loss:0.3846	fnorm_loss:0.0064, a_fnorm_loss:0.0511P:0.30, R:0.88
normal: 0.0797 0.3949  anomaly: 0.0775 0.6246	P:0.12, R:0.12
Pixel Auroc:0.924, Sample Auroc0.742, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0267
training Stubborn Student...
capsules
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:10<20:16, 10.22s/it]epoch [1/120], kd_loss:4.4713
  2%|▏         | 2/120 [00:20<20:09, 10.25s/it]epoch [2/120], kd_loss:3.7989
  2%|▎         | 3/120 [00:30<19:55, 10.21s/it]epoch [3/120], kd_loss:2.8987
  3%|▎         | 4/120 [00:40<19:44, 10.21s/it]epoch [4/120], kd_loss:2.2942
  4%|▍         | 5/120 [00:51<19:38, 10.25s/it]epoch [5/120], kd_loss:2.3154
  5%|▌         | 6/120 [01:01<19:27, 10.24s/it]epoch [6/120], kd_loss:2.0681
  6%|▌         | 7/120 [01:11<19:19, 10.26s/it]epoch [7/120], kd_loss:2.0355
  7%|▋         | 8/120 [01:22<19:11, 10.28s/it]epoch [8/120], kd_loss:1.9483
  8%|▊         | 9/120 [01:32<19:02, 10.29s/it]epoch [9/120], kd_loss:1.8393
  8%|▊         | 10/120 [02:00<29:06, 15.88s/it]epoch [10/120], kd_loss:1.9046
normal: 1.0358 1.5254  anomaly: 1.0138 2.2053
thresh: 1.2659339157305176
fpr: 0.13333333333333333 fnr 0.21
Pixel Auroc:0.940, Sample Auroc0.829, Pixel Aupro0.0
  9%|▉         | 11/120 [02:10<25:40, 14.14s/it]epoch [11/120], kd_loss:1.7842
 10%|█         | 12/120 [02:21<23:21, 12.97s/it]epoch [12/120], kd_loss:1.7260
 11%|█         | 13/120 [02:31<21:40, 12.15s/it]epoch [13/120], kd_loss:1.6744
 12%|█▏        | 14/120 [02:41<20:31, 11.62s/it]epoch [14/120], kd_loss:1.6680
 12%|█▎        | 15/120 [02:52<19:37, 11.22s/it]epoch [15/120], kd_loss:1.8672
 13%|█▎        | 16/120 [03:02<18:59, 10.95s/it]epoch [16/120], kd_loss:1.9651
 14%|█▍        | 17/120 [03:12<18:27, 10.76s/it]epoch [17/120], kd_loss:1.7153
 15%|█▌        | 18/120 [03:23<18:02, 10.61s/it]epoch [18/120], kd_loss:1.6420
 16%|█▌        | 19/120 [03:33<17:43, 10.53s/it]epoch [19/120], kd_loss:1.6109
 17%|█▋        | 20/120 [04:02<26:47, 16.07s/it]epoch [20/120], kd_loss:1.6018
normal: 0.9279 1.4390  anomaly: 0.9235 2.1452
thresh: 1.0962174226764134
fpr: 0.25 fnr 0.16
Pixel Auroc:0.948, Sample Auroc0.836, Pixel Aupro0.0
 18%|█▊        | 21/120 [04:12<23:39, 14.34s/it]epoch [21/120], kd_loss:1.5985
 18%|█▊        | 22/120 [04:22<21:24, 13.11s/it]epoch [22/120], kd_loss:1.6172
 19%|█▉        | 23/120 [04:33<19:48, 12.25s/it]epoch [23/120], kd_loss:1.6288
 20%|██        | 24/120 [04:43<18:38, 11.65s/it]epoch [24/120], kd_loss:1.6191
 21%|██        | 25/120 [04:53<17:49, 11.25s/it]epoch [25/120], kd_loss:1.5834
 22%|██▏       | 26/120 [05:04<17:10, 10.97s/it]epoch [26/120], kd_loss:1.5822
 22%|██▎       | 27/120 [05:14<16:40, 10.76s/it]epoch [27/120], kd_loss:1.5858
 23%|██▎       | 28/120 [05:24<16:16, 10.62s/it]epoch [28/120], kd_loss:1.8637
 24%|██▍       | 29/120 [05:34<15:57, 10.53s/it]epoch [29/120], kd_loss:2.0135
 25%|██▌       | 30/120 [06:02<23:28, 15.65s/it]epoch [30/120], kd_loss:1.8171
normal: 0.9746 1.4962  anomaly: 1.0180 2.1591
thresh: 1.1586618354369063
fpr: 0.31666666666666665 fnr 0.17
Pixel Auroc:0.941, Sample Auroc0.825, Pixel Aupro0.0
 26%|██▌       | 31/120 [06:12<20:48, 14.03s/it]epoch [31/120], kd_loss:2.5920
 27%|██▋       | 32/120 [06:23<18:54, 12.89s/it]epoch [32/120], kd_loss:2.1740
 28%|██▊       | 33/120 [06:33<17:31, 12.09s/it]epoch [33/120], kd_loss:2.1332
 28%|██▊       | 34/120 [06:43<16:32, 11.54s/it]epoch [34/120], kd_loss:1.9194
 29%|██▉       | 35/120 [06:53<15:48, 11.16s/it]epoch [35/120], kd_loss:1.8698
 30%|███       | 36/120 [07:04<15:14, 10.88s/it]epoch [36/120], kd_loss:1.9494
 31%|███       | 37/120 [07:14<14:49, 10.71s/it]epoch [37/120], kd_loss:1.8098
 32%|███▏      | 38/120 [07:24<14:29, 10.60s/it]epoch [38/120], kd_loss:1.7833
 32%|███▎      | 39/120 [07:35<14:11, 10.51s/it]epoch [39/120], kd_loss:1.7837
 33%|███▎      | 40/120 [08:03<21:12, 15.90s/it]epoch [40/120], kd_loss:1.7396
normal: 0.9946 1.5588  anomaly: 0.9644 2.0775
thresh: 1.139377612407379
fpr: 0.36666666666666664 fnr 0.14
Pixel Auroc:0.942, Sample Auroc0.832, Pixel Aupro0.0
 34%|███▍      | 41/120 [08:13<18:40, 14.18s/it]epoch [41/120], kd_loss:1.7216
 35%|███▌      | 42/120 [08:23<16:55, 13.02s/it]epoch [42/120], kd_loss:1.7047
 36%|███▌      | 43/120 [08:34<15:40, 12.21s/it]epoch [43/120], kd_loss:1.6822
 37%|███▋      | 44/120 [08:44<14:45, 11.65s/it]epoch [44/120], kd_loss:1.6734
 38%|███▊      | 45/120 [08:55<14:07, 11.30s/it]epoch [45/120], kd_loss:1.6709
 38%|███▊      | 46/120 [09:05<13:35, 11.02s/it]epoch [46/120], kd_loss:1.6433
 39%|███▉      | 47/120 [09:15<13:10, 10.83s/it]epoch [47/120], kd_loss:1.6393
 40%|████      | 48/120 [09:26<12:49, 10.69s/it]epoch [48/120], kd_loss:1.7203
 41%|████      | 49/120 [09:36<12:34, 10.63s/it]epoch [49/120], kd_loss:1.6703
 42%|████▏     | 50/120 [10:05<18:49, 16.14s/it]epoch [50/120], kd_loss:1.6516
normal: 0.9121 2.2541  anomaly: 0.9167 2.2342
thresh: 1.0790010442267683
fpr: 0.4 fnr 0.16
Pixel Auroc:0.952, Sample Auroc0.768, Pixel Aupro0.0
 42%|████▎     | 51/120 [10:15<16:32, 14.38s/it]epoch [51/120], kd_loss:1.6272
 43%|████▎     | 52/120 [10:26<14:54, 13.15s/it]epoch [52/120], kd_loss:1.6050
 44%|████▍     | 53/120 [10:36<13:43, 12.29s/it]epoch [53/120], kd_loss:1.5989
 45%|████▌     | 54/120 [10:46<12:52, 11.70s/it]epoch [54/120], kd_loss:1.6031
 46%|████▌     | 55/120 [10:57<12:16, 11.33s/it]epoch [55/120], kd_loss:1.5938
 47%|████▋     | 56/120 [11:07<11:45, 11.02s/it]epoch [56/120], kd_loss:1.5738
 48%|████▊     | 57/120 [11:18<11:22, 10.83s/it]epoch [57/120], kd_loss:1.5779
 48%|████▊     | 58/120 [11:28<11:03, 10.70s/it]epoch [58/120], kd_loss:1.5656
 49%|████▉     | 59/120 [11:38<10:46, 10.60s/it]epoch [59/120], kd_loss:1.6413
 50%|█████     | 60/120 [12:07<16:02, 16.05s/it]epoch [60/120], kd_loss:1.6346
normal: 0.9032 2.1534  anomaly: 0.9005 2.2952
thresh: 1.0788084569230616
fpr: 0.31666666666666665 fnr 0.15
Pixel Auroc:0.945, Sample Auroc0.834, Pixel Aupro0.0
 51%|█████     | 61/120 [12:17<14:04, 14.31s/it]epoch [61/120], kd_loss:1.6073
 52%|█████▏    | 62/120 [12:28<12:39, 13.10s/it]epoch [62/120], kd_loss:1.6349
 52%|█████▎    | 63/120 [12:38<11:38, 12.25s/it]epoch [63/120], kd_loss:1.6021
 53%|█████▎    | 64/120 [12:48<10:53, 11.67s/it]epoch [64/120], kd_loss:1.7316
 54%|█████▍    | 65/120 [12:59<10:22, 11.32s/it]epoch [65/120], kd_loss:1.6596
 55%|█████▌    | 66/120 [13:09<09:56, 11.04s/it]epoch [66/120], kd_loss:1.6374
 56%|█████▌    | 67/120 [13:19<09:35, 10.85s/it]epoch [67/120], kd_loss:1.5932
 57%|█████▋    | 68/120 [13:30<09:16, 10.71s/it]epoch [68/120], kd_loss:1.5779
 57%|█████▊    | 69/120 [13:40<09:00, 10.60s/it]epoch [69/120], kd_loss:1.5720
 58%|█████▊    | 70/120 [14:08<13:08, 15.77s/it]epoch [70/120], kd_loss:1.5616
normal: 0.9147 1.4014  anomaly: 0.9206 1.9562
thresh: 1.047384564916603
fpr: 0.4 fnr 0.19
Pixel Auroc:0.950, Sample Auroc0.794, Pixel Aupro0.0
 59%|█████▉    | 71/120 [14:18<11:31, 14.12s/it]epoch [71/120], kd_loss:1.8091
 60%|██████    | 72/120 [14:29<10:21, 12.96s/it]epoch [72/120], kd_loss:1.5814
 61%|██████    | 73/120 [14:39<09:31, 12.16s/it]epoch [73/120], kd_loss:1.5589
 62%|██████▏   | 74/120 [14:49<08:55, 11.64s/it]epoch [74/120], kd_loss:1.5600
 62%|██████▎   | 75/120 [15:00<08:25, 11.24s/it]epoch [75/120], kd_loss:1.5465
 63%|██████▎   | 76/120 [15:10<08:02, 10.97s/it]epoch [76/120], kd_loss:1.5360
 64%|██████▍   | 77/120 [15:20<07:43, 10.78s/it]epoch [77/120], kd_loss:1.5396
 65%|██████▌   | 78/120 [15:31<07:28, 10.67s/it]epoch [78/120], kd_loss:1.5185
 66%|██████▌   | 79/120 [15:41<07:13, 10.58s/it]epoch [79/120], kd_loss:1.5216
 67%|██████▋   | 80/120 [16:10<10:43, 16.08s/it]epoch [80/120], kd_loss:1.5113
normal: 0.8785 1.4219  anomaly: 0.9059 2.0167
thresh: 0.97240561947209
fpr: 0.6 fnr 0.07
Pixel Auroc:0.956, Sample Auroc0.808, Pixel Aupro0.0
 68%|██████▊   | 81/120 [16:20<09:21, 14.39s/it]epoch [81/120], kd_loss:1.5179
 68%|██████▊   | 82/120 [16:31<08:20, 13.17s/it]epoch [82/120], kd_loss:1.6621
 69%|██████▉   | 83/120 [16:41<07:38, 12.39s/it]epoch [83/120], kd_loss:1.5375
 70%|███████   | 84/120 [16:52<07:03, 11.76s/it]epoch [84/120], kd_loss:1.5498
 71%|███████   | 85/120 [17:02<06:36, 11.32s/it]epoch [85/120], kd_loss:1.5340
 72%|███████▏  | 86/120 [17:12<06:14, 11.01s/it]epoch [86/120], kd_loss:1.5635
 72%|███████▎  | 87/120 [17:23<05:57, 10.83s/it]epoch [87/120], kd_loss:1.5256
 73%|███████▎  | 88/120 [17:33<05:43, 10.72s/it]epoch [88/120], kd_loss:1.5607
 74%|███████▍  | 89/120 [17:43<05:29, 10.63s/it]epoch [89/120], kd_loss:1.5627
 75%|███████▌  | 90/120 [18:12<08:02, 16.07s/it]epoch [90/120], kd_loss:1.5356
normal: 0.8894 1.4383  anomaly: 0.8878 2.0615
thresh: 1.0375904539020349
fpr: 0.31666666666666665 fnr 0.2
Pixel Auroc:0.955, Sample Auroc0.803, Pixel Aupro0.0
 76%|███████▌  | 91/120 [18:23<06:55, 14.34s/it]epoch [91/120], kd_loss:1.5252
 77%|███████▋  | 92/120 [18:33<06:07, 13.13s/it]epoch [92/120], kd_loss:1.5174
 78%|███████▊  | 93/120 [18:43<05:32, 12.30s/it]epoch [93/120], kd_loss:1.5110
 78%|███████▊  | 94/120 [18:53<05:04, 11.70s/it]epoch [94/120], kd_loss:1.5197
 79%|███████▉  | 95/120 [19:04<04:42, 11.30s/it]epoch [95/120], kd_loss:1.5081
 80%|████████  | 96/120 [19:14<04:24, 11.01s/it]epoch [96/120], kd_loss:1.4982
 81%|████████  | 97/120 [19:25<04:09, 10.83s/it]epoch [97/120], kd_loss:1.4817
 82%|████████▏ | 98/120 [19:35<03:54, 10.68s/it]epoch [98/120], kd_loss:1.4761
 82%|████████▎ | 99/120 [19:45<03:42, 10.59s/it]epoch [99/120], kd_loss:1.4764
 83%|████████▎ | 100/120 [20:14<05:22, 16.12s/it]epoch [100/120], kd_loss:1.4717
normal: 0.8266 1.4511  anomaly: 0.8587 2.1255
thresh: 0.9984296612304624
fpr: 0.35 fnr 0.2
Pixel Auroc:0.958, Sample Auroc0.801, Pixel Aupro0.0
 84%|████████▍ | 101/120 [20:25<04:33, 14.39s/it]epoch [101/120], kd_loss:1.4690
 85%|████████▌ | 102/120 [20:35<03:56, 13.15s/it]epoch [102/120], kd_loss:1.4670
 86%|████████▌ | 103/120 [20:45<03:29, 12.33s/it]epoch [103/120], kd_loss:1.4631
 87%|████████▋ | 104/120 [20:56<03:07, 11.73s/it]epoch [104/120], kd_loss:1.4604
 88%|████████▊ | 105/120 [21:06<02:49, 11.33s/it]epoch [105/120], kd_loss:1.4613
 88%|████████▊ | 106/120 [21:16<02:34, 11.05s/it]epoch [106/120], kd_loss:1.4606
 89%|████████▉ | 107/120 [21:27<02:21, 10.86s/it]epoch [107/120], kd_loss:1.4569
 90%|█████████ | 108/120 [21:37<02:08, 10.70s/it]epoch [108/120], kd_loss:1.4637
 91%|█████████ | 109/120 [21:48<01:56, 10.58s/it]epoch [109/120], kd_loss:1.4768
 92%|█████████▏| 110/120 [22:17<02:41, 16.13s/it]epoch [110/120], kd_loss:1.4630
normal: 0.8239 1.4528  anomaly: 0.8457 2.1418
thresh: 0.9270721132382718
fpr: 0.75 fnr 0.05
Pixel Auroc:0.959, Sample Auroc0.800, Pixel Aupro0.0
 92%|█████████▎| 111/120 [22:27<02:09, 14.36s/it]epoch [111/120], kd_loss:1.4575
 93%|█████████▎| 112/120 [22:37<01:45, 13.14s/it]epoch [112/120], kd_loss:1.4547
 94%|█████████▍| 113/120 [22:47<01:25, 12.27s/it]epoch [113/120], kd_loss:1.4528
 95%|█████████▌| 114/120 [22:58<01:10, 11.68s/it]epoch [114/120], kd_loss:1.4519
 96%|█████████▌| 115/120 [23:08<00:56, 11.29s/it]epoch [115/120], kd_loss:1.4509
 97%|█████████▋| 116/120 [23:18<00:44, 11.01s/it]epoch [116/120], kd_loss:1.4494
 98%|█████████▊| 117/120 [23:29<00:32, 10.81s/it]epoch [117/120], kd_loss:1.4489
 98%|█████████▊| 118/120 [23:39<00:21, 10.67s/it]epoch [118/120], kd_loss:1.4485
 99%|█████████▉| 119/120 [23:49<00:10, 10.58s/it]epoch [119/120], kd_loss:1.4480
100%|██████████| 120/120 [24:18<00:00, 15.93s/it]100%|██████████| 120/120 [24:18<00:00, 12.15s/it]
epoch [120/120], kd_loss:1.4471
normal: 0.8228 1.4476  anomaly: 0.8523 2.0181
thresh: 0.9375714618153714
fpr: 0.6333333333333333 fnr 0.09
Pixel Auroc:0.959, Sample Auroc0.800, Pixel Aupro0.0
training Advanced Teacher...
cashew
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:34<57:31, 34.86s/it]epoch [1/100], focal_loss:0.0693	, anomaly_loss:0.5212	fnorm_loss:0.0716, a_fnorm_loss:0.0157P:0.00, R:0.02
normal: 0.2378 0.2434  anomaly: 0.2316 0.2433	P:0.00, R:0.00
Pixel Auroc:0.873, Sample Auroc0.517, Pixel Aupro0.0
test_fnorm_loss: 0.0648 test_afnorm_loss: 0.0167
  2%|▏         | 2/100 [00:49<37:04, 22.70s/it]epoch [2/100], focal_loss:0.0534	, anomaly_loss:0.5476	fnorm_loss:0.0597, a_fnorm_loss:0.0130P:0.00, R:0.00
  3%|▎         | 3/100 [01:03<30:53, 19.11s/it]epoch [3/100], focal_loss:0.0420	, anomaly_loss:0.5539	fnorm_loss:0.0503, a_fnorm_loss:0.0113P:0.00, R:0.00
  4%|▍         | 4/100 [01:18<27:32, 17.22s/it]epoch [4/100], focal_loss:0.0372	, anomaly_loss:0.5973	fnorm_loss:0.0439, a_fnorm_loss:0.0099P:0.00, R:0.00
  5%|▌         | 5/100 [01:50<35:47, 22.60s/it]epoch [5/100], focal_loss:0.0336	, anomaly_loss:0.5825	fnorm_loss:0.0412, a_fnorm_loss:0.0098P:0.00, R:0.00
normal: 0.1410 0.1456  anomaly: 0.1392 0.1467	P:0.00, R:0.00
Pixel Auroc:0.878, Sample Auroc0.479, Pixel Aupro0.0
test_fnorm_loss: 0.0377 test_afnorm_loss: 0.0105
  6%|▌         | 6/100 [02:04<30:59, 19.78s/it]epoch [6/100], focal_loss:0.0318	, anomaly_loss:0.4403	fnorm_loss:0.0361, a_fnorm_loss:0.0317P:0.13, R:0.37
  7%|▋         | 7/100 [02:20<28:37, 18.46s/it]epoch [7/100], focal_loss:0.0247	, anomaly_loss:0.3306	fnorm_loss:0.0293, a_fnorm_loss:0.0416P:0.27, R:0.85
  8%|▊         | 8/100 [02:34<26:00, 16.97s/it]epoch [8/100], focal_loss:0.0193	, anomaly_loss:0.2943	fnorm_loss:0.0247, a_fnorm_loss:0.0436P:0.32, R:0.88
  9%|▉         | 9/100 [02:47<23:59, 15.82s/it]epoch [9/100], focal_loss:0.0164	, anomaly_loss:0.2542	fnorm_loss:0.0217, a_fnorm_loss:0.0470P:0.33, R:0.91
 10%|█         | 10/100 [03:22<32:42, 21.80s/it]epoch [10/100], focal_loss:0.0133	, anomaly_loss:0.2521	fnorm_loss:0.0193, a_fnorm_loss:0.0480P:0.36, R:0.96
normal: 0.0672 0.1197  anomaly: 0.0693 0.4894	P:0.08, R:0.06
Pixel Auroc:0.930, Sample Auroc0.893, Pixel Aupro0.0
test_fnorm_loss: 0.0174 test_afnorm_loss: 0.0157
 11%|█         | 11/100 [03:37<29:02, 19.58s/it]epoch [11/100], focal_loss:0.0128	, anomaly_loss:0.2521	fnorm_loss:0.0176, a_fnorm_loss:0.0493P:0.39, R:0.95
 12%|█▏        | 12/100 [03:51<26:22, 17.99s/it]epoch [12/100], focal_loss:0.0126	, anomaly_loss:0.2450	fnorm_loss:0.0165, a_fnorm_loss:0.0495P:0.36, R:0.95
 13%|█▎        | 13/100 [04:05<24:29, 16.90s/it]epoch [13/100], focal_loss:0.0101	, anomaly_loss:0.2288	fnorm_loss:0.0150, a_fnorm_loss:0.0521P:0.46, R:0.93
 14%|█▍        | 14/100 [04:20<23:13, 16.21s/it]epoch [14/100], focal_loss:0.0112	, anomaly_loss:0.2417	fnorm_loss:0.0141, a_fnorm_loss:0.0516P:0.46, R:0.91
 15%|█▌        | 15/100 [04:59<32:30, 22.95s/it]epoch [15/100], focal_loss:0.0098	, anomaly_loss:0.2399	fnorm_loss:0.0136, a_fnorm_loss:0.0511P:0.48, R:0.95
normal: 0.0539 0.1874  anomaly: 0.0570 0.6466	P:0.12, R:0.09
Pixel Auroc:0.930, Sample Auroc0.801, Pixel Aupro0.0
test_fnorm_loss: 0.0124 test_afnorm_loss: 0.0253
 16%|█▌        | 16/100 [05:12<28:16, 20.20s/it]epoch [16/100], focal_loss:0.0085	, anomaly_loss:0.2305	fnorm_loss:0.0127, a_fnorm_loss:0.0530P:0.47, R:0.97
 17%|█▋        | 17/100 [05:26<25:10, 18.20s/it]epoch [17/100], focal_loss:0.0083	, anomaly_loss:0.2282	fnorm_loss:0.0121, a_fnorm_loss:0.0524P:0.45, R:0.93
 18%|█▊        | 18/100 [05:40<23:06, 16.91s/it]epoch [18/100], focal_loss:0.0070	, anomaly_loss:0.2221	fnorm_loss:0.0115, a_fnorm_loss:0.0540P:0.48, R:0.94
 19%|█▉        | 19/100 [05:54<21:33, 15.97s/it]epoch [19/100], focal_loss:0.0076	, anomaly_loss:0.2274	fnorm_loss:0.0111, a_fnorm_loss:0.0542P:0.52, R:0.97
 20%|██        | 20/100 [06:26<27:47, 20.84s/it]epoch [20/100], focal_loss:0.0075	, anomaly_loss:0.2203	fnorm_loss:0.0106, a_fnorm_loss:0.0550P:0.52, R:0.96
normal: 0.0653 0.4085  anomaly: 0.0832 0.7435	P:0.11, R:0.13
Pixel Auroc:0.960, Sample Auroc0.821, Pixel Aupro0.0
test_fnorm_loss: 0.0106 test_afnorm_loss: 0.0411
 21%|██        | 21/100 [06:40<24:44, 18.79s/it]epoch [21/100], focal_loss:0.0067	, anomaly_loss:0.2178	fnorm_loss:0.0103, a_fnorm_loss:0.0542P:0.55, R:0.97
 22%|██▏       | 22/100 [06:54<22:25, 17.25s/it]epoch [22/100], focal_loss:0.0072	, anomaly_loss:0.2269	fnorm_loss:0.0100, a_fnorm_loss:0.0553P:0.55, R:0.95
 23%|██▎       | 23/100 [07:08<21:06, 16.45s/it]epoch [23/100], focal_loss:0.0075	, anomaly_loss:0.2176	fnorm_loss:0.0098, a_fnorm_loss:0.0549P:0.51, R:0.93
 24%|██▍       | 24/100 [07:22<19:57, 15.76s/it]epoch [24/100], focal_loss:0.0062	, anomaly_loss:0.2132	fnorm_loss:0.0094, a_fnorm_loss:0.0560P:0.57, R:0.98
 25%|██▌       | 25/100 [07:56<26:15, 21.01s/it]epoch [25/100], focal_loss:0.0061	, anomaly_loss:0.2170	fnorm_loss:0.0092, a_fnorm_loss:0.0564P:0.52, R:0.97
normal: 0.0314 0.1340  anomaly: 0.0320 0.6572	P:0.10, R:0.07
Pixel Auroc:0.931, Sample Auroc0.803, Pixel Aupro0.0
test_fnorm_loss: 0.0085 test_afnorm_loss: 0.0213
 26%|██▌       | 26/100 [08:09<23:15, 18.85s/it]epoch [26/100], focal_loss:0.0082	, anomaly_loss:0.2476	fnorm_loss:0.0090, a_fnorm_loss:0.0547P:0.57, R:0.90
 27%|██▋       | 27/100 [08:24<21:27, 17.63s/it]epoch [27/100], focal_loss:0.0086	, anomaly_loss:0.2198	fnorm_loss:0.0089, a_fnorm_loss:0.0559P:0.50, R:0.97
 28%|██▊       | 28/100 [08:38<19:54, 16.59s/it]epoch [28/100], focal_loss:0.0074	, anomaly_loss:0.2222	fnorm_loss:0.0087, a_fnorm_loss:0.0562P:0.49, R:0.98
 29%|██▉       | 29/100 [08:52<18:40, 15.77s/it]epoch [29/100], focal_loss:0.0072	, anomaly_loss:0.2225	fnorm_loss:0.0086, a_fnorm_loss:0.0559P:0.49, R:0.90
 30%|███       | 30/100 [09:29<25:55, 22.22s/it]epoch [30/100], focal_loss:0.0063	, anomaly_loss:0.2162	fnorm_loss:0.0083, a_fnorm_loss:0.0567P:0.58, R:0.97
normal: 0.0381 0.2483  anomaly: 0.0428 0.7281	P:0.12, R:0.10
Pixel Auroc:0.933, Sample Auroc0.659, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0276
 31%|███       | 31/100 [09:43<22:40, 19.72s/it]epoch [31/100], focal_loss:0.0059	, anomaly_loss:0.2053	fnorm_loss:0.0082, a_fnorm_loss:0.0574P:0.48, R:0.98
 32%|███▏      | 32/100 [09:57<20:25, 18.03s/it]epoch [32/100], focal_loss:0.0050	, anomaly_loss:0.2013	fnorm_loss:0.0079, a_fnorm_loss:0.0572P:0.52, R:0.94
 33%|███▎      | 33/100 [10:11<18:38, 16.70s/it]epoch [33/100], focal_loss:0.0057	, anomaly_loss:0.2088	fnorm_loss:0.0079, a_fnorm_loss:0.0585P:0.53, R:0.97
 34%|███▍      | 34/100 [10:25<17:25, 15.85s/it]epoch [34/100], focal_loss:0.0056	, anomaly_loss:0.2209	fnorm_loss:0.0078, a_fnorm_loss:0.0579P:0.54, R:0.97
 35%|███▌      | 35/100 [10:56<22:04, 20.38s/it]epoch [35/100], focal_loss:0.0050	, anomaly_loss:0.2121	fnorm_loss:0.0076, a_fnorm_loss:0.0586P:0.56, R:0.98
normal: 0.0293 0.3054  anomaly: 0.0624 0.7574	P:0.10, R:0.12
Pixel Auroc:0.948, Sample Auroc0.881, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0405
 36%|███▌      | 36/100 [11:10<19:49, 18.58s/it]epoch [36/100], focal_loss:0.0061	, anomaly_loss:0.2144	fnorm_loss:0.0076, a_fnorm_loss:0.0593P:0.55, R:0.97
 37%|███▋      | 37/100 [11:24<17:55, 17.07s/it]epoch [37/100], focal_loss:0.0061	, anomaly_loss:0.2158	fnorm_loss:0.0075, a_fnorm_loss:0.0579P:0.54, R:0.97
 38%|███▊      | 38/100 [11:38<16:42, 16.18s/it]epoch [38/100], focal_loss:0.0057	, anomaly_loss:0.2117	fnorm_loss:0.0073, a_fnorm_loss:0.0576P:0.60, R:0.97
 39%|███▉      | 39/100 [11:52<15:59, 15.73s/it]epoch [39/100], focal_loss:0.0053	, anomaly_loss:0.2084	fnorm_loss:0.0073, a_fnorm_loss:0.0581P:0.56, R:0.98
 40%|████      | 40/100 [12:29<22:02, 22.05s/it]epoch [40/100], focal_loss:0.0050	, anomaly_loss:0.2121	fnorm_loss:0.0072, a_fnorm_loss:0.0587P:0.57, R:0.98
normal: 0.0247 0.1796  anomaly: 0.0257 0.7828	P:0.13, R:0.10
Pixel Auroc:0.948, Sample Auroc0.852, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0323
 41%|████      | 41/100 [12:43<19:06, 19.44s/it]epoch [41/100], focal_loss:0.0055	, anomaly_loss:0.2073	fnorm_loss:0.0072, a_fnorm_loss:0.0584P:0.57, R:0.97
 42%|████▏     | 42/100 [12:56<17:03, 17.65s/it]epoch [42/100], focal_loss:0.0055	, anomaly_loss:0.2048	fnorm_loss:0.0071, a_fnorm_loss:0.0574P:0.51, R:0.97
 43%|████▎     | 43/100 [13:10<15:44, 16.57s/it]epoch [43/100], focal_loss:0.0056	, anomaly_loss:0.2150	fnorm_loss:0.0071, a_fnorm_loss:0.0578P:0.58, R:0.98
 44%|████▍     | 44/100 [13:25<14:56, 16.00s/it]epoch [44/100], focal_loss:0.0048	, anomaly_loss:0.2071	fnorm_loss:0.0069, a_fnorm_loss:0.0580P:0.61, R:0.98
 45%|████▌     | 45/100 [13:57<19:05, 20.82s/it]epoch [45/100], focal_loss:0.0059	, anomaly_loss:0.2025	fnorm_loss:0.0070, a_fnorm_loss:0.0569P:0.53, R:0.97
normal: 0.0252 0.2083  anomaly: 0.0319 0.7587	P:0.12, R:0.11
Pixel Auroc:0.946, Sample Auroc0.867, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0341
 46%|████▌     | 46/100 [14:10<16:45, 18.63s/it]epoch [46/100], focal_loss:0.0061	, anomaly_loss:0.2087	fnorm_loss:0.0070, a_fnorm_loss:0.0582P:0.55, R:0.93
 47%|████▋     | 47/100 [14:24<15:00, 17.00s/it]epoch [47/100], focal_loss:0.0055	, anomaly_loss:0.2122	fnorm_loss:0.0069, a_fnorm_loss:0.0580P:0.59, R:0.97
 48%|████▊     | 48/100 [14:38<14:07, 16.30s/it]epoch [48/100], focal_loss:0.0054	, anomaly_loss:0.2060	fnorm_loss:0.0068, a_fnorm_loss:0.0590P:0.53, R:0.94
 49%|████▉     | 49/100 [14:52<13:15, 15.59s/it]epoch [49/100], focal_loss:0.0048	, anomaly_loss:0.2007	fnorm_loss:0.0067, a_fnorm_loss:0.0596P:0.57, R:0.98
 50%|█████     | 50/100 [15:23<16:42, 20.06s/it]epoch [50/100], focal_loss:0.0050	, anomaly_loss:0.1996	fnorm_loss:0.0067, a_fnorm_loss:0.0586P:0.50, R:0.94
normal: 0.0246 0.1865  anomaly: 0.0304 0.6853	P:0.11, R:0.09
Pixel Auroc:0.958, Sample Auroc0.868, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0324
 51%|█████     | 51/100 [15:37<14:56, 18.29s/it]epoch [51/100], focal_loss:0.0050	, anomaly_loss:0.1986	fnorm_loss:0.0067, a_fnorm_loss:0.0584P:0.57, R:0.95
 52%|█████▏    | 52/100 [15:50<13:24, 16.75s/it]epoch [52/100], focal_loss:0.0057	, anomaly_loss:0.2094	fnorm_loss:0.0069, a_fnorm_loss:0.0576P:0.53, R:0.96
 53%|█████▎    | 53/100 [16:04<12:24, 15.85s/it]epoch [53/100], focal_loss:0.0052	, anomaly_loss:0.2091	fnorm_loss:0.0067, a_fnorm_loss:0.0574P:0.57, R:0.96
 54%|█████▍    | 54/100 [16:19<11:55, 15.55s/it]epoch [54/100], focal_loss:0.0053	, anomaly_loss:0.2021	fnorm_loss:0.0067, a_fnorm_loss:0.0586P:0.54, R:0.98
 55%|█████▌    | 55/100 [16:51<15:26, 20.60s/it]epoch [55/100], focal_loss:0.0046	, anomaly_loss:0.2130	fnorm_loss:0.0065, a_fnorm_loss:0.0592P:0.57, R:0.98
normal: 0.0837 0.3405  anomaly: 0.1151 0.7653	P:0.10, R:0.14
Pixel Auroc:0.936, Sample Auroc0.849, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0406
 56%|█████▌    | 56/100 [17:05<13:45, 18.76s/it]epoch [56/100], focal_loss:0.0061	, anomaly_loss:0.2222	fnorm_loss:0.0067, a_fnorm_loss:0.0588P:0.52, R:0.95
 57%|█████▋    | 57/100 [17:20<12:28, 17.41s/it]epoch [57/100], focal_loss:0.0063	, anomaly_loss:0.2092	fnorm_loss:0.0068, a_fnorm_loss:0.0568P:0.52, R:0.93
 58%|█████▊    | 58/100 [17:33<11:23, 16.27s/it]epoch [58/100], focal_loss:0.0051	, anomaly_loss:0.2042	fnorm_loss:0.0065, a_fnorm_loss:0.0576P:0.54, R:0.93
 59%|█████▉    | 59/100 [17:47<10:36, 15.54s/it]epoch [59/100], focal_loss:0.0046	, anomaly_loss:0.1963	fnorm_loss:0.0065, a_fnorm_loss:0.0596P:0.53, R:0.94
 60%|██████    | 60/100 [18:23<14:21, 21.54s/it]epoch [60/100], focal_loss:0.0046	, anomaly_loss:0.1990	fnorm_loss:0.0064, a_fnorm_loss:0.0590P:0.58, R:0.98
normal: 0.4402 0.6912  anomaly: 0.4842 0.8221	P:0.06, R:0.19
Pixel Auroc:0.918, Sample Auroc0.805, Pixel Aupro0.0
test_fnorm_loss: 0.0085 test_afnorm_loss: 0.0516
 61%|██████    | 61/100 [18:37<12:38, 19.44s/it]epoch [61/100], focal_loss:0.0084	, anomaly_loss:0.2159	fnorm_loss:0.0067, a_fnorm_loss:0.0590P:0.52, R:0.95
 62%|██████▏   | 62/100 [18:52<11:24, 18.02s/it]epoch [62/100], focal_loss:0.0050	, anomaly_loss:0.2042	fnorm_loss:0.0065, a_fnorm_loss:0.0593P:0.52, R:0.98
 63%|██████▎   | 63/100 [19:06<10:27, 16.96s/it]epoch [63/100], focal_loss:0.0044	, anomaly_loss:0.1986	fnorm_loss:0.0064, a_fnorm_loss:0.0595P:0.59, R:0.98
 64%|██████▍   | 64/100 [19:20<09:37, 16.04s/it]epoch [64/100], focal_loss:0.0045	, anomaly_loss:0.2038	fnorm_loss:0.0064, a_fnorm_loss:0.0605P:0.56, R:0.99
 65%|██████▌   | 65/100 [19:53<12:20, 21.17s/it]epoch [65/100], focal_loss:0.0042	, anomaly_loss:0.1930	fnorm_loss:0.0063, a_fnorm_loss:0.0600P:0.54, R:0.94
normal: 0.0221 0.1531  anomaly: 0.0225 0.7234	P:0.10, R:0.07
Pixel Auroc:0.947, Sample Auroc0.864, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0266
 66%|██████▌   | 66/100 [20:08<10:47, 19.06s/it]epoch [66/100], focal_loss:0.0045	, anomaly_loss:0.2095	fnorm_loss:0.0063, a_fnorm_loss:0.0600P:0.61, R:0.98
 67%|██████▋   | 67/100 [20:22<09:40, 17.58s/it]epoch [67/100], focal_loss:0.0046	, anomaly_loss:0.2058	fnorm_loss:0.0063, a_fnorm_loss:0.0610P:0.58, R:0.98
 68%|██████▊   | 68/100 [20:36<08:50, 16.57s/it]epoch [68/100], focal_loss:0.0043	, anomaly_loss:0.2014	fnorm_loss:0.0063, a_fnorm_loss:0.0615P:0.54, R:0.98
 69%|██████▉   | 69/100 [20:50<08:07, 15.73s/it]epoch [69/100], focal_loss:0.0048	, anomaly_loss:0.2003	fnorm_loss:0.0063, a_fnorm_loss:0.0610P:0.57, R:0.98
 70%|███████   | 70/100 [21:24<10:41, 21.40s/it]epoch [70/100], focal_loss:0.0049	, anomaly_loss:0.2031	fnorm_loss:0.0063, a_fnorm_loss:0.0594P:0.59, R:0.98
normal: 0.0221 0.1138  anomaly: 0.0225 0.5982	P:0.10, R:0.07
Pixel Auroc:0.939, Sample Auroc0.846, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0238
 71%|███████   | 71/100 [21:39<09:18, 19.26s/it]epoch [71/100], focal_loss:0.0043	, anomaly_loss:0.2111	fnorm_loss:0.0062, a_fnorm_loss:0.0595P:0.64, R:0.98
 72%|███████▏  | 72/100 [21:54<08:28, 18.17s/it]epoch [72/100], focal_loss:0.0044	, anomaly_loss:0.2056	fnorm_loss:0.0063, a_fnorm_loss:0.0600P:0.56, R:0.98
 73%|███████▎  | 73/100 [22:08<07:37, 16.93s/it]epoch [73/100], focal_loss:0.0056	, anomaly_loss:0.2098	fnorm_loss:0.0065, a_fnorm_loss:0.0555P:0.51, R:0.96
 74%|███████▍  | 74/100 [22:23<07:00, 16.19s/it]epoch [74/100], focal_loss:0.0042	, anomaly_loss:0.2022	fnorm_loss:0.0063, a_fnorm_loss:0.0598P:0.56, R:0.98
 75%|███████▌  | 75/100 [23:03<09:41, 23.28s/it]epoch [75/100], focal_loss:0.0051	, anomaly_loss:0.2004	fnorm_loss:0.0063, a_fnorm_loss:0.0587P:0.59, R:0.97
normal: 0.0436 0.2373  anomaly: 0.0628 0.7738	P:0.13, R:0.13
Pixel Auroc:0.961, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0374
 76%|███████▌  | 76/100 [23:18<08:21, 20.88s/it]epoch [76/100], focal_loss:0.0045	, anomaly_loss:0.1965	fnorm_loss:0.0063, a_fnorm_loss:0.0602P:0.55, R:0.98
 77%|███████▋  | 77/100 [23:32<07:14, 18.88s/it]epoch [77/100], focal_loss:0.0045	, anomaly_loss:0.2020	fnorm_loss:0.0062, a_fnorm_loss:0.0609P:0.61, R:0.98
 78%|███████▊  | 78/100 [23:47<06:29, 17.70s/it]epoch [78/100], focal_loss:0.0046	, anomaly_loss:0.2013	fnorm_loss:0.0062, a_fnorm_loss:0.0597P:0.57, R:0.98
 79%|███████▉  | 79/100 [24:01<05:49, 16.64s/it]epoch [79/100], focal_loss:0.0046	, anomaly_loss:0.2020	fnorm_loss:0.0062, a_fnorm_loss:0.0605P:0.61, R:0.98
 80%|████████  | 80/100 [24:35<07:13, 21.66s/it]epoch [80/100], focal_loss:0.0044	, anomaly_loss:0.2050	fnorm_loss:0.0062, a_fnorm_loss:0.0605P:0.57, R:0.98
normal: 0.0237 0.2025  anomaly: 0.0267 0.7608	P:0.12, R:0.10
Pixel Auroc:0.956, Sample Auroc0.872, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0345
 81%|████████  | 81/100 [24:49<06:12, 19.60s/it]epoch [81/100], focal_loss:0.0041	, anomaly_loss:0.2024	fnorm_loss:0.0062, a_fnorm_loss:0.0600P:0.56, R:0.98
 82%|████████▏ | 82/100 [25:04<05:24, 18.04s/it]epoch [82/100], focal_loss:0.0046	, anomaly_loss:0.2074	fnorm_loss:0.0062, a_fnorm_loss:0.0584P:0.59, R:0.97
 83%|████████▎ | 83/100 [25:18<04:46, 16.85s/it]epoch [83/100], focal_loss:0.0043	, anomaly_loss:0.1973	fnorm_loss:0.0063, a_fnorm_loss:0.0598P:0.57, R:0.99
 84%|████████▍ | 84/100 [25:32<04:18, 16.16s/it]epoch [84/100], focal_loss:0.0042	, anomaly_loss:0.2027	fnorm_loss:0.0062, a_fnorm_loss:0.0609P:0.60, R:0.98
 85%|████████▌ | 85/100 [26:11<05:43, 22.88s/it]epoch [85/100], focal_loss:0.0044	, anomaly_loss:0.2020	fnorm_loss:0.0062, a_fnorm_loss:0.0602P:0.58, R:0.94
normal: 0.0237 0.2441  anomaly: 0.0287 0.7783	P:0.13, R:0.12
Pixel Auroc:0.957, Sample Auroc0.855, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0363
 86%|████████▌ | 86/100 [26:25<04:45, 20.36s/it]epoch [86/100], focal_loss:0.0043	, anomaly_loss:0.2053	fnorm_loss:0.0062, a_fnorm_loss:0.0610P:0.59, R:0.98
 87%|████████▋ | 87/100 [26:41<04:07, 19.00s/it]epoch [87/100], focal_loss:0.0039	, anomaly_loss:0.2029	fnorm_loss:0.0061, a_fnorm_loss:0.0613P:0.61, R:0.99
 88%|████████▊ | 88/100 [26:55<03:30, 17.53s/it]epoch [88/100], focal_loss:0.0040	, anomaly_loss:0.1938	fnorm_loss:0.0061, a_fnorm_loss:0.0607P:0.59, R:0.99
 89%|████████▉ | 89/100 [27:09<03:01, 16.49s/it]epoch [89/100], focal_loss:0.0040	, anomaly_loss:0.1912	fnorm_loss:0.0062, a_fnorm_loss:0.0607P:0.55, R:0.95
 90%|█████████ | 90/100 [27:42<03:34, 21.44s/it]epoch [90/100], focal_loss:0.0042	, anomaly_loss:0.1917	fnorm_loss:0.0062, a_fnorm_loss:0.0600P:0.62, R:0.98
normal: 0.0223 0.2044  anomaly: 0.0251 0.7814	P:0.13, R:0.11
Pixel Auroc:0.957, Sample Auroc0.879, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0350
 91%|█████████ | 91/100 [27:57<02:53, 19.28s/it]epoch [91/100], focal_loss:0.0036	, anomaly_loss:0.2071	fnorm_loss:0.0061, a_fnorm_loss:0.0601P:0.64, R:0.98
 92%|█████████▏| 92/100 [28:12<02:23, 17.99s/it]epoch [92/100], focal_loss:0.0042	, anomaly_loss:0.2022	fnorm_loss:0.0062, a_fnorm_loss:0.0598P:0.60, R:0.98
 93%|█████████▎| 93/100 [28:26<01:58, 16.90s/it]epoch [93/100], focal_loss:0.0046	, anomaly_loss:0.2029	fnorm_loss:0.0062, a_fnorm_loss:0.0610P:0.59, R:0.94
 94%|█████████▍| 94/100 [28:41<01:37, 16.26s/it]epoch [94/100], focal_loss:0.0042	, anomaly_loss:0.1966	fnorm_loss:0.0062, a_fnorm_loss:0.0606P:0.56, R:0.94
 95%|█████████▌| 95/100 [29:15<01:47, 21.58s/it]epoch [95/100], focal_loss:0.0042	, anomaly_loss:0.1915	fnorm_loss:0.0062, a_fnorm_loss:0.0603P:0.60, R:0.98
normal: 0.0228 0.2275  anomaly: 0.0261 0.7820	P:0.13, R:0.12
Pixel Auroc:0.956, Sample Auroc0.867, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0352
 96%|█████████▌| 96/100 [29:29<01:17, 19.44s/it]epoch [96/100], focal_loss:0.0043	, anomaly_loss:0.2004	fnorm_loss:0.0062, a_fnorm_loss:0.0604P:0.62, R:0.98
 97%|█████████▋| 97/100 [29:43<00:53, 17.89s/it]epoch [97/100], focal_loss:0.0043	, anomaly_loss:0.1927	fnorm_loss:0.0062, a_fnorm_loss:0.0594P:0.53, R:0.94
 98%|█████████▊| 98/100 [29:57<00:33, 16.69s/it]epoch [98/100], focal_loss:0.0042	, anomaly_loss:0.2019	fnorm_loss:0.0062, a_fnorm_loss:0.0592P:0.59, R:0.98
 99%|█████████▉| 99/100 [30:12<00:16, 16.04s/it]epoch [99/100], focal_loss:0.0044	, anomaly_loss:0.2015	fnorm_loss:0.0062, a_fnorm_loss:0.0612P:0.59, R:0.99
100%|██████████| 100/100 [30:44<00:00, 20.73s/it]100%|██████████| 100/100 [30:44<00:00, 18.44s/it]
epoch [100/100], focal_loss:0.0037	, anomaly_loss:0.1891	fnorm_loss:0.0061, a_fnorm_loss:0.0596P:0.60, R:0.98
normal: 0.0221 0.2042  anomaly: 0.0250 0.7777	P:0.13, R:0.11
Pixel Auroc:0.957, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0354
training Stubborn Student...
cashew
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:08<17:30,  8.83s/it]epoch [1/120], kd_loss:4.3047
  2%|▏         | 2/120 [00:17<17:23,  8.84s/it]epoch [2/120], kd_loss:3.1351
  2%|▎         | 3/120 [00:26<17:09,  8.80s/it]epoch [3/120], kd_loss:2.3285
  3%|▎         | 4/120 [00:35<17:02,  8.81s/it]epoch [4/120], kd_loss:1.9640
  4%|▍         | 5/120 [00:43<16:50,  8.78s/it]epoch [5/120], kd_loss:2.0802
  5%|▌         | 6/120 [00:52<16:40,  8.78s/it]epoch [6/120], kd_loss:1.7522
  6%|▌         | 7/120 [01:01<16:32,  8.79s/it]epoch [7/120], kd_loss:2.0194
  7%|▋         | 8/120 [01:10<16:26,  8.81s/it]epoch [8/120], kd_loss:1.6681
  8%|▊         | 9/120 [01:19<16:21,  8.84s/it]epoch [9/120], kd_loss:1.6922
  8%|▊         | 10/120 [01:45<26:11, 14.29s/it]epoch [10/120], kd_loss:1.5816
normal: 0.9171 1.4239  anomaly: 1.0185 2.2785
thresh: 1.1598519913648677
fpr: 0.12 fnr 0.09
Pixel Auroc:0.981, Sample Auroc0.950, Pixel Aupro0.0
  9%|▉         | 11/120 [01:54<22:55, 12.62s/it]epoch [11/120], kd_loss:1.5150
 10%|█         | 12/120 [02:03<20:33, 11.42s/it]epoch [12/120], kd_loss:1.4637
 11%|█         | 13/120 [02:12<18:57, 10.63s/it]epoch [13/120], kd_loss:1.4634
 12%|█▏        | 14/120 [02:20<17:47, 10.07s/it]epoch [14/120], kd_loss:1.3747
 12%|█▎        | 15/120 [02:29<16:59,  9.71s/it]epoch [15/120], kd_loss:1.3684
 13%|█▎        | 16/120 [02:38<16:25,  9.47s/it]epoch [16/120], kd_loss:1.7028
 14%|█▍        | 17/120 [02:47<15:54,  9.26s/it]epoch [17/120], kd_loss:1.4597
 15%|█▌        | 18/120 [02:56<15:32,  9.14s/it]epoch [18/120], kd_loss:1.6699
 16%|█▌        | 19/120 [03:05<15:15,  9.06s/it]epoch [19/120], kd_loss:1.4168
 17%|█▋        | 20/120 [03:30<23:15, 13.95s/it]epoch [20/120], kd_loss:1.3561
normal: 0.7566 1.3173  anomaly: 0.8617 2.2251
thresh: 0.9833844066297073
fpr: 0.14 fnr 0.08
Pixel Auroc:0.987, Sample Auroc0.945, Pixel Aupro0.0
 18%|█▊        | 21/120 [03:39<20:25, 12.38s/it]epoch [21/120], kd_loss:1.3332
 18%|█▊        | 22/120 [03:48<18:27, 11.30s/it]epoch [22/120], kd_loss:1.3500
 19%|█▉        | 23/120 [03:56<17:01, 10.53s/it]epoch [23/120], kd_loss:1.4817
 20%|██        | 24/120 [04:05<15:57,  9.98s/it]epoch [24/120], kd_loss:1.5484
 21%|██        | 25/120 [04:14<15:13,  9.62s/it]epoch [25/120], kd_loss:2.7013
 22%|██▏       | 26/120 [04:23<14:40,  9.36s/it]epoch [26/120], kd_loss:1.6404
 22%|██▎       | 27/120 [04:31<14:17,  9.22s/it]epoch [27/120], kd_loss:1.5362
 23%|██▎       | 28/120 [04:40<13:58,  9.11s/it]epoch [28/120], kd_loss:1.3886
 24%|██▍       | 29/120 [04:49<13:42,  9.04s/it]epoch [29/120], kd_loss:2.0086
 25%|██▌       | 30/120 [05:15<21:04, 14.05s/it]epoch [30/120], kd_loss:1.5118
normal: 0.9505 1.3216  anomaly: 0.9612 2.3847
thresh: 1.0871222643817298
fpr: 0.16 fnr 0.1
Pixel Auroc:0.980, Sample Auroc0.927, Pixel Aupro0.0
 26%|██▌       | 31/120 [05:24<18:28, 12.46s/it]epoch [31/120], kd_loss:1.4191
 27%|██▋       | 32/120 [05:32<16:40, 11.37s/it]epoch [32/120], kd_loss:1.3674
 28%|██▊       | 33/120 [05:41<15:21, 10.59s/it]epoch [33/120], kd_loss:1.4127
 28%|██▊       | 34/120 [05:50<14:23, 10.04s/it]epoch [34/120], kd_loss:1.3674
 29%|██▉       | 35/120 [05:59<13:42,  9.67s/it]epoch [35/120], kd_loss:1.9310
 30%|███       | 36/120 [06:08<13:11,  9.43s/it]epoch [36/120], kd_loss:1.3755
 31%|███       | 37/120 [06:17<12:50,  9.28s/it]epoch [37/120], kd_loss:1.3298
 32%|███▏      | 38/120 [06:25<12:30,  9.15s/it]epoch [38/120], kd_loss:1.4368
 32%|███▎      | 39/120 [06:34<12:16,  9.09s/it]epoch [39/120], kd_loss:1.3567
 33%|███▎      | 40/120 [07:01<18:57, 14.22s/it]epoch [40/120], kd_loss:1.3131
normal: 1.0946 3.1082  anomaly: 1.9679 2.9991
thresh: 1.9678790244737612
fpr: 0.96 fnr 0.0
Pixel Auroc:0.956, Sample Auroc0.656, Pixel Aupro0.0
 34%|███▍      | 41/120 [07:09<16:33, 12.57s/it]epoch [41/120], kd_loss:1.7572
 35%|███▌      | 42/120 [07:18<14:50, 11.41s/it]epoch [42/120], kd_loss:1.9700
 36%|███▌      | 43/120 [07:27<13:37, 10.61s/it]epoch [43/120], kd_loss:1.6489
 37%|███▋      | 44/120 [07:36<12:44, 10.05s/it]epoch [44/120], kd_loss:1.4643
 38%|███▊      | 45/120 [07:44<12:05,  9.68s/it]epoch [45/120], kd_loss:1.4182
 38%|███▊      | 46/120 [07:53<11:37,  9.43s/it]epoch [46/120], kd_loss:1.4659
 39%|███▉      | 47/120 [08:02<11:14,  9.23s/it]epoch [47/120], kd_loss:1.4466
 40%|████      | 48/120 [08:11<10:55,  9.11s/it]epoch [48/120], kd_loss:1.3653
 41%|████      | 49/120 [08:19<10:38,  8.99s/it]epoch [49/120], kd_loss:1.3267
 42%|████▏     | 50/120 [08:48<17:12, 14.74s/it]epoch [50/120], kd_loss:1.4215
normal: 0.7845 1.3486  anomaly: 0.8453 2.2517
thresh: 0.9944241321530991
fpr: 0.12 fnr 0.09
Pixel Auroc:0.984, Sample Auroc0.951, Pixel Aupro0.0
 42%|████▎     | 51/120 [08:57<14:55, 12.98s/it]epoch [51/120], kd_loss:1.3323
 43%|████▎     | 52/120 [09:05<13:15, 11.71s/it]epoch [52/120], kd_loss:1.3533
 44%|████▍     | 53/120 [09:14<12:04, 10.82s/it]epoch [53/120], kd_loss:1.3704
 45%|████▌     | 54/120 [09:23<11:12, 10.20s/it]epoch [54/120], kd_loss:1.3931
 46%|████▌     | 55/120 [09:32<10:35,  9.78s/it]epoch [55/120], kd_loss:1.3269
 47%|████▋     | 56/120 [09:40<10:08,  9.50s/it]epoch [56/120], kd_loss:1.3067
 48%|████▊     | 57/120 [09:49<09:48,  9.34s/it]epoch [57/120], kd_loss:1.3330
 48%|████▊     | 58/120 [09:58<09:30,  9.20s/it]epoch [58/120], kd_loss:1.3279
 49%|████▉     | 59/120 [10:07<09:15,  9.10s/it]epoch [59/120], kd_loss:1.2876
 50%|█████     | 60/120 [10:34<14:19, 14.32s/it]epoch [60/120], kd_loss:1.2915
normal: 0.8483 1.4764  anomaly: 0.8995 2.1243
thresh: 1.0158621636089933
fpr: 0.22 fnr 0.06
Pixel Auroc:0.985, Sample Auroc0.940, Pixel Aupro0.0
 51%|█████     | 61/120 [10:42<12:27, 12.67s/it]epoch [61/120], kd_loss:1.2854
 52%|█████▏    | 62/120 [10:51<11:08, 11.52s/it]epoch [62/120], kd_loss:1.2643
 52%|█████▎    | 63/120 [11:00<10:11, 10.72s/it]epoch [63/120], kd_loss:1.2577
 53%|█████▎    | 64/120 [11:09<09:26, 10.12s/it]epoch [64/120], kd_loss:1.2551
 54%|█████▍    | 65/120 [11:18<08:54,  9.71s/it]epoch [65/120], kd_loss:1.2448
 55%|█████▌    | 66/120 [11:26<08:28,  9.41s/it]epoch [66/120], kd_loss:1.4103
 56%|█████▌    | 67/120 [11:35<08:09,  9.23s/it]epoch [67/120], kd_loss:1.2687
 57%|█████▋    | 68/120 [11:44<07:52,  9.09s/it]epoch [68/120], kd_loss:1.2734
 57%|█████▊    | 69/120 [11:53<07:38,  8.99s/it]epoch [69/120], kd_loss:1.2417
 58%|█████▊    | 70/120 [12:19<11:54, 14.29s/it]epoch [70/120], kd_loss:1.2362
normal: 0.7012 1.2511  anomaly: 0.7614 2.1251
thresh: 0.8962927395329353
fpr: 0.18 fnr 0.06
Pixel Auroc:0.983, Sample Auroc0.950, Pixel Aupro0.0
 59%|█████▉    | 71/120 [12:28<10:18, 12.62s/it]epoch [71/120], kd_loss:1.2360
 60%|██████    | 72/120 [12:37<09:09, 11.45s/it]epoch [72/120], kd_loss:1.2813
 61%|██████    | 73/120 [12:46<08:20, 10.65s/it]epoch [73/120], kd_loss:1.2560
 62%|██████▏   | 74/120 [12:54<07:44, 10.11s/it]epoch [74/120], kd_loss:1.2484
 62%|██████▎   | 75/120 [13:03<07:18,  9.75s/it]epoch [75/120], kd_loss:1.2712
 63%|██████▎   | 76/120 [13:12<06:56,  9.48s/it]epoch [76/120], kd_loss:1.2395
 64%|██████▍   | 77/120 [13:21<06:38,  9.27s/it]epoch [77/120], kd_loss:1.3397
 65%|██████▌   | 78/120 [13:30<06:24,  9.15s/it]epoch [78/120], kd_loss:1.3597
 66%|██████▌   | 79/120 [13:39<06:10,  9.04s/it]epoch [79/120], kd_loss:1.4363
 67%|██████▋   | 80/120 [14:04<09:12, 13.82s/it]epoch [80/120], kd_loss:1.4014
normal: 0.7741 1.2142  anomaly: 0.8496 2.2396
thresh: 0.9569246601825301
fpr: 0.2 fnr 0.07
Pixel Auroc:0.983, Sample Auroc0.948, Pixel Aupro0.0
 68%|██████▊   | 81/120 [14:12<07:59, 12.29s/it]epoch [81/120], kd_loss:1.3268
 68%|██████▊   | 82/120 [14:21<07:06, 11.22s/it]epoch [82/120], kd_loss:1.5472
 69%|██████▉   | 83/120 [14:30<06:27, 10.47s/it]epoch [83/120], kd_loss:1.5275
 70%|███████   | 84/120 [14:38<05:58,  9.96s/it]epoch [84/120], kd_loss:1.2992
 71%|███████   | 85/120 [14:47<05:36,  9.60s/it]epoch [85/120], kd_loss:1.2479
 72%|███████▏  | 86/120 [14:56<05:18,  9.36s/it]epoch [86/120], kd_loss:1.4108
 72%|███████▎  | 87/120 [15:05<05:04,  9.21s/it]epoch [87/120], kd_loss:1.3513
 73%|███████▎  | 88/120 [15:14<04:51,  9.09s/it]epoch [88/120], kd_loss:1.2691
 74%|███████▍  | 89/120 [15:23<04:39,  9.00s/it]epoch [89/120], kd_loss:1.2957
 75%|███████▌  | 90/120 [15:50<07:12, 14.43s/it]epoch [90/120], kd_loss:1.2982
normal: 0.7411 1.2438  anomaly: 0.7741 2.1786
thresh: 0.9643871653297849
fpr: 0.06 fnr 0.11
Pixel Auroc:0.987, Sample Auroc0.952, Pixel Aupro0.0
 76%|███████▌  | 91/120 [15:59<06:10, 12.78s/it]epoch [91/120], kd_loss:1.2561
 77%|███████▋  | 92/120 [16:07<05:24, 11.59s/it]epoch [92/120], kd_loss:1.2376
 78%|███████▊  | 93/120 [16:16<04:50, 10.75s/it]epoch [93/120], kd_loss:1.2316
 78%|███████▊  | 94/120 [16:25<04:23, 10.14s/it]epoch [94/120], kd_loss:1.2344
 79%|███████▉  | 95/120 [16:34<04:03,  9.75s/it]epoch [95/120], kd_loss:1.3198
 80%|████████  | 96/120 [16:42<03:46,  9.46s/it]epoch [96/120], kd_loss:1.2404
 81%|████████  | 97/120 [16:51<03:33,  9.26s/it]epoch [97/120], kd_loss:1.3372
 82%|████████▏ | 98/120 [17:00<03:21,  9.18s/it]epoch [98/120], kd_loss:1.2199
 82%|████████▎ | 99/120 [17:09<03:10,  9.09s/it]epoch [99/120], kd_loss:1.2184
 83%|████████▎ | 100/120 [17:35<04:43, 14.15s/it]epoch [100/120], kd_loss:1.2104
normal: 0.6872 1.3156  anomaly: 0.7592 2.2443
thresh: 0.9509491440703157
fpr: 0.08 fnr 0.1
Pixel Auroc:0.986, Sample Auroc0.952, Pixel Aupro0.0
 84%|████████▍ | 101/120 [17:44<03:58, 12.53s/it]epoch [101/120], kd_loss:1.2061
 85%|████████▌ | 102/120 [17:53<03:25, 11.41s/it]epoch [102/120], kd_loss:1.2043
 86%|████████▌ | 103/120 [18:01<03:00, 10.62s/it]epoch [103/120], kd_loss:1.2040
 87%|████████▋ | 104/120 [18:10<02:40, 10.06s/it]epoch [104/120], kd_loss:1.2020
 88%|████████▊ | 105/120 [18:19<02:25,  9.68s/it]epoch [105/120], kd_loss:1.2002
 88%|████████▊ | 106/120 [18:28<02:12,  9.46s/it]epoch [106/120], kd_loss:1.1974
 89%|████████▉ | 107/120 [18:37<02:00,  9.30s/it]epoch [107/120], kd_loss:1.1911
 90%|█████████ | 108/120 [18:46<01:50,  9.18s/it]epoch [108/120], kd_loss:1.1902
 91%|█████████ | 109/120 [18:55<01:39,  9.07s/it]epoch [109/120], kd_loss:1.1893
 92%|█████████▏| 110/120 [19:21<02:22, 14.23s/it]epoch [110/120], kd_loss:1.1900
normal: 0.6888 1.2112  anomaly: 0.7410 2.2394
thresh: 0.9458784600043351
fpr: 0.06 fnr 0.12
Pixel Auroc:0.986, Sample Auroc0.950, Pixel Aupro0.0
 92%|█████████▎| 111/120 [19:30<01:53, 12.63s/it]epoch [111/120], kd_loss:1.1892
 93%|█████████▎| 112/120 [19:38<01:31, 11.45s/it]epoch [112/120], kd_loss:1.1871
 94%|█████████▍| 113/120 [19:47<01:14, 10.67s/it]epoch [113/120], kd_loss:1.1899
 95%|█████████▌| 114/120 [19:56<01:00, 10.10s/it]epoch [114/120], kd_loss:1.1859
 96%|█████████▌| 115/120 [20:05<00:48,  9.73s/it]epoch [115/120], kd_loss:1.1900
 97%|█████████▋| 116/120 [20:14<00:37,  9.46s/it]epoch [116/120], kd_loss:1.1867
 98%|█████████▊| 117/120 [20:23<00:27,  9.26s/it]epoch [117/120], kd_loss:1.1916
 98%|█████████▊| 118/120 [20:31<00:18,  9.16s/it]epoch [118/120], kd_loss:1.1905
 99%|█████████▉| 119/120 [20:40<00:09,  9.08s/it]epoch [119/120], kd_loss:1.1881
100%|██████████| 120/120 [21:06<00:00, 14.03s/it]100%|██████████| 120/120 [21:06<00:00, 10.55s/it]
epoch [120/120], kd_loss:1.1897
normal: 0.6826 1.2072  anomaly: 0.7420 2.2624
thresh: 0.9493110657453737
fpr: 0.04 fnr 0.12
Pixel Auroc:0.986, Sample Auroc0.950, Pixel Aupro0.0
training Advanced Teacher...
chewinggum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:34<56:21, 34.16s/it]epoch [1/100], focal_loss:0.0713	, anomaly_loss:0.5446	fnorm_loss:0.0609, a_fnorm_loss:0.0147P:0.00, R:0.02
normal: 0.2275 0.2339  anomaly: 0.2244 0.2330	P:0.00, R:0.00
Pixel Auroc:0.826, Sample Auroc0.259, Pixel Aupro0.0
test_fnorm_loss: 0.0560 test_afnorm_loss: 0.0149
  2%|▏         | 2/100 [00:47<36:02, 22.06s/it]epoch [2/100], focal_loss:0.0531	, anomaly_loss:0.5661	fnorm_loss:0.0506, a_fnorm_loss:0.0123P:0.00, R:0.00
  3%|▎         | 3/100 [01:00<28:55, 17.89s/it]epoch [3/100], focal_loss:0.0436	, anomaly_loss:0.5967	fnorm_loss:0.0424, a_fnorm_loss:0.0103P:0.00, R:0.00
  4%|▍         | 4/100 [01:14<25:56, 16.21s/it]epoch [4/100], focal_loss:0.0425	, anomaly_loss:0.6076	fnorm_loss:0.0383, a_fnorm_loss:0.0097P:0.01, R:0.01
  5%|▌         | 5/100 [01:46<34:31, 21.81s/it]epoch [5/100], focal_loss:0.0402	, anomaly_loss:0.5073	fnorm_loss:0.0354, a_fnorm_loss:0.0273P:0.08, R:0.29
normal: 0.2826 0.3349  anomaly: 0.2865 0.3391	P:0.02, R:0.17
Pixel Auroc:0.953, Sample Auroc0.456, Pixel Aupro0.0
test_fnorm_loss: 0.0331 test_afnorm_loss: 0.0371
  6%|▌         | 6/100 [01:58<29:19, 18.72s/it]epoch [6/100], focal_loss:0.0334	, anomaly_loss:0.4519	fnorm_loss:0.0291, a_fnorm_loss:0.0339P:0.15, R:0.50
  7%|▋         | 7/100 [02:12<26:41, 17.22s/it]epoch [7/100], focal_loss:0.0281	, anomaly_loss:0.4215	fnorm_loss:0.0242, a_fnorm_loss:0.0379P:0.20, R:0.62
  8%|▊         | 8/100 [02:25<24:22, 15.90s/it]epoch [8/100], focal_loss:0.0248	, anomaly_loss:0.4110	fnorm_loss:0.0211, a_fnorm_loss:0.0384P:0.20, R:0.63
  9%|▉         | 9/100 [02:39<22:49, 15.05s/it]epoch [9/100], focal_loss:0.0230	, anomaly_loss:0.4005	fnorm_loss:0.0187, a_fnorm_loss:0.0399P:0.26, R:0.63
 10%|█         | 10/100 [03:10<29:55, 19.95s/it]epoch [10/100], focal_loss:0.0217	, anomaly_loss:0.4025	fnorm_loss:0.0170, a_fnorm_loss:0.0406P:0.26, R:0.63
normal: 0.0827 0.0849  anomaly: 0.0830 0.4265	P:0.13, R:0.07
Pixel Auroc:0.986, Sample Auroc0.957, Pixel Aupro0.0
test_fnorm_loss: 0.0154 test_afnorm_loss: 0.0119
 11%|█         | 11/100 [03:22<26:14, 17.70s/it]epoch [11/100], focal_loss:0.0210	, anomaly_loss:0.3827	fnorm_loss:0.0156, a_fnorm_loss:0.0430P:0.33, R:0.69
 12%|█▏        | 12/100 [03:35<23:58, 16.35s/it]epoch [12/100], focal_loss:0.0197	, anomaly_loss:0.3736	fnorm_loss:0.0145, a_fnorm_loss:0.0431P:0.34, R:0.71
 13%|█▎        | 13/100 [03:49<22:39, 15.63s/it]epoch [13/100], focal_loss:0.0161	, anomaly_loss:0.3333	fnorm_loss:0.0135, a_fnorm_loss:0.0455P:0.42, R:0.85
 14%|█▍        | 14/100 [04:02<21:05, 14.72s/it]epoch [14/100], focal_loss:0.0150	, anomaly_loss:0.3142	fnorm_loss:0.0128, a_fnorm_loss:0.0454P:0.43, R:0.92
 15%|█▌        | 15/100 [04:37<29:35, 20.89s/it]epoch [15/100], focal_loss:0.0127	, anomaly_loss:0.3043	fnorm_loss:0.0120, a_fnorm_loss:0.0464P:0.42, R:0.94
normal: 0.0526 0.1855  anomaly: 0.0543 0.6134	P:0.32, R:0.34
Pixel Auroc:0.993, Sample Auroc0.955, Pixel Aupro0.0
test_fnorm_loss: 0.0112 test_afnorm_loss: 0.0443
 16%|█▌        | 16/100 [04:51<26:18, 18.79s/it]epoch [16/100], focal_loss:0.0109	, anomaly_loss:0.2950	fnorm_loss:0.0114, a_fnorm_loss:0.0479P:0.47, R:0.95
 17%|█▋        | 17/100 [05:04<23:35, 17.05s/it]epoch [17/100], focal_loss:0.0111	, anomaly_loss:0.2916	fnorm_loss:0.0109, a_fnorm_loss:0.0487P:0.44, R:0.94
 18%|█▊        | 18/100 [05:17<21:46, 15.94s/it]epoch [18/100], focal_loss:0.0124	, anomaly_loss:0.3094	fnorm_loss:0.0106, a_fnorm_loss:0.0471P:0.47, R:0.91
 19%|█▉        | 19/100 [05:31<20:27, 15.15s/it]epoch [19/100], focal_loss:0.0100	, anomaly_loss:0.2993	fnorm_loss:0.0101, a_fnorm_loss:0.0488P:0.47, R:0.95
 20%|██        | 20/100 [06:08<28:55, 21.70s/it]epoch [20/100], focal_loss:0.0092	, anomaly_loss:0.2842	fnorm_loss:0.0097, a_fnorm_loss:0.0486P:0.50, R:0.96
normal: 0.0420 0.1395  anomaly: 0.0428 0.7005	P:0.37, R:0.39
Pixel Auroc:0.993, Sample Auroc0.968, Pixel Aupro0.0
test_fnorm_loss: 0.0090 test_afnorm_loss: 0.0439
 21%|██        | 21/100 [06:22<25:36, 19.45s/it]epoch [21/100], focal_loss:0.0093	, anomaly_loss:0.2768	fnorm_loss:0.0093, a_fnorm_loss:0.0500P:0.49, R:0.92
 22%|██▏       | 22/100 [06:35<22:48, 17.55s/it]epoch [22/100], focal_loss:0.0091	, anomaly_loss:0.2859	fnorm_loss:0.0091, a_fnorm_loss:0.0491P:0.50, R:0.95
 23%|██▎       | 23/100 [06:48<20:54, 16.29s/it]epoch [23/100], focal_loss:0.0077	, anomaly_loss:0.2798	fnorm_loss:0.0087, a_fnorm_loss:0.0511P:0.54, R:0.97
 24%|██▍       | 24/100 [07:02<19:34, 15.46s/it]epoch [24/100], focal_loss:0.0083	, anomaly_loss:0.2818	fnorm_loss:0.0086, a_fnorm_loss:0.0501P:0.53, R:0.97
 25%|██▌       | 25/100 [07:34<25:25, 20.34s/it]epoch [25/100], focal_loss:0.0095	, anomaly_loss:0.2920	fnorm_loss:0.0084, a_fnorm_loss:0.0501P:0.56, R:0.93
normal: 0.1706 0.3260  anomaly: 0.1828 0.6908	P:0.23, R:0.50
Pixel Auroc:0.991, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0104 test_afnorm_loss: 0.0487
 26%|██▌       | 26/100 [07:47<22:34, 18.30s/it]epoch [26/100], focal_loss:0.0081	, anomaly_loss:0.2810	fnorm_loss:0.0083, a_fnorm_loss:0.0501P:0.54, R:0.97
 27%|██▋       | 27/100 [08:01<20:39, 16.98s/it]epoch [27/100], focal_loss:0.0084	, anomaly_loss:0.2866	fnorm_loss:0.0081, a_fnorm_loss:0.0497P:0.53, R:0.92
 28%|██▊       | 28/100 [08:15<19:09, 15.97s/it]epoch [28/100], focal_loss:0.0087	, anomaly_loss:0.2835	fnorm_loss:0.0080, a_fnorm_loss:0.0499P:0.48, R:0.96
 29%|██▉       | 29/100 [08:28<17:49, 15.06s/it]epoch [29/100], focal_loss:0.0076	, anomaly_loss:0.2778	fnorm_loss:0.0077, a_fnorm_loss:0.0511P:0.54, R:0.96
 30%|███       | 30/100 [08:59<23:21, 20.03s/it]epoch [30/100], focal_loss:0.0072	, anomaly_loss:0.2694	fnorm_loss:0.0075, a_fnorm_loss:0.0511P:0.52, R:0.96
normal: 0.0344 0.0962  anomaly: 0.0474 0.6824	P:0.37, R:0.37
Pixel Auroc:0.993, Sample Auroc0.972, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0337
 31%|███       | 31/100 [09:12<20:34, 17.89s/it]epoch [31/100], focal_loss:0.0084	, anomaly_loss:0.2783	fnorm_loss:0.0077, a_fnorm_loss:0.0489P:0.55, R:0.96
 32%|███▏      | 32/100 [09:26<18:49, 16.61s/it]epoch [32/100], focal_loss:0.0079	, anomaly_loss:0.2787	fnorm_loss:0.0074, a_fnorm_loss:0.0502P:0.54, R:0.96
 33%|███▎      | 33/100 [09:39<17:20, 15.53s/it]epoch [33/100], focal_loss:0.0076	, anomaly_loss:0.2735	fnorm_loss:0.0073, a_fnorm_loss:0.0501P:0.52, R:0.97
 34%|███▍      | 34/100 [09:52<16:13, 14.75s/it]epoch [34/100], focal_loss:0.0067	, anomaly_loss:0.2704	fnorm_loss:0.0071, a_fnorm_loss:0.0516P:0.50, R:0.97
 35%|███▌      | 35/100 [10:23<21:23, 19.74s/it]epoch [35/100], focal_loss:0.0063	, anomaly_loss:0.2727	fnorm_loss:0.0069, a_fnorm_loss:0.0521P:0.56, R:0.97
normal: 0.0269 0.0687  anomaly: 0.0271 0.6991	P:0.36, R:0.34
Pixel Auroc:0.993, Sample Auroc0.976, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0344
 36%|███▌      | 36/100 [10:36<18:54, 17.73s/it]epoch [36/100], focal_loss:0.0066	, anomaly_loss:0.2711	fnorm_loss:0.0068, a_fnorm_loss:0.0522P:0.58, R:0.97
 37%|███▋      | 37/100 [10:50<17:17, 16.47s/it]epoch [37/100], focal_loss:0.0069	, anomaly_loss:0.2731	fnorm_loss:0.0068, a_fnorm_loss:0.0519P:0.55, R:0.97
 38%|███▊      | 38/100 [11:03<16:06, 15.59s/it]epoch [38/100], focal_loss:0.0111	, anomaly_loss:0.2971	fnorm_loss:0.0072, a_fnorm_loss:0.0456P:0.53, R:0.92
 39%|███▉      | 39/100 [11:16<15:05, 14.84s/it]epoch [39/100], focal_loss:0.0065	, anomaly_loss:0.2687	fnorm_loss:0.0066, a_fnorm_loss:0.0500P:0.54, R:0.97
 40%|████      | 40/100 [11:48<19:45, 19.76s/it]epoch [40/100], focal_loss:0.0058	, anomaly_loss:0.2651	fnorm_loss:0.0065, a_fnorm_loss:0.0524P:0.56, R:0.97
normal: 0.0255 0.1104  anomaly: 0.0269 0.7367	P:0.37, R:0.43
Pixel Auroc:0.994, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0507
 41%|████      | 41/100 [12:00<17:21, 17.66s/it]epoch [41/100], focal_loss:0.0060	, anomaly_loss:0.2640	fnorm_loss:0.0065, a_fnorm_loss:0.0528P:0.54, R:0.97
 42%|████▏     | 42/100 [12:13<15:40, 16.22s/it]epoch [42/100], focal_loss:0.0063	, anomaly_loss:0.2647	fnorm_loss:0.0064, a_fnorm_loss:0.0517P:0.58, R:0.97
 43%|████▎     | 43/100 [12:27<14:43, 15.49s/it]epoch [43/100], focal_loss:0.0067	, anomaly_loss:0.2645	fnorm_loss:0.0065, a_fnorm_loss:0.0526P:0.52, R:0.96
 44%|████▍     | 44/100 [12:39<13:36, 14.58s/it]epoch [44/100], focal_loss:0.0065	, anomaly_loss:0.2681	fnorm_loss:0.0064, a_fnorm_loss:0.0523P:0.55, R:0.97
 45%|████▌     | 45/100 [13:12<18:15, 19.91s/it]epoch [45/100], focal_loss:0.0062	, anomaly_loss:0.2617	fnorm_loss:0.0063, a_fnorm_loss:0.0521P:0.56, R:0.98
normal: 0.0244 0.1140  anomaly: 0.0273 0.6534	P:0.36, R:0.33
Pixel Auroc:0.992, Sample Auroc0.958, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0284
 46%|████▌     | 46/100 [13:25<16:02, 17.82s/it]epoch [46/100], focal_loss:0.0063	, anomaly_loss:0.2658	fnorm_loss:0.0062, a_fnorm_loss:0.0512P:0.55, R:0.97
 47%|████▋     | 47/100 [13:39<14:42, 16.65s/it]epoch [47/100], focal_loss:0.0067	, anomaly_loss:0.2736	fnorm_loss:0.0062, a_fnorm_loss:0.0522P:0.55, R:0.96
 48%|████▊     | 48/100 [13:51<13:26, 15.51s/it]epoch [48/100], focal_loss:0.0062	, anomaly_loss:0.2780	fnorm_loss:0.0061, a_fnorm_loss:0.0525P:0.58, R:0.96
 49%|████▉     | 49/100 [14:06<12:55, 15.21s/it]epoch [49/100], focal_loss:0.0063	, anomaly_loss:0.2734	fnorm_loss:0.0061, a_fnorm_loss:0.0526P:0.52, R:0.98
 50%|█████     | 50/100 [14:43<18:12, 21.84s/it]epoch [50/100], focal_loss:0.0070	, anomaly_loss:0.2925	fnorm_loss:0.0060, a_fnorm_loss:0.0523P:0.56, R:0.94
normal: 0.0273 0.0736  anomaly: 0.0303 0.7329	P:0.39, R:0.39
Pixel Auroc:0.994, Sample Auroc0.977, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0430
 51%|█████     | 51/100 [14:57<15:46, 19.32s/it]epoch [51/100], focal_loss:0.0061	, anomaly_loss:0.2800	fnorm_loss:0.0060, a_fnorm_loss:0.0530P:0.58, R:0.97
 52%|█████▏    | 52/100 [15:11<14:10, 17.72s/it]epoch [52/100], focal_loss:0.0066	, anomaly_loss:0.2770	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.55, R:0.96
 53%|█████▎    | 53/100 [15:24<12:44, 16.27s/it]epoch [53/100], focal_loss:0.0057	, anomaly_loss:0.2716	fnorm_loss:0.0060, a_fnorm_loss:0.0534P:0.60, R:0.98
 54%|█████▍    | 54/100 [15:37<11:47, 15.38s/it]epoch [54/100], focal_loss:0.0057	, anomaly_loss:0.2640	fnorm_loss:0.0059, a_fnorm_loss:0.0536P:0.58, R:0.94
 55%|█████▌    | 55/100 [16:08<15:10, 20.23s/it]epoch [55/100], focal_loss:0.0059	, anomaly_loss:0.2800	fnorm_loss:0.0059, a_fnorm_loss:0.0517P:0.57, R:0.96
normal: 0.0238 0.0749  anomaly: 0.0248 0.7300	P:0.37, R:0.42
Pixel Auroc:0.993, Sample Auroc0.980, Pixel Aupro0.0
test_fnorm_loss: 0.0055 test_afnorm_loss: 0.0457
 56%|█████▌    | 56/100 [16:21<13:14, 18.06s/it]epoch [56/100], focal_loss:0.0064	, anomaly_loss:0.2727	fnorm_loss:0.0059, a_fnorm_loss:0.0532P:0.58, R:0.97
 57%|█████▋    | 57/100 [16:35<11:54, 16.62s/it]epoch [57/100], focal_loss:0.0061	, anomaly_loss:0.2748	fnorm_loss:0.0059, a_fnorm_loss:0.0532P:0.58, R:0.97
 58%|█████▊    | 58/100 [16:50<11:18, 16.16s/it]epoch [58/100], focal_loss:0.0064	, anomaly_loss:0.2734	fnorm_loss:0.0059, a_fnorm_loss:0.0522P:0.55, R:0.96
 59%|█████▉    | 59/100 [17:03<10:30, 15.37s/it]epoch [59/100], focal_loss:0.0058	, anomaly_loss:0.2698	fnorm_loss:0.0058, a_fnorm_loss:0.0533P:0.59, R:0.97
 60%|██████    | 60/100 [17:41<14:41, 22.03s/it]epoch [60/100], focal_loss:0.0059	, anomaly_loss:0.2730	fnorm_loss:0.0058, a_fnorm_loss:0.0532P:0.57, R:0.97
normal: 0.0224 0.0920  anomaly: 0.0247 0.7200	P:0.40, R:0.41
Pixel Auroc:0.994, Sample Auroc0.981, Pixel Aupro0.0
test_fnorm_loss: 0.0053 test_afnorm_loss: 0.0400
 61%|██████    | 61/100 [17:54<12:30, 19.24s/it]epoch [61/100], focal_loss:0.0068	, anomaly_loss:0.2855	fnorm_loss:0.0058, a_fnorm_loss:0.0523P:0.56, R:0.94
 62%|██████▏   | 62/100 [18:07<11:00, 17.39s/it]epoch [62/100], focal_loss:0.0055	, anomaly_loss:0.2706	fnorm_loss:0.0057, a_fnorm_loss:0.0540P:0.57, R:0.98
 63%|██████▎   | 63/100 [18:20<10:02, 16.29s/it]epoch [63/100], focal_loss:0.0081	, anomaly_loss:0.2870	fnorm_loss:0.0059, a_fnorm_loss:0.0500P:0.55, R:0.94
 64%|██████▍   | 64/100 [18:34<09:18, 15.50s/it]epoch [64/100], focal_loss:0.0080	, anomaly_loss:0.2827	fnorm_loss:0.0059, a_fnorm_loss:0.0520P:0.53, R:0.95
 65%|██████▌   | 65/100 [19:06<11:54, 20.40s/it]epoch [65/100], focal_loss:0.0068	, anomaly_loss:0.2730	fnorm_loss:0.0058, a_fnorm_loss:0.0525P:0.57, R:0.96
normal: 0.0222 0.0905  anomaly: 0.0247 0.7213	P:0.38, R:0.42
Pixel Auroc:0.994, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0053 test_afnorm_loss: 0.0404
 66%|██████▌   | 66/100 [19:19<10:20, 18.24s/it]epoch [66/100], focal_loss:0.0058	, anomaly_loss:0.2724	fnorm_loss:0.0057, a_fnorm_loss:0.0528P:0.58, R:0.97
 67%|██████▋   | 67/100 [19:33<09:14, 16.81s/it]epoch [67/100], focal_loss:0.0054	, anomaly_loss:0.2728	fnorm_loss:0.0056, a_fnorm_loss:0.0533P:0.62, R:0.97
 68%|██████▊   | 68/100 [19:46<08:23, 15.72s/it]epoch [68/100], focal_loss:0.0059	, anomaly_loss:0.2800	fnorm_loss:0.0057, a_fnorm_loss:0.0531P:0.59, R:0.97
 69%|██████▉   | 69/100 [19:59<07:41, 14.89s/it]epoch [69/100], focal_loss:0.0054	, anomaly_loss:0.2728	fnorm_loss:0.0056, a_fnorm_loss:0.0542P:0.60, R:0.98
 70%|███████   | 70/100 [20:30<09:51, 19.71s/it]epoch [70/100], focal_loss:0.0053	, anomaly_loss:0.2715	fnorm_loss:0.0056, a_fnorm_loss:0.0543P:0.59, R:0.97
normal: 0.0219 0.0973  anomaly: 0.0238 0.7323	P:0.38, R:0.42
Pixel Auroc:0.994, Sample Auroc0.978, Pixel Aupro0.0
test_fnorm_loss: 0.0052 test_afnorm_loss: 0.0444
 71%|███████   | 71/100 [20:43<08:35, 17.77s/it]epoch [71/100], focal_loss:0.0056	, anomaly_loss:0.2768	fnorm_loss:0.0056, a_fnorm_loss:0.0537P:0.60, R:0.97
 72%|███████▏  | 72/100 [20:56<07:36, 16.32s/it]epoch [72/100], focal_loss:0.0060	, anomaly_loss:0.2674	fnorm_loss:0.0056, a_fnorm_loss:0.0533P:0.60, R:0.97
 73%|███████▎  | 73/100 [21:09<06:56, 15.42s/it]epoch [73/100], focal_loss:0.0056	, anomaly_loss:0.2665	fnorm_loss:0.0055, a_fnorm_loss:0.0555P:0.62, R:0.97
 74%|███████▍  | 74/100 [21:22<06:22, 14.73s/it]epoch [74/100], focal_loss:0.0064	, anomaly_loss:0.2723	fnorm_loss:0.0057, a_fnorm_loss:0.0533P:0.56, R:0.96
 75%|███████▌  | 75/100 [21:53<08:10, 19.61s/it]epoch [75/100], focal_loss:0.0061	, anomaly_loss:0.2725	fnorm_loss:0.0056, a_fnorm_loss:0.0533P:0.59, R:0.97
normal: 0.0240 0.1473  anomaly: 0.0298 0.7273	P:0.38, R:0.43
Pixel Auroc:0.993, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0425
 76%|███████▌  | 76/100 [22:06<07:02, 17.61s/it]epoch [76/100], focal_loss:0.0057	, anomaly_loss:0.2671	fnorm_loss:0.0056, a_fnorm_loss:0.0533P:0.60, R:0.98
 77%|███████▋  | 77/100 [22:19<06:12, 16.21s/it]epoch [77/100], focal_loss:0.0058	, anomaly_loss:0.2707	fnorm_loss:0.0056, a_fnorm_loss:0.0545P:0.57, R:0.97
 78%|███████▊  | 78/100 [22:32<05:34, 15.19s/it]epoch [78/100], focal_loss:0.0056	, anomaly_loss:0.2741	fnorm_loss:0.0055, a_fnorm_loss:0.0542P:0.61, R:0.97
 79%|███████▉  | 79/100 [22:45<05:07, 14.63s/it]epoch [79/100], focal_loss:0.0059	, anomaly_loss:0.2744	fnorm_loss:0.0055, a_fnorm_loss:0.0534P:0.56, R:0.96
 80%|████████  | 80/100 [23:16<06:31, 19.59s/it]epoch [80/100], focal_loss:0.0062	, anomaly_loss:0.2725	fnorm_loss:0.0057, a_fnorm_loss:0.0522P:0.58, R:0.97
normal: 0.0226 0.0874  anomaly: 0.0256 0.7316	P:0.38, R:0.40
Pixel Auroc:0.993, Sample Auroc0.977, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0447
 81%|████████  | 81/100 [23:30<05:37, 17.74s/it]epoch [81/100], focal_loss:0.0053	, anomaly_loss:0.2703	fnorm_loss:0.0055, a_fnorm_loss:0.0543P:0.60, R:0.97
 82%|████████▏ | 82/100 [23:43<04:55, 16.40s/it]epoch [82/100], focal_loss:0.0051	, anomaly_loss:0.2678	fnorm_loss:0.0055, a_fnorm_loss:0.0536P:0.60, R:0.97
 83%|████████▎ | 83/100 [23:56<04:20, 15.32s/it]epoch [83/100], focal_loss:0.0050	, anomaly_loss:0.2650	fnorm_loss:0.0055, a_fnorm_loss:0.0547P:0.61, R:0.98
 84%|████████▍ | 84/100 [24:09<03:53, 14.57s/it]epoch [84/100], focal_loss:0.0051	, anomaly_loss:0.2704	fnorm_loss:0.0055, a_fnorm_loss:0.0550P:0.63, R:0.97
 85%|████████▌ | 85/100 [24:45<05:16, 21.10s/it]epoch [85/100], focal_loss:0.0050	, anomaly_loss:0.2648	fnorm_loss:0.0054, a_fnorm_loss:0.0546P:0.61, R:0.97
normal: 0.0245 0.1474  anomaly: 0.0297 0.7374	P:0.40, R:0.42
Pixel Auroc:0.994, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0437
 86%|████████▌ | 86/100 [24:58<04:20, 18.59s/it]epoch [86/100], focal_loss:0.0049	, anomaly_loss:0.2653	fnorm_loss:0.0054, a_fnorm_loss:0.0546P:0.62, R:0.97
 87%|████████▋ | 87/100 [25:11<03:42, 17.11s/it]epoch [87/100], focal_loss:0.0053	, anomaly_loss:0.2754	fnorm_loss:0.0055, a_fnorm_loss:0.0544P:0.61, R:0.97
 88%|████████▊ | 88/100 [25:24<03:09, 15.80s/it]epoch [88/100], focal_loss:0.0052	, anomaly_loss:0.2690	fnorm_loss:0.0055, a_fnorm_loss:0.0541P:0.60, R:0.98
 89%|████████▉ | 89/100 [25:37<02:44, 14.92s/it]epoch [89/100], focal_loss:0.0052	, anomaly_loss:0.2659	fnorm_loss:0.0055, a_fnorm_loss:0.0546P:0.59, R:0.97
 90%|█████████ | 90/100 [26:09<03:20, 20.01s/it]epoch [90/100], focal_loss:0.0057	, anomaly_loss:0.2729	fnorm_loss:0.0055, a_fnorm_loss:0.0527P:0.62, R:0.97
normal: 0.0237 0.1602  anomaly: 0.0366 0.7441	P:0.38, R:0.45
Pixel Auroc:0.994, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0052 test_afnorm_loss: 0.0478
 91%|█████████ | 91/100 [26:23<02:43, 18.14s/it]epoch [91/100], focal_loss:0.0050	, anomaly_loss:0.2652	fnorm_loss:0.0054, a_fnorm_loss:0.0544P:0.62, R:0.98
 92%|█████████▏| 92/100 [26:36<02:14, 16.78s/it]epoch [92/100], focal_loss:0.0052	, anomaly_loss:0.2764	fnorm_loss:0.0055, a_fnorm_loss:0.0540P:0.63, R:0.97
 93%|█████████▎| 93/100 [26:50<01:51, 15.96s/it]epoch [93/100], focal_loss:0.0054	, anomaly_loss:0.2751	fnorm_loss:0.0054, a_fnorm_loss:0.0548P:0.61, R:0.98
 94%|█████████▍| 94/100 [27:04<01:31, 15.19s/it]epoch [94/100], focal_loss:0.0048	, anomaly_loss:0.2738	fnorm_loss:0.0055, a_fnorm_loss:0.0546P:0.62, R:0.98
 95%|█████████▌| 95/100 [27:35<01:39, 19.95s/it]epoch [95/100], focal_loss:0.0055	, anomaly_loss:0.2799	fnorm_loss:0.0055, a_fnorm_loss:0.0541P:0.57, R:0.96
normal: 0.0259 0.1726  anomaly: 0.0408 0.7458	P:0.38, R:0.45
Pixel Auroc:0.994, Sample Auroc0.976, Pixel Aupro0.0
test_fnorm_loss: 0.0052 test_afnorm_loss: 0.0488
 96%|█████████▌| 96/100 [27:48<01:11, 17.84s/it]epoch [96/100], focal_loss:0.0054	, anomaly_loss:0.2743	fnorm_loss:0.0055, a_fnorm_loss:0.0544P:0.60, R:0.98
 97%|█████████▋| 97/100 [28:01<00:48, 16.32s/it]epoch [97/100], focal_loss:0.0051	, anomaly_loss:0.2721	fnorm_loss:0.0054, a_fnorm_loss:0.0541P:0.63, R:0.98
 98%|█████████▊| 98/100 [28:13<00:30, 15.13s/it]epoch [98/100], focal_loss:0.0048	, anomaly_loss:0.2670	fnorm_loss:0.0054, a_fnorm_loss:0.0540P:0.62, R:0.98
 99%|█████████▉| 99/100 [28:26<00:14, 14.59s/it]epoch [99/100], focal_loss:0.0051	, anomaly_loss:0.2676	fnorm_loss:0.0055, a_fnorm_loss:0.0542P:0.60, R:0.98
100%|██████████| 100/100 [28:57<00:00, 19.55s/it]100%|██████████| 100/100 [28:57<00:00, 17.38s/it]
epoch [100/100], focal_loss:0.0054	, anomaly_loss:0.2742	fnorm_loss:0.0055, a_fnorm_loss:0.0550P:0.62, R:0.97
normal: 0.0237 0.1639  anomaly: 0.0328 0.7419	P:0.39, R:0.44
Pixel Auroc:0.994, Sample Auroc0.977, Pixel Aupro0.0
test_fnorm_loss: 0.0051 test_afnorm_loss: 0.0472
training Stubborn Student...
chewinggum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:08<17:17,  8.72s/it]epoch [1/120], kd_loss:4.2851
  2%|▏         | 2/120 [00:17<17:08,  8.72s/it]epoch [2/120], kd_loss:3.4609
  2%|▎         | 3/120 [00:26<16:59,  8.71s/it]epoch [3/120], kd_loss:2.9259
  3%|▎         | 4/120 [00:34<16:52,  8.73s/it]epoch [4/120], kd_loss:2.3752
  4%|▍         | 5/120 [00:43<16:46,  8.75s/it]epoch [5/120], kd_loss:2.0159
  5%|▌         | 6/120 [00:52<16:38,  8.76s/it]epoch [6/120], kd_loss:2.1937
  6%|▌         | 7/120 [01:01<16:33,  8.79s/it]epoch [7/120], kd_loss:1.8345
  7%|▋         | 8/120 [01:10<16:28,  8.82s/it]epoch [8/120], kd_loss:2.0172
  8%|▊         | 9/120 [01:19<16:19,  8.83s/it]epoch [9/120], kd_loss:1.8772
  8%|▊         | 10/120 [01:45<26:05, 14.23s/it]epoch [10/120], kd_loss:2.0588
normal: 1.0453 1.3841  anomaly: 1.0707 2.6165
thresh: 1.3047683885065127
fpr: 0.06 fnr 0.06
Pixel Auroc:0.992, Sample Auroc0.969, Pixel Aupro0.0
  9%|▉         | 11/120 [01:54<22:45, 12.53s/it]epoch [11/120], kd_loss:1.7062
 10%|█         | 12/120 [02:02<20:31, 11.40s/it]epoch [12/120], kd_loss:1.6873
 11%|█         | 13/120 [02:11<18:53, 10.59s/it]epoch [13/120], kd_loss:1.6025
 12%|█▏        | 14/120 [02:20<17:46, 10.06s/it]epoch [14/120], kd_loss:1.5543
 12%|█▎        | 15/120 [02:29<16:57,  9.69s/it]epoch [15/120], kd_loss:1.6918
 13%|█▎        | 16/120 [02:38<16:20,  9.42s/it]epoch [16/120], kd_loss:1.7891
 14%|█▍        | 17/120 [02:46<15:49,  9.22s/it]epoch [17/120], kd_loss:1.6481
 15%|█▌        | 18/120 [02:55<15:27,  9.09s/it]epoch [18/120], kd_loss:1.5591
 16%|█▌        | 19/120 [03:04<15:11,  9.02s/it]epoch [19/120], kd_loss:1.5223
 17%|█▋        | 20/120 [03:30<23:39, 14.19s/it]epoch [20/120], kd_loss:1.5027
normal: 0.8588 1.3012  anomaly: 0.9611 2.6830
thresh: 1.1769659371635925
fpr: 0.04 fnr 0.08
Pixel Auroc:0.989, Sample Auroc0.963, Pixel Aupro0.0
 18%|█▊        | 21/120 [03:39<20:44, 12.57s/it]epoch [21/120], kd_loss:1.5726
 18%|█▊        | 22/120 [03:48<18:38, 11.42s/it]epoch [22/120], kd_loss:1.5348
 19%|█▉        | 23/120 [03:56<17:09, 10.62s/it]epoch [23/120], kd_loss:1.4851
 20%|██        | 24/120 [04:05<16:07, 10.08s/it]epoch [24/120], kd_loss:1.4761
 21%|██        | 25/120 [04:14<15:20,  9.69s/it]epoch [25/120], kd_loss:1.4892
 22%|██▏       | 26/120 [04:23<14:47,  9.44s/it]epoch [26/120], kd_loss:1.4507
 22%|██▎       | 27/120 [04:32<14:21,  9.26s/it]epoch [27/120], kd_loss:1.8550
 23%|██▎       | 28/120 [04:41<14:00,  9.13s/it]epoch [28/120], kd_loss:2.0037
 24%|██▍       | 29/120 [04:49<13:43,  9.05s/it]epoch [29/120], kd_loss:1.6875
 25%|██▌       | 30/120 [05:15<21:02, 14.03s/it]epoch [30/120], kd_loss:1.5663
normal: 0.9083 1.4845  anomaly: 0.9652 2.6446
thresh: 1.1779309837996692
fpr: 0.12 fnr 0.04
Pixel Auroc:0.992, Sample Auroc0.964, Pixel Aupro0.0
 26%|██▌       | 31/120 [05:24<18:27, 12.44s/it]epoch [31/120], kd_loss:1.6009
 27%|██▋       | 32/120 [05:33<16:37, 11.34s/it]epoch [32/120], kd_loss:1.6125
 28%|██▊       | 33/120 [05:41<15:18, 10.55s/it]epoch [33/120], kd_loss:1.5642
 28%|██▊       | 34/120 [05:50<14:20, 10.01s/it]epoch [34/120], kd_loss:1.5493
 29%|██▉       | 35/120 [05:59<13:39,  9.65s/it]epoch [35/120], kd_loss:1.5035
 30%|███       | 36/120 [06:08<13:09,  9.40s/it]epoch [36/120], kd_loss:1.4864
 31%|███       | 37/120 [06:17<12:46,  9.23s/it]epoch [37/120], kd_loss:1.4452
 32%|███▏      | 38/120 [06:25<12:25,  9.09s/it]epoch [38/120], kd_loss:1.4576
 32%|███▎      | 39/120 [06:34<12:09,  9.01s/it]epoch [39/120], kd_loss:1.5591
 33%|███▎      | 40/120 [07:02<19:21, 14.51s/it]epoch [40/120], kd_loss:1.4423
normal: 0.8267 1.4301  anomaly: 0.9570 2.7094
thresh: 1.0952545005192291
fpr: 0.1 fnr 0.06
Pixel Auroc:0.987, Sample Auroc0.974, Pixel Aupro0.0
 34%|███▍      | 41/120 [07:10<16:49, 12.78s/it]epoch [41/120], kd_loss:1.4258
 35%|███▌      | 42/120 [07:19<15:00, 11.55s/it]epoch [42/120], kd_loss:1.4335
 36%|███▌      | 43/120 [07:28<13:45, 10.72s/it]epoch [43/120], kd_loss:1.4312
 37%|███▋      | 44/120 [07:36<12:50, 10.14s/it]epoch [44/120], kd_loss:1.3969
 38%|███▊      | 45/120 [07:45<12:09,  9.73s/it]epoch [45/120], kd_loss:1.4370
 38%|███▊      | 46/120 [07:54<11:38,  9.45s/it]epoch [46/120], kd_loss:1.3923
 39%|███▉      | 47/120 [08:03<11:13,  9.23s/it]epoch [47/120], kd_loss:1.6629
 40%|████      | 48/120 [08:12<10:55,  9.10s/it]epoch [48/120], kd_loss:1.7990
 41%|████      | 49/120 [08:20<10:39,  9.00s/it]epoch [49/120], kd_loss:1.4921
 42%|████▏     | 50/120 [08:46<16:12, 13.90s/it]epoch [50/120], kd_loss:1.4299
normal: 0.8607 1.3194  anomaly: 0.9350 2.7233
thresh: 1.3461344183676225
fpr: 0.0 fnr 0.12
Pixel Auroc:0.985, Sample Auroc0.959, Pixel Aupro0.0
 42%|████▎     | 51/120 [08:54<14:13, 12.37s/it]epoch [51/120], kd_loss:1.4218
 43%|████▎     | 52/120 [09:03<12:47, 11.29s/it]epoch [52/120], kd_loss:1.4035
 44%|████▍     | 53/120 [09:12<11:45, 10.53s/it]epoch [53/120], kd_loss:1.3949
 45%|████▌     | 54/120 [09:21<10:59,  9.99s/it]epoch [54/120], kd_loss:1.3938
 46%|████▌     | 55/120 [09:30<10:27,  9.65s/it]epoch [55/120], kd_loss:1.3945
 47%|████▋     | 56/120 [09:38<10:02,  9.41s/it]epoch [56/120], kd_loss:1.4152
 48%|████▊     | 57/120 [09:47<09:41,  9.24s/it]epoch [57/120], kd_loss:1.4045
 48%|████▊     | 58/120 [09:56<09:23,  9.09s/it]epoch [58/120], kd_loss:1.3802
 49%|████▉     | 59/120 [10:05<09:09,  9.02s/it]epoch [59/120], kd_loss:1.3929
 50%|█████     | 60/120 [10:31<14:06, 14.11s/it]epoch [60/120], kd_loss:1.3537
normal: 0.7999 1.5698  anomaly: 0.8472 2.7757
thresh: 1.0611389614439992
fpr: 0.08 fnr 0.07
Pixel Auroc:0.986, Sample Auroc0.959, Pixel Aupro0.0
 51%|█████     | 61/120 [10:40<12:17, 12.50s/it]epoch [61/120], kd_loss:1.3481
 52%|█████▏    | 62/120 [10:48<10:59, 11.37s/it]epoch [62/120], kd_loss:1.3436
 52%|█████▎    | 63/120 [10:57<10:02, 10.58s/it]epoch [63/120], kd_loss:1.3476
 53%|█████▎    | 64/120 [11:06<09:20, 10.02s/it]epoch [64/120], kd_loss:1.3212
 54%|█████▍    | 65/120 [11:15<08:50,  9.65s/it]epoch [65/120], kd_loss:1.3207
 55%|█████▌    | 66/120 [11:23<08:28,  9.41s/it]epoch [66/120], kd_loss:1.3439
 56%|█████▌    | 67/120 [11:32<08:10,  9.25s/it]epoch [67/120], kd_loss:1.3104
 57%|█████▋    | 68/120 [11:41<07:53,  9.11s/it]epoch [68/120], kd_loss:1.2908
 57%|█████▊    | 69/120 [11:50<07:40,  9.03s/it]epoch [69/120], kd_loss:1.2938
 58%|█████▊    | 70/120 [12:18<12:15, 14.72s/it]epoch [70/120], kd_loss:1.3654
normal: 0.7647 1.0462  anomaly: 0.8358 2.5480
thresh: 1.0144837630072883
fpr: 0.04 fnr 0.06
Pixel Auroc:0.989, Sample Auroc0.981, Pixel Aupro0.0
 59%|█████▉    | 71/120 [12:27<10:32, 12.92s/it]epoch [71/120], kd_loss:1.3545
 60%|██████    | 72/120 [12:35<09:19, 11.66s/it]epoch [72/120], kd_loss:1.3175
 61%|██████    | 73/120 [12:44<08:27, 10.80s/it]epoch [73/120], kd_loss:1.7903
 62%|██████▏   | 74/120 [12:53<07:49, 10.20s/it]epoch [74/120], kd_loss:1.5106
 62%|██████▎   | 75/120 [13:02<07:19,  9.77s/it]epoch [75/120], kd_loss:1.3741
 63%|██████▎   | 76/120 [13:11<06:57,  9.49s/it]epoch [76/120], kd_loss:1.3958
 64%|██████▍   | 77/120 [13:19<06:38,  9.27s/it]epoch [77/120], kd_loss:1.3232
 65%|██████▌   | 78/120 [13:28<06:23,  9.14s/it]epoch [78/120], kd_loss:1.3365
 66%|██████▌   | 79/120 [13:37<06:10,  9.03s/it]epoch [79/120], kd_loss:1.3055
 67%|██████▋   | 80/120 [14:04<09:35, 14.39s/it]epoch [80/120], kd_loss:1.3281
normal: 0.7559 1.0499  anomaly: 0.7900 2.5609
thresh: 0.9900194561416775
fpr: 0.04 fnr 0.07
Pixel Auroc:0.988, Sample Auroc0.969, Pixel Aupro0.0
 68%|██████▊   | 81/120 [14:12<08:14, 12.68s/it]epoch [81/120], kd_loss:1.2844
 68%|██████▊   | 82/120 [14:21<07:16, 11.49s/it]epoch [82/120], kd_loss:1.2706
 69%|██████▉   | 83/120 [14:30<06:34, 10.67s/it]epoch [83/120], kd_loss:1.2634
 70%|███████   | 84/120 [14:39<06:04, 10.12s/it]epoch [84/120], kd_loss:1.2991
 71%|███████   | 85/120 [14:48<05:40,  9.74s/it]epoch [85/120], kd_loss:1.2590
 72%|███████▏  | 86/120 [14:56<05:22,  9.47s/it]epoch [86/120], kd_loss:1.4135
 72%|███████▎  | 87/120 [15:05<05:06,  9.27s/it]epoch [87/120], kd_loss:1.3320
 73%|███████▎  | 88/120 [15:14<04:52,  9.13s/it]epoch [88/120], kd_loss:1.2841
 74%|███████▍  | 89/120 [15:23<04:40,  9.05s/it]epoch [89/120], kd_loss:1.3147
 75%|███████▌  | 90/120 [15:49<07:03, 14.12s/it]epoch [90/120], kd_loss:1.2961
normal: 0.8198 1.1815  anomaly: 0.9051 2.6304
thresh: 1.0679922131743458
fpr: 0.08 fnr 0.07
Pixel Auroc:0.989, Sample Auroc0.967, Pixel Aupro0.0
 76%|███████▌  | 91/120 [15:58<06:03, 12.53s/it]epoch [91/120], kd_loss:1.3014
 77%|███████▋  | 92/120 [16:07<05:19, 11.42s/it]epoch [92/120], kd_loss:2.0129
 78%|███████▊  | 93/120 [16:15<04:46, 10.62s/it]epoch [93/120], kd_loss:1.7800
 78%|███████▊  | 94/120 [16:24<04:21, 10.05s/it]epoch [94/120], kd_loss:1.4549
 79%|███████▉  | 95/120 [16:33<04:00,  9.64s/it]epoch [95/120], kd_loss:1.4641
 80%|████████  | 96/120 [16:41<03:45,  9.38s/it]epoch [96/120], kd_loss:1.4840
 81%|████████  | 97/120 [16:50<03:32,  9.22s/it]epoch [97/120], kd_loss:1.4030
 82%|████████▏ | 98/120 [16:59<03:20,  9.11s/it]epoch [98/120], kd_loss:1.3839
 82%|████████▎ | 99/120 [17:08<03:09,  9.01s/it]epoch [99/120], kd_loss:1.3719
 83%|████████▎ | 100/120 [17:34<04:41, 14.08s/it]epoch [100/120], kd_loss:1.3697
normal: 0.7994 1.0666  anomaly: 0.8670 2.7367
thresh: 1.1194051233455875
fpr: 0.0 fnr 0.09
Pixel Auroc:0.989, Sample Auroc0.977, Pixel Aupro0.0
 84%|████████▍ | 101/120 [17:43<03:56, 12.47s/it]epoch [101/120], kd_loss:1.3598
 85%|████████▌ | 102/120 [17:51<03:24, 11.36s/it]epoch [102/120], kd_loss:1.3488
 86%|████████▌ | 103/120 [18:00<03:00, 10.61s/it]epoch [103/120], kd_loss:1.3439
 87%|████████▋ | 104/120 [18:09<02:40, 10.05s/it]epoch [104/120], kd_loss:1.4328
 88%|████████▊ | 105/120 [18:18<02:25,  9.67s/it]epoch [105/120], kd_loss:1.3452
 88%|████████▊ | 106/120 [18:26<02:11,  9.40s/it]epoch [106/120], kd_loss:1.3374
 89%|████████▉ | 107/120 [18:35<01:59,  9.22s/it]epoch [107/120], kd_loss:1.3322
 90%|█████████ | 108/120 [18:44<01:49,  9.13s/it]epoch [108/120], kd_loss:1.3263
 91%|█████████ | 109/120 [18:53<01:39,  9.04s/it]epoch [109/120], kd_loss:1.3222
 92%|█████████▏| 110/120 [19:18<02:19, 13.91s/it]epoch [110/120], kd_loss:1.3215
normal: 0.7735 1.5051  anomaly: 0.8424 2.6473
thresh: 1.1294418549932306
fpr: 0.02 fnr 0.09
Pixel Auroc:0.988, Sample Auroc0.976, Pixel Aupro0.0
 92%|█████████▎| 111/120 [19:27<01:51, 12.36s/it]epoch [111/120], kd_loss:1.3208
 93%|█████████▎| 112/120 [19:36<01:30, 11.26s/it]epoch [112/120], kd_loss:1.3187
 94%|█████████▍| 113/120 [19:45<01:13, 10.52s/it]epoch [113/120], kd_loss:1.3190
 95%|█████████▌| 114/120 [19:53<00:59,  9.99s/it]epoch [114/120], kd_loss:1.3178
 96%|█████████▌| 115/120 [20:02<00:48,  9.63s/it]epoch [115/120], kd_loss:1.3170
 97%|█████████▋| 116/120 [20:11<00:37,  9.38s/it]epoch [116/120], kd_loss:1.3161
 98%|█████████▊| 117/120 [20:20<00:27,  9.22s/it]epoch [117/120], kd_loss:1.3150
 98%|█████████▊| 118/120 [20:29<00:18,  9.12s/it]epoch [118/120], kd_loss:1.3149
 99%|█████████▉| 119/120 [20:38<00:09,  9.05s/it]epoch [119/120], kd_loss:1.3140
100%|██████████| 120/120 [21:03<00:00, 14.07s/it]100%|██████████| 120/120 [21:03<00:00, 10.53s/it]
epoch [120/120], kd_loss:1.3131
normal: 0.7723 1.0694  anomaly: 0.8230 2.6049
thresh: 1.0930745496432905
fpr: 0.0 fnr 0.09
Pixel Auroc:0.988, Sample Auroc0.975, Pixel Aupro0.0
training Advanced Teacher...
fryum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:35<58:05, 35.21s/it]epoch [1/100], focal_loss:0.0705	, anomaly_loss:0.5187	fnorm_loss:0.0728, a_fnorm_loss:0.0144P:0.00, R:0.02
normal: 0.2350 0.2404  anomaly: 0.2312 0.2406	P:0.00, R:0.00
Pixel Auroc:0.841, Sample Auroc0.355, Pixel Aupro0.0
test_fnorm_loss: 0.0687 test_afnorm_loss: 0.0136
  2%|▏         | 2/100 [00:47<35:51, 21.95s/it]epoch [2/100], focal_loss:0.0517	, anomaly_loss:0.5621	fnorm_loss:0.0605, a_fnorm_loss:0.0123P:0.00, R:0.00
  3%|▎         | 3/100 [01:00<28:47, 17.81s/it]epoch [3/100], focal_loss:0.0432	, anomaly_loss:0.5926	fnorm_loss:0.0507, a_fnorm_loss:0.0104P:0.00, R:0.00
  4%|▍         | 4/100 [01:14<25:44, 16.09s/it]epoch [4/100], focal_loss:0.0380	, anomaly_loss:0.5918	fnorm_loss:0.0450, a_fnorm_loss:0.0092P:0.00, R:0.00
  5%|▌         | 5/100 [01:46<34:27, 21.77s/it]epoch [5/100], focal_loss:0.0356	, anomaly_loss:0.6243	fnorm_loss:0.0409, a_fnorm_loss:0.0086P:0.00, R:0.00
normal: 0.1419 0.1445  anomaly: 0.1408 0.1448	P:0.00, R:0.00
Pixel Auroc:0.850, Sample Auroc0.375, Pixel Aupro0.0
test_fnorm_loss: 0.0411 test_afnorm_loss: 0.0086
  6%|▌         | 6/100 [01:59<29:39, 18.93s/it]epoch [6/100], focal_loss:0.0346	, anomaly_loss:0.5539	fnorm_loss:0.0386, a_fnorm_loss:0.0194P:0.04, R:0.17
  7%|▋         | 7/100 [02:13<27:00, 17.43s/it]epoch [7/100], focal_loss:0.0313	, anomaly_loss:0.4779	fnorm_loss:0.0330, a_fnorm_loss:0.0287P:0.08, R:0.28
  8%|▊         | 8/100 [02:27<24:55, 16.25s/it]epoch [8/100], focal_loss:0.0278	, anomaly_loss:0.4549	fnorm_loss:0.0303, a_fnorm_loss:0.0315P:0.17, R:0.43
  9%|▉         | 9/100 [02:40<23:04, 15.21s/it]epoch [9/100], focal_loss:0.0234	, anomaly_loss:0.3830	fnorm_loss:0.0262, a_fnorm_loss:0.0354P:0.30, R:0.69
 10%|█         | 10/100 [03:12<30:47, 20.53s/it]epoch [10/100], focal_loss:0.0195	, anomaly_loss:0.3272	fnorm_loss:0.0232, a_fnorm_loss:0.0387P:0.35, R:0.85
normal: 0.1589 0.4163  anomaly: 0.1663 0.6245	P:0.18, R:0.17
Pixel Auroc:0.924, Sample Auroc0.833, Pixel Aupro0.0
test_fnorm_loss: 0.0216 test_afnorm_loss: 0.0225
 11%|█         | 11/100 [03:25<26:58, 18.19s/it]epoch [11/100], focal_loss:0.0208	, anomaly_loss:0.3382	fnorm_loss:0.0211, a_fnorm_loss:0.0370P:0.37, R:0.80
 12%|█▏        | 12/100 [03:38<24:21, 16.61s/it]epoch [12/100], focal_loss:0.0156	, anomaly_loss:0.2816	fnorm_loss:0.0191, a_fnorm_loss:0.0415P:0.34, R:0.87
 13%|█▎        | 13/100 [03:51<22:28, 15.50s/it]epoch [13/100], focal_loss:0.0153	, anomaly_loss:0.2877	fnorm_loss:0.0177, a_fnorm_loss:0.0406P:0.37, R:0.85
 14%|█▍        | 14/100 [04:04<21:14, 14.83s/it]epoch [14/100], focal_loss:0.0163	, anomaly_loss:0.3058	fnorm_loss:0.0169, a_fnorm_loss:0.0407P:0.38, R:0.86
 15%|█▌        | 15/100 [04:36<28:08, 19.86s/it]epoch [15/100], focal_loss:0.0142	, anomaly_loss:0.2969	fnorm_loss:0.0158, a_fnorm_loss:0.0419P:0.36, R:0.90
normal: 0.1669 0.3747  anomaly: 0.2176 0.6534	P:0.17, R:0.17
Pixel Auroc:0.933, Sample Auroc0.849, Pixel Aupro0.0
test_fnorm_loss: 0.0161 test_afnorm_loss: 0.0262
 16%|█▌        | 16/100 [04:49<24:43, 17.66s/it]epoch [16/100], focal_loss:0.0133	, anomaly_loss:0.2820	fnorm_loss:0.0149, a_fnorm_loss:0.0424P:0.36, R:0.90
 17%|█▋        | 17/100 [05:01<22:26, 16.22s/it]epoch [17/100], focal_loss:0.0136	, anomaly_loss:0.2833	fnorm_loss:0.0142, a_fnorm_loss:0.0436P:0.38, R:0.90
 18%|█▊        | 18/100 [05:14<20:41, 15.14s/it]epoch [18/100], focal_loss:0.0123	, anomaly_loss:0.2770	fnorm_loss:0.0135, a_fnorm_loss:0.0445P:0.43, R:0.91
 19%|█▉        | 19/100 [05:28<19:45, 14.64s/it]epoch [19/100], focal_loss:0.0102	, anomaly_loss:0.2719	fnorm_loss:0.0127, a_fnorm_loss:0.0452P:0.42, R:0.93
 20%|██        | 20/100 [06:00<26:28, 19.85s/it]epoch [20/100], focal_loss:0.0120	, anomaly_loss:0.2752	fnorm_loss:0.0124, a_fnorm_loss:0.0447P:0.44, R:0.92
normal: 0.0459 0.2230  anomaly: 0.0485 0.6602	P:0.17, R:0.11
Pixel Auroc:0.944, Sample Auroc0.862, Pixel Aupro0.0
test_fnorm_loss: 0.0116 test_afnorm_loss: 0.0217
 21%|██        | 21/100 [06:12<23:19, 17.71s/it]epoch [21/100], focal_loss:0.0110	, anomaly_loss:0.2673	fnorm_loss:0.0119, a_fnorm_loss:0.0446P:0.40, R:0.88
 22%|██▏       | 22/100 [06:26<21:24, 16.47s/it]epoch [22/100], focal_loss:0.0107	, anomaly_loss:0.2708	fnorm_loss:0.0116, a_fnorm_loss:0.0451P:0.41, R:0.87
 23%|██▎       | 23/100 [06:39<19:52, 15.49s/it]epoch [23/100], focal_loss:0.0127	, anomaly_loss:0.2941	fnorm_loss:0.0115, a_fnorm_loss:0.0435P:0.45, R:0.87
 24%|██▍       | 24/100 [06:52<18:46, 14.82s/it]epoch [24/100], focal_loss:0.0102	, anomaly_loss:0.2620	fnorm_loss:0.0110, a_fnorm_loss:0.0472P:0.41, R:0.93
 25%|██▌       | 25/100 [07:23<24:38, 19.72s/it]epoch [25/100], focal_loss:0.0093	, anomaly_loss:0.2527	fnorm_loss:0.0106, a_fnorm_loss:0.0469P:0.40, R:0.90
normal: 0.0486 0.3439  anomaly: 0.0462 0.7282	P:0.17, R:0.12
Pixel Auroc:0.944, Sample Auroc0.854, Pixel Aupro0.0
test_fnorm_loss: 0.0101 test_afnorm_loss: 0.0284
 26%|██▌       | 26/100 [07:37<22:00, 17.84s/it]epoch [26/100], focal_loss:0.0104	, anomaly_loss:0.2640	fnorm_loss:0.0103, a_fnorm_loss:0.0457P:0.42, R:0.93
 27%|██▋       | 27/100 [07:51<20:16, 16.66s/it]epoch [27/100], focal_loss:0.0100	, anomaly_loss:0.2696	fnorm_loss:0.0102, a_fnorm_loss:0.0468P:0.41, R:0.92
 28%|██▊       | 28/100 [08:04<18:53, 15.74s/it]epoch [28/100], focal_loss:0.0091	, anomaly_loss:0.2622	fnorm_loss:0.0098, a_fnorm_loss:0.0458P:0.46, R:0.93
 29%|██▉       | 29/100 [08:18<17:47, 15.04s/it]epoch [29/100], focal_loss:0.0107	, anomaly_loss:0.2765	fnorm_loss:0.0099, a_fnorm_loss:0.0457P:0.44, R:0.90
 30%|███       | 30/100 [08:49<23:07, 19.82s/it]epoch [30/100], focal_loss:0.0091	, anomaly_loss:0.2553	fnorm_loss:0.0093, a_fnorm_loss:0.0481P:0.45, R:0.94
normal: 0.0418 0.2173  anomaly: 0.0426 0.6703	P:0.15, R:0.09
Pixel Auroc:0.947, Sample Auroc0.835, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0176
 31%|███       | 31/100 [09:02<20:24, 17.75s/it]epoch [31/100], focal_loss:0.0090	, anomaly_loss:0.2534	fnorm_loss:0.0093, a_fnorm_loss:0.0471P:0.44, R:0.90
 32%|███▏      | 32/100 [09:15<18:34, 16.38s/it]epoch [32/100], focal_loss:0.0105	, anomaly_loss:0.2749	fnorm_loss:0.0093, a_fnorm_loss:0.0451P:0.44, R:0.90
 33%|███▎      | 33/100 [09:28<17:11, 15.40s/it]epoch [33/100], focal_loss:0.0087	, anomaly_loss:0.2619	fnorm_loss:0.0089, a_fnorm_loss:0.0489P:0.49, R:0.92
 34%|███▍      | 34/100 [09:41<16:18, 14.83s/it]epoch [34/100], focal_loss:0.0090	, anomaly_loss:0.2594	fnorm_loss:0.0089, a_fnorm_loss:0.0485P:0.45, R:0.94
 35%|███▌      | 35/100 [10:13<21:34, 19.91s/it]epoch [35/100], focal_loss:0.0119	, anomaly_loss:0.2865	fnorm_loss:0.0090, a_fnorm_loss:0.0456P:0.48, R:0.88
normal: 0.0340 0.1994  anomaly: 0.0346 0.6509	P:0.15, R:0.10
Pixel Auroc:0.949, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0208
 36%|███▌      | 36/100 [10:27<19:07, 17.93s/it]epoch [36/100], focal_loss:0.0087	, anomaly_loss:0.2616	fnorm_loss:0.0086, a_fnorm_loss:0.0480P:0.46, R:0.94
 37%|███▋      | 37/100 [10:39<17:04, 16.26s/it]epoch [37/100], focal_loss:0.0090	, anomaly_loss:0.2617	fnorm_loss:0.0086, a_fnorm_loss:0.0476P:0.42, R:0.93
 38%|███▊      | 38/100 [10:53<15:59, 15.48s/it]epoch [38/100], focal_loss:0.0082	, anomaly_loss:0.2626	fnorm_loss:0.0084, a_fnorm_loss:0.0480P:0.45, R:0.92
 39%|███▉      | 39/100 [11:06<14:58, 14.73s/it]epoch [39/100], focal_loss:0.0084	, anomaly_loss:0.2530	fnorm_loss:0.0083, a_fnorm_loss:0.0493P:0.43, R:0.90
 40%|████      | 40/100 [11:38<19:54, 19.91s/it]epoch [40/100], focal_loss:0.0111	, anomaly_loss:0.2767	fnorm_loss:0.0086, a_fnorm_loss:0.0463P:0.46, R:0.89
normal: 0.0428 0.2282  anomaly: 0.0497 0.6951	P:0.18, R:0.12
Pixel Auroc:0.948, Sample Auroc0.871, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0216
 41%|████      | 41/100 [11:51<17:34, 17.88s/it]epoch [41/100], focal_loss:0.0084	, anomaly_loss:0.2809	fnorm_loss:0.0082, a_fnorm_loss:0.0465P:0.42, R:0.89
 42%|████▏     | 42/100 [12:03<15:45, 16.31s/it]epoch [42/100], focal_loss:0.0108	, anomaly_loss:0.2671	fnorm_loss:0.0085, a_fnorm_loss:0.0463P:0.46, R:0.91
 43%|████▎     | 43/100 [12:17<14:45, 15.53s/it]epoch [43/100], focal_loss:0.0084	, anomaly_loss:0.2391	fnorm_loss:0.0081, a_fnorm_loss:0.0490P:0.45, R:0.90
 44%|████▍     | 44/100 [12:30<13:49, 14.81s/it]epoch [44/100], focal_loss:0.0089	, anomaly_loss:0.2601	fnorm_loss:0.0081, a_fnorm_loss:0.0475P:0.44, R:0.92
 45%|████▌     | 45/100 [13:01<17:56, 19.56s/it]epoch [45/100], focal_loss:0.0090	, anomaly_loss:0.2571	fnorm_loss:0.0080, a_fnorm_loss:0.0472P:0.46, R:0.92
normal: 0.0667 0.3135  anomaly: 0.0740 0.7319	P:0.16, R:0.13
Pixel Auroc:0.951, Sample Auroc0.849, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0273
 46%|████▌     | 46/100 [13:14<15:48, 17.57s/it]epoch [46/100], focal_loss:0.0081	, anomaly_loss:0.2590	fnorm_loss:0.0078, a_fnorm_loss:0.0485P:0.47, R:0.93
 47%|████▋     | 47/100 [13:27<14:17, 16.19s/it]epoch [47/100], focal_loss:0.0111	, anomaly_loss:0.2786	fnorm_loss:0.0081, a_fnorm_loss:0.0464P:0.45, R:0.89
 48%|████▊     | 48/100 [13:39<13:03, 15.08s/it]epoch [48/100], focal_loss:0.0088	, anomaly_loss:0.2528	fnorm_loss:0.0078, a_fnorm_loss:0.0485P:0.43, R:0.93
 49%|████▉     | 49/100 [13:52<12:14, 14.41s/it]epoch [49/100], focal_loss:0.0086	, anomaly_loss:0.2538	fnorm_loss:0.0077, a_fnorm_loss:0.0480P:0.47, R:0.90
 50%|█████     | 50/100 [14:22<15:56, 19.13s/it]epoch [50/100], focal_loss:0.0073	, anomaly_loss:0.2406	fnorm_loss:0.0074, a_fnorm_loss:0.0502P:0.47, R:0.91
normal: 0.0308 0.1900  anomaly: 0.0310 0.6894	P:0.16, R:0.09
Pixel Auroc:0.954, Sample Auroc0.841, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0199
 51%|█████     | 51/100 [14:35<13:58, 17.12s/it]epoch [51/100], focal_loss:0.0079	, anomaly_loss:0.2599	fnorm_loss:0.0075, a_fnorm_loss:0.0509P:0.46, R:0.94
 52%|█████▏    | 52/100 [14:48<12:47, 16.00s/it]epoch [52/100], focal_loss:0.0081	, anomaly_loss:0.2536	fnorm_loss:0.0075, a_fnorm_loss:0.0494P:0.49, R:0.92
 53%|█████▎    | 53/100 [15:02<11:59, 15.31s/it]epoch [53/100], focal_loss:0.0084	, anomaly_loss:0.2543	fnorm_loss:0.0075, a_fnorm_loss:0.0485P:0.49, R:0.93
 54%|█████▍    | 54/100 [15:16<11:30, 15.01s/it]epoch [54/100], focal_loss:0.0081	, anomaly_loss:0.2523	fnorm_loss:0.0074, a_fnorm_loss:0.0496P:0.47, R:0.94
 55%|█████▌    | 55/100 [15:47<14:45, 19.69s/it]epoch [55/100], focal_loss:0.0078	, anomaly_loss:0.2474	fnorm_loss:0.0073, a_fnorm_loss:0.0485P:0.47, R:0.93
normal: 0.0306 0.1424  anomaly: 0.0347 0.7008	P:0.17, R:0.09
Pixel Auroc:0.952, Sample Auroc0.876, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0223
 56%|█████▌    | 56/100 [16:00<12:59, 17.71s/it]epoch [56/100], focal_loss:0.0082	, anomaly_loss:0.2424	fnorm_loss:0.0074, a_fnorm_loss:0.0496P:0.47, R:0.90
 57%|█████▋    | 57/100 [16:13<11:45, 16.40s/it]epoch [57/100], focal_loss:0.0083	, anomaly_loss:0.2460	fnorm_loss:0.0074, a_fnorm_loss:0.0488P:0.51, R:0.93
 58%|█████▊    | 58/100 [16:26<10:43, 15.33s/it]epoch [58/100], focal_loss:0.0085	, anomaly_loss:0.2598	fnorm_loss:0.0073, a_fnorm_loss:0.0475P:0.51, R:0.92
 59%|█████▉    | 59/100 [16:39<09:59, 14.61s/it]epoch [59/100], focal_loss:0.0084	, anomaly_loss:0.2438	fnorm_loss:0.0073, a_fnorm_loss:0.0486P:0.46, R:0.90
 60%|██████    | 60/100 [17:11<13:12, 19.82s/it]epoch [60/100], focal_loss:0.0080	, anomaly_loss:0.2430	fnorm_loss:0.0071, a_fnorm_loss:0.0506P:0.48, R:0.94
normal: 0.3428 0.6697  anomaly: 0.3401 0.8070	P:0.15, R:0.23
Pixel Auroc:0.944, Sample Auroc0.772, Pixel Aupro0.0
test_fnorm_loss: 0.0110 test_afnorm_loss: 0.0453
 61%|██████    | 61/100 [17:24<11:38, 17.92s/it]epoch [61/100], focal_loss:0.0113	, anomaly_loss:0.2872	fnorm_loss:0.0078, a_fnorm_loss:0.0445P:0.50, R:0.85
 62%|██████▏   | 62/100 [17:38<10:30, 16.59s/it]epoch [62/100], focal_loss:0.0125	, anomaly_loss:0.2811	fnorm_loss:0.0081, a_fnorm_loss:0.0440P:0.41, R:0.90
 63%|██████▎   | 63/100 [17:51<09:35, 15.56s/it]epoch [63/100], focal_loss:0.0085	, anomaly_loss:0.2501	fnorm_loss:0.0074, a_fnorm_loss:0.0483P:0.47, R:0.93
 64%|██████▍   | 64/100 [18:04<08:54, 14.84s/it]epoch [64/100], focal_loss:0.0073	, anomaly_loss:0.2498	fnorm_loss:0.0071, a_fnorm_loss:0.0489P:0.44, R:0.93
 65%|██████▌   | 65/100 [18:35<11:24, 19.55s/it]epoch [65/100], focal_loss:0.0072	, anomaly_loss:0.2462	fnorm_loss:0.0070, a_fnorm_loss:0.0493P:0.45, R:0.94
normal: 0.2138 0.4349  anomaly: 0.2000 0.7696	P:0.14, R:0.17
Pixel Auroc:0.945, Sample Auroc0.828, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0300
 66%|██████▌   | 66/100 [18:47<09:54, 17.48s/it]epoch [66/100], focal_loss:0.0091	, anomaly_loss:0.2659	fnorm_loss:0.0072, a_fnorm_loss:0.0474P:0.47, R:0.90
 67%|██████▋   | 67/100 [19:01<08:54, 16.21s/it]epoch [67/100], focal_loss:0.0086	, anomaly_loss:0.2506	fnorm_loss:0.0072, a_fnorm_loss:0.0484P:0.44, R:0.93
 68%|██████▊   | 68/100 [19:14<08:14, 15.46s/it]epoch [68/100], focal_loss:0.0084	, anomaly_loss:0.2597	fnorm_loss:0.0072, a_fnorm_loss:0.0479P:0.49, R:0.91
 69%|██████▉   | 69/100 [19:27<07:38, 14.79s/it]epoch [69/100], focal_loss:0.0078	, anomaly_loss:0.2514	fnorm_loss:0.0072, a_fnorm_loss:0.0491P:0.49, R:0.94
 70%|███████   | 70/100 [19:58<09:42, 19.40s/it]epoch [70/100], focal_loss:0.0095	, anomaly_loss:0.2554	fnorm_loss:0.0074, a_fnorm_loss:0.0473P:0.44, R:0.93
normal: 0.0294 0.1067  anomaly: 0.0277 0.6814	P:0.15, R:0.07
Pixel Auroc:0.956, Sample Auroc0.874, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0170
 71%|███████   | 71/100 [20:11<08:30, 17.60s/it]epoch [71/100], focal_loss:0.0077	, anomaly_loss:0.2556	fnorm_loss:0.0070, a_fnorm_loss:0.0492P:0.47, R:0.93
 72%|███████▏  | 72/100 [20:24<07:35, 16.28s/it]epoch [72/100], focal_loss:0.0069	, anomaly_loss:0.2423	fnorm_loss:0.0069, a_fnorm_loss:0.0500P:0.52, R:0.95
 73%|███████▎  | 73/100 [20:37<06:51, 15.25s/it]epoch [73/100], focal_loss:0.0085	, anomaly_loss:0.2545	fnorm_loss:0.0071, a_fnorm_loss:0.0494P:0.48, R:0.93
 74%|███████▍  | 74/100 [20:50<06:17, 14.52s/it]epoch [74/100], focal_loss:0.0081	, anomaly_loss:0.2529	fnorm_loss:0.0070, a_fnorm_loss:0.0497P:0.46, R:0.93
 75%|███████▌  | 75/100 [21:21<08:07, 19.48s/it]epoch [75/100], focal_loss:0.0079	, anomaly_loss:0.2413	fnorm_loss:0.0069, a_fnorm_loss:0.0490P:0.40, R:0.90
normal: 0.0278 0.1375  anomaly: 0.0265 0.7057	P:0.15, R:0.08
Pixel Auroc:0.953, Sample Auroc0.881, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0177
 76%|███████▌  | 76/100 [21:34<06:58, 17.42s/it]epoch [76/100], focal_loss:0.0098	, anomaly_loss:0.2617	fnorm_loss:0.0072, a_fnorm_loss:0.0472P:0.47, R:0.91
 77%|███████▋  | 77/100 [21:47<06:12, 16.18s/it]epoch [77/100], focal_loss:0.0080	, anomaly_loss:0.2603	fnorm_loss:0.0070, a_fnorm_loss:0.0493P:0.50, R:0.94
 78%|███████▊  | 78/100 [22:00<05:36, 15.31s/it]epoch [78/100], focal_loss:0.0076	, anomaly_loss:0.2423	fnorm_loss:0.0069, a_fnorm_loss:0.0508P:0.48, R:0.95
 79%|███████▉  | 79/100 [22:13<05:07, 14.64s/it]epoch [79/100], focal_loss:0.0087	, anomaly_loss:0.2485	fnorm_loss:0.0070, a_fnorm_loss:0.0492P:0.48, R:0.93
 80%|████████  | 80/100 [22:43<06:24, 19.24s/it]epoch [80/100], focal_loss:0.0076	, anomaly_loss:0.2527	fnorm_loss:0.0069, a_fnorm_loss:0.0490P:0.49, R:0.93
normal: 0.0387 0.1578  anomaly: 0.0402 0.7133	P:0.17, R:0.10
Pixel Auroc:0.953, Sample Auroc0.894, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0206
 81%|████████  | 81/100 [22:56<05:31, 17.45s/it]epoch [81/100], focal_loss:0.0076	, anomaly_loss:0.2459	fnorm_loss:0.0070, a_fnorm_loss:0.0495P:0.50, R:0.94
 82%|████████▏ | 82/100 [23:10<04:55, 16.40s/it]epoch [82/100], focal_loss:0.0067	, anomaly_loss:0.2489	fnorm_loss:0.0068, a_fnorm_loss:0.0510P:0.49, R:0.95
 83%|████████▎ | 83/100 [23:23<04:20, 15.33s/it]epoch [83/100], focal_loss:0.0079	, anomaly_loss:0.2603	fnorm_loss:0.0069, a_fnorm_loss:0.0502P:0.45, R:0.92
 84%|████████▍ | 84/100 [23:36<03:54, 14.64s/it]epoch [84/100], focal_loss:0.0069	, anomaly_loss:0.2463	fnorm_loss:0.0069, a_fnorm_loss:0.0494P:0.46, R:0.94
 85%|████████▌ | 85/100 [24:09<05:01, 20.07s/it]epoch [85/100], focal_loss:0.0071	, anomaly_loss:0.2367	fnorm_loss:0.0069, a_fnorm_loss:0.0509P:0.47, R:0.96
normal: 0.0419 0.2372  anomaly: 0.0374 0.7566	P:0.17, R:0.12
Pixel Auroc:0.958, Sample Auroc0.857, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0266
 86%|████████▌ | 86/100 [24:22<04:12, 18.06s/it]epoch [86/100], focal_loss:0.0079	, anomaly_loss:0.2499	fnorm_loss:0.0069, a_fnorm_loss:0.0499P:0.49, R:0.94
 87%|████████▋ | 87/100 [24:36<03:36, 16.63s/it]epoch [87/100], focal_loss:0.0078	, anomaly_loss:0.2496	fnorm_loss:0.0069, a_fnorm_loss:0.0498P:0.47, R:0.94
 88%|████████▊ | 88/100 [24:50<03:10, 15.91s/it]epoch [88/100], focal_loss:0.0072	, anomaly_loss:0.2514	fnorm_loss:0.0068, a_fnorm_loss:0.0511P:0.47, R:0.94
 89%|████████▉ | 89/100 [25:03<02:46, 15.17s/it]epoch [89/100], focal_loss:0.0078	, anomaly_loss:0.2403	fnorm_loss:0.0069, a_fnorm_loss:0.0501P:0.50, R:0.95
 90%|█████████ | 90/100 [25:36<03:24, 20.43s/it]epoch [90/100], focal_loss:0.0073	, anomaly_loss:0.2516	fnorm_loss:0.0068, a_fnorm_loss:0.0501P:0.48, R:0.93
normal: 0.0532 0.2441  anomaly: 0.0470 0.7517	P:0.17, R:0.12
Pixel Auroc:0.958, Sample Auroc0.862, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0249
 91%|█████████ | 91/100 [25:51<02:47, 18.66s/it]epoch [91/100], focal_loss:0.0071	, anomaly_loss:0.2498	fnorm_loss:0.0068, a_fnorm_loss:0.0500P:0.49, R:0.93
 92%|█████████▏| 92/100 [26:03<02:14, 16.87s/it]epoch [92/100], focal_loss:0.0065	, anomaly_loss:0.2395	fnorm_loss:0.0068, a_fnorm_loss:0.0528P:0.43, R:0.97
 93%|█████████▎| 93/100 [26:16<01:49, 15.62s/it]epoch [93/100], focal_loss:0.0063	, anomaly_loss:0.2417	fnorm_loss:0.0067, a_fnorm_loss:0.0498P:0.48, R:0.94
 94%|█████████▍| 94/100 [26:29<01:28, 14.83s/it]epoch [94/100], focal_loss:0.0072	, anomaly_loss:0.2455	fnorm_loss:0.0068, a_fnorm_loss:0.0502P:0.47, R:0.95
 95%|█████████▌| 95/100 [27:00<01:38, 19.71s/it]epoch [95/100], focal_loss:0.0064	, anomaly_loss:0.2337	fnorm_loss:0.0067, a_fnorm_loss:0.0507P:0.50, R:0.92
normal: 0.0554 0.3171  anomaly: 0.0506 0.7757	P:0.18, R:0.14
Pixel Auroc:0.959, Sample Auroc0.863, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0285
 96%|█████████▌| 96/100 [27:13<01:10, 17.61s/it]epoch [96/100], focal_loss:0.0073	, anomaly_loss:0.2410	fnorm_loss:0.0068, a_fnorm_loss:0.0510P:0.47, R:0.95
 97%|█████████▋| 97/100 [27:26<00:49, 16.35s/it]epoch [97/100], focal_loss:0.0075	, anomaly_loss:0.2458	fnorm_loss:0.0069, a_fnorm_loss:0.0513P:0.47, R:0.95
 98%|█████████▊| 98/100 [27:40<00:30, 15.44s/it]epoch [98/100], focal_loss:0.0073	, anomaly_loss:0.2385	fnorm_loss:0.0068, a_fnorm_loss:0.0505P:0.48, R:0.96
 99%|█████████▉| 99/100 [27:52<00:14, 14.70s/it]epoch [99/100], focal_loss:0.0066	, anomaly_loss:0.2351	fnorm_loss:0.0067, a_fnorm_loss:0.0502P:0.48, R:0.92
100%|██████████| 100/100 [28:24<00:00, 19.64s/it]100%|██████████| 100/100 [28:24<00:00, 17.04s/it]
epoch [100/100], focal_loss:0.0074	, anomaly_loss:0.2468	fnorm_loss:0.0068, a_fnorm_loss:0.0501P:0.51, R:0.95
normal: 0.0497 0.2611  anomaly: 0.0463 0.7552	P:0.17, R:0.12
Pixel Auroc:0.959, Sample Auroc0.863, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0253
training Stubborn Student...
fryum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:08<17:11,  8.67s/it]epoch [1/120], kd_loss:4.4141
  2%|▏         | 2/120 [00:17<16:57,  8.62s/it]epoch [2/120], kd_loss:3.6698
  2%|▎         | 3/120 [00:25<16:49,  8.63s/it]epoch [3/120], kd_loss:3.3913
  3%|▎         | 4/120 [00:34<16:46,  8.68s/it]epoch [4/120], kd_loss:2.8540
  4%|▍         | 5/120 [00:43<16:41,  8.71s/it]epoch [5/120], kd_loss:2.3582
  5%|▌         | 6/120 [00:52<16:38,  8.76s/it]epoch [6/120], kd_loss:2.1135
  6%|▌         | 7/120 [01:01<16:32,  8.79s/it]epoch [7/120], kd_loss:2.2072
  7%|▋         | 8/120 [01:09<16:22,  8.77s/it]epoch [8/120], kd_loss:1.8569
  8%|▊         | 9/120 [01:18<16:16,  8.80s/it]epoch [9/120], kd_loss:2.7698
  8%|▊         | 10/120 [01:45<26:17, 14.34s/it]epoch [10/120], kd_loss:2.3279
normal: 1.4261 1.6486  anomaly: 1.4490 2.3536
thresh: 1.518029196433043
fpr: 0.28 fnr 0.08
Pixel Auroc:0.941, Sample Auroc0.918, Pixel Aupro0.0
  9%|▉         | 11/120 [01:54<22:52, 12.60s/it]epoch [11/120], kd_loss:2.1997
 10%|█         | 12/120 [02:02<20:31, 11.40s/it]epoch [12/120], kd_loss:1.9182
 11%|█         | 13/120 [02:11<18:54, 10.61s/it]epoch [13/120], kd_loss:1.9843
 12%|█▏        | 14/120 [02:20<17:45, 10.05s/it]epoch [14/120], kd_loss:1.8743
 12%|█▎        | 15/120 [02:29<16:54,  9.66s/it]epoch [15/120], kd_loss:1.8188
 13%|█▎        | 16/120 [02:37<16:15,  9.38s/it]epoch [16/120], kd_loss:1.9943
 14%|█▍        | 17/120 [02:46<15:48,  9.21s/it]epoch [17/120], kd_loss:1.7803
 15%|█▌        | 18/120 [02:55<15:26,  9.08s/it]epoch [18/120], kd_loss:1.7433
 16%|█▌        | 19/120 [03:04<15:10,  9.01s/it]epoch [19/120], kd_loss:1.7244
 17%|█▋        | 20/120 [03:31<24:06, 14.47s/it]epoch [20/120], kd_loss:1.6993
normal: 1.1811 1.5276  anomaly: 1.1766 2.4754
thresh: 1.3014452863117334
fpr: 0.5 fnr 0.07
Pixel Auroc:0.956, Sample Auroc0.883, Pixel Aupro0.0
 18%|█▊        | 21/120 [03:40<20:59, 12.72s/it]epoch [21/120], kd_loss:1.7036
 18%|█▊        | 22/120 [03:48<18:51, 11.54s/it]epoch [22/120], kd_loss:1.6651
 19%|█▉        | 23/120 [03:57<17:21, 10.74s/it]epoch [23/120], kd_loss:1.6996
 20%|██        | 24/120 [04:06<16:12, 10.13s/it]epoch [24/120], kd_loss:1.9788
 21%|██        | 25/120 [04:15<15:25,  9.74s/it]epoch [25/120], kd_loss:1.6603
 22%|██▏       | 26/120 [04:24<14:47,  9.44s/it]epoch [26/120], kd_loss:1.6009
 22%|██▎       | 27/120 [04:32<14:20,  9.25s/it]epoch [27/120], kd_loss:1.5196
 23%|██▎       | 28/120 [04:41<14:01,  9.15s/it]epoch [28/120], kd_loss:1.5746
 24%|██▍       | 29/120 [04:50<13:43,  9.05s/it]epoch [29/120], kd_loss:1.4900
 25%|██▌       | 30/120 [05:18<22:06, 14.74s/it]epoch [30/120], kd_loss:1.5069
normal: 1.0282 1.3631  anomaly: 1.0958 2.3202
thresh: 1.1798101229269586
fpr: 0.28 fnr 0.09
Pixel Auroc:0.963, Sample Auroc0.927, Pixel Aupro0.0
 26%|██▌       | 31/120 [05:27<19:12, 12.95s/it]epoch [31/120], kd_loss:1.4491
 27%|██▋       | 32/120 [05:36<17:08, 11.69s/it]epoch [32/120], kd_loss:1.5125
 28%|██▊       | 33/120 [05:44<15:39, 10.80s/it]epoch [33/120], kd_loss:1.4324
 28%|██▊       | 34/120 [05:53<14:37, 10.21s/it]epoch [34/120], kd_loss:1.4663
 29%|██▉       | 35/120 [06:02<13:51,  9.78s/it]epoch [35/120], kd_loss:2.0317
 30%|███       | 36/120 [06:11<13:17,  9.50s/it]epoch [36/120], kd_loss:1.6962
 31%|███       | 37/120 [06:20<12:53,  9.31s/it]epoch [37/120], kd_loss:1.8126
 32%|███▏      | 38/120 [06:29<12:36,  9.22s/it]epoch [38/120], kd_loss:1.5390
 32%|███▎      | 39/120 [06:37<12:16,  9.09s/it]epoch [39/120], kd_loss:1.4706
 33%|███▎      | 40/120 [07:04<19:00, 14.25s/it]epoch [40/120], kd_loss:1.5047
normal: 1.2206 1.5783  anomaly: 1.2523 2.3815
thresh: 1.4504494405125206
fpr: 0.24 fnr 0.19
Pixel Auroc:0.954, Sample Auroc0.855, Pixel Aupro0.0
 34%|███▍      | 41/120 [07:13<16:37, 12.63s/it]epoch [41/120], kd_loss:1.4617
 35%|███▌      | 42/120 [07:21<14:55, 11.48s/it]epoch [42/120], kd_loss:1.4551
 36%|███▌      | 43/120 [07:30<13:40, 10.65s/it]epoch [43/120], kd_loss:1.3948
 37%|███▋      | 44/120 [07:39<12:47, 10.10s/it]epoch [44/120], kd_loss:1.3903
 38%|███▊      | 45/120 [07:48<12:07,  9.69s/it]epoch [45/120], kd_loss:1.4204
 38%|███▊      | 46/120 [07:56<11:36,  9.41s/it]epoch [46/120], kd_loss:1.3747
 39%|███▉      | 47/120 [08:05<11:13,  9.23s/it]epoch [47/120], kd_loss:1.4998
 40%|████      | 48/120 [08:14<10:54,  9.09s/it]epoch [48/120], kd_loss:1.3661
 41%|████      | 49/120 [08:23<10:39,  9.00s/it]epoch [49/120], kd_loss:1.6662
 42%|████▏     | 50/120 [08:50<17:02, 14.60s/it]epoch [50/120], kd_loss:1.5665
normal: 0.9382 1.2089  anomaly: 0.9908 2.3704
thresh: 1.1069262507736632
fpr: 0.2 fnr 0.1
Pixel Auroc:0.965, Sample Auroc0.943, Pixel Aupro0.0
 42%|████▎     | 51/120 [08:59<14:47, 12.87s/it]epoch [51/120], kd_loss:1.4571
 43%|████▎     | 52/120 [09:08<13:11, 11.64s/it]epoch [52/120], kd_loss:1.4529
 44%|████▍     | 53/120 [09:17<12:00, 10.76s/it]epoch [53/120], kd_loss:1.4436
 45%|████▌     | 54/120 [09:25<11:09, 10.15s/it]epoch [54/120], kd_loss:1.4002
 46%|████▌     | 55/120 [09:34<10:31,  9.72s/it]epoch [55/120], kd_loss:1.8222
 47%|████▋     | 56/120 [09:43<10:03,  9.44s/it]epoch [56/120], kd_loss:1.7722
 48%|████▊     | 57/120 [09:52<09:42,  9.24s/it]epoch [57/120], kd_loss:1.5952
 48%|████▊     | 58/120 [10:01<09:25,  9.11s/it]epoch [58/120], kd_loss:1.5559
 49%|████▉     | 59/120 [10:09<09:08,  8.99s/it]epoch [59/120], kd_loss:1.4423
 50%|█████     | 60/120 [10:34<13:44, 13.75s/it]epoch [60/120], kd_loss:1.4245
normal: 0.8821 1.1635  anomaly: 0.9716 2.2891
thresh: 1.0055447069358743
fpr: 0.42 fnr 0.01
Pixel Auroc:0.962, Sample Auroc0.937, Pixel Aupro0.0
 51%|█████     | 61/120 [10:43<12:00, 12.22s/it]epoch [61/120], kd_loss:1.4523
 52%|█████▏    | 62/120 [10:51<10:46, 11.14s/it]epoch [62/120], kd_loss:1.4275
 52%|█████▎    | 63/120 [11:00<09:52, 10.40s/it]epoch [63/120], kd_loss:1.3913
 53%|█████▎    | 64/120 [11:09<09:13,  9.89s/it]epoch [64/120], kd_loss:1.4020
 54%|█████▍    | 65/120 [11:17<08:44,  9.53s/it]epoch [65/120], kd_loss:1.3943
 55%|█████▌    | 66/120 [11:26<08:21,  9.29s/it]epoch [66/120], kd_loss:1.3672
 56%|█████▌    | 67/120 [11:35<08:05,  9.16s/it]epoch [67/120], kd_loss:1.3647
 57%|█████▋    | 68/120 [11:44<07:47,  9.00s/it]epoch [68/120], kd_loss:1.3535
 57%|█████▊    | 69/120 [11:52<07:34,  8.91s/it]epoch [69/120], kd_loss:1.3678
 58%|█████▊    | 70/120 [12:18<11:42, 14.05s/it]epoch [70/120], kd_loss:1.3759
normal: 0.8387 1.1671  anomaly: 0.9056 2.3224
thresh: 0.9941358588198221
fpr: 0.24 fnr 0.07
Pixel Auroc:0.965, Sample Auroc0.944, Pixel Aupro0.0
 59%|█████▉    | 71/120 [12:27<10:10, 12.46s/it]epoch [71/120], kd_loss:1.3387
 60%|██████    | 72/120 [12:36<09:02, 11.30s/it]epoch [72/120], kd_loss:1.4182
 61%|██████    | 73/120 [12:44<08:13, 10.50s/it]epoch [73/120], kd_loss:1.3895
 62%|██████▏   | 74/120 [12:53<07:37,  9.95s/it]epoch [74/120], kd_loss:1.3338
 62%|██████▎   | 75/120 [13:02<07:10,  9.57s/it]epoch [75/120], kd_loss:1.3696
 63%|██████▎   | 76/120 [13:10<06:49,  9.30s/it]epoch [76/120], kd_loss:1.3226
 64%|██████▍   | 77/120 [13:19<06:31,  9.11s/it]epoch [77/120], kd_loss:1.3267
 65%|██████▌   | 78/120 [13:28<06:17,  8.98s/it]epoch [78/120], kd_loss:1.3577
 66%|██████▌   | 79/120 [13:36<06:04,  8.89s/it]epoch [79/120], kd_loss:1.4897
 67%|██████▋   | 80/120 [14:03<09:25, 14.13s/it]epoch [80/120], kd_loss:1.5580
normal: 0.8722 1.2154  anomaly: 0.9179 2.3212
thresh: 1.027302247231582
fpr: 0.18 fnr 0.08
Pixel Auroc:0.961, Sample Auroc0.947, Pixel Aupro0.0
 68%|██████▊   | 81/120 [14:11<08:07, 12.49s/it]epoch [81/120], kd_loss:1.3831
 68%|██████▊   | 82/120 [14:20<07:10, 11.33s/it]epoch [82/120], kd_loss:1.3795
 69%|██████▉   | 83/120 [14:29<06:30, 10.54s/it]epoch [83/120], kd_loss:1.3824
 70%|███████   | 84/120 [14:37<05:59,  9.98s/it]epoch [84/120], kd_loss:1.3606
 71%|███████   | 85/120 [14:46<05:36,  9.62s/it]epoch [85/120], kd_loss:1.3249
 72%|███████▏  | 86/120 [14:55<05:17,  9.33s/it]epoch [86/120], kd_loss:1.3267
 72%|███████▎  | 87/120 [15:04<05:01,  9.13s/it]epoch [87/120], kd_loss:1.3211
 73%|███████▎  | 88/120 [15:12<04:47,  9.00s/it]epoch [88/120], kd_loss:1.3118
 74%|███████▍  | 89/120 [15:21<04:37,  8.96s/it]epoch [89/120], kd_loss:1.2976
 75%|███████▌  | 90/120 [15:46<06:48, 13.60s/it]epoch [90/120], kd_loss:1.2884
normal: 0.8153 1.2288  anomaly: 0.8629 2.3747
thresh: 0.9725177465101567
fpr: 0.18 fnr 0.1
Pixel Auroc:0.967, Sample Auroc0.932, Pixel Aupro0.0
 76%|███████▌  | 91/120 [15:54<05:51, 12.10s/it]epoch [91/120], kd_loss:1.2884
 77%|███████▋  | 92/120 [16:03<05:09, 11.04s/it]epoch [92/120], kd_loss:1.2941
 78%|███████▊  | 93/120 [16:11<04:38, 10.33s/it]epoch [93/120], kd_loss:1.3059
 78%|███████▊  | 94/120 [16:20<04:16,  9.85s/it]epoch [94/120], kd_loss:1.2857
 79%|███████▉  | 95/120 [16:29<03:57,  9.49s/it]epoch [95/120], kd_loss:1.2800
 80%|████████  | 96/120 [16:37<03:42,  9.26s/it]epoch [96/120], kd_loss:1.2770
 81%|████████  | 97/120 [16:46<03:28,  9.08s/it]epoch [97/120], kd_loss:1.2652
 82%|████████▏ | 98/120 [16:55<03:17,  8.97s/it]epoch [98/120], kd_loss:1.2635
 82%|████████▎ | 99/120 [17:04<03:06,  8.90s/it]epoch [99/120], kd_loss:1.2616
 83%|████████▎ | 100/120 [17:28<04:33, 13.66s/it]epoch [100/120], kd_loss:1.2582
normal: 0.7821 1.1961  anomaly: 0.8468 2.4308
thresh: 0.9413050768933784
fpr: 0.26 fnr 0.09
Pixel Auroc:0.968, Sample Auroc0.925, Pixel Aupro0.0
 84%|████████▍ | 101/120 [17:37<03:51, 12.17s/it]epoch [101/120], kd_loss:1.2564
 85%|████████▌ | 102/120 [17:46<03:19, 11.10s/it]epoch [102/120], kd_loss:1.2539
 86%|████████▌ | 103/120 [17:54<02:56, 10.36s/it]epoch [103/120], kd_loss:1.2555
 87%|████████▋ | 104/120 [18:03<02:37,  9.85s/it]epoch [104/120], kd_loss:1.2569
 88%|████████▊ | 105/120 [18:12<02:22,  9.52s/it]epoch [105/120], kd_loss:1.2544
 88%|████████▊ | 106/120 [18:20<02:09,  9.28s/it]epoch [106/120], kd_loss:1.2544
 89%|████████▉ | 107/120 [18:29<01:58,  9.10s/it]epoch [107/120], kd_loss:1.2521
 90%|█████████ | 108/120 [18:38<01:47,  8.99s/it]epoch [108/120], kd_loss:1.2556
 91%|█████████ | 109/120 [18:47<01:37,  8.90s/it]epoch [109/120], kd_loss:1.2528
 92%|█████████▏| 110/120 [19:11<02:17, 13.72s/it]epoch [110/120], kd_loss:1.2525
normal: 0.7777 1.1996  anomaly: 0.8423 2.4233
thresh: 0.9793532904145381
fpr: 0.1 fnr 0.14
Pixel Auroc:0.968, Sample Auroc0.926, Pixel Aupro0.0
 92%|█████████▎| 111/120 [19:20<01:49, 12.19s/it]epoch [111/120], kd_loss:1.2506
 93%|█████████▎| 112/120 [19:29<01:29, 11.18s/it]epoch [112/120], kd_loss:1.2506
 94%|█████████▍| 113/120 [19:38<01:13, 10.44s/it]epoch [113/120], kd_loss:1.2505
 95%|█████████▌| 114/120 [19:46<00:59,  9.91s/it]epoch [114/120], kd_loss:1.2498
 96%|█████████▌| 115/120 [19:55<00:47,  9.54s/it]epoch [115/120], kd_loss:1.2502
 97%|█████████▋| 116/120 [20:04<00:37,  9.27s/it]epoch [116/120], kd_loss:1.2492
 98%|█████████▊| 117/120 [20:12<00:27,  9.10s/it]epoch [117/120], kd_loss:1.2479
 98%|█████████▊| 118/120 [20:21<00:17,  8.98s/it]epoch [118/120], kd_loss:1.2487
 99%|█████████▉| 119/120 [20:30<00:08,  8.90s/it]epoch [119/120], kd_loss:1.2498
100%|██████████| 120/120 [20:55<00:00, 13.76s/it]100%|██████████| 120/120 [20:55<00:00, 10.46s/it]
epoch [120/120], kd_loss:1.2477
normal: 0.7788 1.1732  anomaly: 0.8611 2.4279
thresh: 0.9761335068223774
fpr: 0.12 fnr 0.14
Pixel Auroc:0.968, Sample Auroc0.925, Pixel Aupro0.0
training Advanced Teacher...
macaroni1
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:49<1:20:51, 49.01s/it]epoch [1/100], focal_loss:0.0579	, anomaly_loss:0.5469	fnorm_loss:0.0626, a_fnorm_loss:0.0126P:0.00, R:0.00
normal: 0.1899 0.1942  anomaly: 0.1902 0.1944	P:0.00, R:0.00
Pixel Auroc:0.908, Sample Auroc0.544, Pixel Aupro0.0
test_fnorm_loss: 0.0521 test_afnorm_loss: 0.0120
  2%|▏         | 2/100 [01:11<54:58, 33.66s/it]  epoch [2/100], focal_loss:0.0354	, anomaly_loss:0.6004	fnorm_loss:0.0445, a_fnorm_loss:0.0090P:0.00, R:0.00
  3%|▎         | 3/100 [01:35<46:55, 29.02s/it]epoch [3/100], focal_loss:0.0294	, anomaly_loss:0.5707	fnorm_loss:0.0366, a_fnorm_loss:0.0160P:0.03, R:0.13
  4%|▍         | 4/100 [01:58<42:59, 26.87s/it]epoch [4/100], focal_loss:0.0236	, anomaly_loss:0.4868	fnorm_loss:0.0279, a_fnorm_loss:0.0337P:0.10, R:0.31
  5%|▌         | 5/100 [02:45<53:33, 33.83s/it]epoch [5/100], focal_loss:0.0215	, anomaly_loss:0.4860	fnorm_loss:0.0234, a_fnorm_loss:0.0348P:0.10, R:0.32
normal: 0.0966 0.1689  anomaly: 0.0969 0.2745	P:0.00, R:0.00
Pixel Auroc:0.960, Sample Auroc0.791, Pixel Aupro0.0
test_fnorm_loss: 0.0220 test_afnorm_loss: 0.0238
  6%|▌         | 6/100 [03:08<47:34, 30.37s/it]epoch [6/100], focal_loss:0.0201	, anomaly_loss:0.4706	fnorm_loss:0.0215, a_fnorm_loss:0.0361P:0.12, R:0.34
  7%|▋         | 7/100 [03:31<43:13, 27.89s/it]epoch [7/100], focal_loss:0.0170	, anomaly_loss:0.4095	fnorm_loss:0.0194, a_fnorm_loss:0.0405P:0.21, R:0.55
  8%|▊         | 8/100 [03:54<40:25, 26.36s/it]epoch [8/100], focal_loss:0.0147	, anomaly_loss:0.3763	fnorm_loss:0.0181, a_fnorm_loss:0.0417P:0.24, R:0.65
  9%|▉         | 9/100 [04:17<38:17, 25.25s/it]epoch [9/100], focal_loss:0.0135	, anomaly_loss:0.3539	fnorm_loss:0.0174, a_fnorm_loss:0.0423P:0.26, R:0.70
 10%|█         | 10/100 [05:05<48:34, 32.39s/it]epoch [10/100], focal_loss:0.0106	, anomaly_loss:0.2688	fnorm_loss:0.0141, a_fnorm_loss:0.0478P:0.37, R:0.95
normal: 0.0895 0.3748  anomaly: 0.1138 0.6175	P:0.01, R:0.03
Pixel Auroc:0.968, Sample Auroc0.781, Pixel Aupro0.0
test_fnorm_loss: 0.0129 test_afnorm_loss: 0.0415
 11%|█         | 11/100 [05:28<43:32, 29.36s/it]epoch [11/100], focal_loss:0.0088	, anomaly_loss:0.2536	fnorm_loss:0.0121, a_fnorm_loss:0.0490P:0.39, R:0.96
 12%|█▏        | 12/100 [05:51<40:24, 27.55s/it]epoch [12/100], focal_loss:0.0078	, anomaly_loss:0.2459	fnorm_loss:0.0109, a_fnorm_loss:0.0495P:0.40, R:0.94
 13%|█▎        | 13/100 [06:15<38:08, 26.30s/it]epoch [13/100], focal_loss:0.0068	, anomaly_loss:0.2466	fnorm_loss:0.0099, a_fnorm_loss:0.0507P:0.46, R:0.97
 14%|█▍        | 14/100 [06:38<36:28, 25.45s/it]epoch [14/100], focal_loss:0.0065	, anomaly_loss:0.2460	fnorm_loss:0.0092, a_fnorm_loss:0.0509P:0.47, R:0.96
 15%|█▌        | 15/100 [07:28<46:39, 32.94s/it]epoch [15/100], focal_loss:0.0058	, anomaly_loss:0.2384	fnorm_loss:0.0087, a_fnorm_loss:0.0516P:0.48, R:0.96
normal: 0.0723 0.3339  anomaly: 0.0848 0.5743	P:0.01, R:0.02
Pixel Auroc:0.974, Sample Auroc0.748, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0454
 16%|█▌        | 16/100 [07:51<41:48, 29.87s/it]epoch [16/100], focal_loss:0.0060	, anomaly_loss:0.2347	fnorm_loss:0.0084, a_fnorm_loss:0.0509P:0.47, R:0.96
 17%|█▋        | 17/100 [08:14<38:26, 27.79s/it]epoch [17/100], focal_loss:0.0094	, anomaly_loss:0.3034	fnorm_loss:0.0087, a_fnorm_loss:0.0484P:0.38, R:0.78
 18%|█▊        | 18/100 [08:38<36:16, 26.54s/it]epoch [18/100], focal_loss:0.0091	, anomaly_loss:0.3020	fnorm_loss:0.0079, a_fnorm_loss:0.0491P:0.39, R:0.82
 19%|█▉        | 19/100 [09:01<34:26, 25.51s/it]epoch [19/100], focal_loss:0.0064	, anomaly_loss:0.2392	fnorm_loss:0.0076, a_fnorm_loss:0.0518P:0.45, R:0.96
 20%|██        | 20/100 [09:47<42:20, 31.76s/it]epoch [20/100], focal_loss:0.0053	, anomaly_loss:0.2339	fnorm_loss:0.0073, a_fnorm_loss:0.0531P:0.46, R:0.97
normal: 0.0291 0.1524  anomaly: 0.0303 0.4544	P:0.01, R:0.01
Pixel Auroc:0.979, Sample Auroc0.777, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0219
 21%|██        | 21/100 [10:10<38:18, 29.10s/it]epoch [21/100], focal_loss:0.0054	, anomaly_loss:0.2318	fnorm_loss:0.0071, a_fnorm_loss:0.0522P:0.51, R:0.97
 22%|██▏       | 22/100 [10:33<35:22, 27.22s/it]epoch [22/100], focal_loss:0.0051	, anomaly_loss:0.2259	fnorm_loss:0.0069, a_fnorm_loss:0.0524P:0.49, R:0.98
 23%|██▎       | 23/100 [10:56<33:15, 25.92s/it]epoch [23/100], focal_loss:0.0052	, anomaly_loss:0.2281	fnorm_loss:0.0068, a_fnorm_loss:0.0534P:0.49, R:0.96
 24%|██▍       | 24/100 [11:20<32:08, 25.38s/it]epoch [24/100], focal_loss:0.0052	, anomaly_loss:0.2317	fnorm_loss:0.0068, a_fnorm_loss:0.0526P:0.51, R:0.97
 25%|██▌       | 25/100 [12:11<41:30, 33.21s/it]epoch [25/100], focal_loss:0.0051	, anomaly_loss:0.2310	fnorm_loss:0.0066, a_fnorm_loss:0.0523P:0.54, R:0.97
normal: 0.0339 0.2728  anomaly: 0.0310 0.5457	P:0.02, R:0.02
Pixel Auroc:0.974, Sample Auroc0.744, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0386
 26%|██▌       | 26/100 [12:34<37:05, 30.08s/it]epoch [26/100], focal_loss:0.0052	, anomaly_loss:0.2289	fnorm_loss:0.0066, a_fnorm_loss:0.0525P:0.53, R:0.96
 27%|██▋       | 27/100 [12:58<34:11, 28.11s/it]epoch [27/100], focal_loss:0.0049	, anomaly_loss:0.2179	fnorm_loss:0.0064, a_fnorm_loss:0.0526P:0.50, R:0.96
 28%|██▊       | 28/100 [13:20<31:47, 26.49s/it]epoch [28/100], focal_loss:0.0048	, anomaly_loss:0.2318	fnorm_loss:0.0064, a_fnorm_loss:0.0528P:0.49, R:0.97
 29%|██▉       | 29/100 [13:44<30:11, 25.51s/it]epoch [29/100], focal_loss:0.0044	, anomaly_loss:0.2273	fnorm_loss:0.0063, a_fnorm_loss:0.0526P:0.53, R:0.97
 30%|███       | 30/100 [14:30<36:56, 31.66s/it]epoch [30/100], focal_loss:0.0046	, anomaly_loss:0.2262	fnorm_loss:0.0062, a_fnorm_loss:0.0532P:0.53, R:0.97
normal: 0.0266 0.2509  anomaly: 0.0327 0.5612	P:0.02, R:0.02
Pixel Auroc:0.976, Sample Auroc0.748, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0378
 31%|███       | 31/100 [14:53<33:32, 29.16s/it]epoch [31/100], focal_loss:0.0043	, anomaly_loss:0.2293	fnorm_loss:0.0062, a_fnorm_loss:0.0528P:0.54, R:0.97
 32%|███▏      | 32/100 [15:17<31:09, 27.49s/it]epoch [32/100], focal_loss:0.0050	, anomaly_loss:0.2247	fnorm_loss:0.0064, a_fnorm_loss:0.0530P:0.48, R:0.98
 33%|███▎      | 33/100 [15:40<29:28, 26.39s/it]epoch [33/100], focal_loss:0.0046	, anomaly_loss:0.2262	fnorm_loss:0.0061, a_fnorm_loss:0.0538P:0.52, R:0.97
 34%|███▍      | 34/100 [16:04<28:01, 25.48s/it]epoch [34/100], focal_loss:0.0044	, anomaly_loss:0.2214	fnorm_loss:0.0061, a_fnorm_loss:0.0541P:0.51, R:0.98
 35%|███▌      | 35/100 [16:50<34:16, 31.64s/it]epoch [35/100], focal_loss:0.0057	, anomaly_loss:0.2359	fnorm_loss:0.0062, a_fnorm_loss:0.0524P:0.50, R:0.96
normal: 0.0261 0.1881  anomaly: 0.0316 0.5284	P:0.02, R:0.02
Pixel Auroc:0.978, Sample Auroc0.828, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0277
 36%|███▌      | 36/100 [17:13<31:10, 29.23s/it]epoch [36/100], focal_loss:0.0049	, anomaly_loss:0.2244	fnorm_loss:0.0061, a_fnorm_loss:0.0536P:0.51, R:0.97
 37%|███▋      | 37/100 [17:37<28:59, 27.61s/it]epoch [37/100], focal_loss:0.0045	, anomaly_loss:0.2252	fnorm_loss:0.0061, a_fnorm_loss:0.0537P:0.51, R:0.97
 38%|███▊      | 38/100 [18:00<27:09, 26.27s/it]epoch [38/100], focal_loss:0.0048	, anomaly_loss:0.2249	fnorm_loss:0.0060, a_fnorm_loss:0.0532P:0.51, R:0.96
 39%|███▉      | 39/100 [18:24<25:48, 25.39s/it]epoch [39/100], focal_loss:0.0045	, anomaly_loss:0.2224	fnorm_loss:0.0060, a_fnorm_loss:0.0538P:0.51, R:0.98
 40%|████      | 40/100 [19:10<31:39, 31.66s/it]epoch [40/100], focal_loss:0.0045	, anomaly_loss:0.2265	fnorm_loss:0.0060, a_fnorm_loss:0.0535P:0.54, R:0.97
normal: 0.1410 0.4393  anomaly: 0.1576 0.6418	P:0.01, R:0.03
Pixel Auroc:0.967, Sample Auroc0.768, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0476
 41%|████      | 41/100 [19:33<28:32, 29.03s/it]epoch [41/100], focal_loss:0.0043	, anomaly_loss:0.2180	fnorm_loss:0.0060, a_fnorm_loss:0.0538P:0.52, R:0.98
 42%|████▏     | 42/100 [19:56<26:25, 27.33s/it]epoch [42/100], focal_loss:0.0045	, anomaly_loss:0.2224	fnorm_loss:0.0060, a_fnorm_loss:0.0539P:0.55, R:0.98
 43%|████▎     | 43/100 [20:19<24:36, 25.90s/it]epoch [43/100], focal_loss:0.0042	, anomaly_loss:0.2242	fnorm_loss:0.0060, a_fnorm_loss:0.0538P:0.53, R:0.98
 44%|████▍     | 44/100 [20:42<23:24, 25.07s/it]epoch [44/100], focal_loss:0.0046	, anomaly_loss:0.2283	fnorm_loss:0.0060, a_fnorm_loss:0.0527P:0.51, R:0.97
 45%|████▌     | 45/100 [21:28<28:44, 31.36s/it]epoch [45/100], focal_loss:0.0043	, anomaly_loss:0.2199	fnorm_loss:0.0059, a_fnorm_loss:0.0542P:0.53, R:0.98
normal: 0.0272 0.2492  anomaly: 0.0301 0.5462	P:0.02, R:0.02
Pixel Auroc:0.979, Sample Auroc0.791, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0349
 46%|████▌     | 46/100 [21:51<25:55, 28.80s/it]epoch [46/100], focal_loss:0.0041	, anomaly_loss:0.2243	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.53, R:0.98
 47%|████▋     | 47/100 [22:14<24:02, 27.22s/it]epoch [47/100], focal_loss:0.0043	, anomaly_loss:0.2241	fnorm_loss:0.0060, a_fnorm_loss:0.0533P:0.51, R:0.97
 48%|████▊     | 48/100 [22:37<22:20, 25.78s/it]epoch [48/100], focal_loss:0.0043	, anomaly_loss:0.2203	fnorm_loss:0.0059, a_fnorm_loss:0.0530P:0.50, R:0.98
 49%|████▉     | 49/100 [23:00<21:13, 24.97s/it]epoch [49/100], focal_loss:0.0044	, anomaly_loss:0.2204	fnorm_loss:0.0059, a_fnorm_loss:0.0541P:0.52, R:0.98
 50%|█████     | 50/100 [23:47<26:27, 31.75s/it]epoch [50/100], focal_loss:0.0043	, anomaly_loss:0.2237	fnorm_loss:0.0059, a_fnorm_loss:0.0535P:0.54, R:0.98
normal: 0.0230 0.1801  anomaly: 0.0247 0.5071	P:0.01, R:0.02
Pixel Auroc:0.978, Sample Auroc0.767, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0257
 51%|█████     | 51/100 [24:11<23:59, 29.37s/it]epoch [51/100], focal_loss:0.0041	, anomaly_loss:0.2212	fnorm_loss:0.0059, a_fnorm_loss:0.0537P:0.53, R:0.98
 52%|█████▏    | 52/100 [24:35<22:02, 27.56s/it]epoch [52/100], focal_loss:0.0040	, anomaly_loss:0.2282	fnorm_loss:0.0059, a_fnorm_loss:0.0541P:0.53, R:0.98
 53%|█████▎    | 53/100 [24:58<20:38, 26.35s/it]epoch [53/100], focal_loss:0.0044	, anomaly_loss:0.2276	fnorm_loss:0.0059, a_fnorm_loss:0.0536P:0.56, R:0.97
 54%|█████▍    | 54/100 [25:21<19:29, 25.42s/it]epoch [54/100], focal_loss:0.0042	, anomaly_loss:0.2207	fnorm_loss:0.0059, a_fnorm_loss:0.0542P:0.52, R:0.98
 55%|█████▌    | 55/100 [26:08<23:48, 31.75s/it]epoch [55/100], focal_loss:0.0040	, anomaly_loss:0.2156	fnorm_loss:0.0059, a_fnorm_loss:0.0543P:0.53, R:0.98
normal: 0.0219 0.0846  anomaly: 0.0228 0.4830	P:0.01, R:0.01
Pixel Auroc:0.983, Sample Auroc0.780, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0206
 56%|█████▌    | 56/100 [26:31<21:22, 29.15s/it]epoch [56/100], focal_loss:0.0038	, anomaly_loss:0.2172	fnorm_loss:0.0058, a_fnorm_loss:0.0548P:0.54, R:0.98
 57%|█████▋    | 57/100 [26:54<19:34, 27.32s/it]epoch [57/100], focal_loss:0.0048	, anomaly_loss:0.2266	fnorm_loss:0.0059, a_fnorm_loss:0.0535P:0.54, R:0.96
 58%|█████▊    | 58/100 [27:17<18:13, 26.04s/it]epoch [58/100], focal_loss:0.0045	, anomaly_loss:0.2201	fnorm_loss:0.0060, a_fnorm_loss:0.0532P:0.51, R:0.96
 59%|█████▉    | 59/100 [27:40<17:13, 25.21s/it]epoch [59/100], focal_loss:0.0040	, anomaly_loss:0.2237	fnorm_loss:0.0059, a_fnorm_loss:0.0539P:0.57, R:0.98
 60%|██████    | 60/100 [28:26<20:58, 31.45s/it]epoch [60/100], focal_loss:0.0038	, anomaly_loss:0.2187	fnorm_loss:0.0059, a_fnorm_loss:0.0550P:0.56, R:0.99
normal: 0.0271 0.3128  anomaly: 0.0528 0.6195	P:0.01, R:0.02
Pixel Auroc:0.977, Sample Auroc0.819, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0357
 61%|██████    | 61/100 [28:49<18:45, 28.85s/it]epoch [61/100], focal_loss:0.0043	, anomaly_loss:0.2229	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.56, R:0.98
 62%|██████▏   | 62/100 [29:12<17:05, 27.00s/it]epoch [62/100], focal_loss:0.0041	, anomaly_loss:0.2225	fnorm_loss:0.0059, a_fnorm_loss:0.0537P:0.54, R:0.98
 63%|██████▎   | 63/100 [29:35<15:51, 25.73s/it]epoch [63/100], focal_loss:0.0041	, anomaly_loss:0.2225	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.55, R:0.98
 64%|██████▍   | 64/100 [29:58<15:00, 25.02s/it]epoch [64/100], focal_loss:0.0045	, anomaly_loss:0.2260	fnorm_loss:0.0059, a_fnorm_loss:0.0541P:0.55, R:0.97
 65%|██████▌   | 65/100 [30:44<18:15, 31.31s/it]epoch [65/100], focal_loss:0.0040	, anomaly_loss:0.2183	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.53, R:0.98
normal: 0.0215 0.2408  anomaly: 0.0227 0.5565	P:0.02, R:0.02
Pixel Auroc:0.978, Sample Auroc0.741, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0355
 66%|██████▌   | 66/100 [31:07<16:15, 28.70s/it]epoch [66/100], focal_loss:0.0049	, anomaly_loss:0.2277	fnorm_loss:0.0060, a_fnorm_loss:0.0533P:0.54, R:0.96
 67%|██████▋   | 67/100 [31:30<14:51, 27.01s/it]epoch [67/100], focal_loss:0.0047	, anomaly_loss:0.2247	fnorm_loss:0.0060, a_fnorm_loss:0.0533P:0.54, R:0.97
 68%|██████▊   | 68/100 [31:52<13:40, 25.64s/it]epoch [68/100], focal_loss:0.0040	, anomaly_loss:0.2221	fnorm_loss:0.0059, a_fnorm_loss:0.0549P:0.55, R:0.98
 69%|██████▉   | 69/100 [32:15<12:50, 24.86s/it]epoch [69/100], focal_loss:0.0041	, anomaly_loss:0.2164	fnorm_loss:0.0059, a_fnorm_loss:0.0539P:0.55, R:0.98
 70%|███████   | 70/100 [32:58<15:12, 30.42s/it]epoch [70/100], focal_loss:0.0060	, anomaly_loss:0.2505	fnorm_loss:0.0065, a_fnorm_loss:0.0513P:0.54, R:0.89
normal: 0.0277 0.1466  anomaly: 0.0312 0.4915	P:0.02, R:0.02
Pixel Auroc:0.982, Sample Auroc0.820, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0316
 71%|███████   | 71/100 [33:20<13:28, 27.89s/it]epoch [71/100], focal_loss:0.0043	, anomaly_loss:0.2258	fnorm_loss:0.0060, a_fnorm_loss:0.0539P:0.53, R:0.98
 72%|███████▏  | 72/100 [33:43<12:18, 26.37s/it]epoch [72/100], focal_loss:0.0045	, anomaly_loss:0.2277	fnorm_loss:0.0059, a_fnorm_loss:0.0535P:0.51, R:0.97
 73%|███████▎  | 73/100 [34:07<11:27, 25.44s/it]epoch [73/100], focal_loss:0.0042	, anomaly_loss:0.2168	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.54, R:0.98
 74%|███████▍  | 74/100 [34:29<10:37, 24.52s/it]epoch [74/100], focal_loss:0.0045	, anomaly_loss:0.2250	fnorm_loss:0.0059, a_fnorm_loss:0.0538P:0.55, R:0.98
 75%|███████▌  | 75/100 [35:12<12:34, 30.16s/it]epoch [75/100], focal_loss:0.0041	, anomaly_loss:0.2250	fnorm_loss:0.0059, a_fnorm_loss:0.0539P:0.54, R:0.98
normal: 0.0220 0.1928  anomaly: 0.0224 0.5693	P:0.01, R:0.02
Pixel Auroc:0.978, Sample Auroc0.778, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0332
 76%|███████▌  | 76/100 [35:34<11:04, 27.70s/it]epoch [76/100], focal_loss:0.0040	, anomaly_loss:0.2194	fnorm_loss:0.0059, a_fnorm_loss:0.0543P:0.57, R:0.98
 77%|███████▋  | 77/100 [35:57<10:05, 26.34s/it]epoch [77/100], focal_loss:0.0039	, anomaly_loss:0.2235	fnorm_loss:0.0058, a_fnorm_loss:0.0544P:0.58, R:0.98
 78%|███████▊  | 78/100 [36:21<09:20, 25.46s/it]epoch [78/100], focal_loss:0.0047	, anomaly_loss:0.2268	fnorm_loss:0.0060, a_fnorm_loss:0.0531P:0.53, R:0.97
 79%|███████▉  | 79/100 [36:43<08:32, 24.39s/it]epoch [79/100], focal_loss:0.0041	, anomaly_loss:0.2244	fnorm_loss:0.0059, a_fnorm_loss:0.0536P:0.57, R:0.98
 80%|████████  | 80/100 [37:26<10:02, 30.14s/it]epoch [80/100], focal_loss:0.0043	, anomaly_loss:0.2233	fnorm_loss:0.0059, a_fnorm_loss:0.0535P:0.54, R:0.98
normal: 0.0222 0.1803  anomaly: 0.0231 0.5587	P:0.02, R:0.02
Pixel Auroc:0.979, Sample Auroc0.811, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0324
 81%|████████  | 81/100 [37:49<08:49, 27.88s/it]epoch [81/100], focal_loss:0.0038	, anomaly_loss:0.2155	fnorm_loss:0.0059, a_fnorm_loss:0.0538P:0.55, R:0.98
 82%|████████▏ | 82/100 [38:12<07:54, 26.36s/it]epoch [82/100], focal_loss:0.0037	, anomaly_loss:0.2145	fnorm_loss:0.0059, a_fnorm_loss:0.0548P:0.54, R:0.99
 83%|████████▎ | 83/100 [38:35<07:11, 25.38s/it]epoch [83/100], focal_loss:0.0039	, anomaly_loss:0.2221	fnorm_loss:0.0059, a_fnorm_loss:0.0540P:0.56, R:0.98
 84%|████████▍ | 84/100 [38:57<06:30, 24.40s/it]epoch [84/100], focal_loss:0.0038	, anomaly_loss:0.2185	fnorm_loss:0.0058, a_fnorm_loss:0.0545P:0.57, R:0.99
 85%|████████▌ | 85/100 [39:41<07:35, 30.34s/it]epoch [85/100], focal_loss:0.0038	, anomaly_loss:0.2219	fnorm_loss:0.0059, a_fnorm_loss:0.0546P:0.58, R:0.98
normal: 0.0234 0.1839  anomaly: 0.0236 0.5376	P:0.01, R:0.02
Pixel Auroc:0.979, Sample Auroc0.792, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0292
 86%|████████▌ | 86/100 [40:04<06:31, 28.00s/it]epoch [86/100], focal_loss:0.0038	, anomaly_loss:0.2166	fnorm_loss:0.0058, a_fnorm_loss:0.0542P:0.56, R:0.98
 87%|████████▋ | 87/100 [40:27<05:45, 26.56s/it]epoch [87/100], focal_loss:0.0040	, anomaly_loss:0.2211	fnorm_loss:0.0059, a_fnorm_loss:0.0551P:0.56, R:0.98
 88%|████████▊ | 88/100 [40:49<05:04, 25.37s/it]epoch [88/100], focal_loss:0.0037	, anomaly_loss:0.2139	fnorm_loss:0.0058, a_fnorm_loss:0.0551P:0.55, R:0.99
 89%|████████▉ | 89/100 [41:11<04:26, 24.26s/it]epoch [89/100], focal_loss:0.0039	, anomaly_loss:0.2189	fnorm_loss:0.0059, a_fnorm_loss:0.0539P:0.56, R:0.98
 90%|█████████ | 90/100 [41:55<05:01, 30.20s/it]epoch [90/100], focal_loss:0.0035	, anomaly_loss:0.2167	fnorm_loss:0.0058, a_fnorm_loss:0.0547P:0.59, R:0.99
normal: 0.0226 0.2191  anomaly: 0.0246 0.5791	P:0.02, R:0.02
Pixel Auroc:0.975, Sample Auroc0.790, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0343
 91%|█████████ | 91/100 [42:18<04:11, 27.89s/it]epoch [91/100], focal_loss:0.0038	, anomaly_loss:0.2152	fnorm_loss:0.0058, a_fnorm_loss:0.0546P:0.54, R:0.98
 92%|█████████▏| 92/100 [42:40<03:30, 26.28s/it]epoch [92/100], focal_loss:0.0037	, anomaly_loss:0.2156	fnorm_loss:0.0058, a_fnorm_loss:0.0543P:0.56, R:0.98
 93%|█████████▎| 93/100 [43:03<02:56, 25.21s/it]epoch [93/100], focal_loss:0.0038	, anomaly_loss:0.2191	fnorm_loss:0.0059, a_fnorm_loss:0.0538P:0.58, R:0.98
 94%|█████████▍| 94/100 [43:25<02:26, 24.37s/it]epoch [94/100], focal_loss:0.0037	, anomaly_loss:0.2162	fnorm_loss:0.0058, a_fnorm_loss:0.0552P:0.56, R:0.98
 95%|█████████▌| 95/100 [44:10<02:32, 30.43s/it]epoch [95/100], focal_loss:0.0035	, anomaly_loss:0.2145	fnorm_loss:0.0058, a_fnorm_loss:0.0549P:0.58, R:0.99
normal: 0.0227 0.1944  anomaly: 0.0230 0.5553	P:0.01, R:0.02
Pixel Auroc:0.977, Sample Auroc0.792, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0298
 96%|█████████▌| 96/100 [44:32<01:51, 27.88s/it]epoch [96/100], focal_loss:0.0037	, anomaly_loss:0.2241	fnorm_loss:0.0058, a_fnorm_loss:0.0549P:0.57, R:0.98
 97%|█████████▋| 97/100 [44:55<01:19, 26.62s/it]epoch [97/100], focal_loss:0.0034	, anomaly_loss:0.2183	fnorm_loss:0.0058, a_fnorm_loss:0.0549P:0.57, R:0.98
 98%|█████████▊| 98/100 [45:18<00:50, 25.30s/it]epoch [98/100], focal_loss:0.0039	, anomaly_loss:0.2199	fnorm_loss:0.0059, a_fnorm_loss:0.0547P:0.55, R:0.98
 99%|█████████▉| 99/100 [45:40<00:24, 24.43s/it]epoch [99/100], focal_loss:0.0036	, anomaly_loss:0.2136	fnorm_loss:0.0058, a_fnorm_loss:0.0545P:0.60, R:0.98
100%|██████████| 100/100 [46:23<00:00, 29.91s/it]100%|██████████| 100/100 [46:23<00:00, 27.83s/it]
epoch [100/100], focal_loss:0.0038	, anomaly_loss:0.2187	fnorm_loss:0.0058, a_fnorm_loss:0.0551P:0.56, R:0.99
normal: 0.0225 0.1926  anomaly: 0.0227 0.5532	P:0.02, R:0.02
Pixel Auroc:0.977, Sample Auroc0.787, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0310
training Stubborn Student...
macaroni1
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<31:56, 16.10s/it]epoch [1/120], kd_loss:3.7631
  2%|▏         | 2/120 [00:32<31:51, 16.20s/it]epoch [2/120], kd_loss:2.1052
  2%|▎         | 3/120 [00:48<31:38, 16.23s/it]epoch [3/120], kd_loss:1.7051
  3%|▎         | 4/120 [01:04<31:27, 16.27s/it]epoch [4/120], kd_loss:2.2821
  4%|▍         | 5/120 [01:21<31:12, 16.28s/it]epoch [5/120], kd_loss:2.1362
  5%|▌         | 6/120 [01:37<30:56, 16.28s/it]epoch [6/120], kd_loss:1.7717
  6%|▌         | 7/120 [01:53<30:41, 16.29s/it]epoch [7/120], kd_loss:1.6313
  7%|▋         | 8/120 [02:10<30:26, 16.30s/it]epoch [8/120], kd_loss:1.5474
  8%|▊         | 9/120 [02:26<30:12, 16.33s/it]epoch [9/120], kd_loss:1.5148
  8%|▊         | 10/120 [03:02<41:00, 22.37s/it]epoch [10/120], kd_loss:1.5111
normal: 0.8900 1.2506  anomaly: 0.9294 1.8845
thresh: 1.080383951224921
fpr: 0.12 fnr 0.25
Pixel Auroc:0.970, Sample Auroc0.869, Pixel Aupro0.0
  9%|▉         | 11/120 [03:18<37:12, 20.48s/it]epoch [11/120], kd_loss:1.4394
 10%|█         | 12/120 [03:34<34:33, 19.20s/it]epoch [12/120], kd_loss:1.6830
 11%|█         | 13/120 [03:51<32:40, 18.32s/it]epoch [13/120], kd_loss:1.4526
 12%|█▏        | 14/120 [04:07<31:17, 17.71s/it]epoch [14/120], kd_loss:1.3784
 12%|█▎        | 15/120 [04:23<30:18, 17.32s/it]epoch [15/120], kd_loss:1.3478
 13%|█▎        | 16/120 [04:40<29:33, 17.05s/it]epoch [16/120], kd_loss:1.3198
 14%|█▍        | 17/120 [04:56<28:54, 16.84s/it]epoch [17/120], kd_loss:1.3168
 15%|█▌        | 18/120 [05:13<28:21, 16.68s/it]epoch [18/120], kd_loss:1.3279
 16%|█▌        | 19/120 [05:29<27:53, 16.57s/it]epoch [19/120], kd_loss:1.3185
 17%|█▋        | 20/120 [06:04<37:05, 22.25s/it]epoch [20/120], kd_loss:1.2313
normal: 0.8850 1.2943  anomaly: 0.8857 1.7566
thresh: 1.0886330835938138
fpr: 0.07 fnr 0.36
Pixel Auroc:0.966, Sample Auroc0.824, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:21<33:42, 20.43s/it]epoch [21/120], kd_loss:1.2536
 18%|█▊        | 22/120 [06:37<31:18, 19.17s/it]epoch [22/120], kd_loss:1.4089
 19%|█▉        | 23/120 [06:53<29:35, 18.30s/it]epoch [23/120], kd_loss:1.4027
 20%|██        | 24/120 [07:09<28:19, 17.70s/it]epoch [24/120], kd_loss:1.2461
 21%|██        | 25/120 [07:26<27:23, 17.30s/it]epoch [25/120], kd_loss:1.2447
 22%|██▏       | 26/120 [07:42<26:38, 17.01s/it]epoch [26/120], kd_loss:1.2293
 22%|██▎       | 27/120 [07:58<26:03, 16.81s/it]epoch [27/120], kd_loss:1.2195
 23%|██▎       | 28/120 [08:15<25:33, 16.67s/it]epoch [28/120], kd_loss:1.1968
 24%|██▍       | 29/120 [08:31<25:07, 16.56s/it]epoch [29/120], kd_loss:1.5804
 25%|██▌       | 30/120 [09:07<33:36, 22.41s/it]epoch [30/120], kd_loss:1.3775
normal: 0.7969 1.2290  anomaly: 0.8133 1.7308
thresh: 0.9612553300322855
fpr: 0.18 fnr 0.2
Pixel Auroc:0.978, Sample Auroc0.887, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:23<30:28, 20.54s/it]epoch [31/120], kd_loss:1.3763
 27%|██▋       | 32/120 [09:40<28:14, 19.25s/it]epoch [32/120], kd_loss:1.2206
 28%|██▊       | 33/120 [09:56<26:36, 18.36s/it]epoch [33/120], kd_loss:1.5094
 28%|██▊       | 34/120 [10:12<25:28, 17.77s/it]epoch [34/120], kd_loss:1.3719
 29%|██▉       | 35/120 [10:29<24:33, 17.34s/it]epoch [35/120], kd_loss:1.2355
 30%|███       | 36/120 [10:45<23:50, 17.03s/it]epoch [36/120], kd_loss:1.1954
 31%|███       | 37/120 [11:01<23:15, 16.82s/it]epoch [37/120], kd_loss:1.1684
 32%|███▏      | 38/120 [11:17<22:46, 16.66s/it]epoch [38/120], kd_loss:1.1482
 32%|███▎      | 39/120 [11:34<22:22, 16.57s/it]epoch [39/120], kd_loss:1.1344
 33%|███▎      | 40/120 [12:13<30:56, 23.21s/it]epoch [40/120], kd_loss:1.1102
normal: 0.6854 1.1714  anomaly: 0.7535 1.6844
thresh: 0.8233885158224841
fpr: 0.26 fnr 0.08
Pixel Auroc:0.981, Sample Auroc0.924, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:29<27:46, 21.10s/it]epoch [41/120], kd_loss:1.1397
 35%|███▌      | 42/120 [12:45<25:31, 19.64s/it]epoch [42/120], kd_loss:1.1248
 36%|███▌      | 43/120 [13:01<23:53, 18.62s/it]epoch [43/120], kd_loss:1.1066
 37%|███▋      | 44/120 [13:17<22:42, 17.93s/it]epoch [44/120], kd_loss:1.0992
 38%|███▊      | 45/120 [13:34<21:48, 17.44s/it]epoch [45/120], kd_loss:1.1386
 38%|███▊      | 46/120 [13:50<21:06, 17.12s/it]epoch [46/120], kd_loss:1.0721
 39%|███▉      | 47/120 [14:06<20:31, 16.87s/it]epoch [47/120], kd_loss:1.2005
 40%|████      | 48/120 [14:23<20:02, 16.70s/it]epoch [48/120], kd_loss:1.0980
 41%|████      | 49/120 [14:39<19:36, 16.57s/it]epoch [49/120], kd_loss:1.0746
 42%|████▏     | 50/120 [15:15<25:57, 22.25s/it]epoch [50/120], kd_loss:1.0524
normal: 0.6243 0.9954  anomaly: 0.6652 1.6897
thresh: 0.8487723899238473
fpr: 0.1 fnr 0.24
Pixel Auroc:0.980, Sample Auroc0.898, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:31<23:29, 20.43s/it]epoch [51/120], kd_loss:1.0430
 43%|████▎     | 52/120 [15:47<21:44, 19.18s/it]epoch [52/120], kd_loss:1.0683
 44%|████▍     | 53/120 [16:03<20:27, 18.32s/it]epoch [53/120], kd_loss:1.4723
 45%|████▌     | 54/120 [16:20<19:29, 17.72s/it]epoch [54/120], kd_loss:1.2212
 46%|████▌     | 55/120 [16:36<18:44, 17.30s/it]epoch [55/120], kd_loss:1.3530
 47%|████▋     | 56/120 [16:52<18:08, 17.01s/it]epoch [56/120], kd_loss:1.1449
 48%|████▊     | 57/120 [17:09<17:38, 16.81s/it]epoch [57/120], kd_loss:1.3021
 48%|████▊     | 58/120 [17:25<17:12, 16.66s/it]epoch [58/120], kd_loss:1.1256
 49%|████▉     | 59/120 [17:41<16:51, 16.58s/it]epoch [59/120], kd_loss:1.1070
 50%|█████     | 60/120 [18:17<22:16, 22.28s/it]epoch [60/120], kd_loss:1.1193
normal: 0.9328 1.5329  anomaly: 1.1070 1.7733
thresh: 1.3105773264868998
fpr: 0.35 fnr 0.26
Pixel Auroc:0.982, Sample Auroc0.741, Pixel Aupro0.0
 51%|█████     | 61/120 [18:33<20:06, 20.44s/it]epoch [61/120], kd_loss:1.1555
 52%|█████▏    | 62/120 [18:49<18:32, 19.18s/it]epoch [62/120], kd_loss:1.1171
 52%|█████▎    | 63/120 [19:06<17:23, 18.31s/it]epoch [63/120], kd_loss:1.0855
 53%|█████▎    | 64/120 [19:22<16:33, 17.73s/it]epoch [64/120], kd_loss:1.0764
 54%|█████▍    | 65/120 [19:38<15:51, 17.31s/it]epoch [65/120], kd_loss:1.0565
 55%|█████▌    | 66/120 [19:55<15:18, 17.01s/it]epoch [66/120], kd_loss:1.0762
 56%|█████▌    | 67/120 [20:11<14:51, 16.82s/it]epoch [67/120], kd_loss:1.0560
 57%|█████▋    | 68/120 [20:27<14:27, 16.69s/it]epoch [68/120], kd_loss:1.0893
 57%|█████▊    | 69/120 [20:44<14:05, 16.58s/it]epoch [69/120], kd_loss:1.0505
 58%|█████▊    | 70/120 [21:19<18:37, 22.34s/it]epoch [70/120], kd_loss:1.0646
normal: 0.6452 1.0074  anomaly: 0.7266 1.7025
thresh: 0.8206854766964821
fpr: 0.18 fnr 0.16
Pixel Auroc:0.979, Sample Auroc0.919, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:36<16:44, 20.49s/it]epoch [71/120], kd_loss:1.2938
 60%|██████    | 72/120 [21:52<15:22, 19.22s/it]epoch [72/120], kd_loss:1.0959
 61%|██████    | 73/120 [22:08<14:22, 18.35s/it]epoch [73/120], kd_loss:1.0944
 62%|██████▏   | 74/120 [22:24<13:35, 17.72s/it]epoch [74/120], kd_loss:1.0931
 62%|██████▎   | 75/120 [22:41<12:58, 17.30s/it]epoch [75/120], kd_loss:1.1195
 63%|██████▎   | 76/120 [22:57<12:28, 17.02s/it]epoch [76/120], kd_loss:1.1533
 64%|██████▍   | 77/120 [23:13<12:02, 16.81s/it]epoch [77/120], kd_loss:1.0813
 65%|██████▌   | 78/120 [23:30<11:40, 16.68s/it]epoch [78/120], kd_loss:1.1409
 66%|██████▌   | 79/120 [23:46<11:20, 16.59s/it]epoch [79/120], kd_loss:1.1683
 67%|██████▋   | 80/120 [24:22<14:53, 22.34s/it]epoch [80/120], kd_loss:1.0570
normal: 0.6504 1.1722  anomaly: 0.7225 1.7363
thresh: 0.8217499374696425
fpr: 0.19 fnr 0.16
Pixel Auroc:0.975, Sample Auroc0.906, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:38<13:19, 20.50s/it]epoch [81/120], kd_loss:1.0332
 68%|██████▊   | 82/120 [24:54<12:10, 19.21s/it]epoch [82/120], kd_loss:1.0407
 69%|██████▉   | 83/120 [25:11<11:18, 18.33s/it]epoch [83/120], kd_loss:1.0371
 70%|███████   | 84/120 [25:27<10:38, 17.73s/it]epoch [84/120], kd_loss:1.0574
 71%|███████   | 85/120 [25:43<10:05, 17.31s/it]epoch [85/120], kd_loss:1.2147
 72%|███████▏  | 86/120 [26:00<09:38, 17.02s/it]epoch [86/120], kd_loss:1.1075
 72%|███████▎  | 87/120 [26:16<09:14, 16.81s/it]epoch [87/120], kd_loss:1.1566
 73%|███████▎  | 88/120 [26:32<08:52, 16.66s/it]epoch [88/120], kd_loss:1.1324
 74%|███████▍  | 89/120 [26:49<08:33, 16.55s/it]epoch [89/120], kd_loss:1.0706
 75%|███████▌  | 90/120 [27:24<11:02, 22.10s/it]epoch [90/120], kd_loss:1.0377
normal: 0.6361 1.0670  anomaly: 0.6653 1.7245
thresh: 0.8162247086592036
fpr: 0.16 fnr 0.17
Pixel Auroc:0.977, Sample Auroc0.895, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:40<09:49, 20.32s/it]epoch [91/120], kd_loss:1.0301
 77%|███████▋  | 92/120 [27:56<08:54, 19.11s/it]epoch [92/120], kd_loss:1.6339
 78%|███████▊  | 93/120 [28:12<08:13, 18.27s/it]epoch [93/120], kd_loss:1.2658
 78%|███████▊  | 94/120 [28:29<07:39, 17.68s/it]epoch [94/120], kd_loss:1.2462
 79%|███████▉  | 95/120 [28:45<07:11, 17.26s/it]epoch [95/120], kd_loss:1.3357
 80%|████████  | 96/120 [29:01<06:47, 16.99s/it]epoch [96/120], kd_loss:1.2661
 81%|████████  | 97/120 [29:18<06:26, 16.79s/it]epoch [97/120], kd_loss:1.1625
 82%|████████▏ | 98/120 [29:34<06:06, 16.64s/it]epoch [98/120], kd_loss:1.1364
 82%|████████▎ | 99/120 [29:50<05:48, 16.58s/it]epoch [99/120], kd_loss:1.1204
 83%|████████▎ | 100/120 [30:25<07:21, 22.08s/it]epoch [100/120], kd_loss:1.1165
normal: 0.6859 1.0280  anomaly: 0.7432 1.6925
thresh: 0.8803283420049208
fpr: 0.17 fnr 0.16
Pixel Auroc:0.984, Sample Auroc0.907, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:41<06:25, 20.30s/it]epoch [101/120], kd_loss:1.1033
 85%|████████▌ | 102/120 [30:58<05:43, 19.08s/it]epoch [102/120], kd_loss:1.0930
 86%|████████▌ | 103/120 [31:14<05:10, 18.25s/it]epoch [103/120], kd_loss:1.0856
 87%|████████▋ | 104/120 [31:30<04:42, 17.68s/it]epoch [104/120], kd_loss:1.0755
 88%|████████▊ | 105/120 [31:47<04:19, 17.27s/it]epoch [105/120], kd_loss:1.0762
 88%|████████▊ | 106/120 [32:03<03:57, 16.99s/it]epoch [106/120], kd_loss:1.0711
 89%|████████▉ | 107/120 [32:19<03:38, 16.81s/it]epoch [107/120], kd_loss:1.0733
 90%|█████████ | 108/120 [32:36<03:20, 16.72s/it]epoch [108/120], kd_loss:1.0595
 91%|█████████ | 109/120 [32:52<03:03, 16.64s/it]epoch [109/120], kd_loss:1.0579
 92%|█████████▏| 110/120 [33:30<03:50, 23.02s/it]epoch [110/120], kd_loss:1.0535
normal: 0.6518 1.0770  anomaly: 0.7346 1.6907
thresh: 0.8465122400798116
fpr: 0.2 fnr 0.13
Pixel Auroc:0.983, Sample Auroc0.919, Pixel Aupro0.0
 92%|█████████▎| 111/120 [33:47<03:09, 21.00s/it]epoch [111/120], kd_loss:1.0521
 93%|█████████▎| 112/120 [34:03<02:36, 19.57s/it]epoch [112/120], kd_loss:1.0513
 94%|█████████▍| 113/120 [34:19<02:10, 18.63s/it]epoch [113/120], kd_loss:1.0496
 95%|█████████▌| 114/120 [34:36<01:48, 18.04s/it]epoch [114/120], kd_loss:1.0474
 96%|█████████▌| 115/120 [34:52<01:27, 17.56s/it]epoch [115/120], kd_loss:1.0462
 97%|█████████▋| 116/120 [35:09<01:08, 17.22s/it]epoch [116/120], kd_loss:1.0462
 98%|█████████▊| 117/120 [35:25<00:51, 17.03s/it]epoch [117/120], kd_loss:1.0456
 98%|█████████▊| 118/120 [35:42<00:33, 16.88s/it]epoch [118/120], kd_loss:1.0469
 99%|█████████▉| 119/120 [35:58<00:16, 16.71s/it]epoch [119/120], kd_loss:1.0442
100%|██████████| 120/120 [36:36<00:00, 22.97s/it]100%|██████████| 120/120 [36:36<00:00, 18.30s/it]
epoch [120/120], kd_loss:1.0434
normal: 0.6315 1.0607  anomaly: 0.7250 1.6869
thresh: 0.8770097924188098
fpr: 0.09 fnr 0.23
Pixel Auroc:0.982, Sample Auroc0.910, Pixel Aupro0.0
training Advanced Teacher...
macaroni2
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:47<1:18:38, 47.66s/it]epoch [1/100], focal_loss:0.0583	, anomaly_loss:0.5462	fnorm_loss:0.0630, a_fnorm_loss:0.0125P:0.00, R:0.01
normal: 0.1849 0.1928  anomaly: 0.1866 0.1923	P:0.00, R:0.00
Pixel Auroc:0.899, Sample Auroc0.484, Pixel Aupro0.0
test_fnorm_loss: 0.0514 test_afnorm_loss: 0.0106
  2%|▏         | 2/100 [01:09<53:27, 32.73s/it]  epoch [2/100], focal_loss:0.0354	, anomaly_loss:0.6039	fnorm_loss:0.0444, a_fnorm_loss:0.0089P:0.00, R:0.00
  3%|▎         | 3/100 [01:33<45:50, 28.35s/it]epoch [3/100], focal_loss:0.0296	, anomaly_loss:0.6336	fnorm_loss:0.0363, a_fnorm_loss:0.0074P:0.00, R:0.00
  4%|▍         | 4/100 [01:55<41:55, 26.20s/it]epoch [4/100], focal_loss:0.0280	, anomaly_loss:0.5384	fnorm_loss:0.0318, a_fnorm_loss:0.0232P:0.06, R:0.21
  5%|▌         | 5/100 [02:40<51:50, 32.74s/it]epoch [5/100], focal_loss:0.0221	, anomaly_loss:0.4897	fnorm_loss:0.0250, a_fnorm_loss:0.0334P:0.09, R:0.31
normal: 0.0988 0.2668  anomaly: 0.1008 0.2682	P:0.00, R:0.00
Pixel Auroc:0.957, Sample Auroc0.653, Pixel Aupro0.0
test_fnorm_loss: 0.0225 test_afnorm_loss: 0.0054
  6%|▌         | 6/100 [03:02<45:54, 29.30s/it]epoch [6/100], focal_loss:0.0204	, anomaly_loss:0.4407	fnorm_loss:0.0215, a_fnorm_loss:0.0371P:0.15, R:0.45
  7%|▋         | 7/100 [03:25<42:01, 27.11s/it]epoch [7/100], focal_loss:0.0180	, anomaly_loss:0.3857	fnorm_loss:0.0172, a_fnorm_loss:0.0400P:0.21, R:0.62
  8%|▊         | 8/100 [03:48<39:28, 25.75s/it]epoch [8/100], focal_loss:0.0160	, anomaly_loss:0.3758	fnorm_loss:0.0147, a_fnorm_loss:0.0401P:0.22, R:0.62
  9%|▉         | 9/100 [04:11<37:40, 24.85s/it]epoch [9/100], focal_loss:0.0127	, anomaly_loss:0.2990	fnorm_loss:0.0129, a_fnorm_loss:0.0447P:0.34, R:0.86
 10%|█         | 10/100 [04:54<46:01, 30.68s/it]epoch [10/100], focal_loss:0.0112	, anomaly_loss:0.2797	fnorm_loss:0.0118, a_fnorm_loss:0.0451P:0.36, R:0.91
normal: 0.0452 0.2880  anomaly: 0.0491 0.3813	P:0.00, R:0.00
Pixel Auroc:0.965, Sample Auroc0.665, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0035
 11%|█         | 11/100 [05:18<42:10, 28.43s/it]epoch [11/100], focal_loss:0.0092	, anomaly_loss:0.2668	fnorm_loss:0.0108, a_fnorm_loss:0.0467P:0.39, R:0.93
 12%|█▏        | 12/100 [05:40<38:59, 26.58s/it]epoch [12/100], focal_loss:0.0088	, anomaly_loss:0.2621	fnorm_loss:0.0100, a_fnorm_loss:0.0473P:0.40, R:0.94
 13%|█▎        | 13/100 [06:02<36:37, 25.26s/it]epoch [13/100], focal_loss:0.0083	, anomaly_loss:0.2589	fnorm_loss:0.0095, a_fnorm_loss:0.0481P:0.42, R:0.94
 14%|█▍        | 14/100 [06:25<34:50, 24.31s/it]epoch [14/100], focal_loss:0.0079	, anomaly_loss:0.2526	fnorm_loss:0.0090, a_fnorm_loss:0.0476P:0.43, R:0.94
 15%|█▌        | 15/100 [07:13<44:35, 31.48s/it]epoch [15/100], focal_loss:0.0072	, anomaly_loss:0.2503	fnorm_loss:0.0086, a_fnorm_loss:0.0478P:0.42, R:0.94
normal: 0.0365 0.3449  anomaly: 0.0382 0.3646	P:0.00, R:0.00
Pixel Auroc:0.964, Sample Auroc0.654, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0065
 16%|█▌        | 16/100 [07:36<40:29, 28.92s/it]epoch [16/100], focal_loss:0.0066	, anomaly_loss:0.2494	fnorm_loss:0.0082, a_fnorm_loss:0.0491P:0.43, R:0.95
 17%|█▋        | 17/100 [07:58<37:22, 27.02s/it]epoch [17/100], focal_loss:0.0091	, anomaly_loss:0.2674	fnorm_loss:0.0083, a_fnorm_loss:0.0459P:0.40, R:0.91
 18%|█▊        | 18/100 [08:20<34:47, 25.46s/it]epoch [18/100], focal_loss:0.0073	, anomaly_loss:0.2491	fnorm_loss:0.0078, a_fnorm_loss:0.0476P:0.41, R:0.94
 19%|█▉        | 19/100 [08:42<33:09, 24.56s/it]epoch [19/100], focal_loss:0.0077	, anomaly_loss:0.2504	fnorm_loss:0.0077, a_fnorm_loss:0.0477P:0.44, R:0.94
 20%|██        | 20/100 [09:31<42:11, 31.64s/it]epoch [20/100], focal_loss:0.0067	, anomaly_loss:0.2445	fnorm_loss:0.0075, a_fnorm_loss:0.0483P:0.44, R:0.94
normal: 0.0993 0.5141  anomaly: 0.1052 0.4832	P:0.00, R:0.00
Pixel Auroc:0.948, Sample Auroc0.629, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0145
 21%|██        | 21/100 [09:53<37:51, 28.76s/it]epoch [21/100], focal_loss:0.0068	, anomaly_loss:0.2480	fnorm_loss:0.0073, a_fnorm_loss:0.0485P:0.43, R:0.94
 22%|██▏       | 22/100 [10:16<35:08, 27.03s/it]epoch [22/100], focal_loss:0.0060	, anomaly_loss:0.2457	fnorm_loss:0.0071, a_fnorm_loss:0.0509P:0.46, R:0.95
 23%|██▎       | 23/100 [10:38<32:56, 25.67s/it]epoch [23/100], focal_loss:0.0075	, anomaly_loss:0.2607	fnorm_loss:0.0071, a_fnorm_loss:0.0483P:0.46, R:0.92
 24%|██▍       | 24/100 [11:01<31:16, 24.69s/it]epoch [24/100], focal_loss:0.0065	, anomaly_loss:0.2432	fnorm_loss:0.0069, a_fnorm_loss:0.0486P:0.42, R:0.94
 25%|██▌       | 25/100 [11:44<38:00, 30.41s/it]epoch [25/100], focal_loss:0.0063	, anomaly_loss:0.2401	fnorm_loss:0.0068, a_fnorm_loss:0.0496P:0.47, R:0.94
normal: 0.0378 0.3262  anomaly: 0.0399 0.3397	P:0.00, R:0.00
Pixel Auroc:0.959, Sample Auroc0.633, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0096
 26%|██▌       | 26/100 [12:07<34:30, 27.98s/it]epoch [26/100], focal_loss:0.0057	, anomaly_loss:0.2374	fnorm_loss:0.0067, a_fnorm_loss:0.0508P:0.47, R:0.96
 27%|██▋       | 27/100 [12:29<31:50, 26.17s/it]epoch [27/100], focal_loss:0.0056	, anomaly_loss:0.2413	fnorm_loss:0.0066, a_fnorm_loss:0.0502P:0.48, R:0.96
 28%|██▊       | 28/100 [12:51<29:55, 24.94s/it]epoch [28/100], focal_loss:0.0059	, anomaly_loss:0.2404	fnorm_loss:0.0065, a_fnorm_loss:0.0497P:0.46, R:0.95
 29%|██▉       | 29/100 [13:12<28:22, 23.97s/it]epoch [29/100], focal_loss:0.0058	, anomaly_loss:0.2306	fnorm_loss:0.0065, a_fnorm_loss:0.0503P:0.42, R:0.96
 30%|███       | 30/100 [14:01<36:28, 31.27s/it]epoch [30/100], focal_loss:0.0054	, anomaly_loss:0.2371	fnorm_loss:0.0064, a_fnorm_loss:0.0509P:0.50, R:0.96
normal: 0.0563 0.4061  anomaly: 0.0680 0.5096	P:0.00, R:0.00
Pixel Auroc:0.955, Sample Auroc0.659, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0169
 31%|███       | 31/100 [14:22<32:36, 28.35s/it]epoch [31/100], focal_loss:0.0055	, anomaly_loss:0.2379	fnorm_loss:0.0064, a_fnorm_loss:0.0519P:0.47, R:0.96
 32%|███▏      | 32/100 [14:44<29:56, 26.41s/it]epoch [32/100], focal_loss:0.0059	, anomaly_loss:0.2390	fnorm_loss:0.0063, a_fnorm_loss:0.0505P:0.47, R:0.96
 33%|███▎      | 33/100 [15:06<27:53, 24.98s/it]epoch [33/100], focal_loss:0.0058	, anomaly_loss:0.2406	fnorm_loss:0.0063, a_fnorm_loss:0.0505P:0.46, R:0.96
 34%|███▍      | 34/100 [15:27<26:08, 23.76s/it]epoch [34/100], focal_loss:0.0060	, anomaly_loss:0.2367	fnorm_loss:0.0063, a_fnorm_loss:0.0505P:0.47, R:0.96
 35%|███▌      | 35/100 [16:08<31:26, 29.02s/it]epoch [35/100], focal_loss:0.0054	, anomaly_loss:0.2357	fnorm_loss:0.0062, a_fnorm_loss:0.0511P:0.46, R:0.96
normal: 0.0231 0.2781  anomaly: 0.0248 0.3776	P:0.00, R:0.00
Pixel Auroc:0.967, Sample Auroc0.636, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0030
 36%|███▌      | 36/100 [16:29<28:25, 26.65s/it]epoch [36/100], focal_loss:0.0064	, anomaly_loss:0.2488	fnorm_loss:0.0063, a_fnorm_loss:0.0494P:0.45, R:0.94
 37%|███▋      | 37/100 [16:50<26:14, 25.00s/it]epoch [37/100], focal_loss:0.0058	, anomaly_loss:0.2388	fnorm_loss:0.0063, a_fnorm_loss:0.0508P:0.47, R:0.96
 38%|███▊      | 38/100 [17:12<24:50, 24.04s/it]epoch [38/100], focal_loss:0.0056	, anomaly_loss:0.2418	fnorm_loss:0.0062, a_fnorm_loss:0.0502P:0.47, R:0.95
 39%|███▉      | 39/100 [17:33<23:32, 23.16s/it]epoch [39/100], focal_loss:0.0056	, anomaly_loss:0.2331	fnorm_loss:0.0062, a_fnorm_loss:0.0508P:0.49, R:0.96
 40%|████      | 40/100 [18:15<28:39, 28.65s/it]epoch [40/100], focal_loss:0.0054	, anomaly_loss:0.2343	fnorm_loss:0.0062, a_fnorm_loss:0.0503P:0.47, R:0.96
normal: 0.0256 0.3648  anomaly: 0.0321 0.5570	P:0.00, R:0.00
Pixel Auroc:0.949, Sample Auroc0.644, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0139
 41%|████      | 41/100 [18:36<26:02, 26.48s/it]epoch [41/100], focal_loss:0.0057	, anomaly_loss:0.2335	fnorm_loss:0.0062, a_fnorm_loss:0.0505P:0.50, R:0.96
 42%|████▏     | 42/100 [18:57<24:06, 24.94s/it]epoch [42/100], focal_loss:0.0056	, anomaly_loss:0.2286	fnorm_loss:0.0061, a_fnorm_loss:0.0512P:0.48, R:0.96
 43%|████▎     | 43/100 [19:19<22:52, 24.08s/it]epoch [43/100], focal_loss:0.0060	, anomaly_loss:0.2396	fnorm_loss:0.0062, a_fnorm_loss:0.0499P:0.45, R:0.95
 44%|████▍     | 44/100 [19:41<21:54, 23.48s/it]epoch [44/100], focal_loss:0.0059	, anomaly_loss:0.2425	fnorm_loss:0.0061, a_fnorm_loss:0.0506P:0.49, R:0.95
 45%|████▌     | 45/100 [20:23<26:29, 28.90s/it]epoch [45/100], focal_loss:0.0053	, anomaly_loss:0.2281	fnorm_loss:0.0061, a_fnorm_loss:0.0509P:0.50, R:0.96
normal: 0.0365 0.3623  anomaly: 0.0508 0.3720	P:0.00, R:0.00
Pixel Auroc:0.948, Sample Auroc0.612, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0127
 46%|████▌     | 46/100 [20:45<24:06, 26.79s/it]epoch [46/100], focal_loss:0.0055	, anomaly_loss:0.2387	fnorm_loss:0.0061, a_fnorm_loss:0.0509P:0.51, R:0.95
 47%|████▋     | 47/100 [21:08<22:34, 25.55s/it]epoch [47/100], focal_loss:0.0056	, anomaly_loss:0.2390	fnorm_loss:0.0061, a_fnorm_loss:0.0501P:0.45, R:0.95
 48%|████▊     | 48/100 [21:29<21:02, 24.29s/it]epoch [48/100], focal_loss:0.0053	, anomaly_loss:0.2341	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.49, R:0.97
 49%|████▉     | 49/100 [21:50<19:55, 23.45s/it]epoch [49/100], focal_loss:0.0053	, anomaly_loss:0.2399	fnorm_loss:0.0060, a_fnorm_loss:0.0512P:0.49, R:0.96
 50%|█████     | 50/100 [22:32<24:03, 28.87s/it]epoch [50/100], focal_loss:0.0055	, anomaly_loss:0.2386	fnorm_loss:0.0061, a_fnorm_loss:0.0504P:0.48, R:0.95
normal: 0.0371 0.3936  anomaly: 0.0585 0.4964	P:0.00, R:0.00
Pixel Auroc:0.951, Sample Auroc0.648, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0144
 51%|█████     | 51/100 [22:53<21:41, 26.56s/it]epoch [51/100], focal_loss:0.0063	, anomaly_loss:0.2526	fnorm_loss:0.0062, a_fnorm_loss:0.0488P:0.50, R:0.92
 52%|█████▏    | 52/100 [23:14<20:00, 25.02s/it]epoch [52/100], focal_loss:0.0055	, anomaly_loss:0.2369	fnorm_loss:0.0061, a_fnorm_loss:0.0512P:0.47, R:0.96
 53%|█████▎    | 53/100 [23:36<18:47, 24.00s/it]epoch [53/100], focal_loss:0.0052	, anomaly_loss:0.2334	fnorm_loss:0.0061, a_fnorm_loss:0.0513P:0.49, R:0.96
 54%|█████▍    | 54/100 [23:57<17:40, 23.05s/it]epoch [54/100], focal_loss:0.0050	, anomaly_loss:0.2322	fnorm_loss:0.0060, a_fnorm_loss:0.0513P:0.47, R:0.96
 55%|█████▌    | 55/100 [24:38<21:17, 28.39s/it]epoch [55/100], focal_loss:0.0052	, anomaly_loss:0.2301	fnorm_loss:0.0060, a_fnorm_loss:0.0512P:0.50, R:0.96
normal: 0.0304 0.3478  anomaly: 0.0269 0.5165	P:0.00, R:0.00
Pixel Auroc:0.953, Sample Auroc0.643, Pixel Aupro0.0
test_fnorm_loss: 0.0058 test_afnorm_loss: 0.0173
 56%|█████▌    | 56/100 [24:59<19:18, 26.33s/it]epoch [56/100], focal_loss:0.0053	, anomaly_loss:0.2441	fnorm_loss:0.0060, a_fnorm_loss:0.0510P:0.48, R:0.95
 57%|█████▋    | 57/100 [25:21<17:46, 24.80s/it]epoch [57/100], focal_loss:0.0056	, anomaly_loss:0.2358	fnorm_loss:0.0061, a_fnorm_loss:0.0505P:0.46, R:0.96
 58%|█████▊    | 58/100 [25:42<16:39, 23.80s/it]epoch [58/100], focal_loss:0.0053	, anomaly_loss:0.2305	fnorm_loss:0.0060, a_fnorm_loss:0.0515P:0.49, R:0.97
 59%|█████▉    | 59/100 [26:04<15:49, 23.15s/it]epoch [59/100], focal_loss:0.0048	, anomaly_loss:0.2265	fnorm_loss:0.0060, a_fnorm_loss:0.0519P:0.50, R:0.97
 60%|██████    | 60/100 [26:47<19:34, 29.36s/it]epoch [60/100], focal_loss:0.0050	, anomaly_loss:0.2294	fnorm_loss:0.0060, a_fnorm_loss:0.0519P:0.52, R:0.97
normal: 0.0226 0.3106  anomaly: 0.0236 0.5439	P:0.00, R:0.00
Pixel Auroc:0.967, Sample Auroc0.653, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0034
 61%|██████    | 61/100 [27:08<17:26, 26.83s/it]epoch [61/100], focal_loss:0.0051	, anomaly_loss:0.2324	fnorm_loss:0.0060, a_fnorm_loss:0.0516P:0.51, R:0.96
 62%|██████▏   | 62/100 [27:30<15:54, 25.12s/it]epoch [62/100], focal_loss:0.0060	, anomaly_loss:0.2364	fnorm_loss:0.0061, a_fnorm_loss:0.0499P:0.49, R:0.95
 63%|██████▎   | 63/100 [27:52<14:58, 24.28s/it]epoch [63/100], focal_loss:0.0056	, anomaly_loss:0.2459	fnorm_loss:0.0061, a_fnorm_loss:0.0503P:0.51, R:0.95
 64%|██████▍   | 64/100 [28:14<14:06, 23.50s/it]epoch [64/100], focal_loss:0.0051	, anomaly_loss:0.2272	fnorm_loss:0.0060, a_fnorm_loss:0.0512P:0.52, R:0.97
 65%|██████▌   | 65/100 [28:55<16:49, 28.83s/it]epoch [65/100], focal_loss:0.0055	, anomaly_loss:0.2309	fnorm_loss:0.0060, a_fnorm_loss:0.0516P:0.50, R:0.96
normal: 0.0232 0.2612  anomaly: 0.0230 0.4515	P:0.00, R:0.00
Pixel Auroc:0.960, Sample Auroc0.632, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0031
 66%|██████▌   | 66/100 [29:16<14:58, 26.44s/it]epoch [66/100], focal_loss:0.0052	, anomaly_loss:0.2308	fnorm_loss:0.0060, a_fnorm_loss:0.0506P:0.50, R:0.96
 67%|██████▋   | 67/100 [29:37<13:45, 25.02s/it]epoch [67/100], focal_loss:0.0051	, anomaly_loss:0.2328	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.50, R:0.96
 68%|██████▊   | 68/100 [29:59<12:50, 24.06s/it]epoch [68/100], focal_loss:0.0056	, anomaly_loss:0.2345	fnorm_loss:0.0061, a_fnorm_loss:0.0510P:0.51, R:0.96
 69%|██████▉   | 69/100 [30:20<11:56, 23.11s/it]epoch [69/100], focal_loss:0.0048	, anomaly_loss:0.2255	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.49, R:0.97
 70%|███████   | 70/100 [31:02<14:26, 28.90s/it]epoch [70/100], focal_loss:0.0055	, anomaly_loss:0.2364	fnorm_loss:0.0060, a_fnorm_loss:0.0505P:0.48, R:0.95
normal: 0.2049 0.5901  anomaly: 0.1964 0.5834	P:0.00, R:0.01
Pixel Auroc:0.931, Sample Auroc0.581, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0293
 71%|███████   | 71/100 [31:24<12:51, 26.60s/it]epoch [71/100], focal_loss:0.0057	, anomaly_loss:0.2360	fnorm_loss:0.0061, a_fnorm_loss:0.0500P:0.46, R:0.93
 72%|███████▏  | 72/100 [31:46<11:45, 25.18s/it]epoch [72/100], focal_loss:0.0050	, anomaly_loss:0.2332	fnorm_loss:0.0060, a_fnorm_loss:0.0512P:0.50, R:0.96
 73%|███████▎  | 73/100 [32:06<10:43, 23.84s/it]epoch [73/100], focal_loss:0.0050	, anomaly_loss:0.2220	fnorm_loss:0.0060, a_fnorm_loss:0.0522P:0.51, R:0.97
 74%|███████▍  | 74/100 [32:28<10:01, 23.15s/it]epoch [74/100], focal_loss:0.0050	, anomaly_loss:0.2322	fnorm_loss:0.0060, a_fnorm_loss:0.0514P:0.52, R:0.96
 75%|███████▌  | 75/100 [33:09<11:54, 28.57s/it]epoch [75/100], focal_loss:0.0053	, anomaly_loss:0.2291	fnorm_loss:0.0060, a_fnorm_loss:0.0510P:0.50, R:0.96
normal: 0.0257 0.3896  anomaly: 0.0358 0.4375	P:0.00, R:0.00
Pixel Auroc:0.946, Sample Auroc0.652, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0072
 76%|███████▌  | 76/100 [33:31<10:34, 26.44s/it]epoch [76/100], focal_loss:0.0049	, anomaly_loss:0.2315	fnorm_loss:0.0060, a_fnorm_loss:0.0523P:0.50, R:0.97
 77%|███████▋  | 77/100 [33:51<09:29, 24.78s/it]epoch [77/100], focal_loss:0.0051	, anomaly_loss:0.2295	fnorm_loss:0.0060, a_fnorm_loss:0.0515P:0.49, R:0.97
 78%|███████▊  | 78/100 [34:13<08:42, 23.76s/it]epoch [78/100], focal_loss:0.0059	, anomaly_loss:0.2356	fnorm_loss:0.0061, a_fnorm_loss:0.0506P:0.52, R:0.95
 79%|███████▉  | 79/100 [34:34<07:59, 22.85s/it]epoch [79/100], focal_loss:0.0047	, anomaly_loss:0.2328	fnorm_loss:0.0060, a_fnorm_loss:0.0515P:0.52, R:0.97
 80%|████████  | 80/100 [35:14<09:24, 28.22s/it]epoch [80/100], focal_loss:0.0054	, anomaly_loss:0.2392	fnorm_loss:0.0060, a_fnorm_loss:0.0504P:0.49, R:0.96
normal: 0.0564 0.4246  anomaly: 0.0508 0.5869	P:0.00, R:0.00
Pixel Auroc:0.949, Sample Auroc0.668, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0191
 81%|████████  | 81/100 [35:36<08:18, 26.24s/it]epoch [81/100], focal_loss:0.0050	, anomaly_loss:0.2346	fnorm_loss:0.0060, a_fnorm_loss:0.0515P:0.50, R:0.96
 82%|████████▏ | 82/100 [35:57<07:25, 24.76s/it]epoch [82/100], focal_loss:0.0049	, anomaly_loss:0.2318	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.51, R:0.96
 83%|████████▎ | 83/100 [36:19<06:45, 23.86s/it]epoch [83/100], focal_loss:0.0047	, anomaly_loss:0.2254	fnorm_loss:0.0060, a_fnorm_loss:0.0518P:0.51, R:0.97
 84%|████████▍ | 84/100 [36:40<06:08, 23.05s/it]epoch [84/100], focal_loss:0.0047	, anomaly_loss:0.2305	fnorm_loss:0.0059, a_fnorm_loss:0.0517P:0.49, R:0.97
 85%|████████▌ | 85/100 [37:24<07:19, 29.32s/it]epoch [85/100], focal_loss:0.0046	, anomaly_loss:0.2310	fnorm_loss:0.0060, a_fnorm_loss:0.0515P:0.50, R:0.97
normal: 0.0251 0.3289  anomaly: 0.0257 0.4863	P:0.00, R:0.00
Pixel Auroc:0.958, Sample Auroc0.643, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0072
 86%|████████▌ | 86/100 [37:45<06:14, 26.77s/it]epoch [86/100], focal_loss:0.0047	, anomaly_loss:0.2322	fnorm_loss:0.0060, a_fnorm_loss:0.0521P:0.53, R:0.97
 87%|████████▋ | 87/100 [38:06<05:26, 25.13s/it]epoch [87/100], focal_loss:0.0051	, anomaly_loss:0.2238	fnorm_loss:0.0060, a_fnorm_loss:0.0512P:0.50, R:0.95
 88%|████████▊ | 88/100 [38:28<04:48, 24.08s/it]epoch [88/100], focal_loss:0.0049	, anomaly_loss:0.2302	fnorm_loss:0.0060, a_fnorm_loss:0.0514P:0.48, R:0.95
 89%|████████▉ | 89/100 [38:50<04:17, 23.37s/it]epoch [89/100], focal_loss:0.0045	, anomaly_loss:0.2312	fnorm_loss:0.0060, a_fnorm_loss:0.0517P:0.51, R:0.97
 90%|█████████ | 90/100 [39:32<04:52, 29.23s/it]epoch [90/100], focal_loss:0.0046	, anomaly_loss:0.2353	fnorm_loss:0.0059, a_fnorm_loss:0.0522P:0.53, R:0.97
normal: 0.0264 0.3334  anomaly: 0.0281 0.4888	P:0.00, R:0.00
Pixel Auroc:0.955, Sample Auroc0.634, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0069
 91%|█████████ | 91/100 [39:54<04:03, 27.03s/it]epoch [91/100], focal_loss:0.0044	, anomaly_loss:0.2247	fnorm_loss:0.0059, a_fnorm_loss:0.0514P:0.53, R:0.97
 92%|█████████▏| 92/100 [40:15<03:21, 25.20s/it]epoch [92/100], focal_loss:0.0047	, anomaly_loss:0.2239	fnorm_loss:0.0059, a_fnorm_loss:0.0515P:0.50, R:0.95
 93%|█████████▎| 93/100 [40:37<02:48, 24.00s/it]epoch [93/100], focal_loss:0.0046	, anomaly_loss:0.2231	fnorm_loss:0.0060, a_fnorm_loss:0.0526P:0.50, R:0.97
 94%|█████████▍| 94/100 [40:58<02:18, 23.11s/it]epoch [94/100], focal_loss:0.0044	, anomaly_loss:0.2261	fnorm_loss:0.0059, a_fnorm_loss:0.0522P:0.52, R:0.97
 95%|█████████▌| 95/100 [41:40<02:24, 28.96s/it]epoch [95/100], focal_loss:0.0046	, anomaly_loss:0.2309	fnorm_loss:0.0059, a_fnorm_loss:0.0518P:0.52, R:0.97
normal: 0.0270 0.3665  anomaly: 0.0310 0.5092	P:0.00, R:0.00
Pixel Auroc:0.954, Sample Auroc0.653, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0086
 96%|█████████▌| 96/100 [42:01<01:46, 26.63s/it]epoch [96/100], focal_loss:0.0046	, anomaly_loss:0.2265	fnorm_loss:0.0059, a_fnorm_loss:0.0521P:0.53, R:0.97
 97%|█████████▋| 97/100 [42:23<01:15, 25.09s/it]epoch [97/100], focal_loss:0.0050	, anomaly_loss:0.2380	fnorm_loss:0.0060, a_fnorm_loss:0.0510P:0.51, R:0.96
 98%|█████████▊| 98/100 [42:45<00:48, 24.13s/it]epoch [98/100], focal_loss:0.0048	, anomaly_loss:0.2216	fnorm_loss:0.0060, a_fnorm_loss:0.0514P:0.51, R:0.95
 99%|█████████▉| 99/100 [43:06<00:23, 23.25s/it]epoch [99/100], focal_loss:0.0045	, anomaly_loss:0.2241	fnorm_loss:0.0060, a_fnorm_loss:0.0524P:0.51, R:0.97
100%|██████████| 100/100 [43:49<00:00, 29.20s/it]100%|██████████| 100/100 [43:49<00:00, 26.29s/it]
epoch [100/100], focal_loss:0.0047	, anomaly_loss:0.2291	fnorm_loss:0.0060, a_fnorm_loss:0.0520P:0.51, R:0.97
normal: 0.0277 0.3479  anomaly: 0.0291 0.5044	P:0.00, R:0.00
Pixel Auroc:0.953, Sample Auroc0.646, Pixel Aupro0.0
test_fnorm_loss: 0.0057 test_afnorm_loss: 0.0088
training Stubborn Student...
macaroni2
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<32:06, 16.19s/it]epoch [1/120], kd_loss:3.7284
  2%|▏         | 2/120 [00:32<31:55, 16.24s/it]epoch [2/120], kd_loss:2.4217
  2%|▎         | 3/120 [00:48<31:44, 16.28s/it]epoch [3/120], kd_loss:1.9967
  3%|▎         | 4/120 [01:05<31:33, 16.32s/it]epoch [4/120], kd_loss:1.8389
  4%|▍         | 5/120 [01:21<31:23, 16.38s/it]epoch [5/120], kd_loss:1.7066
  5%|▌         | 6/120 [01:38<31:09, 16.40s/it]epoch [6/120], kd_loss:1.7321
  6%|▌         | 7/120 [01:54<30:56, 16.43s/it]epoch [7/120], kd_loss:1.6442
  7%|▋         | 8/120 [02:11<30:40, 16.43s/it]epoch [8/120], kd_loss:1.5320
  8%|▊         | 9/120 [02:27<30:23, 16.43s/it]epoch [9/120], kd_loss:1.4935
  8%|▊         | 10/120 [03:03<41:21, 22.56s/it]epoch [10/120], kd_loss:1.4543
normal: 0.9066 1.2781  anomaly: 0.9528 1.8217
thresh: 1.1684774613834217
fpr: 0.18 fnr 0.32
Pixel Auroc:0.961, Sample Auroc0.791, Pixel Aupro0.0
  9%|▉         | 11/120 [03:19<37:26, 20.61s/it]epoch [11/120], kd_loss:1.6654
 10%|█         | 12/120 [03:36<34:47, 19.33s/it]epoch [12/120], kd_loss:1.4296
 11%|█         | 13/120 [03:52<32:52, 18.43s/it]epoch [13/120], kd_loss:1.5177
 12%|█▏        | 14/120 [04:09<31:34, 17.87s/it]epoch [14/120], kd_loss:1.7214
 12%|█▎        | 15/120 [04:25<30:29, 17.43s/it]epoch [15/120], kd_loss:1.4483
 13%|█▎        | 16/120 [04:42<29:40, 17.12s/it]epoch [16/120], kd_loss:1.4536
 14%|█▍        | 17/120 [04:58<29:02, 16.92s/it]epoch [17/120], kd_loss:1.4730
 15%|█▌        | 18/120 [05:14<28:29, 16.76s/it]epoch [18/120], kd_loss:1.7712
 16%|█▌        | 19/120 [05:31<28:02, 16.66s/it]epoch [19/120], kd_loss:1.7100
 17%|█▋        | 20/120 [06:07<37:23, 22.44s/it]epoch [20/120], kd_loss:1.6529
normal: 1.0004 1.4839  anomaly: 1.0492 1.7974
thresh: 1.1142016743311143
fpr: 0.61 fnr 0.07
Pixel Auroc:0.951, Sample Auroc0.771, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:23<33:54, 20.55s/it]epoch [21/120], kd_loss:1.7300
 18%|█▊        | 22/120 [06:39<31:28, 19.27s/it]epoch [22/120], kd_loss:1.6200
 19%|█▉        | 23/120 [06:56<29:45, 18.41s/it]epoch [23/120], kd_loss:1.5435
 20%|██        | 24/120 [07:12<28:28, 17.80s/it]epoch [24/120], kd_loss:1.5138
 21%|██        | 25/120 [07:28<27:31, 17.38s/it]epoch [25/120], kd_loss:1.5465
 22%|██▏       | 26/120 [07:45<26:46, 17.09s/it]epoch [26/120], kd_loss:1.5078
 22%|██▎       | 27/120 [08:01<26:09, 16.88s/it]epoch [27/120], kd_loss:1.4576
 23%|██▎       | 28/120 [08:18<25:39, 16.74s/it]epoch [28/120], kd_loss:1.4584
 24%|██▍       | 29/120 [08:34<25:16, 16.66s/it]epoch [29/120], kd_loss:1.4229
 25%|██▌       | 30/120 [09:09<33:18, 22.21s/it]epoch [30/120], kd_loss:1.4036
normal: 0.8961 1.3365  anomaly: 0.9189 1.7873
thresh: 1.0450645324175807
fpr: 0.51 fnr 0.16
Pixel Auroc:0.960, Sample Auroc0.773, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:25<30:16, 20.40s/it]epoch [31/120], kd_loss:1.4005
 27%|██▋       | 32/120 [09:42<28:08, 19.18s/it]epoch [32/120], kd_loss:1.4107
 28%|██▊       | 33/120 [09:58<26:34, 18.32s/it]epoch [33/120], kd_loss:1.4491
 28%|██▊       | 34/120 [10:14<25:24, 17.73s/it]epoch [34/120], kd_loss:1.4162
 29%|██▉       | 35/120 [10:31<24:31, 17.32s/it]epoch [35/120], kd_loss:1.4660
 30%|███       | 36/120 [10:47<23:51, 17.04s/it]epoch [36/120], kd_loss:1.3878
 31%|███       | 37/120 [11:04<23:19, 16.86s/it]epoch [37/120], kd_loss:1.3854
 32%|███▏      | 38/120 [11:20<22:51, 16.73s/it]epoch [38/120], kd_loss:1.3633
 32%|███▎      | 39/120 [11:36<22:29, 16.66s/it]epoch [39/120], kd_loss:1.5336
 33%|███▎      | 40/120 [12:14<30:22, 22.78s/it]epoch [40/120], kd_loss:1.4708
normal: 0.9406 1.3818  anomaly: 0.9800 1.7816
thresh: 1.129382895954401
fpr: 0.34 fnr 0.26
Pixel Auroc:0.954, Sample Auroc0.764, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:30<27:26, 20.84s/it]epoch [41/120], kd_loss:1.5698
 35%|███▌      | 42/120 [12:46<25:21, 19.50s/it]epoch [42/120], kd_loss:1.4585
 36%|███▌      | 43/120 [13:03<23:49, 18.57s/it]epoch [43/120], kd_loss:1.4362
 37%|███▋      | 44/120 [13:19<22:41, 17.91s/it]epoch [44/120], kd_loss:1.4023
 38%|███▊      | 45/120 [13:35<21:47, 17.44s/it]epoch [45/120], kd_loss:1.6751
 38%|███▊      | 46/120 [13:52<21:08, 17.14s/it]epoch [46/120], kd_loss:1.4215
 39%|███▉      | 47/120 [14:08<20:33, 16.90s/it]epoch [47/120], kd_loss:1.4531
 40%|████      | 48/120 [14:25<20:07, 16.77s/it]epoch [48/120], kd_loss:1.5527
 41%|████      | 49/120 [14:41<19:42, 16.66s/it]epoch [49/120], kd_loss:1.4906
 42%|████▏     | 50/120 [15:17<26:15, 22.50s/it]epoch [50/120], kd_loss:1.4671
normal: 0.9617 1.4814  anomaly: 0.9570 1.9184
thresh: 1.101078754695802
fpr: 0.6 fnr 0.13
Pixel Auroc:0.955, Sample Auroc0.756, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:33<23:42, 20.61s/it]epoch [51/120], kd_loss:1.4257
 43%|████▎     | 52/120 [15:50<21:53, 19.32s/it]epoch [52/120], kd_loss:1.4006
 44%|████▍     | 53/120 [16:06<20:34, 18.42s/it]epoch [53/120], kd_loss:1.5083
 45%|████▌     | 54/120 [16:22<19:34, 17.80s/it]epoch [54/120], kd_loss:1.5766
 46%|████▌     | 55/120 [16:39<18:49, 17.38s/it]epoch [55/120], kd_loss:1.5483
 47%|████▋     | 56/120 [16:55<18:14, 17.10s/it]epoch [56/120], kd_loss:1.4645
 48%|████▊     | 57/120 [17:12<17:44, 16.89s/it]epoch [57/120], kd_loss:1.4538
 48%|████▊     | 58/120 [17:28<17:17, 16.74s/it]epoch [58/120], kd_loss:1.4280
 49%|████▉     | 59/120 [17:44<16:55, 16.65s/it]epoch [59/120], kd_loss:1.4036
 50%|█████     | 60/120 [18:19<22:10, 22.17s/it]epoch [60/120], kd_loss:1.4002
normal: 0.9169 1.2997  anomaly: 0.9366 1.8310
thresh: 1.0365619532054566
fpr: 0.58 fnr 0.17
Pixel Auroc:0.956, Sample Auroc0.750, Pixel Aupro0.0
 51%|█████     | 61/120 [18:36<20:03, 20.40s/it]epoch [61/120], kd_loss:1.4133
 52%|█████▏    | 62/120 [18:52<18:33, 19.20s/it]epoch [62/120], kd_loss:1.5247
 52%|█████▎    | 63/120 [19:09<17:27, 18.38s/it]epoch [63/120], kd_loss:1.4416
 53%|█████▎    | 64/120 [19:25<16:35, 17.78s/it]epoch [64/120], kd_loss:1.4106
 54%|█████▍    | 65/120 [19:41<15:53, 17.33s/it]epoch [65/120], kd_loss:1.4247
 55%|█████▌    | 66/120 [19:58<15:19, 17.03s/it]epoch [66/120], kd_loss:1.3946
 56%|█████▌    | 67/120 [20:14<14:52, 16.84s/it]epoch [67/120], kd_loss:1.3841
 57%|█████▋    | 68/120 [20:30<14:28, 16.70s/it]epoch [68/120], kd_loss:1.4510
 57%|█████▊    | 69/120 [20:47<14:06, 16.59s/it]epoch [69/120], kd_loss:1.3986
 58%|█████▊    | 70/120 [21:21<18:09, 21.78s/it]epoch [70/120], kd_loss:1.3827
normal: 0.8809 1.3119  anomaly: 0.9302 1.8459
thresh: 0.9856587469908035
fpr: 0.68 fnr 0.07
Pixel Auroc:0.947, Sample Auroc0.767, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:37<16:23, 20.08s/it]epoch [71/120], kd_loss:1.3914
 60%|██████    | 72/120 [21:53<15:08, 18.93s/it]epoch [72/120], kd_loss:1.3940
 61%|██████    | 73/120 [22:09<14:11, 18.13s/it]epoch [73/120], kd_loss:1.4169
 62%|██████▏   | 74/120 [22:25<13:28, 17.57s/it]epoch [74/120], kd_loss:1.3778
 62%|██████▎   | 75/120 [22:42<12:53, 17.19s/it]epoch [75/120], kd_loss:1.3603
 63%|██████▎   | 76/120 [22:58<12:25, 16.93s/it]epoch [76/120], kd_loss:1.3534
 64%|██████▍   | 77/120 [23:14<11:59, 16.74s/it]epoch [77/120], kd_loss:1.3921
 65%|██████▌   | 78/120 [23:31<11:38, 16.62s/it]epoch [78/120], kd_loss:1.3660
 66%|██████▌   | 79/120 [23:47<11:17, 16.53s/it]epoch [79/120], kd_loss:1.3577
 67%|██████▋   | 80/120 [24:21<14:28, 21.71s/it]epoch [80/120], kd_loss:1.3420
normal: 0.8720 1.2430  anomaly: 0.9026 1.8105
thresh: 1.010025703789543
fpr: 0.46 fnr 0.19
Pixel Auroc:0.955, Sample Auroc0.778, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:37<13:01, 20.04s/it]epoch [81/120], kd_loss:1.3461
 68%|██████▊   | 82/120 [24:53<11:59, 18.93s/it]epoch [82/120], kd_loss:1.3763
 69%|██████▉   | 83/120 [25:10<11:10, 18.12s/it]epoch [83/120], kd_loss:1.3428
 70%|███████   | 84/120 [25:26<10:31, 17.55s/it]epoch [84/120], kd_loss:1.4836
 71%|███████   | 85/120 [25:42<10:01, 17.19s/it]epoch [85/120], kd_loss:1.4338
 72%|███████▏  | 86/120 [25:58<09:34, 16.91s/it]epoch [86/120], kd_loss:1.3709
 72%|███████▎  | 87/120 [26:15<09:12, 16.73s/it]epoch [87/120], kd_loss:1.3922
 73%|███████▎  | 88/120 [26:31<08:50, 16.59s/it]epoch [88/120], kd_loss:1.3543
 74%|███████▍  | 89/120 [26:47<08:31, 16.51s/it]epoch [89/120], kd_loss:1.3723
 75%|███████▌  | 90/120 [27:23<11:07, 22.26s/it]epoch [90/120], kd_loss:1.3500
normal: 0.8504 1.2635  anomaly: 0.8912 1.8289
thresh: 1.0510093049055464
fpr: 0.26 fnr 0.27
Pixel Auroc:0.956, Sample Auroc0.788, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:39<09:53, 20.45s/it]epoch [91/120], kd_loss:1.3680
 77%|███████▋  | 92/120 [27:55<08:57, 19.20s/it]epoch [92/120], kd_loss:1.3822
 78%|███████▊  | 93/120 [28:12<08:16, 18.38s/it]epoch [93/120], kd_loss:1.3570
 78%|███████▊  | 94/120 [28:28<07:41, 17.76s/it]epoch [94/120], kd_loss:1.3765
 79%|███████▉  | 95/120 [28:45<07:13, 17.33s/it]epoch [95/120], kd_loss:1.3795
 80%|████████  | 96/120 [29:01<06:49, 17.05s/it]epoch [96/120], kd_loss:1.3857
 81%|████████  | 97/120 [29:17<06:27, 16.86s/it]epoch [97/120], kd_loss:1.3527
 82%|████████▏ | 98/120 [29:34<06:07, 16.70s/it]epoch [98/120], kd_loss:1.3474
 82%|████████▎ | 99/120 [29:50<05:48, 16.58s/it]epoch [99/120], kd_loss:1.3475
 83%|████████▎ | 100/120 [30:24<07:17, 21.89s/it]epoch [100/120], kd_loss:1.3460
normal: 0.8602 1.2906  anomaly: 0.9081 2.0945
thresh: 1.0050036746742446
fpr: 0.48 fnr 0.16
Pixel Auroc:0.956, Sample Auroc0.779, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:40<06:22, 20.15s/it]epoch [101/120], kd_loss:1.3449
 85%|████████▌ | 102/120 [30:57<05:41, 18.98s/it]epoch [102/120], kd_loss:1.3430
 86%|████████▌ | 103/120 [31:13<05:09, 18.21s/it]epoch [103/120], kd_loss:1.3380
 87%|████████▋ | 104/120 [31:29<04:42, 17.67s/it]epoch [104/120], kd_loss:1.3378
 88%|████████▊ | 105/120 [31:46<04:19, 17.30s/it]epoch [105/120], kd_loss:1.3435
 88%|████████▊ | 106/120 [32:02<03:58, 17.03s/it]epoch [106/120], kd_loss:1.3335
 89%|████████▉ | 107/120 [32:19<03:38, 16.84s/it]epoch [107/120], kd_loss:1.3365
 90%|█████████ | 108/120 [32:35<03:20, 16.70s/it]epoch [108/120], kd_loss:1.3281
 91%|█████████ | 109/120 [32:51<03:02, 16.58s/it]epoch [109/120], kd_loss:1.3248
 92%|█████████▏| 110/120 [33:26<03:39, 21.90s/it]epoch [110/120], kd_loss:1.3249
normal: 0.8470 1.4904  anomaly: 0.8559 2.0946
thresh: 1.0112203106829278
fpr: 0.39 fnr 0.21
Pixel Auroc:0.958, Sample Auroc0.790, Pixel Aupro0.0
 92%|█████████▎| 111/120 [33:42<03:02, 20.24s/it]epoch [111/120], kd_loss:1.3232
 93%|█████████▎| 112/120 [33:58<02:32, 19.10s/it]epoch [112/120], kd_loss:1.3242
 94%|█████████▍| 113/120 [34:15<02:08, 18.30s/it]epoch [113/120], kd_loss:1.3252
 95%|█████████▌| 114/120 [34:31<01:46, 17.71s/it]epoch [114/120], kd_loss:1.3209
 96%|█████████▌| 115/120 [34:48<01:26, 17.29s/it]epoch [115/120], kd_loss:1.3222
 97%|█████████▋| 116/120 [35:04<01:08, 17.07s/it]epoch [116/120], kd_loss:1.3194
 98%|█████████▊| 117/120 [35:20<00:50, 16.86s/it]epoch [117/120], kd_loss:1.3200
 98%|█████████▊| 118/120 [35:37<00:33, 16.73s/it]epoch [118/120], kd_loss:1.3183
 99%|█████████▉| 119/120 [35:53<00:16, 16.61s/it]epoch [119/120], kd_loss:1.3177
100%|██████████| 120/120 [36:27<00:00, 21.80s/it]100%|██████████| 120/120 [36:27<00:00, 18.23s/it]
epoch [120/120], kd_loss:1.3181
normal: 0.8430 1.4053  anomaly: 0.8565 2.1048
thresh: 1.0261365123661996
fpr: 0.32 fnr 0.23
Pixel Auroc:0.956, Sample Auroc0.786, Pixel Aupro0.0
training Advanced Teacher...
pcb1
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:45<1:15:34, 45.80s/it]epoch [1/100], focal_loss:0.0591	, anomaly_loss:0.5950	fnorm_loss:0.0590, a_fnorm_loss:0.0141P:0.00, R:0.01
normal: 0.1882 0.1942  anomaly: 0.1870 0.1927	P:0.00, R:0.00
Pixel Auroc:0.790, Sample Auroc0.243, Pixel Aupro0.0
test_fnorm_loss: 0.0484 test_afnorm_loss: 0.0115
  2%|▏         | 2/100 [01:06<51:07, 31.30s/it]  epoch [2/100], focal_loss:0.0392	, anomaly_loss:0.6443	fnorm_loss:0.0422, a_fnorm_loss:0.0102P:0.00, R:0.00
  3%|▎         | 3/100 [01:29<44:12, 27.34s/it]epoch [3/100], focal_loss:0.0358	, anomaly_loss:0.6653	fnorm_loss:0.0353, a_fnorm_loss:0.0093P:0.00, R:0.01
  4%|▍         | 4/100 [01:50<39:59, 25.00s/it]epoch [4/100], focal_loss:0.0337	, anomaly_loss:0.6174	fnorm_loss:0.0321, a_fnorm_loss:0.0168P:0.03, R:0.13
  5%|▌         | 5/100 [02:32<49:03, 30.98s/it]epoch [5/100], focal_loss:0.0295	, anomaly_loss:0.5455	fnorm_loss:0.0256, a_fnorm_loss:0.0277P:0.12, R:0.27
normal: 0.1179 0.2623  anomaly: 0.1228 0.3503	P:0.04, R:0.02
Pixel Auroc:0.945, Sample Auroc0.584, Pixel Aupro0.0
test_fnorm_loss: 0.0213 test_afnorm_loss: 0.0130
  6%|▌         | 6/100 [02:54<43:32, 27.79s/it]epoch [6/100], focal_loss:0.0263	, anomaly_loss:0.5211	fnorm_loss:0.0215, a_fnorm_loss:0.0307P:0.16, R:0.38
  7%|▋         | 7/100 [03:16<40:11, 25.93s/it]epoch [7/100], focal_loss:0.0232	, anomaly_loss:0.4749	fnorm_loss:0.0186, a_fnorm_loss:0.0346P:0.23, R:0.52
  8%|▊         | 8/100 [03:37<37:37, 24.54s/it]epoch [8/100], focal_loss:0.0214	, anomaly_loss:0.4540	fnorm_loss:0.0166, a_fnorm_loss:0.0360P:0.27, R:0.65
  9%|▉         | 9/100 [03:59<35:48, 23.61s/it]epoch [9/100], focal_loss:0.0200	, anomaly_loss:0.4412	fnorm_loss:0.0150, a_fnorm_loss:0.0369P:0.31, R:0.70
 10%|█         | 10/100 [04:42<44:34, 29.72s/it]epoch [10/100], focal_loss:0.0179	, anomaly_loss:0.4244	fnorm_loss:0.0138, a_fnorm_loss:0.0380P:0.31, R:0.74
normal: 0.1670 0.3639  anomaly: 0.1624 0.5026	P:0.05, R:0.07
Pixel Auroc:0.954, Sample Auroc0.703, Pixel Aupro0.0
test_fnorm_loss: 0.0127 test_afnorm_loss: 0.0231
 11%|█         | 11/100 [05:05<41:06, 27.71s/it]epoch [11/100], focal_loss:0.0172	, anomaly_loss:0.4180	fnorm_loss:0.0129, a_fnorm_loss:0.0394P:0.34, R:0.75
 12%|█▏        | 12/100 [05:27<37:55, 25.85s/it]epoch [12/100], focal_loss:0.0165	, anomaly_loss:0.4168	fnorm_loss:0.0122, a_fnorm_loss:0.0393P:0.30, R:0.75
 13%|█▎        | 13/100 [05:49<35:48, 24.69s/it]epoch [13/100], focal_loss:0.0157	, anomaly_loss:0.4048	fnorm_loss:0.0114, a_fnorm_loss:0.0406P:0.34, R:0.78
 14%|█▍        | 14/100 [06:12<34:30, 24.07s/it]epoch [14/100], focal_loss:0.0156	, anomaly_loss:0.4032	fnorm_loss:0.0110, a_fnorm_loss:0.0402P:0.33, R:0.78
 15%|█▌        | 15/100 [06:58<43:30, 30.71s/it]epoch [15/100], focal_loss:0.0161	, anomaly_loss:0.4110	fnorm_loss:0.0107, a_fnorm_loss:0.0396P:0.33, R:0.76
normal: 0.0835 0.3014  anomaly: 0.0921 0.4392	P:0.05, R:0.05
Pixel Auroc:0.952, Sample Auroc0.750, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0207
 16%|█▌        | 16/100 [07:20<39:26, 28.17s/it]epoch [16/100], focal_loss:0.0173	, anomaly_loss:0.4162	fnorm_loss:0.0105, a_fnorm_loss:0.0396P:0.37, R:0.74
 17%|█▋        | 17/100 [07:42<36:09, 26.14s/it]epoch [17/100], focal_loss:0.0147	, anomaly_loss:0.4041	fnorm_loss:0.0100, a_fnorm_loss:0.0414P:0.35, R:0.77
 18%|█▊        | 18/100 [08:03<33:59, 24.87s/it]epoch [18/100], focal_loss:0.0140	, anomaly_loss:0.3972	fnorm_loss:0.0095, a_fnorm_loss:0.0410P:0.33, R:0.78
 19%|█▉        | 19/100 [08:26<32:36, 24.16s/it]epoch [19/100], focal_loss:0.0145	, anomaly_loss:0.4046	fnorm_loss:0.0093, a_fnorm_loss:0.0419P:0.34, R:0.77
 20%|██        | 20/100 [09:08<39:31, 29.65s/it]epoch [20/100], focal_loss:0.0134	, anomaly_loss:0.3917	fnorm_loss:0.0090, a_fnorm_loss:0.0427P:0.35, R:0.80
normal: 0.1346 0.4089  anomaly: 0.1845 0.6347	P:0.05, R:0.09
Pixel Auroc:0.958, Sample Auroc0.727, Pixel Aupro0.0
test_fnorm_loss: 0.0085 test_afnorm_loss: 0.0271
 21%|██        | 21/100 [09:31<36:05, 27.41s/it]epoch [21/100], focal_loss:0.0128	, anomaly_loss:0.3931	fnorm_loss:0.0088, a_fnorm_loss:0.0433P:0.37, R:0.80
 22%|██▏       | 22/100 [09:53<33:47, 26.00s/it]epoch [22/100], focal_loss:0.0133	, anomaly_loss:0.3848	fnorm_loss:0.0086, a_fnorm_loss:0.0433P:0.35, R:0.81
 23%|██▎       | 23/100 [10:16<31:56, 24.89s/it]epoch [23/100], focal_loss:0.0128	, anomaly_loss:0.3848	fnorm_loss:0.0084, a_fnorm_loss:0.0430P:0.34, R:0.81
 24%|██▍       | 24/100 [10:37<30:23, 23.99s/it]epoch [24/100], focal_loss:0.0137	, anomaly_loss:0.3904	fnorm_loss:0.0085, a_fnorm_loss:0.0421P:0.35, R:0.79
 25%|██▌       | 25/100 [11:19<36:29, 29.19s/it]epoch [25/100], focal_loss:0.0126	, anomaly_loss:0.3840	fnorm_loss:0.0082, a_fnorm_loss:0.0440P:0.37, R:0.82
normal: 0.1970 0.5273  anomaly: 0.2230 0.6768	P:0.04, R:0.10
Pixel Auroc:0.949, Sample Auroc0.627, Pixel Aupro0.0
test_fnorm_loss: 0.0080 test_afnorm_loss: 0.0266
 26%|██▌       | 26/100 [11:40<33:06, 26.84s/it]epoch [26/100], focal_loss:0.0130	, anomaly_loss:0.3825	fnorm_loss:0.0080, a_fnorm_loss:0.0439P:0.36, R:0.81
 27%|██▋       | 27/100 [12:02<30:44, 25.26s/it]epoch [27/100], focal_loss:0.0127	, anomaly_loss:0.3840	fnorm_loss:0.0080, a_fnorm_loss:0.0437P:0.34, R:0.82
 28%|██▊       | 28/100 [12:23<28:54, 24.09s/it]epoch [28/100], focal_loss:0.0120	, anomaly_loss:0.3825	fnorm_loss:0.0078, a_fnorm_loss:0.0442P:0.37, R:0.82
 29%|██▉       | 29/100 [12:45<27:39, 23.38s/it]epoch [29/100], focal_loss:0.0125	, anomaly_loss:0.3846	fnorm_loss:0.0078, a_fnorm_loss:0.0446P:0.39, R:0.82
 30%|███       | 30/100 [13:31<35:11, 30.17s/it]epoch [30/100], focal_loss:0.0121	, anomaly_loss:0.3798	fnorm_loss:0.0076, a_fnorm_loss:0.0440P:0.38, R:0.82
normal: 0.0853 0.3509  anomaly: 0.1105 0.5822	P:0.07, R:0.07
Pixel Auroc:0.961, Sample Auroc0.801, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0236
 31%|███       | 31/100 [13:52<31:30, 27.40s/it]epoch [31/100], focal_loss:0.0116	, anomaly_loss:0.3801	fnorm_loss:0.0075, a_fnorm_loss:0.0445P:0.34, R:0.83
 32%|███▏      | 32/100 [14:14<29:15, 25.81s/it]epoch [32/100], focal_loss:0.0125	, anomaly_loss:0.3858	fnorm_loss:0.0077, a_fnorm_loss:0.0427P:0.36, R:0.80
 33%|███▎      | 33/100 [14:36<27:31, 24.65s/it]epoch [33/100], focal_loss:0.0113	, anomaly_loss:0.3731	fnorm_loss:0.0073, a_fnorm_loss:0.0453P:0.39, R:0.85
 34%|███▍      | 34/100 [14:57<26:00, 23.64s/it]epoch [34/100], focal_loss:0.0128	, anomaly_loss:0.3837	fnorm_loss:0.0075, a_fnorm_loss:0.0435P:0.36, R:0.81
 35%|███▌      | 35/100 [15:39<31:29, 29.07s/it]epoch [35/100], focal_loss:0.0130	, anomaly_loss:0.3882	fnorm_loss:0.0075, a_fnorm_loss:0.0443P:0.39, R:0.80
normal: 0.1656 0.4219  anomaly: 0.1689 0.6414	P:0.05, R:0.09
Pixel Auroc:0.957, Sample Auroc0.783, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0285
 36%|███▌      | 36/100 [16:01<28:40, 26.89s/it]epoch [36/100], focal_loss:0.0113	, anomaly_loss:0.3749	fnorm_loss:0.0072, a_fnorm_loss:0.0450P:0.36, R:0.84
 37%|███▋      | 37/100 [16:22<26:32, 25.28s/it]epoch [37/100], focal_loss:0.0115	, anomaly_loss:0.3838	fnorm_loss:0.0073, a_fnorm_loss:0.0440P:0.36, R:0.81
 38%|███▊      | 38/100 [16:44<25:08, 24.34s/it]epoch [38/100], focal_loss:0.0115	, anomaly_loss:0.3785	fnorm_loss:0.0072, a_fnorm_loss:0.0446P:0.36, R:0.82
 39%|███▉      | 39/100 [17:07<24:09, 23.76s/it]epoch [39/100], focal_loss:0.0119	, anomaly_loss:0.3823	fnorm_loss:0.0072, a_fnorm_loss:0.0442P:0.36, R:0.82
 40%|████      | 40/100 [17:48<29:09, 29.16s/it]epoch [40/100], focal_loss:0.0120	, anomaly_loss:0.3832	fnorm_loss:0.0072, a_fnorm_loss:0.0443P:0.37, R:0.81
normal: 0.1370 0.4663  anomaly: 0.2184 0.6798	P:0.05, R:0.09
Pixel Auroc:0.954, Sample Auroc0.752, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0273
 41%|████      | 41/100 [18:11<26:38, 27.10s/it]epoch [41/100], focal_loss:0.0113	, anomaly_loss:0.3743	fnorm_loss:0.0070, a_fnorm_loss:0.0457P:0.40, R:0.83
 42%|████▏     | 42/100 [18:33<24:41, 25.54s/it]epoch [42/100], focal_loss:0.0120	, anomaly_loss:0.3797	fnorm_loss:0.0072, a_fnorm_loss:0.0443P:0.35, R:0.82
 43%|████▎     | 43/100 [18:54<23:10, 24.39s/it]epoch [43/100], focal_loss:0.0115	, anomaly_loss:0.3735	fnorm_loss:0.0071, a_fnorm_loss:0.0448P:0.37, R:0.84
 44%|████▍     | 44/100 [19:16<21:56, 23.52s/it]epoch [44/100], focal_loss:0.0122	, anomaly_loss:0.3706	fnorm_loss:0.0070, a_fnorm_loss:0.0454P:0.39, R:0.84
 45%|████▌     | 45/100 [19:57<26:30, 28.91s/it]epoch [45/100], focal_loss:0.0115	, anomaly_loss:0.3761	fnorm_loss:0.0071, a_fnorm_loss:0.0450P:0.39, R:0.82
normal: 0.1382 0.4767  anomaly: 0.1644 0.6163	P:0.06, R:0.10
Pixel Auroc:0.960, Sample Auroc0.766, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0216
 46%|████▌     | 46/100 [20:19<24:02, 26.71s/it]epoch [46/100], focal_loss:0.0110	, anomaly_loss:0.3706	fnorm_loss:0.0069, a_fnorm_loss:0.0451P:0.36, R:0.84
 47%|████▋     | 47/100 [20:40<22:11, 25.13s/it]epoch [47/100], focal_loss:0.0107	, anomaly_loss:0.3688	fnorm_loss:0.0069, a_fnorm_loss:0.0469P:0.37, R:0.85
 48%|████▊     | 48/100 [21:01<20:42, 23.90s/it]epoch [48/100], focal_loss:0.0112	, anomaly_loss:0.3767	fnorm_loss:0.0070, a_fnorm_loss:0.0447P:0.37, R:0.83
 49%|████▉     | 49/100 [21:23<19:49, 23.33s/it]epoch [49/100], focal_loss:0.0112	, anomaly_loss:0.3745	fnorm_loss:0.0070, a_fnorm_loss:0.0452P:0.37, R:0.83
 50%|█████     | 50/100 [22:06<24:12, 29.04s/it]epoch [50/100], focal_loss:0.0108	, anomaly_loss:0.3767	fnorm_loss:0.0069, a_fnorm_loss:0.0450P:0.36, R:0.82
normal: 0.1688 0.4088  anomaly: 0.2204 0.6484	P:0.05, R:0.10
Pixel Auroc:0.962, Sample Auroc0.819, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0288
 51%|█████     | 51/100 [22:28<22:05, 27.05s/it]epoch [51/100], focal_loss:0.0105	, anomaly_loss:0.3663	fnorm_loss:0.0069, a_fnorm_loss:0.0463P:0.38, R:0.85
 52%|█████▏    | 52/100 [22:50<20:28, 25.60s/it]epoch [52/100], focal_loss:0.0121	, anomaly_loss:0.3727	fnorm_loss:0.0070, a_fnorm_loss:0.0444P:0.38, R:0.83
 53%|█████▎    | 53/100 [23:12<19:12, 24.53s/it]epoch [53/100], focal_loss:0.0109	, anomaly_loss:0.3626	fnorm_loss:0.0069, a_fnorm_loss:0.0459P:0.38, R:0.86
 54%|█████▍    | 54/100 [23:34<18:07, 23.64s/it]epoch [54/100], focal_loss:0.0105	, anomaly_loss:0.3627	fnorm_loss:0.0068, a_fnorm_loss:0.0469P:0.40, R:0.86
 55%|█████▌    | 55/100 [24:15<21:44, 28.98s/it]epoch [55/100], focal_loss:0.0116	, anomaly_loss:0.3771	fnorm_loss:0.0070, a_fnorm_loss:0.0451P:0.38, R:0.82
normal: 0.0997 0.3480  anomaly: 0.1473 0.6130	P:0.06, R:0.07
Pixel Auroc:0.964, Sample Auroc0.806, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0262
 56%|█████▌    | 56/100 [24:37<19:31, 26.63s/it]epoch [56/100], focal_loss:0.0108	, anomaly_loss:0.3728	fnorm_loss:0.0068, a_fnorm_loss:0.0458P:0.39, R:0.84
 57%|█████▋    | 57/100 [24:58<18:03, 25.20s/it]epoch [57/100], focal_loss:0.0110	, anomaly_loss:0.3673	fnorm_loss:0.0068, a_fnorm_loss:0.0461P:0.42, R:0.85
 58%|█████▊    | 58/100 [25:20<16:56, 24.20s/it]epoch [58/100], focal_loss:0.0110	, anomaly_loss:0.3700	fnorm_loss:0.0069, a_fnorm_loss:0.0455P:0.37, R:0.84
 59%|█████▉    | 59/100 [25:42<16:04, 23.53s/it]epoch [59/100], focal_loss:0.0109	, anomaly_loss:0.3567	fnorm_loss:0.0067, a_fnorm_loss:0.0470P:0.40, R:0.87
 60%|██████    | 60/100 [26:23<19:12, 28.82s/it]epoch [60/100], focal_loss:0.0103	, anomaly_loss:0.3682	fnorm_loss:0.0067, a_fnorm_loss:0.0464P:0.38, R:0.84
normal: 0.2226 0.5043  anomaly: 0.2410 0.6852	P:0.04, R:0.10
Pixel Auroc:0.957, Sample Auroc0.724, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0288
 61%|██████    | 61/100 [26:46<17:25, 26.82s/it]epoch [61/100], focal_loss:0.0104	, anomaly_loss:0.3700	fnorm_loss:0.0068, a_fnorm_loss:0.0459P:0.39, R:0.85
 62%|██████▏   | 62/100 [27:07<15:55, 25.15s/it]epoch [62/100], focal_loss:0.0106	, anomaly_loss:0.3679	fnorm_loss:0.0068, a_fnorm_loss:0.0460P:0.37, R:0.85
 63%|██████▎   | 63/100 [27:29<14:58, 24.29s/it]epoch [63/100], focal_loss:0.0115	, anomaly_loss:0.3741	fnorm_loss:0.0069, a_fnorm_loss:0.0461P:0.40, R:0.83
 64%|██████▍   | 64/100 [27:51<14:08, 23.57s/it]epoch [64/100], focal_loss:0.0097	, anomaly_loss:0.3662	fnorm_loss:0.0066, a_fnorm_loss:0.0467P:0.38, R:0.85
 65%|██████▌   | 65/100 [28:37<17:40, 30.31s/it]epoch [65/100], focal_loss:0.0108	, anomaly_loss:0.3657	fnorm_loss:0.0068, a_fnorm_loss:0.0462P:0.44, R:0.86
normal: 0.0971 0.4428  anomaly: 0.1227 0.6669	P:0.08, R:0.10
Pixel Auroc:0.974, Sample Auroc0.777, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0277
 66%|██████▌   | 66/100 [28:59<15:44, 27.79s/it]epoch [66/100], focal_loss:0.0105	, anomaly_loss:0.3638	fnorm_loss:0.0068, a_fnorm_loss:0.0471P:0.40, R:0.86
 67%|██████▋   | 67/100 [29:21<14:17, 25.97s/it]epoch [67/100], focal_loss:0.0100	, anomaly_loss:0.3629	fnorm_loss:0.0067, a_fnorm_loss:0.0458P:0.37, R:0.85
 68%|██████▊   | 68/100 [29:43<13:11, 24.75s/it]epoch [68/100], focal_loss:0.0108	, anomaly_loss:0.3628	fnorm_loss:0.0068, a_fnorm_loss:0.0462P:0.42, R:0.85
 69%|██████▉   | 69/100 [30:04<12:21, 23.92s/it]epoch [69/100], focal_loss:0.0098	, anomaly_loss:0.3615	fnorm_loss:0.0066, a_fnorm_loss:0.0477P:0.39, R:0.87
 70%|███████   | 70/100 [30:47<14:42, 29.41s/it]epoch [70/100], focal_loss:0.0116	, anomaly_loss:0.3688	fnorm_loss:0.0068, a_fnorm_loss:0.0459P:0.40, R:0.84
normal: 0.0415 0.1863  anomaly: 0.0452 0.4100	P:0.04, R:0.02
Pixel Auroc:0.965, Sample Auroc0.745, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0135
 71%|███████   | 71/100 [31:08<13:04, 27.07s/it]epoch [71/100], focal_loss:0.0105	, anomaly_loss:0.3686	fnorm_loss:0.0068, a_fnorm_loss:0.0455P:0.39, R:0.85
 72%|███████▏  | 72/100 [31:30<11:54, 25.52s/it]epoch [72/100], focal_loss:0.0098	, anomaly_loss:0.3566	fnorm_loss:0.0066, a_fnorm_loss:0.0477P:0.43, R:0.87
 73%|███████▎  | 73/100 [31:51<10:51, 24.14s/it]epoch [73/100], focal_loss:0.0100	, anomaly_loss:0.3592	fnorm_loss:0.0066, a_fnorm_loss:0.0460P:0.39, R:0.86
 74%|███████▍  | 74/100 [32:13<10:06, 23.34s/it]epoch [74/100], focal_loss:0.0106	, anomaly_loss:0.3620	fnorm_loss:0.0068, a_fnorm_loss:0.0464P:0.40, R:0.85
 75%|███████▌  | 75/100 [32:54<12:02, 28.89s/it]epoch [75/100], focal_loss:0.0101	, anomaly_loss:0.3670	fnorm_loss:0.0067, a_fnorm_loss:0.0465P:0.38, R:0.85
normal: 0.0896 0.4567  anomaly: 0.1170 0.6452	P:0.07, R:0.09
Pixel Auroc:0.969, Sample Auroc0.803, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0244
 76%|███████▌  | 76/100 [33:16<10:39, 26.66s/it]epoch [76/100], focal_loss:0.0104	, anomaly_loss:0.3683	fnorm_loss:0.0067, a_fnorm_loss:0.0470P:0.41, R:0.85
 77%|███████▋  | 77/100 [33:38<09:38, 25.17s/it]epoch [77/100], focal_loss:0.0093	, anomaly_loss:0.3594	fnorm_loss:0.0065, a_fnorm_loss:0.0481P:0.40, R:0.88
 78%|███████▊  | 78/100 [34:00<08:55, 24.33s/it]epoch [78/100], focal_loss:0.0106	, anomaly_loss:0.3641	fnorm_loss:0.0068, a_fnorm_loss:0.0464P:0.39, R:0.85
 79%|███████▉  | 79/100 [34:21<08:10, 23.38s/it]epoch [79/100], focal_loss:0.0104	, anomaly_loss:0.3592	fnorm_loss:0.0067, a_fnorm_loss:0.0469P:0.40, R:0.86
 80%|████████  | 80/100 [35:03<09:39, 29.00s/it]epoch [80/100], focal_loss:0.0106	, anomaly_loss:0.3653	fnorm_loss:0.0068, a_fnorm_loss:0.0461P:0.39, R:0.85
normal: 0.1136 0.4684  anomaly: 0.1086 0.6789	P:0.06, R:0.08
Pixel Auroc:0.969, Sample Auroc0.747, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0258
 81%|████████  | 81/100 [35:25<08:27, 26.73s/it]epoch [81/100], focal_loss:0.0099	, anomaly_loss:0.3608	fnorm_loss:0.0067, a_fnorm_loss:0.0479P:0.41, R:0.87
 82%|████████▏ | 82/100 [35:46<07:32, 25.14s/it]epoch [82/100], focal_loss:0.0096	, anomaly_loss:0.3540	fnorm_loss:0.0067, a_fnorm_loss:0.0478P:0.41, R:0.87
 83%|████████▎ | 83/100 [36:07<06:47, 23.96s/it]epoch [83/100], focal_loss:0.0091	, anomaly_loss:0.3564	fnorm_loss:0.0065, a_fnorm_loss:0.0477P:0.38, R:0.88
 84%|████████▍ | 84/100 [36:29<06:10, 23.14s/it]epoch [84/100], focal_loss:0.0095	, anomaly_loss:0.3484	fnorm_loss:0.0066, a_fnorm_loss:0.0483P:0.40, R:0.89
 85%|████████▌ | 85/100 [37:11<07:11, 28.79s/it]epoch [85/100], focal_loss:0.0095	, anomaly_loss:0.3525	fnorm_loss:0.0065, a_fnorm_loss:0.0477P:0.42, R:0.89
normal: 0.0721 0.4006  anomaly: 0.1099 0.6563	P:0.07, R:0.09
Pixel Auroc:0.973, Sample Auroc0.818, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0273
 86%|████████▌ | 86/100 [37:33<06:14, 26.78s/it]epoch [86/100], focal_loss:0.0091	, anomaly_loss:0.3563	fnorm_loss:0.0065, a_fnorm_loss:0.0487P:0.43, R:0.88
 87%|████████▋ | 87/100 [37:54<05:28, 25.27s/it]epoch [87/100], focal_loss:0.0098	, anomaly_loss:0.3564	fnorm_loss:0.0066, a_fnorm_loss:0.0482P:0.40, R:0.88
 88%|████████▊ | 88/100 [38:17<04:52, 24.34s/it]epoch [88/100], focal_loss:0.0094	, anomaly_loss:0.3565	fnorm_loss:0.0066, a_fnorm_loss:0.0476P:0.41, R:0.87
 89%|████████▉ | 89/100 [38:38<04:18, 23.50s/it]epoch [89/100], focal_loss:0.0098	, anomaly_loss:0.3553	fnorm_loss:0.0066, a_fnorm_loss:0.0481P:0.42, R:0.88
 90%|█████████ | 90/100 [39:20<04:49, 28.90s/it]epoch [90/100], focal_loss:0.0086	, anomaly_loss:0.3419	fnorm_loss:0.0064, a_fnorm_loss:0.0494P:0.43, R:0.90
normal: 0.0563 0.3936  anomaly: 0.0742 0.6561	P:0.08, R:0.08
Pixel Auroc:0.974, Sample Auroc0.796, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0254
 91%|█████████ | 91/100 [39:41<04:00, 26.76s/it]epoch [91/100], focal_loss:0.0091	, anomaly_loss:0.3481	fnorm_loss:0.0063, a_fnorm_loss:0.0492P:0.45, R:0.89
 92%|█████████▏| 92/100 [40:03<03:20, 25.09s/it]epoch [92/100], focal_loss:0.0095	, anomaly_loss:0.3551	fnorm_loss:0.0065, a_fnorm_loss:0.0482P:0.39, R:0.87
 93%|█████████▎| 93/100 [40:24<02:47, 23.96s/it]epoch [93/100], focal_loss:0.0090	, anomaly_loss:0.3467	fnorm_loss:0.0065, a_fnorm_loss:0.0488P:0.41, R:0.89
 94%|█████████▍| 94/100 [40:45<02:18, 23.17s/it]epoch [94/100], focal_loss:0.0087	, anomaly_loss:0.3463	fnorm_loss:0.0065, a_fnorm_loss:0.0488P:0.39, R:0.89
 95%|█████████▌| 95/100 [41:26<02:22, 28.57s/it]epoch [95/100], focal_loss:0.0093	, anomaly_loss:0.3528	fnorm_loss:0.0065, a_fnorm_loss:0.0476P:0.40, R:0.88
normal: 0.0759 0.4242  anomaly: 0.1034 0.6768	P:0.07, R:0.09
Pixel Auroc:0.972, Sample Auroc0.792, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0276
 96%|█████████▌| 96/100 [41:48<01:45, 26.42s/it]epoch [96/100], focal_loss:0.0095	, anomaly_loss:0.3585	fnorm_loss:0.0065, a_fnorm_loss:0.0480P:0.39, R:0.88
 97%|█████████▋| 97/100 [42:09<01:15, 25.01s/it]epoch [97/100], focal_loss:0.0095	, anomaly_loss:0.3518	fnorm_loss:0.0065, a_fnorm_loss:0.0484P:0.41, R:0.89
 98%|█████████▊| 98/100 [42:31<00:48, 24.01s/it]epoch [98/100], focal_loss:0.0091	, anomaly_loss:0.3504	fnorm_loss:0.0065, a_fnorm_loss:0.0485P:0.40, R:0.88
 99%|█████████▉| 99/100 [42:53<00:23, 23.44s/it]epoch [99/100], focal_loss:0.0093	, anomaly_loss:0.3476	fnorm_loss:0.0065, a_fnorm_loss:0.0484P:0.41, R:0.89
100%|██████████| 100/100 [43:34<00:00, 28.70s/it]100%|██████████| 100/100 [43:34<00:00, 26.15s/it]
epoch [100/100], focal_loss:0.0090	, anomaly_loss:0.3563	fnorm_loss:0.0065, a_fnorm_loss:0.0476P:0.39, R:0.88
normal: 0.0830 0.4413  anomaly: 0.0972 0.6677	P:0.07, R:0.09
Pixel Auroc:0.973, Sample Auroc0.798, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0284
training Stubborn Student...
pcb1
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<32:04, 16.17s/it]epoch [1/120], kd_loss:4.0645
  2%|▏         | 2/120 [00:32<32:01, 16.28s/it]epoch [2/120], kd_loss:2.7550
  2%|▎         | 3/120 [00:48<31:47, 16.30s/it]epoch [3/120], kd_loss:2.7020
  3%|▎         | 4/120 [01:05<31:41, 16.39s/it]epoch [4/120], kd_loss:2.2423
  4%|▍         | 5/120 [01:21<31:25, 16.39s/it]epoch [5/120], kd_loss:2.7561
  5%|▌         | 6/120 [01:38<31:12, 16.43s/it]epoch [6/120], kd_loss:2.4045
  6%|▌         | 7/120 [01:54<30:54, 16.41s/it]epoch [7/120], kd_loss:2.6628
  7%|▋         | 8/120 [02:11<30:37, 16.41s/it]epoch [8/120], kd_loss:2.4282
  8%|▊         | 9/120 [02:27<30:22, 16.42s/it]epoch [9/120], kd_loss:2.1335
  8%|▊         | 10/120 [03:02<40:21, 22.01s/it]epoch [10/120], kd_loss:2.0543
normal: 1.2581 1.8165  anomaly: 1.3627 2.4060
thresh: 1.45777921648025
fpr: 0.25 fnr 0.1
Pixel Auroc:0.992, Sample Auroc0.867, Pixel Aupro0.0
  9%|▉         | 11/120 [03:18<36:46, 20.24s/it]epoch [11/120], kd_loss:1.9747
 10%|█         | 12/120 [03:34<34:17, 19.05s/it]epoch [12/120], kd_loss:1.8831
 11%|█         | 13/120 [03:51<32:35, 18.28s/it]epoch [13/120], kd_loss:1.9358
 12%|█▏        | 14/120 [04:07<31:24, 17.77s/it]epoch [14/120], kd_loss:1.8137
 12%|█▎        | 15/120 [04:24<30:26, 17.40s/it]epoch [15/120], kd_loss:1.7571
 13%|█▎        | 16/120 [04:41<29:52, 17.24s/it]epoch [16/120], kd_loss:1.8719
 14%|█▍        | 17/120 [04:57<29:15, 17.05s/it]epoch [17/120], kd_loss:1.8533
 15%|█▌        | 18/120 [05:14<28:40, 16.86s/it]epoch [18/120], kd_loss:1.8397
 16%|█▌        | 19/120 [05:30<28:09, 16.73s/it]epoch [19/120], kd_loss:1.8361
 17%|█▋        | 20/120 [06:05<37:08, 22.29s/it]epoch [20/120], kd_loss:1.7366
normal: 1.0278 1.7899  anomaly: 1.1973 2.3130
thresh: 1.2461841548981718
fpr: 0.31 fnr 0.05
Pixel Auroc:0.993, Sample Auroc0.904, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:22<33:47, 20.48s/it]epoch [21/120], kd_loss:1.6983
 18%|█▊        | 22/120 [06:38<31:24, 19.23s/it]epoch [22/120], kd_loss:1.7275
 19%|█▉        | 23/120 [06:54<29:41, 18.36s/it]epoch [23/120], kd_loss:1.7031
 20%|██        | 24/120 [07:11<28:28, 17.80s/it]epoch [24/120], kd_loss:1.7560
 21%|██        | 25/120 [07:27<27:30, 17.37s/it]epoch [25/120], kd_loss:1.7714
 22%|██▏       | 26/120 [07:43<26:45, 17.08s/it]epoch [26/120], kd_loss:1.6425
 22%|██▎       | 27/120 [08:00<26:10, 16.89s/it]epoch [27/120], kd_loss:1.7035
 23%|██▎       | 28/120 [08:16<25:43, 16.78s/it]epoch [28/120], kd_loss:1.6326
 24%|██▍       | 29/120 [08:33<25:16, 16.67s/it]epoch [29/120], kd_loss:1.6173
 25%|██▌       | 30/120 [09:07<32:53, 21.93s/it]epoch [30/120], kd_loss:1.7435
normal: 1.9149 2.4906  anomaly: 2.0287 2.5605
thresh: 2.065396005853193
fpr: 0.86 fnr 0.01
Pixel Auroc:0.910, Sample Auroc0.629, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:23<29:58, 20.21s/it]epoch [31/120], kd_loss:2.3702
 27%|██▋       | 32/120 [09:40<27:57, 19.06s/it]epoch [32/120], kd_loss:1.8053
 28%|██▊       | 33/120 [09:56<26:28, 18.26s/it]epoch [33/120], kd_loss:1.6896
 28%|██▊       | 34/120 [10:12<25:22, 17.70s/it]epoch [34/120], kd_loss:1.7016
 29%|██▉       | 35/120 [10:29<24:32, 17.32s/it]epoch [35/120], kd_loss:1.6294
 30%|███       | 36/120 [10:45<23:51, 17.04s/it]epoch [36/120], kd_loss:1.6157
 31%|███       | 37/120 [11:02<23:18, 16.85s/it]epoch [37/120], kd_loss:1.6424
 32%|███▏      | 38/120 [11:18<22:50, 16.71s/it]epoch [38/120], kd_loss:1.6397
 32%|███▎      | 39/120 [11:34<22:25, 16.61s/it]epoch [39/120], kd_loss:1.5807
 33%|███▎      | 40/120 [12:10<29:46, 22.34s/it]epoch [40/120], kd_loss:1.8147
normal: 0.9636 1.5701  anomaly: 1.1283 2.4929
thresh: 1.2260535971105033
fpr: 0.27 fnr 0.05
Pixel Auroc:0.993, Sample Auroc0.914, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:26<26:59, 20.50s/it]epoch [41/120], kd_loss:1.6462
 35%|███▌      | 42/120 [12:43<25:05, 19.30s/it]epoch [42/120], kd_loss:1.6372
 36%|███▌      | 43/120 [12:59<23:39, 18.43s/it]epoch [43/120], kd_loss:1.6623
 37%|███▋      | 44/120 [13:16<22:34, 17.82s/it]epoch [44/120], kd_loss:1.6575
 38%|███▊      | 45/120 [13:32<21:44, 17.40s/it]epoch [45/120], kd_loss:1.6642
 38%|███▊      | 46/120 [13:48<21:05, 17.10s/it]epoch [46/120], kd_loss:1.6021
 39%|███▉      | 47/120 [14:05<20:32, 16.88s/it]epoch [47/120], kd_loss:1.6134
 40%|████      | 48/120 [14:21<20:06, 16.75s/it]epoch [48/120], kd_loss:1.5905
 41%|████      | 49/120 [14:38<19:41, 16.64s/it]epoch [49/120], kd_loss:1.6073
 42%|████▏     | 50/120 [15:12<25:37, 21.97s/it]epoch [50/120], kd_loss:1.9340
normal: 0.9492 1.6547  anomaly: 1.1269 2.4907
thresh: 1.219351216933034
fpr: 0.25 fnr 0.06
Pixel Auroc:0.991, Sample Auroc0.908, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:28<23:17, 20.26s/it]epoch [51/120], kd_loss:1.6300
 43%|████▎     | 52/120 [15:45<21:39, 19.11s/it]epoch [52/120], kd_loss:1.6639
 44%|████▍     | 53/120 [16:01<20:28, 18.34s/it]epoch [53/120], kd_loss:3.1594
 45%|████▌     | 54/120 [16:18<19:33, 17.78s/it]epoch [54/120], kd_loss:2.2449
 46%|████▌     | 55/120 [16:34<18:48, 17.36s/it]epoch [55/120], kd_loss:2.0947
 47%|████▋     | 56/120 [16:51<18:11, 17.06s/it]epoch [56/120], kd_loss:2.0418
 48%|████▊     | 57/120 [17:07<17:43, 16.88s/it]epoch [57/120], kd_loss:2.0873
 48%|████▊     | 58/120 [17:23<17:18, 16.74s/it]epoch [58/120], kd_loss:2.0244
 49%|████▉     | 59/120 [17:40<16:54, 16.63s/it]epoch [59/120], kd_loss:1.9639
 50%|█████     | 60/120 [18:15<22:05, 22.09s/it]epoch [60/120], kd_loss:1.9618
normal: 1.3975 2.1608  anomaly: 1.5412 2.4360
thresh: 1.6371768072436768
fpr: 0.42 fnr 0.1
Pixel Auroc:0.973, Sample Auroc0.790, Pixel Aupro0.0
 51%|█████     | 61/120 [18:31<20:00, 20.35s/it]epoch [61/120], kd_loss:2.1974
 52%|█████▏    | 62/120 [18:47<18:30, 19.15s/it]epoch [62/120], kd_loss:2.0825
 52%|█████▎    | 63/120 [19:04<17:23, 18.31s/it]epoch [63/120], kd_loss:1.9569
 53%|█████▎    | 64/120 [19:20<16:32, 17.73s/it]epoch [64/120], kd_loss:1.9661
 54%|█████▍    | 65/120 [19:36<15:53, 17.34s/it]epoch [65/120], kd_loss:1.9868
 55%|█████▌    | 66/120 [19:53<15:20, 17.05s/it]epoch [66/120], kd_loss:1.9346
 56%|█████▌    | 67/120 [20:09<14:53, 16.87s/it]epoch [67/120], kd_loss:1.8240
 57%|█████▋    | 68/120 [20:26<14:30, 16.73s/it]epoch [68/120], kd_loss:1.7630
 57%|█████▊    | 69/120 [20:42<14:08, 16.63s/it]epoch [69/120], kd_loss:1.7479
 58%|█████▊    | 70/120 [21:16<18:12, 21.85s/it]epoch [70/120], kd_loss:1.8495
normal: 1.0901 2.0091  anomaly: 1.2343 2.5697
thresh: 1.3131702188034933
fpr: 0.33 fnr 0.1
Pixel Auroc:0.989, Sample Auroc0.872, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:32<16:28, 20.17s/it]epoch [71/120], kd_loss:1.7361
 60%|██████    | 72/120 [21:49<15:13, 19.04s/it]epoch [72/120], kd_loss:1.7464
 61%|██████    | 73/120 [22:05<14:17, 18.25s/it]epoch [73/120], kd_loss:1.7909
 62%|██████▏   | 74/120 [22:22<13:34, 17.71s/it]epoch [74/120], kd_loss:1.8716
 62%|██████▎   | 75/120 [22:38<12:58, 17.31s/it]epoch [75/120], kd_loss:1.7424
 63%|██████▎   | 76/120 [22:54<12:30, 17.06s/it]epoch [76/120], kd_loss:1.7246
 64%|██████▍   | 77/120 [23:11<12:05, 16.87s/it]epoch [77/120], kd_loss:1.7510
 65%|██████▌   | 78/120 [23:27<11:42, 16.73s/it]epoch [78/120], kd_loss:1.6794
 66%|██████▌   | 79/120 [23:44<11:22, 16.64s/it]epoch [79/120], kd_loss:1.6563
 67%|██████▋   | 80/120 [24:18<14:35, 21.88s/it]epoch [80/120], kd_loss:1.9949
normal: 1.0748 2.1949  anomaly: 1.1919 2.5149
thresh: 1.2655548229931628
fpr: 0.35 fnr 0.07
Pixel Auroc:0.991, Sample Auroc0.826, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:34<13:07, 20.19s/it]epoch [81/120], kd_loss:1.8258
 68%|██████▊   | 82/120 [24:50<12:02, 19.02s/it]epoch [82/120], kd_loss:1.8999
 69%|██████▉   | 83/120 [25:07<11:15, 18.25s/it]epoch [83/120], kd_loss:1.7718
 70%|███████   | 84/120 [25:23<10:37, 17.70s/it]epoch [84/120], kd_loss:1.7035
 71%|███████   | 85/120 [25:40<10:05, 17.30s/it]epoch [85/120], kd_loss:1.6606
 72%|███████▏  | 86/120 [25:56<09:38, 17.02s/it]epoch [86/120], kd_loss:1.6365
 72%|███████▎  | 87/120 [26:12<09:15, 16.83s/it]epoch [87/120], kd_loss:1.6517
 73%|███████▎  | 88/120 [26:29<08:55, 16.72s/it]epoch [88/120], kd_loss:1.6146
 74%|███████▍  | 89/120 [26:45<08:35, 16.62s/it]epoch [89/120], kd_loss:1.6204
 75%|███████▌  | 90/120 [27:19<10:55, 21.84s/it]epoch [90/120], kd_loss:1.6252
normal: 0.9388 1.5920  anomaly: 1.1229 2.5808
thresh: 1.2016491394895097
fpr: 0.3 fnr 0.09
Pixel Auroc:0.992, Sample Auroc0.893, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:35<09:44, 20.17s/it]epoch [91/120], kd_loss:1.6371
 77%|███████▋  | 92/120 [27:52<08:52, 19.00s/it]epoch [92/120], kd_loss:1.6126
 78%|███████▊  | 93/120 [28:08<08:11, 18.20s/it]epoch [93/120], kd_loss:1.6154
 78%|███████▊  | 94/120 [28:24<07:39, 17.66s/it]epoch [94/120], kd_loss:1.6589
 79%|███████▉  | 95/120 [28:41<07:12, 17.29s/it]epoch [95/120], kd_loss:1.6708
 80%|████████  | 96/120 [28:57<06:49, 17.04s/it]epoch [96/120], kd_loss:1.6338
 81%|████████  | 97/120 [29:14<06:28, 16.88s/it]epoch [97/120], kd_loss:1.6034
 82%|████████▏ | 98/120 [29:30<06:08, 16.73s/it]epoch [98/120], kd_loss:1.6035
 82%|████████▎ | 99/120 [29:47<05:49, 16.64s/it]epoch [99/120], kd_loss:1.5921
 83%|████████▎ | 100/120 [30:21<07:17, 21.88s/it]epoch [100/120], kd_loss:1.5874
normal: 0.9538 1.5411  anomaly: 1.0785 2.5339
thresh: 1.1449419845855526
fpr: 0.38 fnr 0.03
Pixel Auroc:0.991, Sample Auroc0.885, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:37<06:23, 20.16s/it]epoch [101/120], kd_loss:1.5830
 85%|████████▌ | 102/120 [30:53<05:42, 19.02s/it]epoch [102/120], kd_loss:1.5791
 86%|████████▌ | 103/120 [31:10<05:09, 18.22s/it]epoch [103/120], kd_loss:1.5779
 87%|████████▋ | 104/120 [31:26<04:42, 17.66s/it]epoch [104/120], kd_loss:1.5742
 88%|████████▊ | 105/120 [31:43<04:19, 17.32s/it]epoch [105/120], kd_loss:1.5692
 88%|████████▊ | 106/120 [31:59<03:59, 17.10s/it]epoch [106/120], kd_loss:1.5667
 89%|████████▉ | 107/120 [32:16<03:39, 16.90s/it]epoch [107/120], kd_loss:1.5638
 90%|█████████ | 108/120 [32:32<03:21, 16.76s/it]epoch [108/120], kd_loss:1.5613
 91%|█████████ | 109/120 [32:48<03:03, 16.66s/it]epoch [109/120], kd_loss:1.5592
 92%|█████████▏| 110/120 [33:23<03:39, 21.92s/it]epoch [110/120], kd_loss:1.5578
normal: 0.9323 1.5233  anomaly: 1.0657 2.5427
thresh: 1.1372414366640549
fpr: 0.37 fnr 0.05
Pixel Auroc:0.991, Sample Auroc0.882, Pixel Aupro0.0
 92%|█████████▎| 111/120 [33:39<03:01, 20.20s/it]epoch [111/120], kd_loss:1.5573
 93%|█████████▎| 112/120 [33:55<02:32, 19.04s/it]epoch [112/120], kd_loss:1.5561
 94%|█████████▍| 113/120 [34:12<02:07, 18.26s/it]epoch [113/120], kd_loss:1.5556
 95%|█████████▌| 114/120 [34:28<01:46, 17.72s/it]epoch [114/120], kd_loss:1.5551
 96%|█████████▌| 115/120 [34:44<01:26, 17.31s/it]epoch [115/120], kd_loss:1.5548
 97%|█████████▋| 116/120 [35:01<01:08, 17.03s/it]epoch [116/120], kd_loss:1.5541
 98%|█████████▊| 117/120 [35:17<00:50, 16.85s/it]epoch [117/120], kd_loss:1.5540
 98%|█████████▊| 118/120 [35:34<00:33, 16.72s/it]epoch [118/120], kd_loss:1.5547
 99%|█████████▉| 119/120 [35:50<00:16, 16.61s/it]epoch [119/120], kd_loss:1.5526
100%|██████████| 120/120 [36:24<00:00, 21.93s/it]100%|██████████| 120/120 [36:24<00:00, 18.21s/it]
epoch [120/120], kd_loss:1.5521
normal: 0.9149 1.5226  anomaly: 1.0696 2.5558
thresh: 1.1351896839507623
fpr: 0.38 fnr 0.04
Pixel Auroc:0.991, Sample Auroc0.886, Pixel Aupro0.0
training Advanced Teacher...
pcb2
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:43<1:12:12, 43.77s/it]epoch [1/100], focal_loss:0.0600	, anomaly_loss:0.5780	fnorm_loss:0.0587, a_fnorm_loss:0.0150P:0.00, R:0.01
normal: 0.1907 0.1966  anomaly: 0.1913 0.1968	P:0.00, R:0.00
Pixel Auroc:0.770, Sample Auroc0.451, Pixel Aupro0.0
test_fnorm_loss: 0.0483 test_afnorm_loss: 0.0119
  2%|▏         | 2/100 [01:05<49:55, 30.56s/it]  epoch [2/100], focal_loss:0.0412	, anomaly_loss:0.6297	fnorm_loss:0.0426, a_fnorm_loss:0.0110P:0.00, R:0.00
  3%|▎         | 3/100 [01:26<42:30, 26.29s/it]epoch [3/100], focal_loss:0.0347	, anomaly_loss:0.6465	fnorm_loss:0.0360, a_fnorm_loss:0.0107P:0.01, R:0.01
  4%|▍         | 4/100 [01:47<38:46, 24.23s/it]epoch [4/100], focal_loss:0.0336	, anomaly_loss:0.6303	fnorm_loss:0.0329, a_fnorm_loss:0.0131P:0.03, R:0.06
  5%|▌         | 5/100 [02:28<47:46, 30.17s/it]epoch [5/100], focal_loss:0.0307	, anomaly_loss:0.5191	fnorm_loss:0.0270, a_fnorm_loss:0.0272P:0.13, R:0.29
normal: 0.1991 0.3986  anomaly: 0.2002 0.4188	P:0.03, R:0.08
Pixel Auroc:0.900, Sample Auroc0.649, Pixel Aupro0.0
test_fnorm_loss: 0.0230 test_afnorm_loss: 0.0266
  6%|▌         | 6/100 [02:50<42:58, 27.43s/it]epoch [6/100], focal_loss:0.0277	, anomaly_loss:0.4778	fnorm_loss:0.0221, a_fnorm_loss:0.0306P:0.25, R:0.47
  7%|▋         | 7/100 [03:11<39:27, 25.46s/it]epoch [7/100], focal_loss:0.0244	, anomaly_loss:0.4621	fnorm_loss:0.0192, a_fnorm_loss:0.0322P:0.28, R:0.57
  8%|▊         | 8/100 [03:33<37:04, 24.18s/it]epoch [8/100], focal_loss:0.0228	, anomaly_loss:0.4568	fnorm_loss:0.0169, a_fnorm_loss:0.0333P:0.22, R:0.56
  9%|▉         | 9/100 [03:54<35:34, 23.45s/it]epoch [9/100], focal_loss:0.0208	, anomaly_loss:0.4306	fnorm_loss:0.0156, a_fnorm_loss:0.0344P:0.28, R:0.65
 10%|█         | 10/100 [04:36<43:34, 29.05s/it]epoch [10/100], focal_loss:0.0200	, anomaly_loss:0.4323	fnorm_loss:0.0147, a_fnorm_loss:0.0352P:0.30, R:0.66
normal: 0.3317 0.5656  anomaly: 0.3537 0.6625	P:0.03, R:0.20
Pixel Auroc:0.922, Sample Auroc0.671, Pixel Aupro0.0
test_fnorm_loss: 0.0166 test_afnorm_loss: 0.0349
 11%|█         | 11/100 [04:57<39:32, 26.66s/it]epoch [11/100], focal_loss:0.0193	, anomaly_loss:0.4009	fnorm_loss:0.0136, a_fnorm_loss:0.0375P:0.31, R:0.75
 12%|█▏        | 12/100 [05:19<36:44, 25.05s/it]epoch [12/100], focal_loss:0.0175	, anomaly_loss:0.4070	fnorm_loss:0.0129, a_fnorm_loss:0.0371P:0.29, R:0.73
 13%|█▎        | 13/100 [05:40<34:34, 23.85s/it]epoch [13/100], focal_loss:0.0173	, anomaly_loss:0.4004	fnorm_loss:0.0122, a_fnorm_loss:0.0376P:0.30, R:0.74
 14%|█▍        | 14/100 [06:01<33:04, 23.07s/it]epoch [14/100], focal_loss:0.0170	, anomaly_loss:0.4009	fnorm_loss:0.0118, a_fnorm_loss:0.0383P:0.31, R:0.74
 15%|█▌        | 15/100 [06:47<42:30, 30.01s/it]epoch [15/100], focal_loss:0.0157	, anomaly_loss:0.3940	fnorm_loss:0.0111, a_fnorm_loss:0.0388P:0.29, R:0.76
normal: 0.1280 0.4545  anomaly: 0.1877 0.6660	P:0.06, R:0.13
Pixel Auroc:0.929, Sample Auroc0.739, Pixel Aupro0.0
test_fnorm_loss: 0.0108 test_afnorm_loss: 0.0288
 16%|█▌        | 16/100 [07:09<38:28, 27.48s/it]epoch [16/100], focal_loss:0.0171	, anomaly_loss:0.3828	fnorm_loss:0.0111, a_fnorm_loss:0.0392P:0.31, R:0.75
 17%|█▋        | 17/100 [07:30<35:29, 25.66s/it]epoch [17/100], focal_loss:0.0166	, anomaly_loss:0.3900	fnorm_loss:0.0107, a_fnorm_loss:0.0386P:0.29, R:0.75
 18%|█▊        | 18/100 [07:51<33:11, 24.29s/it]epoch [18/100], focal_loss:0.0162	, anomaly_loss:0.3909	fnorm_loss:0.0104, a_fnorm_loss:0.0392P:0.30, R:0.77
 19%|█▉        | 19/100 [08:13<31:46, 23.54s/it]epoch [19/100], focal_loss:0.0158	, anomaly_loss:0.3852	fnorm_loss:0.0101, a_fnorm_loss:0.0399P:0.32, R:0.77
 20%|██        | 20/100 [08:59<40:28, 30.36s/it]epoch [20/100], focal_loss:0.0157	, anomaly_loss:0.3745	fnorm_loss:0.0098, a_fnorm_loss:0.0410P:0.34, R:0.80
normal: 0.0684 0.3468  anomaly: 0.1000 0.6189	P:0.07, R:0.10
Pixel Auroc:0.928, Sample Auroc0.808, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0229
 21%|██        | 21/100 [09:21<36:29, 27.72s/it]epoch [21/100], focal_loss:0.0152	, anomaly_loss:0.3760	fnorm_loss:0.0095, a_fnorm_loss:0.0413P:0.33, R:0.79
 22%|██▏       | 22/100 [09:42<33:24, 25.70s/it]epoch [22/100], focal_loss:0.0144	, anomaly_loss:0.3724	fnorm_loss:0.0093, a_fnorm_loss:0.0407P:0.32, R:0.78
 23%|██▎       | 23/100 [10:03<31:17, 24.38s/it]epoch [23/100], focal_loss:0.0161	, anomaly_loss:0.3925	fnorm_loss:0.0094, a_fnorm_loss:0.0390P:0.32, R:0.75
 24%|██▍       | 24/100 [10:25<29:54, 23.62s/it]epoch [24/100], focal_loss:0.0159	, anomaly_loss:0.3753	fnorm_loss:0.0093, a_fnorm_loss:0.0408P:0.33, R:0.78
 25%|██▌       | 25/100 [11:07<36:16, 29.02s/it]epoch [25/100], focal_loss:0.0154	, anomaly_loss:0.3752	fnorm_loss:0.0090, a_fnorm_loss:0.0415P:0.35, R:0.78
normal: 0.1001 0.4769  anomaly: 0.1529 0.6713	P:0.07, R:0.14
Pixel Auroc:0.929, Sample Auroc0.749, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0294
 26%|██▌       | 26/100 [11:28<33:06, 26.85s/it]epoch [26/100], focal_loss:0.0134	, anomaly_loss:0.3655	fnorm_loss:0.0086, a_fnorm_loss:0.0420P:0.35, R:0.81
 27%|██▋       | 27/100 [11:50<30:44, 25.27s/it]epoch [27/100], focal_loss:0.0139	, anomaly_loss:0.3728	fnorm_loss:0.0086, a_fnorm_loss:0.0417P:0.32, R:0.80
 28%|██▊       | 28/100 [12:12<29:02, 24.20s/it]epoch [28/100], focal_loss:0.0136	, anomaly_loss:0.3719	fnorm_loss:0.0086, a_fnorm_loss:0.0415P:0.33, R:0.79
 29%|██▉       | 29/100 [12:33<27:44, 23.44s/it]epoch [29/100], focal_loss:0.0146	, anomaly_loss:0.3633	fnorm_loss:0.0085, a_fnorm_loss:0.0428P:0.36, R:0.82
 30%|███       | 30/100 [13:20<35:27, 30.39s/it]epoch [30/100], focal_loss:0.0153	, anomaly_loss:0.4000	fnorm_loss:0.0086, a_fnorm_loss:0.0402P:0.34, R:0.71
normal: 0.0600 0.3145  anomaly: 0.0993 0.5850	P:0.08, R:0.11
Pixel Auroc:0.940, Sample Auroc0.831, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0238
 31%|███       | 31/100 [13:41<31:45, 27.62s/it]epoch [31/100], focal_loss:0.0139	, anomaly_loss:0.3755	fnorm_loss:0.0082, a_fnorm_loss:0.0416P:0.32, R:0.80
 32%|███▏      | 32/100 [14:03<29:15, 25.81s/it]epoch [32/100], focal_loss:0.0131	, anomaly_loss:0.3706	fnorm_loss:0.0081, a_fnorm_loss:0.0423P:0.32, R:0.81
 33%|███▎      | 33/100 [14:23<27:10, 24.33s/it]epoch [33/100], focal_loss:0.0139	, anomaly_loss:0.3661	fnorm_loss:0.0083, a_fnorm_loss:0.0424P:0.33, R:0.80
 34%|███▍      | 34/100 [14:45<25:50, 23.50s/it]epoch [34/100], focal_loss:0.0141	, anomaly_loss:0.3732	fnorm_loss:0.0082, a_fnorm_loss:0.0418P:0.34, R:0.80
 35%|███▌      | 35/100 [15:31<32:44, 30.22s/it]epoch [35/100], focal_loss:0.0140	, anomaly_loss:0.3718	fnorm_loss:0.0081, a_fnorm_loss:0.0419P:0.35, R:0.79
normal: 0.0794 0.4236  anomaly: 0.1022 0.6615	P:0.09, R:0.13
Pixel Auroc:0.948, Sample Auroc0.831, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0273
 36%|███▌      | 36/100 [15:53<29:32, 27.69s/it]epoch [36/100], focal_loss:0.0128	, anomaly_loss:0.3577	fnorm_loss:0.0078, a_fnorm_loss:0.0438P:0.36, R:0.83
 37%|███▋      | 37/100 [16:14<27:07, 25.83s/it]epoch [37/100], focal_loss:0.0132	, anomaly_loss:0.3658	fnorm_loss:0.0078, a_fnorm_loss:0.0429P:0.33, R:0.80
 38%|███▊      | 38/100 [16:36<25:18, 24.50s/it]epoch [38/100], focal_loss:0.0128	, anomaly_loss:0.3568	fnorm_loss:0.0078, a_fnorm_loss:0.0431P:0.35, R:0.83
 39%|███▉      | 39/100 [16:57<23:59, 23.61s/it]epoch [39/100], focal_loss:0.0138	, anomaly_loss:0.3607	fnorm_loss:0.0079, a_fnorm_loss:0.0432P:0.37, R:0.81
 40%|████      | 40/100 [17:39<28:59, 28.98s/it]epoch [40/100], focal_loss:0.0131	, anomaly_loss:0.3604	fnorm_loss:0.0077, a_fnorm_loss:0.0438P:0.34, R:0.81
normal: 0.3077 0.6608  anomaly: 0.3190 0.7318	P:0.03, R:0.20
Pixel Auroc:0.930, Sample Auroc0.659, Pixel Aupro0.0
test_fnorm_loss: 0.0115 test_afnorm_loss: 0.0357
 41%|████      | 41/100 [18:01<26:24, 26.85s/it]epoch [41/100], focal_loss:0.0125	, anomaly_loss:0.3588	fnorm_loss:0.0078, a_fnorm_loss:0.0438P:0.35, R:0.82
 42%|████▏     | 42/100 [18:23<24:32, 25.39s/it]epoch [42/100], focal_loss:0.0128	, anomaly_loss:0.3595	fnorm_loss:0.0077, a_fnorm_loss:0.0432P:0.34, R:0.82
 43%|████▎     | 43/100 [18:43<22:47, 24.00s/it]epoch [43/100], focal_loss:0.0129	, anomaly_loss:0.3589	fnorm_loss:0.0077, a_fnorm_loss:0.0430P:0.35, R:0.82
 44%|████▍     | 44/100 [19:05<21:42, 23.26s/it]epoch [44/100], focal_loss:0.0117	, anomaly_loss:0.3535	fnorm_loss:0.0074, a_fnorm_loss:0.0451P:0.36, R:0.85
 45%|████▌     | 45/100 [19:46<26:07, 28.51s/it]epoch [45/100], focal_loss:0.0141	, anomaly_loss:0.3732	fnorm_loss:0.0077, a_fnorm_loss:0.0425P:0.35, R:0.79
normal: 0.0521 0.4131  anomaly: 0.0783 0.6545	P:0.08, R:0.14
Pixel Auroc:0.944, Sample Auroc0.806, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0285
 46%|████▌     | 46/100 [20:07<23:45, 26.40s/it]epoch [46/100], focal_loss:0.0133	, anomaly_loss:0.3597	fnorm_loss:0.0076, a_fnorm_loss:0.0439P:0.37, R:0.82
 47%|████▋     | 47/100 [20:28<22:00, 24.91s/it]epoch [47/100], focal_loss:0.0127	, anomaly_loss:0.3590	fnorm_loss:0.0076, a_fnorm_loss:0.0436P:0.35, R:0.82
 48%|████▊     | 48/100 [20:50<20:45, 23.96s/it]epoch [48/100], focal_loss:0.0123	, anomaly_loss:0.3510	fnorm_loss:0.0076, a_fnorm_loss:0.0436P:0.33, R:0.83
 49%|████▉     | 49/100 [21:12<19:47, 23.27s/it]epoch [49/100], focal_loss:0.0126	, anomaly_loss:0.3592	fnorm_loss:0.0074, a_fnorm_loss:0.0440P:0.35, R:0.82
 50%|█████     | 50/100 [21:52<23:39, 28.38s/it]epoch [50/100], focal_loss:0.0128	, anomaly_loss:0.3591	fnorm_loss:0.0075, a_fnorm_loss:0.0434P:0.36, R:0.81
normal: 0.2342 0.5777  anomaly: 0.2654 0.7082	P:0.05, R:0.20
Pixel Auroc:0.949, Sample Auroc0.787, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0370
 51%|█████     | 51/100 [22:13<21:19, 26.11s/it]epoch [51/100], focal_loss:0.0130	, anomaly_loss:0.3593	fnorm_loss:0.0076, a_fnorm_loss:0.0431P:0.34, R:0.81
 52%|█████▏    | 52/100 [22:35<19:47, 24.73s/it]epoch [52/100], focal_loss:0.0120	, anomaly_loss:0.3525	fnorm_loss:0.0073, a_fnorm_loss:0.0444P:0.37, R:0.83
 53%|█████▎    | 53/100 [22:55<18:29, 23.60s/it]epoch [53/100], focal_loss:0.0129	, anomaly_loss:0.3578	fnorm_loss:0.0075, a_fnorm_loss:0.0433P:0.36, R:0.82
 54%|█████▍    | 54/100 [23:17<17:32, 22.88s/it]epoch [54/100], focal_loss:0.0127	, anomaly_loss:0.3547	fnorm_loss:0.0075, a_fnorm_loss:0.0442P:0.36, R:0.80
 55%|█████▌    | 55/100 [23:57<21:09, 28.21s/it]epoch [55/100], focal_loss:0.0123	, anomaly_loss:0.3587	fnorm_loss:0.0074, a_fnorm_loss:0.0435P:0.35, R:0.82
normal: 0.1086 0.5305  anomaly: 0.1710 0.6971	P:0.08, R:0.17
Pixel Auroc:0.944, Sample Auroc0.814, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0312
 56%|█████▌    | 56/100 [24:19<19:20, 26.37s/it]epoch [56/100], focal_loss:0.0128	, anomaly_loss:0.3595	fnorm_loss:0.0074, a_fnorm_loss:0.0441P:0.39, R:0.83
 57%|█████▋    | 57/100 [24:41<17:48, 24.85s/it]epoch [57/100], focal_loss:0.0116	, anomaly_loss:0.3494	fnorm_loss:0.0073, a_fnorm_loss:0.0432P:0.32, R:0.81
 58%|█████▊    | 58/100 [25:02<16:44, 23.91s/it]epoch [58/100], focal_loss:0.0120	, anomaly_loss:0.3467	fnorm_loss:0.0073, a_fnorm_loss:0.0452P:0.36, R:0.82
 59%|█████▉    | 59/100 [25:25<15:58, 23.38s/it]epoch [59/100], focal_loss:0.0128	, anomaly_loss:0.3600	fnorm_loss:0.0075, a_fnorm_loss:0.0429P:0.35, R:0.81
 60%|██████    | 60/100 [26:11<20:17, 30.44s/it]epoch [60/100], focal_loss:0.0129	, anomaly_loss:0.3537	fnorm_loss:0.0074, a_fnorm_loss:0.0446P:0.37, R:0.83
normal: 0.0432 0.4529  anomaly: 0.0742 0.6453	P:0.10, R:0.13
Pixel Auroc:0.952, Sample Auroc0.875, Pixel Aupro0.0
test_fnorm_loss: 0.0056 test_afnorm_loss: 0.0252
 61%|██████    | 61/100 [26:33<18:03, 27.78s/it]epoch [61/100], focal_loss:0.0118	, anomaly_loss:0.3594	fnorm_loss:0.0073, a_fnorm_loss:0.0440P:0.34, R:0.82
 62%|██████▏   | 62/100 [26:55<16:30, 26.06s/it]epoch [62/100], focal_loss:0.0114	, anomaly_loss:0.3392	fnorm_loss:0.0070, a_fnorm_loss:0.0463P:0.38, R:0.85
 63%|██████▎   | 63/100 [27:16<15:05, 24.48s/it]epoch [63/100], focal_loss:0.0120	, anomaly_loss:0.3472	fnorm_loss:0.0072, a_fnorm_loss:0.0447P:0.38, R:0.85
 64%|██████▍   | 64/100 [27:38<14:11, 23.64s/it]epoch [64/100], focal_loss:0.0125	, anomaly_loss:0.3445	fnorm_loss:0.0073, a_fnorm_loss:0.0448P:0.37, R:0.84
 65%|██████▌   | 65/100 [28:18<16:47, 28.79s/it]epoch [65/100], focal_loss:0.0108	, anomaly_loss:0.3454	fnorm_loss:0.0071, a_fnorm_loss:0.0450P:0.35, R:0.84
normal: 0.1023 0.5960  anomaly: 0.1711 0.6816	P:0.07, R:0.18
Pixel Auroc:0.944, Sample Auroc0.781, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0337
 66%|██████▌   | 66/100 [28:39<15:00, 26.49s/it]epoch [66/100], focal_loss:0.0122	, anomaly_loss:0.3450	fnorm_loss:0.0073, a_fnorm_loss:0.0450P:0.36, R:0.84
 67%|██████▋   | 67/100 [29:00<13:37, 24.79s/it]epoch [67/100], focal_loss:0.0128	, anomaly_loss:0.3542	fnorm_loss:0.0074, a_fnorm_loss:0.0442P:0.35, R:0.83
 68%|██████▊   | 68/100 [29:22<12:47, 23.98s/it]epoch [68/100], focal_loss:0.0119	, anomaly_loss:0.3497	fnorm_loss:0.0072, a_fnorm_loss:0.0444P:0.37, R:0.83
 69%|██████▉   | 69/100 [29:44<12:00, 23.24s/it]epoch [69/100], focal_loss:0.0118	, anomaly_loss:0.3449	fnorm_loss:0.0073, a_fnorm_loss:0.0451P:0.36, R:0.84
 70%|███████   | 70/100 [30:25<14:14, 28.49s/it]epoch [70/100], focal_loss:0.0113	, anomaly_loss:0.3503	fnorm_loss:0.0071, a_fnorm_loss:0.0444P:0.36, R:0.84
normal: 0.0815 0.4895  anomaly: 0.1329 0.6946	P:0.09, R:0.18
Pixel Auroc:0.958, Sample Auroc0.859, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0347
 71%|███████   | 71/100 [30:46<12:43, 26.33s/it]epoch [71/100], focal_loss:0.0109	, anomaly_loss:0.3511	fnorm_loss:0.0071, a_fnorm_loss:0.0456P:0.35, R:0.84
 72%|███████▏  | 72/100 [31:07<11:33, 24.76s/it]epoch [72/100], focal_loss:0.0111	, anomaly_loss:0.3482	fnorm_loss:0.0071, a_fnorm_loss:0.0459P:0.37, R:0.85
 73%|███████▎  | 73/100 [31:29<10:43, 23.82s/it]epoch [73/100], focal_loss:0.0117	, anomaly_loss:0.3468	fnorm_loss:0.0072, a_fnorm_loss:0.0445P:0.35, R:0.84
 74%|███████▍  | 74/100 [31:51<10:04, 23.24s/it]epoch [74/100], focal_loss:0.0121	, anomaly_loss:0.3431	fnorm_loss:0.0072, a_fnorm_loss:0.0451P:0.37, R:0.85
 75%|███████▌  | 75/100 [32:36<12:28, 29.95s/it]epoch [75/100], focal_loss:0.0112	, anomaly_loss:0.3488	fnorm_loss:0.0070, a_fnorm_loss:0.0456P:0.37, R:0.85
normal: 0.0700 0.4727  anomaly: 0.0791 0.6490	P:0.11, R:0.17
Pixel Auroc:0.952, Sample Auroc0.847, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0304
 76%|███████▌  | 76/100 [32:58<10:58, 27.44s/it]epoch [76/100], focal_loss:0.0124	, anomaly_loss:0.3508	fnorm_loss:0.0073, a_fnorm_loss:0.0440P:0.37, R:0.82
 77%|███████▋  | 77/100 [33:19<09:49, 25.61s/it]epoch [77/100], focal_loss:0.0119	, anomaly_loss:0.3487	fnorm_loss:0.0072, a_fnorm_loss:0.0444P:0.38, R:0.85
 78%|███████▊  | 78/100 [33:41<08:57, 24.41s/it]epoch [78/100], focal_loss:0.0104	, anomaly_loss:0.3449	fnorm_loss:0.0070, a_fnorm_loss:0.0453P:0.35, R:0.85
 79%|███████▉  | 79/100 [34:02<08:14, 23.54s/it]epoch [79/100], focal_loss:0.0107	, anomaly_loss:0.3481	fnorm_loss:0.0069, a_fnorm_loss:0.0457P:0.37, R:0.84
 80%|████████  | 80/100 [34:43<09:36, 28.84s/it]epoch [80/100], focal_loss:0.0120	, anomaly_loss:0.3555	fnorm_loss:0.0072, a_fnorm_loss:0.0447P:0.38, R:0.83
normal: 0.1325 0.4398  anomaly: 0.1869 0.6884	P:0.10, R:0.18
Pixel Auroc:0.957, Sample Auroc0.864, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0344
 81%|████████  | 81/100 [35:05<08:25, 26.59s/it]epoch [81/100], focal_loss:0.0109	, anomaly_loss:0.3435	fnorm_loss:0.0072, a_fnorm_loss:0.0456P:0.36, R:0.85
 82%|████████▏ | 82/100 [35:26<07:32, 25.13s/it]epoch [82/100], focal_loss:0.0108	, anomaly_loss:0.3361	fnorm_loss:0.0070, a_fnorm_loss:0.0472P:0.37, R:0.87
 83%|████████▎ | 83/100 [35:48<06:50, 24.15s/it]epoch [83/100], focal_loss:0.0111	, anomaly_loss:0.3366	fnorm_loss:0.0070, a_fnorm_loss:0.0469P:0.38, R:0.87
 84%|████████▍ | 84/100 [36:10<06:12, 23.29s/it]epoch [84/100], focal_loss:0.0104	, anomaly_loss:0.3279	fnorm_loss:0.0070, a_fnorm_loss:0.0472P:0.37, R:0.88
 85%|████████▌ | 85/100 [36:51<07:09, 28.66s/it]epoch [85/100], focal_loss:0.0108	, anomaly_loss:0.3372	fnorm_loss:0.0070, a_fnorm_loss:0.0461P:0.37, R:0.86
normal: 0.1153 0.6104  anomaly: 0.1636 0.7324	P:0.08, R:0.20
Pixel Auroc:0.956, Sample Auroc0.804, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0378
 86%|████████▌ | 86/100 [37:12<06:10, 26.48s/it]epoch [86/100], focal_loss:0.0106	, anomaly_loss:0.3292	fnorm_loss:0.0069, a_fnorm_loss:0.0478P:0.37, R:0.87
 87%|████████▋ | 87/100 [37:34<05:24, 24.94s/it]epoch [87/100], focal_loss:0.0112	, anomaly_loss:0.3386	fnorm_loss:0.0070, a_fnorm_loss:0.0466P:0.34, R:0.85
 88%|████████▊ | 88/100 [37:55<04:46, 23.88s/it]epoch [88/100], focal_loss:0.0106	, anomaly_loss:0.3373	fnorm_loss:0.0069, a_fnorm_loss:0.0466P:0.35, R:0.86
 89%|████████▉ | 89/100 [38:16<04:12, 22.98s/it]epoch [89/100], focal_loss:0.0104	, anomaly_loss:0.3343	fnorm_loss:0.0069, a_fnorm_loss:0.0468P:0.37, R:0.87
 90%|█████████ | 90/100 [38:56<04:42, 28.27s/it]epoch [90/100], focal_loss:0.0096	, anomaly_loss:0.3308	fnorm_loss:0.0068, a_fnorm_loss:0.0479P:0.37, R:0.88
normal: 0.0746 0.5741  anomaly: 0.1410 0.7197	P:0.09, R:0.19
Pixel Auroc:0.962, Sample Auroc0.870, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0371
 91%|█████████ | 91/100 [39:18<03:57, 26.36s/it]epoch [91/100], focal_loss:0.0104	, anomaly_loss:0.3403	fnorm_loss:0.0069, a_fnorm_loss:0.0465P:0.35, R:0.85
 92%|█████████▏| 92/100 [39:40<03:18, 24.81s/it]epoch [92/100], focal_loss:0.0102	, anomaly_loss:0.3390	fnorm_loss:0.0069, a_fnorm_loss:0.0459P:0.34, R:0.86
 93%|█████████▎| 93/100 [40:01<02:47, 23.95s/it]epoch [93/100], focal_loss:0.0104	, anomaly_loss:0.3325	fnorm_loss:0.0069, a_fnorm_loss:0.0475P:0.36, R:0.88
 94%|█████████▍| 94/100 [40:23<02:20, 23.35s/it]epoch [94/100], focal_loss:0.0104	, anomaly_loss:0.3380	fnorm_loss:0.0069, a_fnorm_loss:0.0464P:0.36, R:0.87
 95%|█████████▌| 95/100 [41:04<02:22, 28.60s/it]epoch [95/100], focal_loss:0.0106	, anomaly_loss:0.3376	fnorm_loss:0.0069, a_fnorm_loss:0.0465P:0.36, R:0.86
normal: 0.0953 0.5962  anomaly: 0.1866 0.7248	P:0.09, R:0.19
Pixel Auroc:0.959, Sample Auroc0.837, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0377
 96%|█████████▌| 96/100 [41:25<01:44, 26.21s/it]epoch [96/100], focal_loss:0.0101	, anomaly_loss:0.3281	fnorm_loss:0.0069, a_fnorm_loss:0.0477P:0.35, R:0.88
 97%|█████████▋| 97/100 [41:46<01:14, 24.78s/it]epoch [97/100], focal_loss:0.0113	, anomaly_loss:0.3358	fnorm_loss:0.0069, a_fnorm_loss:0.0468P:0.39, R:0.86
 98%|█████████▊| 98/100 [42:08<00:47, 23.70s/it]epoch [98/100], focal_loss:0.0110	, anomaly_loss:0.3420	fnorm_loss:0.0070, a_fnorm_loss:0.0466P:0.35, R:0.87
 99%|█████████▉| 99/100 [42:28<00:22, 22.84s/it]epoch [99/100], focal_loss:0.0106	, anomaly_loss:0.3327	fnorm_loss:0.0070, a_fnorm_loss:0.0468P:0.35, R:0.87
100%|██████████| 100/100 [43:10<00:00, 28.41s/it]100%|██████████| 100/100 [43:10<00:00, 25.90s/it]
epoch [100/100], focal_loss:0.0110	, anomaly_loss:0.3405	fnorm_loss:0.0069, a_fnorm_loss:0.0464P:0.38, R:0.86
normal: 0.0958 0.5847  anomaly: 0.1820 0.7165	P:0.09, R:0.19
Pixel Auroc:0.959, Sample Auroc0.840, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0378
training Stubborn Student...
pcb2
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<31:54, 16.09s/it]epoch [1/120], kd_loss:4.2762
  2%|▏         | 2/120 [00:32<31:50, 16.19s/it]epoch [2/120], kd_loss:2.9709
  2%|▎         | 3/120 [00:48<31:43, 16.27s/it]epoch [3/120], kd_loss:2.6498
  3%|▎         | 4/120 [01:05<31:31, 16.31s/it]epoch [4/120], kd_loss:2.4287
  4%|▍         | 5/120 [01:21<31:16, 16.32s/it]epoch [5/120], kd_loss:3.4436
  5%|▌         | 6/120 [01:37<31:02, 16.34s/it]epoch [6/120], kd_loss:3.0192
  6%|▌         | 7/120 [01:54<30:46, 16.34s/it]epoch [7/120], kd_loss:3.1998
  7%|▋         | 8/120 [02:10<30:33, 16.37s/it]epoch [8/120], kd_loss:2.7248
  8%|▊         | 9/120 [02:26<30:19, 16.39s/it]epoch [9/120], kd_loss:2.2147
  8%|▊         | 10/120 [03:01<40:23, 22.03s/it]epoch [10/120], kd_loss:2.0845
normal: 1.3480 1.7838  anomaly: 1.4233 2.2752
thresh: 1.4958484958436595
fpr: 0.34 fnr 0.06
Pixel Auroc:0.952, Sample Auroc0.901, Pixel Aupro0.0
  9%|▉         | 11/120 [03:17<36:48, 20.26s/it]epoch [11/120], kd_loss:2.0951
 10%|█         | 12/120 [03:34<34:16, 19.04s/it]epoch [12/120], kd_loss:2.0189
 11%|█         | 13/120 [03:50<32:32, 18.25s/it]epoch [13/120], kd_loss:1.9143
 12%|█▏        | 14/120 [04:06<31:12, 17.67s/it]epoch [14/120], kd_loss:1.8365
 12%|█▎        | 15/120 [04:23<30:16, 17.30s/it]epoch [15/120], kd_loss:1.8466
 13%|█▎        | 16/120 [04:39<29:29, 17.01s/it]epoch [16/120], kd_loss:1.7730
 14%|█▍        | 17/120 [04:56<28:54, 16.84s/it]epoch [17/120], kd_loss:2.3211
 15%|█▌        | 18/120 [05:12<28:22, 16.69s/it]epoch [18/120], kd_loss:1.7999
 16%|█▌        | 19/120 [05:28<27:58, 16.62s/it]epoch [19/120], kd_loss:1.7767
 17%|█▋        | 20/120 [06:05<37:26, 22.47s/it]epoch [20/120], kd_loss:1.7137
normal: 1.2923 1.7236  anomaly: 1.3543 2.2353
thresh: 1.4521561795862046
fpr: 0.14 fnr 0.15
Pixel Auroc:0.933, Sample Auroc0.914, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:21<33:57, 20.59s/it]epoch [21/120], kd_loss:1.7594
 18%|█▊        | 22/120 [06:37<31:29, 19.28s/it]epoch [22/120], kd_loss:1.7025
 19%|█▉        | 23/120 [06:53<29:44, 18.40s/it]epoch [23/120], kd_loss:1.6619
 20%|██        | 24/120 [07:10<28:28, 17.79s/it]epoch [24/120], kd_loss:1.8479
 21%|██        | 25/120 [07:26<27:34, 17.42s/it]epoch [25/120], kd_loss:1.7804
 22%|██▏       | 26/120 [07:43<26:51, 17.14s/it]epoch [26/120], kd_loss:1.6830
 22%|██▎       | 27/120 [07:59<26:11, 16.90s/it]epoch [27/120], kd_loss:1.6957
 23%|██▎       | 28/120 [08:15<25:40, 16.74s/it]epoch [28/120], kd_loss:1.6781
 24%|██▍       | 29/120 [08:32<25:15, 16.65s/it]epoch [29/120], kd_loss:1.6155
 25%|██▌       | 30/120 [09:11<35:03, 23.37s/it]epoch [30/120], kd_loss:1.6303
normal: 0.9637 1.5480  anomaly: 1.0069 2.0767
thresh: 1.1470010444421588
fpr: 0.23 fnr 0.07
Pixel Auroc:0.969, Sample Auroc0.926, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:27<31:32, 21.26s/it]epoch [31/120], kd_loss:1.5923
 27%|██▋       | 32/120 [09:44<29:03, 19.82s/it]epoch [32/120], kd_loss:1.6037
 28%|██▊       | 33/120 [10:00<27:14, 18.78s/it]epoch [33/120], kd_loss:1.6190
 28%|██▊       | 34/120 [10:16<25:54, 18.07s/it]epoch [34/120], kd_loss:1.5506
 29%|██▉       | 35/120 [10:33<24:52, 17.55s/it]epoch [35/120], kd_loss:1.6300
 30%|███       | 36/120 [10:49<24:10, 17.27s/it]epoch [36/120], kd_loss:1.5358
 31%|███       | 37/120 [11:06<23:32, 17.01s/it]epoch [37/120], kd_loss:1.6331
 32%|███▏      | 38/120 [11:22<22:58, 16.81s/it]epoch [38/120], kd_loss:1.6959
 32%|███▎      | 39/120 [11:39<22:30, 16.67s/it]epoch [39/120], kd_loss:1.6130
 33%|███▎      | 40/120 [12:13<29:15, 21.94s/it]epoch [40/120], kd_loss:1.5969
normal: 1.1373 1.6422  anomaly: 1.2162 2.0125
thresh: 1.3224532840570362
fpr: 0.25 fnr 0.08
Pixel Auroc:0.971, Sample Auroc0.915, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:29<26:38, 20.23s/it]epoch [41/120], kd_loss:1.6989
 35%|███▌      | 42/120 [12:45<24:45, 19.04s/it]epoch [42/120], kd_loss:1.5627
 36%|███▌      | 43/120 [13:02<23:24, 18.24s/it]epoch [43/120], kd_loss:1.5626
 37%|███▋      | 44/120 [13:18<22:23, 17.68s/it]epoch [44/120], kd_loss:1.5556
 38%|███▊      | 45/120 [13:34<21:36, 17.29s/it]epoch [45/120], kd_loss:1.6786
 38%|███▊      | 46/120 [13:51<20:58, 17.01s/it]epoch [46/120], kd_loss:1.5668
 39%|███▉      | 47/120 [14:07<20:26, 16.81s/it]epoch [47/120], kd_loss:1.7326
 40%|████      | 48/120 [14:23<20:01, 16.68s/it]epoch [48/120], kd_loss:1.5643
 41%|████      | 49/120 [14:40<19:42, 16.65s/it]epoch [49/120], kd_loss:1.5867
 42%|████▏     | 50/120 [15:15<25:42, 22.03s/it]epoch [50/120], kd_loss:1.5611
normal: 1.0033 1.6340  anomaly: 0.9987 2.0546
thresh: 1.2087087881206378
fpr: 0.19 fnr 0.14
Pixel Auroc:0.969, Sample Auroc0.898, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:31<23:19, 20.28s/it]epoch [51/120], kd_loss:1.7501
 43%|████▎     | 52/120 [15:47<21:38, 19.09s/it]epoch [52/120], kd_loss:1.5940
 44%|████▍     | 53/120 [16:04<20:25, 18.28s/it]epoch [53/120], kd_loss:1.6526
 45%|████▌     | 54/120 [16:20<19:28, 17.71s/it]epoch [54/120], kd_loss:1.8372
 46%|████▌     | 55/120 [16:36<18:45, 17.32s/it]epoch [55/120], kd_loss:2.0737
 47%|████▋     | 56/120 [16:53<18:09, 17.02s/it]epoch [56/120], kd_loss:2.4525
 48%|████▊     | 57/120 [17:09<17:40, 16.83s/it]epoch [57/120], kd_loss:2.1964
 48%|████▊     | 58/120 [17:25<17:14, 16.69s/it]epoch [58/120], kd_loss:1.9942
 49%|████▉     | 59/120 [17:42<16:53, 16.62s/it]epoch [59/120], kd_loss:1.9090
 50%|█████     | 60/120 [18:17<22:05, 22.10s/it]epoch [60/120], kd_loss:1.8468
normal: 1.1357 1.7582  anomaly: 1.1829 2.1525
thresh: 1.3808002863667825
fpr: 0.12 fnr 0.15
Pixel Auroc:0.962, Sample Auroc0.925, Pixel Aupro0.0
 51%|█████     | 61/120 [18:33<19:59, 20.33s/it]epoch [61/120], kd_loss:1.7879
 52%|█████▏    | 62/120 [18:49<18:29, 19.13s/it]epoch [62/120], kd_loss:1.7681
 52%|█████▎    | 63/120 [19:06<17:24, 18.33s/it]epoch [63/120], kd_loss:1.7075
 53%|█████▎    | 64/120 [19:22<16:34, 17.76s/it]epoch [64/120], kd_loss:1.8597
 54%|█████▍    | 65/120 [19:39<15:55, 17.38s/it]epoch [65/120], kd_loss:1.7815
 55%|█████▌    | 66/120 [19:55<15:24, 17.12s/it]epoch [66/120], kd_loss:1.6923
 56%|█████▌    | 67/120 [20:12<14:55, 16.89s/it]epoch [67/120], kd_loss:1.8522
 57%|█████▋    | 68/120 [20:28<14:29, 16.73s/it]epoch [68/120], kd_loss:1.6842
 57%|█████▊    | 69/120 [20:44<14:07, 16.62s/it]epoch [69/120], kd_loss:1.6756
 58%|█████▊    | 70/120 [21:23<19:27, 23.34s/it]epoch [70/120], kd_loss:1.6261
normal: 0.9851 1.5869  anomaly: 1.0275 2.1615
thresh: 1.2169159991232572
fpr: 0.17 fnr 0.11
Pixel Auroc:0.969, Sample Auroc0.930, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:40<17:20, 21.24s/it]epoch [71/120], kd_loss:1.6010
 60%|██████    | 72/120 [21:56<15:48, 19.77s/it]epoch [72/120], kd_loss:1.6130
 61%|██████    | 73/120 [22:12<14:40, 18.74s/it]epoch [73/120], kd_loss:1.5752
 62%|██████▏   | 74/120 [22:29<13:50, 18.06s/it]epoch [74/120], kd_loss:1.6013
 62%|██████▎   | 75/120 [22:45<13:09, 17.55s/it]epoch [75/120], kd_loss:1.5986
 63%|██████▎   | 76/120 [23:01<12:36, 17.19s/it]epoch [76/120], kd_loss:1.5577
 64%|██████▍   | 77/120 [23:18<12:08, 16.94s/it]epoch [77/120], kd_loss:1.5632
 65%|██████▌   | 78/120 [23:34<11:44, 16.78s/it]epoch [78/120], kd_loss:1.5977
 66%|██████▌   | 79/120 [23:51<11:23, 16.66s/it]epoch [79/120], kd_loss:1.5945
 67%|██████▋   | 80/120 [24:29<15:23, 23.08s/it]epoch [80/120], kd_loss:1.5508
normal: 0.9779 1.6561  anomaly: 1.0617 2.2206
thresh: 1.2302380665819856
fpr: 0.13 fnr 0.15
Pixel Auroc:0.959, Sample Auroc0.902, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:45<13:40, 21.03s/it]epoch [81/120], kd_loss:1.5607
 68%|██████▊   | 82/120 [25:01<12:24, 19.60s/it]epoch [82/120], kd_loss:1.5837
 69%|██████▉   | 83/120 [25:18<11:30, 18.66s/it]epoch [83/120], kd_loss:1.5973
 70%|███████   | 84/120 [25:34<10:47, 17.99s/it]epoch [84/120], kd_loss:1.5828
 71%|███████   | 85/120 [25:51<10:13, 17.52s/it]epoch [85/120], kd_loss:1.8787
 72%|███████▏  | 86/120 [26:07<09:45, 17.22s/it]epoch [86/120], kd_loss:1.6118
 72%|███████▎  | 87/120 [26:23<09:19, 16.96s/it]epoch [87/120], kd_loss:1.6509
 73%|███████▎  | 88/120 [26:40<08:56, 16.78s/it]epoch [88/120], kd_loss:1.6139
 74%|███████▍  | 89/120 [26:56<08:35, 16.64s/it]epoch [89/120], kd_loss:1.6331
 75%|███████▌  | 90/120 [27:31<10:59, 21.98s/it]epoch [90/120], kd_loss:1.6002
normal: 0.9792 1.6868  anomaly: 1.0298 2.1910
thresh: 1.2735480733285698
fpr: 0.03 fnr 0.24
Pixel Auroc:0.958, Sample Auroc0.917, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:47<09:46, 20.23s/it]epoch [91/120], kd_loss:1.6654
 77%|███████▋  | 92/120 [28:03<08:53, 19.05s/it]epoch [92/120], kd_loss:1.6409
 78%|███████▊  | 93/120 [28:19<08:12, 18.24s/it]epoch [93/120], kd_loss:1.5436
 78%|███████▊  | 94/120 [28:36<07:39, 17.66s/it]epoch [94/120], kd_loss:1.5275
 79%|███████▉  | 95/120 [28:52<07:11, 17.27s/it]epoch [95/120], kd_loss:1.6177
 80%|████████  | 96/120 [29:08<06:48, 17.00s/it]epoch [96/120], kd_loss:1.5608
 81%|████████  | 97/120 [29:25<06:26, 16.80s/it]epoch [97/120], kd_loss:1.5252
 82%|████████▏ | 98/120 [29:41<06:06, 16.66s/it]epoch [98/120], kd_loss:1.5129
 82%|████████▎ | 99/120 [29:57<05:48, 16.58s/it]epoch [99/120], kd_loss:1.5040
 83%|████████▎ | 100/120 [30:32<07:19, 21.95s/it]epoch [100/120], kd_loss:1.4979
normal: 0.9110 1.6633  anomaly: 0.9985 2.1968
thresh: 1.1035997002255635
fpr: 0.26 fnr 0.06
Pixel Auroc:0.963, Sample Auroc0.918, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:48<06:23, 20.21s/it]epoch [101/120], kd_loss:1.4930
 85%|████████▌ | 102/120 [31:04<05:42, 19.03s/it]epoch [102/120], kd_loss:1.4950
 86%|████████▌ | 103/120 [31:21<05:09, 18.20s/it]epoch [103/120], kd_loss:1.4860
 87%|████████▋ | 104/120 [31:37<04:42, 17.65s/it]epoch [104/120], kd_loss:1.4816
 88%|████████▊ | 105/120 [31:53<04:18, 17.26s/it]epoch [105/120], kd_loss:1.4766
 88%|████████▊ | 106/120 [32:10<03:57, 16.98s/it]epoch [106/120], kd_loss:1.4825
 89%|████████▉ | 107/120 [32:26<03:38, 16.78s/it]epoch [107/120], kd_loss:1.4835
 90%|█████████ | 108/120 [32:42<03:19, 16.66s/it]epoch [108/120], kd_loss:1.4966
 91%|█████████ | 109/120 [32:59<03:02, 16.56s/it]epoch [109/120], kd_loss:1.4784
 92%|█████████▏| 110/120 [33:33<03:38, 21.89s/it]epoch [110/120], kd_loss:1.4755
normal: 0.8771 1.6986  anomaly: 0.9713 2.1173
thresh: 1.1274434416041073
fpr: 0.18 fnr 0.14
Pixel Auroc:0.964, Sample Auroc0.917, Pixel Aupro0.0
 92%|█████████▎| 111/120 [33:49<03:01, 20.18s/it]epoch [111/120], kd_loss:1.4740
 93%|█████████▎| 112/120 [34:05<02:32, 19.00s/it]epoch [112/120], kd_loss:1.4717
 94%|█████████▍| 113/120 [34:22<02:07, 18.21s/it]epoch [113/120], kd_loss:1.4699
 95%|█████████▌| 114/120 [34:38<01:45, 17.65s/it]epoch [114/120], kd_loss:1.4703
 96%|█████████▌| 115/120 [34:54<01:26, 17.27s/it]epoch [115/120], kd_loss:1.4672
 97%|█████████▋| 116/120 [35:11<01:07, 16.99s/it]epoch [116/120], kd_loss:1.4662
 98%|█████████▊| 117/120 [35:27<00:50, 16.81s/it]epoch [117/120], kd_loss:1.4654
 98%|█████████▊| 118/120 [35:44<00:33, 16.69s/it]epoch [118/120], kd_loss:1.4641
 99%|█████████▉| 119/120 [36:00<00:16, 16.58s/it]epoch [119/120], kd_loss:1.4643
100%|██████████| 120/120 [36:35<00:00, 21.98s/it]100%|██████████| 120/120 [36:35<00:00, 18.29s/it]
epoch [120/120], kd_loss:1.4644
normal: 0.8965 1.6822  anomaly: 0.9549 2.1713
thresh: 1.1050941413971909
fpr: 0.23 fnr 0.12
Pixel Auroc:0.964, Sample Auroc0.910, Pixel Aupro0.0
training Advanced Teacher...
pcb3
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:46<1:16:17, 46.23s/it]epoch [1/100], focal_loss:0.0594	, anomaly_loss:0.5602	fnorm_loss:0.0631, a_fnorm_loss:0.0148P:0.00, R:0.01
normal: 0.1893 0.1938  anomaly: 0.1884 0.1943	P:0.00, R:0.00
Pixel Auroc:0.845, Sample Auroc0.584, Pixel Aupro0.0
test_fnorm_loss: 0.0520 test_afnorm_loss: 0.0121
  2%|▏         | 2/100 [01:07<51:58, 31.82s/it]  epoch [2/100], focal_loss:0.0372	, anomaly_loss:0.6190	fnorm_loss:0.0453, a_fnorm_loss:0.0107P:0.00, R:0.00
  3%|▎         | 3/100 [01:29<43:58, 27.20s/it]epoch [3/100], focal_loss:0.0328	, anomaly_loss:0.5888	fnorm_loss:0.0377, a_fnorm_loss:0.0172P:0.01, R:0.12
  4%|▍         | 4/100 [01:51<40:16, 25.17s/it]epoch [4/100], focal_loss:0.0312	, anomaly_loss:0.5164	fnorm_loss:0.0308, a_fnorm_loss:0.0281P:0.05, R:0.24
  5%|▌         | 5/100 [02:33<49:05, 31.01s/it]epoch [5/100], focal_loss:0.0259	, anomaly_loss:0.4647	fnorm_loss:0.0254, a_fnorm_loss:0.0323P:0.16, R:0.42
normal: 0.1750 0.3770  anomaly: 0.1780 0.3987	P:0.03, R:0.03
Pixel Auroc:0.912, Sample Auroc0.643, Pixel Aupro0.0
test_fnorm_loss: 0.0212 test_afnorm_loss: 0.0192
  6%|▌         | 6/100 [02:54<43:37, 27.84s/it]epoch [6/100], focal_loss:0.0221	, anomaly_loss:0.4158	fnorm_loss:0.0209, a_fnorm_loss:0.0354P:0.24, R:0.64
  7%|▋         | 7/100 [03:16<39:51, 25.72s/it]epoch [7/100], focal_loss:0.0201	, anomaly_loss:0.3906	fnorm_loss:0.0182, a_fnorm_loss:0.0372P:0.28, R:0.71
  8%|▊         | 8/100 [03:38<37:48, 24.65s/it]epoch [8/100], focal_loss:0.0169	, anomaly_loss:0.3702	fnorm_loss:0.0161, a_fnorm_loss:0.0394P:0.26, R:0.72
  9%|▉         | 9/100 [04:00<36:14, 23.90s/it]epoch [9/100], focal_loss:0.0169	, anomaly_loss:0.3594	fnorm_loss:0.0149, a_fnorm_loss:0.0396P:0.28, R:0.74
 10%|█         | 10/100 [04:42<44:14, 29.50s/it]epoch [10/100], focal_loss:0.0167	, anomaly_loss:0.3642	fnorm_loss:0.0139, a_fnorm_loss:0.0399P:0.31, R:0.73
normal: 0.1589 0.4282  anomaly: 0.2038 0.5886	P:0.07, R:0.11
Pixel Auroc:0.929, Sample Auroc0.808, Pixel Aupro0.0
test_fnorm_loss: 0.0134 test_afnorm_loss: 0.0314
 11%|█         | 11/100 [05:04<40:07, 27.05s/it]epoch [11/100], focal_loss:0.0146	, anomaly_loss:0.3473	fnorm_loss:0.0128, a_fnorm_loss:0.0420P:0.29, R:0.77
 12%|█▏        | 12/100 [05:25<37:15, 25.40s/it]epoch [12/100], focal_loss:0.0151	, anomaly_loss:0.3526	fnorm_loss:0.0122, a_fnorm_loss:0.0413P:0.31, R:0.76
 13%|█▎        | 13/100 [05:48<35:28, 24.47s/it]epoch [13/100], focal_loss:0.0147	, anomaly_loss:0.3524	fnorm_loss:0.0117, a_fnorm_loss:0.0416P:0.32, R:0.76
 14%|█▍        | 14/100 [06:09<33:50, 23.61s/it]epoch [14/100], focal_loss:0.0149	, anomaly_loss:0.3465	fnorm_loss:0.0114, a_fnorm_loss:0.0409P:0.28, R:0.76
 15%|█▌        | 15/100 [06:51<41:07, 29.03s/it]epoch [15/100], focal_loss:0.0137	, anomaly_loss:0.3271	fnorm_loss:0.0108, a_fnorm_loss:0.0435P:0.27, R:0.80
normal: 0.2195 0.5651  anomaly: 0.2719 0.6666	P:0.04, R:0.15
Pixel Auroc:0.925, Sample Auroc0.795, Pixel Aupro0.0
test_fnorm_loss: 0.0111 test_afnorm_loss: 0.0348
 16%|█▌        | 16/100 [07:14<38:01, 27.16s/it]epoch [16/100], focal_loss:0.0134	, anomaly_loss:0.3331	fnorm_loss:0.0105, a_fnorm_loss:0.0429P:0.30, R:0.79
 17%|█▋        | 17/100 [07:35<35:16, 25.49s/it]epoch [17/100], focal_loss:0.0135	, anomaly_loss:0.3247	fnorm_loss:0.0101, a_fnorm_loss:0.0437P:0.31, R:0.79
 18%|█▊        | 18/100 [07:58<33:46, 24.72s/it]epoch [18/100], focal_loss:0.0130	, anomaly_loss:0.3252	fnorm_loss:0.0098, a_fnorm_loss:0.0440P:0.31, R:0.80
 19%|█▉        | 19/100 [08:20<32:13, 23.87s/it]epoch [19/100], focal_loss:0.0131	, anomaly_loss:0.3307	fnorm_loss:0.0097, a_fnorm_loss:0.0432P:0.29, R:0.79
 20%|██        | 20/100 [09:06<40:30, 30.39s/it]epoch [20/100], focal_loss:0.0135	, anomaly_loss:0.3298	fnorm_loss:0.0095, a_fnorm_loss:0.0436P:0.31, R:0.79
normal: 0.1534 0.5152  anomaly: 0.2394 0.6641	P:0.07, R:0.13
Pixel Auroc:0.930, Sample Auroc0.821, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0322
 21%|██        | 21/100 [09:27<36:31, 27.74s/it]epoch [21/100], focal_loss:0.0133	, anomaly_loss:0.3290	fnorm_loss:0.0093, a_fnorm_loss:0.0432P:0.29, R:0.79
 22%|██▏       | 22/100 [09:49<33:47, 25.99s/it]epoch [22/100], focal_loss:0.0126	, anomaly_loss:0.3224	fnorm_loss:0.0090, a_fnorm_loss:0.0447P:0.31, R:0.81
 23%|██▎       | 23/100 [10:11<31:33, 24.59s/it]epoch [23/100], focal_loss:0.0123	, anomaly_loss:0.3226	fnorm_loss:0.0088, a_fnorm_loss:0.0455P:0.30, R:0.81
 24%|██▍       | 24/100 [10:32<29:47, 23.53s/it]epoch [24/100], focal_loss:0.0129	, anomaly_loss:0.3170	fnorm_loss:0.0088, a_fnorm_loss:0.0449P:0.31, R:0.82
 25%|██▌       | 25/100 [11:13<36:01, 28.83s/it]epoch [25/100], focal_loss:0.0123	, anomaly_loss:0.3212	fnorm_loss:0.0087, a_fnorm_loss:0.0448P:0.31, R:0.82
normal: 0.1423 0.5295  anomaly: 0.2111 0.6886	P:0.07, R:0.13
Pixel Auroc:0.924, Sample Auroc0.839, Pixel Aupro0.0
test_fnorm_loss: 0.0081 test_afnorm_loss: 0.0324
 26%|██▌       | 26/100 [11:34<32:53, 26.67s/it]epoch [26/100], focal_loss:0.0117	, anomaly_loss:0.3179	fnorm_loss:0.0084, a_fnorm_loss:0.0455P:0.30, R:0.83
 27%|██▋       | 27/100 [11:56<30:41, 25.22s/it]epoch [27/100], focal_loss:0.0126	, anomaly_loss:0.3191	fnorm_loss:0.0085, a_fnorm_loss:0.0448P:0.29, R:0.81
 28%|██▊       | 28/100 [12:17<28:47, 24.00s/it]epoch [28/100], focal_loss:0.0122	, anomaly_loss:0.3144	fnorm_loss:0.0084, a_fnorm_loss:0.0448P:0.29, R:0.82
 29%|██▉       | 29/100 [12:39<27:30, 23.25s/it]epoch [29/100], focal_loss:0.0121	, anomaly_loss:0.3197	fnorm_loss:0.0083, a_fnorm_loss:0.0448P:0.30, R:0.81
 30%|███       | 30/100 [13:28<36:15, 31.08s/it]epoch [30/100], focal_loss:0.0124	, anomaly_loss:0.3091	fnorm_loss:0.0082, a_fnorm_loss:0.0470P:0.31, R:0.84
normal: 0.1324 0.5213  anomaly: 0.1409 0.6867	P:0.07, R:0.13
Pixel Auroc:0.926, Sample Auroc0.787, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0318
 31%|███       | 31/100 [13:50<32:34, 28.32s/it]epoch [31/100], focal_loss:0.0114	, anomaly_loss:0.3079	fnorm_loss:0.0080, a_fnorm_loss:0.0467P:0.33, R:0.84
 32%|███▏      | 32/100 [14:12<29:46, 26.27s/it]epoch [32/100], focal_loss:0.0117	, anomaly_loss:0.3226	fnorm_loss:0.0080, a_fnorm_loss:0.0456P:0.31, R:0.82
 33%|███▎      | 33/100 [14:33<27:50, 24.93s/it]epoch [33/100], focal_loss:0.0109	, anomaly_loss:0.3087	fnorm_loss:0.0079, a_fnorm_loss:0.0469P:0.30, R:0.84
 34%|███▍      | 34/100 [14:56<26:29, 24.08s/it]epoch [34/100], focal_loss:0.0116	, anomaly_loss:0.3115	fnorm_loss:0.0079, a_fnorm_loss:0.0465P:0.30, R:0.84
 35%|███▌      | 35/100 [15:38<31:54, 29.46s/it]epoch [35/100], focal_loss:0.0118	, anomaly_loss:0.3110	fnorm_loss:0.0078, a_fnorm_loss:0.0460P:0.32, R:0.83
normal: 0.2009 0.5685  anomaly: 0.2638 0.7033	P:0.04, R:0.15
Pixel Auroc:0.923, Sample Auroc0.811, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0334
 36%|███▌      | 36/100 [15:59<28:51, 27.06s/it]epoch [36/100], focal_loss:0.0119	, anomaly_loss:0.3066	fnorm_loss:0.0078, a_fnorm_loss:0.0477P:0.36, R:0.84
 37%|███▋      | 37/100 [16:21<26:46, 25.51s/it]epoch [37/100], focal_loss:0.0106	, anomaly_loss:0.3077	fnorm_loss:0.0076, a_fnorm_loss:0.0479P:0.35, R:0.84
 38%|███▊      | 38/100 [16:43<25:26, 24.63s/it]epoch [38/100], focal_loss:0.0120	, anomaly_loss:0.3096	fnorm_loss:0.0078, a_fnorm_loss:0.0467P:0.34, R:0.84
 39%|███▉      | 39/100 [17:06<24:17, 23.90s/it]epoch [39/100], focal_loss:0.0107	, anomaly_loss:0.3070	fnorm_loss:0.0076, a_fnorm_loss:0.0469P:0.33, R:0.85
 40%|████      | 40/100 [17:51<30:27, 30.45s/it]epoch [40/100], focal_loss:0.0116	, anomaly_loss:0.3080	fnorm_loss:0.0076, a_fnorm_loss:0.0468P:0.35, R:0.84
normal: 0.0664 0.4479  anomaly: 0.1053 0.6589	P:0.07, R:0.09
Pixel Auroc:0.926, Sample Auroc0.857, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0284
 41%|████      | 41/100 [18:13<27:26, 27.91s/it]epoch [41/100], focal_loss:0.0113	, anomaly_loss:0.3117	fnorm_loss:0.0076, a_fnorm_loss:0.0467P:0.32, R:0.83
 42%|████▏     | 42/100 [18:35<25:07, 25.99s/it]epoch [42/100], focal_loss:0.0107	, anomaly_loss:0.2913	fnorm_loss:0.0075, a_fnorm_loss:0.0488P:0.33, R:0.86
 43%|████▎     | 43/100 [18:56<23:24, 24.63s/it]epoch [43/100], focal_loss:0.0110	, anomaly_loss:0.2998	fnorm_loss:0.0074, a_fnorm_loss:0.0482P:0.33, R:0.85
 44%|████▍     | 44/100 [19:19<22:30, 24.12s/it]epoch [44/100], focal_loss:0.0108	, anomaly_loss:0.2992	fnorm_loss:0.0075, a_fnorm_loss:0.0475P:0.34, R:0.86
 45%|████▌     | 45/100 [20:05<27:55, 30.47s/it]epoch [45/100], focal_loss:0.0109	, anomaly_loss:0.3061	fnorm_loss:0.0075, a_fnorm_loss:0.0475P:0.32, R:0.85
normal: 0.1194 0.4583  anomaly: 0.1587 0.6912	P:0.08, R:0.12
Pixel Auroc:0.925, Sample Auroc0.805, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0321
 46%|████▌     | 46/100 [20:27<25:07, 27.91s/it]epoch [46/100], focal_loss:0.0111	, anomaly_loss:0.3069	fnorm_loss:0.0075, a_fnorm_loss:0.0466P:0.31, R:0.84
 47%|████▋     | 47/100 [20:48<23:01, 26.06s/it]epoch [47/100], focal_loss:0.0104	, anomaly_loss:0.2994	fnorm_loss:0.0074, a_fnorm_loss:0.0482P:0.33, R:0.85
 48%|████▊     | 48/100 [21:10<21:29, 24.81s/it]epoch [48/100], focal_loss:0.0113	, anomaly_loss:0.3129	fnorm_loss:0.0075, a_fnorm_loss:0.0460P:0.32, R:0.82
 49%|████▉     | 49/100 [21:32<20:22, 23.97s/it]epoch [49/100], focal_loss:0.0108	, anomaly_loss:0.3025	fnorm_loss:0.0074, a_fnorm_loss:0.0481P:0.32, R:0.85
 50%|█████     | 50/100 [22:15<24:40, 29.60s/it]epoch [50/100], focal_loss:0.0097	, anomaly_loss:0.2964	fnorm_loss:0.0072, a_fnorm_loss:0.0488P:0.36, R:0.87
normal: 0.1490 0.5740  anomaly: 0.2305 0.7271	P:0.06, R:0.14
Pixel Auroc:0.929, Sample Auroc0.792, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0364
 51%|█████     | 51/100 [22:37<22:14, 27.23s/it]epoch [51/100], focal_loss:0.0112	, anomaly_loss:0.3070	fnorm_loss:0.0074, a_fnorm_loss:0.0476P:0.33, R:0.83
 52%|█████▏    | 52/100 [22:59<20:30, 25.64s/it]epoch [52/100], focal_loss:0.0104	, anomaly_loss:0.3007	fnorm_loss:0.0074, a_fnorm_loss:0.0485P:0.34, R:0.85
 53%|█████▎    | 53/100 [23:21<19:16, 24.62s/it]epoch [53/100], focal_loss:0.0105	, anomaly_loss:0.2979	fnorm_loss:0.0073, a_fnorm_loss:0.0486P:0.35, R:0.87
 54%|█████▍    | 54/100 [23:42<18:12, 23.74s/it]epoch [54/100], focal_loss:0.0104	, anomaly_loss:0.2978	fnorm_loss:0.0073, a_fnorm_loss:0.0487P:0.32, R:0.86
 55%|█████▌    | 55/100 [24:24<21:42, 28.95s/it]epoch [55/100], focal_loss:0.0102	, anomaly_loss:0.3010	fnorm_loss:0.0073, a_fnorm_loss:0.0484P:0.32, R:0.85
normal: 0.1598 0.5375  anomaly: 0.1890 0.6864	P:0.06, R:0.13
Pixel Auroc:0.921, Sample Auroc0.797, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0307
 56%|█████▌    | 56/100 [24:46<19:41, 26.86s/it]epoch [56/100], focal_loss:0.0112	, anomaly_loss:0.3081	fnorm_loss:0.0075, a_fnorm_loss:0.0471P:0.33, R:0.83
 57%|█████▋    | 57/100 [25:08<18:12, 25.41s/it]epoch [57/100], focal_loss:0.0105	, anomaly_loss:0.3027	fnorm_loss:0.0073, a_fnorm_loss:0.0485P:0.35, R:0.85
 58%|█████▊    | 58/100 [25:29<17:00, 24.30s/it]epoch [58/100], focal_loss:0.0105	, anomaly_loss:0.2983	fnorm_loss:0.0073, a_fnorm_loss:0.0482P:0.34, R:0.86
 59%|█████▉    | 59/100 [25:52<16:15, 23.80s/it]epoch [59/100], focal_loss:0.0097	, anomaly_loss:0.2988	fnorm_loss:0.0072, a_fnorm_loss:0.0484P:0.33, R:0.86
 60%|██████    | 60/100 [26:33<19:23, 29.10s/it]epoch [60/100], focal_loss:0.0103	, anomaly_loss:0.3087	fnorm_loss:0.0073, a_fnorm_loss:0.0469P:0.29, R:0.84
normal: 0.1122 0.5709  anomaly: 0.1895 0.7205	P:0.06, R:0.14
Pixel Auroc:0.933, Sample Auroc0.820, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0355
 61%|██████    | 61/100 [26:55<17:21, 26.71s/it]epoch [61/100], focal_loss:0.0104	, anomaly_loss:0.3057	fnorm_loss:0.0073, a_fnorm_loss:0.0477P:0.34, R:0.84
 62%|██████▏   | 62/100 [27:16<15:57, 25.21s/it]epoch [62/100], focal_loss:0.0102	, anomaly_loss:0.2959	fnorm_loss:0.0073, a_fnorm_loss:0.0486P:0.33, R:0.85
 63%|██████▎   | 63/100 [27:38<14:53, 24.15s/it]epoch [63/100], focal_loss:0.0109	, anomaly_loss:0.3057	fnorm_loss:0.0074, a_fnorm_loss:0.0469P:0.30, R:0.83
 64%|██████▍   | 64/100 [28:00<14:06, 23.52s/it]epoch [64/100], focal_loss:0.0098	, anomaly_loss:0.2897	fnorm_loss:0.0072, a_fnorm_loss:0.0498P:0.36, R:0.88
 65%|██████▌   | 65/100 [28:41<16:44, 28.70s/it]epoch [65/100], focal_loss:0.0103	, anomaly_loss:0.2996	fnorm_loss:0.0072, a_fnorm_loss:0.0478P:0.35, R:0.86
normal: 0.0946 0.5634  anomaly: 0.1530 0.7162	P:0.07, R:0.14
Pixel Auroc:0.935, Sample Auroc0.826, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0361
 66%|██████▌   | 66/100 [29:02<14:59, 26.46s/it]epoch [66/100], focal_loss:0.0121	, anomaly_loss:0.3199	fnorm_loss:0.0075, a_fnorm_loss:0.0454P:0.31, R:0.81
 67%|██████▋   | 67/100 [29:24<13:46, 25.04s/it]epoch [67/100], focal_loss:0.0101	, anomaly_loss:0.2930	fnorm_loss:0.0073, a_fnorm_loss:0.0489P:0.32, R:0.86
 68%|██████▊   | 68/100 [29:46<12:51, 24.10s/it]epoch [68/100], focal_loss:0.0106	, anomaly_loss:0.3009	fnorm_loss:0.0072, a_fnorm_loss:0.0489P:0.33, R:0.87
 69%|██████▉   | 69/100 [30:07<12:06, 23.43s/it]epoch [69/100], focal_loss:0.0111	, anomaly_loss:0.2988	fnorm_loss:0.0073, a_fnorm_loss:0.0477P:0.35, R:0.86
 70%|███████   | 70/100 [30:49<14:21, 28.72s/it]epoch [70/100], focal_loss:0.0101	, anomaly_loss:0.2903	fnorm_loss:0.0072, a_fnorm_loss:0.0486P:0.35, R:0.87
normal: 0.1119 0.6331  anomaly: 0.2818 0.7393	P:0.05, R:0.15
Pixel Auroc:0.931, Sample Auroc0.831, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0383
 71%|███████   | 71/100 [31:11<12:55, 26.74s/it]epoch [71/100], focal_loss:0.0113	, anomaly_loss:0.2955	fnorm_loss:0.0074, a_fnorm_loss:0.0482P:0.34, R:0.85
 72%|███████▏  | 72/100 [31:32<11:43, 25.11s/it]epoch [72/100], focal_loss:0.0111	, anomaly_loss:0.2886	fnorm_loss:0.0073, a_fnorm_loss:0.0490P:0.37, R:0.86
 73%|███████▎  | 73/100 [31:54<10:51, 24.12s/it]epoch [73/100], focal_loss:0.0106	, anomaly_loss:0.2990	fnorm_loss:0.0073, a_fnorm_loss:0.0475P:0.35, R:0.86
 74%|███████▍  | 74/100 [32:15<10:01, 23.15s/it]epoch [74/100], focal_loss:0.0095	, anomaly_loss:0.2923	fnorm_loss:0.0071, a_fnorm_loss:0.0495P:0.35, R:0.87
 75%|███████▌  | 75/100 [32:56<11:53, 28.56s/it]epoch [75/100], focal_loss:0.0098	, anomaly_loss:0.3002	fnorm_loss:0.0072, a_fnorm_loss:0.0481P:0.34, R:0.86
normal: 0.1388 0.6592  anomaly: 0.2234 0.7192	P:0.06, R:0.14
Pixel Auroc:0.923, Sample Auroc0.810, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0340
 76%|███████▌  | 76/100 [33:17<10:34, 26.42s/it]epoch [76/100], focal_loss:0.0097	, anomaly_loss:0.2923	fnorm_loss:0.0071, a_fnorm_loss:0.0497P:0.38, R:0.87
 77%|███████▋  | 77/100 [33:39<09:35, 25.04s/it]epoch [77/100], focal_loss:0.0098	, anomaly_loss:0.2885	fnorm_loss:0.0071, a_fnorm_loss:0.0496P:0.36, R:0.87
 78%|███████▊  | 78/100 [34:01<08:49, 24.06s/it]epoch [78/100], focal_loss:0.0100	, anomaly_loss:0.2896	fnorm_loss:0.0072, a_fnorm_loss:0.0502P:0.35, R:0.87
 79%|███████▉  | 79/100 [34:22<08:08, 23.26s/it]epoch [79/100], focal_loss:0.0100	, anomaly_loss:0.2971	fnorm_loss:0.0072, a_fnorm_loss:0.0494P:0.31, R:0.86
 80%|████████  | 80/100 [35:03<09:30, 28.51s/it]epoch [80/100], focal_loss:0.0095	, anomaly_loss:0.2998	fnorm_loss:0.0071, a_fnorm_loss:0.0484P:0.33, R:0.86
normal: 0.2859 0.6523  anomaly: 0.3789 0.7397	P:0.04, R:0.16
Pixel Auroc:0.924, Sample Auroc0.763, Pixel Aupro0.0
test_fnorm_loss: 0.0094 test_afnorm_loss: 0.0405
 81%|████████  | 81/100 [35:26<08:27, 26.71s/it]epoch [81/100], focal_loss:0.0103	, anomaly_loss:0.2954	fnorm_loss:0.0074, a_fnorm_loss:0.0490P:0.29, R:0.86
 82%|████████▏ | 82/100 [35:47<07:30, 25.02s/it]epoch [82/100], focal_loss:0.0091	, anomaly_loss:0.2826	fnorm_loss:0.0071, a_fnorm_loss:0.0503P:0.32, R:0.89
 83%|████████▎ | 83/100 [36:09<06:51, 24.21s/it]epoch [83/100], focal_loss:0.0088	, anomaly_loss:0.2775	fnorm_loss:0.0070, a_fnorm_loss:0.0512P:0.38, R:0.91
 84%|████████▍ | 84/100 [36:31<06:15, 23.46s/it]epoch [84/100], focal_loss:0.0090	, anomaly_loss:0.2832	fnorm_loss:0.0071, a_fnorm_loss:0.0508P:0.34, R:0.89
 85%|████████▌ | 85/100 [37:16<07:28, 29.93s/it]epoch [85/100], focal_loss:0.0088	, anomaly_loss:0.2801	fnorm_loss:0.0070, a_fnorm_loss:0.0507P:0.32, R:0.90
normal: 0.0532 0.5433  anomaly: 0.1492 0.7241	P:0.08, R:0.14
Pixel Auroc:0.933, Sample Auroc0.842, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0350
 86%|████████▌ | 86/100 [37:37<06:23, 27.37s/it]epoch [86/100], focal_loss:0.0084	, anomaly_loss:0.2771	fnorm_loss:0.0069, a_fnorm_loss:0.0516P:0.34, R:0.90
 87%|████████▋ | 87/100 [37:58<05:30, 25.39s/it]epoch [87/100], focal_loss:0.0093	, anomaly_loss:0.2787	fnorm_loss:0.0070, a_fnorm_loss:0.0502P:0.33, R:0.88
 88%|████████▊ | 88/100 [38:19<04:50, 24.18s/it]epoch [88/100], focal_loss:0.0099	, anomaly_loss:0.2788	fnorm_loss:0.0071, a_fnorm_loss:0.0505P:0.32, R:0.89
 89%|████████▉ | 89/100 [38:41<04:16, 23.35s/it]epoch [89/100], focal_loss:0.0087	, anomaly_loss:0.2847	fnorm_loss:0.0069, a_fnorm_loss:0.0502P:0.33, R:0.89
 90%|█████████ | 90/100 [39:26<04:58, 29.89s/it]epoch [90/100], focal_loss:0.0092	, anomaly_loss:0.2840	fnorm_loss:0.0070, a_fnorm_loss:0.0512P:0.36, R:0.89
normal: 0.0645 0.5020  anomaly: 0.0812 0.7239	P:0.09, R:0.14
Pixel Auroc:0.934, Sample Auroc0.853, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0335
 91%|█████████ | 91/100 [39:47<04:05, 27.33s/it]epoch [91/100], focal_loss:0.0082	, anomaly_loss:0.2800	fnorm_loss:0.0068, a_fnorm_loss:0.0506P:0.35, R:0.90
 92%|█████████▏| 92/100 [40:10<03:27, 25.91s/it]epoch [92/100], focal_loss:0.0091	, anomaly_loss:0.2827	fnorm_loss:0.0070, a_fnorm_loss:0.0505P:0.35, R:0.88
 93%|█████████▎| 93/100 [40:32<02:53, 24.76s/it]epoch [93/100], focal_loss:0.0093	, anomaly_loss:0.2907	fnorm_loss:0.0071, a_fnorm_loss:0.0493P:0.32, R:0.88
 94%|█████████▍| 94/100 [40:54<02:23, 23.99s/it]epoch [94/100], focal_loss:0.0084	, anomaly_loss:0.2808	fnorm_loss:0.0070, a_fnorm_loss:0.0508P:0.32, R:0.90
 95%|█████████▌| 95/100 [41:35<02:26, 29.23s/it]epoch [95/100], focal_loss:0.0089	, anomaly_loss:0.2767	fnorm_loss:0.0070, a_fnorm_loss:0.0515P:0.37, R:0.90
normal: 0.0889 0.5923  anomaly: 0.1317 0.7299	P:0.08, R:0.15
Pixel Auroc:0.933, Sample Auroc0.847, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0353
 96%|█████████▌| 96/100 [41:57<01:47, 26.82s/it]epoch [96/100], focal_loss:0.0094	, anomaly_loss:0.2787	fnorm_loss:0.0070, a_fnorm_loss:0.0509P:0.33, R:0.89
 97%|█████████▋| 97/100 [42:19<01:16, 25.53s/it]epoch [97/100], focal_loss:0.0089	, anomaly_loss:0.2909	fnorm_loss:0.0070, a_fnorm_loss:0.0502P:0.31, R:0.88
 98%|█████████▊| 98/100 [42:40<00:48, 24.27s/it]epoch [98/100], focal_loss:0.0088	, anomaly_loss:0.2766	fnorm_loss:0.0070, a_fnorm_loss:0.0508P:0.35, R:0.89
 99%|█████████▉| 99/100 [43:02<00:23, 23.45s/it]epoch [99/100], focal_loss:0.0086	, anomaly_loss:0.2799	fnorm_loss:0.0070, a_fnorm_loss:0.0510P:0.35, R:0.90
100%|██████████| 100/100 [43:43<00:00, 28.80s/it]100%|██████████| 100/100 [43:43<00:00, 26.24s/it]
epoch [100/100], focal_loss:0.0093	, anomaly_loss:0.2875	fnorm_loss:0.0071, a_fnorm_loss:0.0498P:0.33, R:0.88
normal: 0.0734 0.5498  anomaly: 0.1015 0.7288	P:0.09, R:0.14
Pixel Auroc:0.935, Sample Auroc0.854, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0353
training Stubborn Student...
pcb3
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<32:03, 16.16s/it]epoch [1/120], kd_loss:4.0781
  2%|▏         | 2/120 [00:32<32:02, 16.29s/it]epoch [2/120], kd_loss:2.6622
  2%|▎         | 3/120 [00:48<31:48, 16.32s/it]epoch [3/120], kd_loss:2.8423
  3%|▎         | 4/120 [01:05<31:36, 16.35s/it]epoch [4/120], kd_loss:2.3606
  4%|▍         | 5/120 [01:21<31:28, 16.42s/it]epoch [5/120], kd_loss:2.1874
  5%|▌         | 6/120 [01:38<31:15, 16.46s/it]epoch [6/120], kd_loss:2.0122
  6%|▌         | 7/120 [01:54<31:00, 16.47s/it]epoch [7/120], kd_loss:1.9859
  7%|▋         | 8/120 [02:11<30:43, 16.46s/it]epoch [8/120], kd_loss:1.8930
  8%|▊         | 9/120 [02:27<30:27, 16.46s/it]epoch [9/120], kd_loss:1.8865
  8%|▊         | 10/120 [03:02<40:21, 22.02s/it]epoch [10/120], kd_loss:1.8676
normal: 1.2126 1.6176  anomaly: 1.2992 2.1165
thresh: 1.4582510076811044
fpr: 0.21782178217821782 fnr 0.26
Pixel Auroc:0.955, Sample Auroc0.835, Pixel Aupro0.0
  9%|▉         | 11/120 [03:18<36:46, 20.25s/it]epoch [11/120], kd_loss:1.9046
 10%|█         | 12/120 [03:34<34:17, 19.06s/it]epoch [12/120], kd_loss:1.8813
 11%|█         | 13/120 [03:51<32:29, 18.22s/it]epoch [13/120], kd_loss:1.6982
 12%|█▏        | 14/120 [04:07<31:12, 17.67s/it]epoch [14/120], kd_loss:1.6857
 12%|█▎        | 15/120 [04:23<30:13, 17.27s/it]epoch [15/120], kd_loss:1.7527
 13%|█▎        | 16/120 [04:40<29:28, 17.01s/it]epoch [16/120], kd_loss:1.6351
 14%|█▍        | 17/120 [04:56<28:52, 16.82s/it]epoch [17/120], kd_loss:1.6691
 15%|█▌        | 18/120 [05:12<28:21, 16.68s/it]epoch [18/120], kd_loss:1.5430
 16%|█▌        | 19/120 [05:29<28:01, 16.64s/it]epoch [19/120], kd_loss:1.4878
 17%|█▋        | 20/120 [06:03<36:34, 21.94s/it]epoch [20/120], kd_loss:1.5421
normal: 1.8936 2.4860  anomaly: 1.8744 2.4262
thresh: 1.8744450680860998
fpr: 1.0 fnr 0.0
Pixel Auroc:0.815, Sample Auroc0.514, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:19<33:21, 20.22s/it]epoch [21/120], kd_loss:1.5665
 18%|█▊        | 22/120 [06:36<31:05, 19.04s/it]epoch [22/120], kd_loss:1.6661
 19%|█▉        | 23/120 [06:52<29:29, 18.24s/it]epoch [23/120], kd_loss:1.6479
 20%|██        | 24/120 [07:08<28:15, 17.66s/it]epoch [24/120], kd_loss:1.5608
 21%|██        | 25/120 [07:25<27:20, 17.27s/it]epoch [25/120], kd_loss:1.5218
 22%|██▏       | 26/120 [07:41<26:40, 17.02s/it]epoch [26/120], kd_loss:1.5287
 22%|██▎       | 27/120 [07:58<26:04, 16.83s/it]epoch [27/120], kd_loss:1.7018
 23%|██▎       | 28/120 [08:14<25:36, 16.71s/it]epoch [28/120], kd_loss:1.5354
 24%|██▍       | 29/120 [08:30<25:11, 16.61s/it]epoch [29/120], kd_loss:1.7680
 25%|██▌       | 30/120 [09:09<34:38, 23.10s/it]epoch [30/120], kd_loss:1.6607
normal: 0.9541 1.5334  anomaly: 1.0101 1.9366
thresh: 1.2236061895923733
fpr: 0.3564356435643564 fnr 0.11
Pixel Auroc:0.959, Sample Auroc0.866, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:25<31:16, 21.08s/it]epoch [31/120], kd_loss:1.6027
 27%|██▋       | 32/120 [09:41<28:50, 19.66s/it]epoch [32/120], kd_loss:1.7161
 28%|██▊       | 33/120 [09:58<27:04, 18.67s/it]epoch [33/120], kd_loss:1.6994
 28%|██▊       | 34/120 [10:14<25:46, 17.98s/it]epoch [34/120], kd_loss:1.7504
 29%|██▉       | 35/120 [10:30<24:45, 17.48s/it]epoch [35/120], kd_loss:1.5919
 30%|███       | 36/120 [10:47<24:01, 17.16s/it]epoch [36/120], kd_loss:1.5499
 31%|███       | 37/120 [11:03<23:23, 16.91s/it]epoch [37/120], kd_loss:1.4894
 32%|███▏      | 38/120 [11:20<22:52, 16.74s/it]epoch [38/120], kd_loss:1.5111
 32%|███▎      | 39/120 [11:36<22:26, 16.63s/it]epoch [39/120], kd_loss:1.4571
 33%|███▎      | 40/120 [12:13<30:23, 22.79s/it]epoch [40/120], kd_loss:1.4657
normal: 0.8835 1.5146  anomaly: 0.9974 1.9724
thresh: 1.181766776726292
fpr: 0.26732673267326734 fnr 0.12
Pixel Auroc:0.966, Sample Auroc0.883, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:29<27:23, 20.80s/it]epoch [41/120], kd_loss:1.4073
 35%|███▌      | 42/120 [12:46<25:16, 19.44s/it]epoch [42/120], kd_loss:1.4199
 36%|███▌      | 43/120 [13:02<23:45, 18.51s/it]epoch [43/120], kd_loss:1.7789
 37%|███▋      | 44/120 [13:18<22:37, 17.86s/it]epoch [44/120], kd_loss:1.4709
 38%|███▊      | 45/120 [13:34<21:44, 17.40s/it]epoch [45/120], kd_loss:1.4164
 38%|███▊      | 46/120 [13:51<21:03, 17.07s/it]epoch [46/120], kd_loss:1.4071
 39%|███▉      | 47/120 [14:07<20:29, 16.84s/it]epoch [47/120], kd_loss:1.3865
 40%|████      | 48/120 [14:23<20:01, 16.69s/it]epoch [48/120], kd_loss:1.3666
 41%|████      | 49/120 [14:40<19:40, 16.63s/it]epoch [49/120], kd_loss:1.3518
 42%|████▏     | 50/120 [15:17<26:33, 22.77s/it]epoch [50/120], kd_loss:1.3413
normal: 0.7814 1.4885  anomaly: 0.8325 1.8842
thresh: 1.0864041205323678
fpr: 0.26732673267326734 fnr 0.1
Pixel Auroc:0.971, Sample Auroc0.901, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:33<23:58, 20.84s/it]epoch [51/120], kd_loss:1.3234
 43%|████▎     | 52/120 [15:50<22:05, 19.49s/it]epoch [52/120], kd_loss:1.3308
 44%|████▍     | 53/120 [16:06<20:43, 18.56s/it]epoch [53/120], kd_loss:1.3676
 45%|████▌     | 54/120 [16:23<19:44, 17.94s/it]epoch [54/120], kd_loss:1.3226
 46%|████▌     | 55/120 [16:39<18:57, 17.51s/it]epoch [55/120], kd_loss:1.2939
 47%|████▋     | 56/120 [16:56<18:19, 17.18s/it]epoch [56/120], kd_loss:1.2792
 48%|████▊     | 57/120 [17:12<17:48, 16.96s/it]epoch [57/120], kd_loss:1.9967
 48%|████▊     | 58/120 [17:28<17:21, 16.80s/it]epoch [58/120], kd_loss:1.7525
 49%|████▉     | 59/120 [17:45<17:01, 16.75s/it]epoch [59/120], kd_loss:1.6365
 50%|█████     | 60/120 [18:20<22:06, 22.11s/it]epoch [60/120], kd_loss:1.5163
normal: 0.9597 1.5370  anomaly: 1.0629 2.4667
thresh: 1.3440854839161214
fpr: 0.16831683168316833 fnr 0.24
Pixel Auroc:0.961, Sample Auroc0.844, Pixel Aupro0.0
 51%|█████     | 61/120 [18:36<20:00, 20.34s/it]epoch [61/120], kd_loss:2.2025
 52%|█████▏    | 62/120 [18:52<18:30, 19.14s/it]epoch [62/120], kd_loss:1.7183
 52%|█████▎    | 63/120 [19:09<17:22, 18.30s/it]epoch [63/120], kd_loss:1.5023
 53%|█████▎    | 64/120 [19:25<16:33, 17.75s/it]epoch [64/120], kd_loss:1.7869
 54%|█████▍    | 65/120 [19:41<15:52, 17.33s/it]epoch [65/120], kd_loss:1.4755
 55%|█████▌    | 66/120 [19:58<15:19, 17.03s/it]epoch [66/120], kd_loss:1.4943
 56%|█████▌    | 67/120 [20:14<14:51, 16.82s/it]epoch [67/120], kd_loss:1.4819
 57%|█████▋    | 68/120 [20:30<14:27, 16.68s/it]epoch [68/120], kd_loss:1.4289
 57%|█████▊    | 69/120 [20:47<14:05, 16.57s/it]epoch [69/120], kd_loss:1.3826
 58%|█████▊    | 70/120 [21:21<18:09, 21.79s/it]epoch [70/120], kd_loss:1.6288
normal: 0.8514 2.3477  anomaly: 0.9392 2.6249
thresh: 1.18841890678454
fpr: 0.1485148514851485 fnr 0.18
Pixel Auroc:0.973, Sample Auroc0.881, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:37<16:26, 20.13s/it]epoch [71/120], kd_loss:1.4155
 60%|██████    | 72/120 [21:53<15:10, 18.97s/it]epoch [72/120], kd_loss:1.6628
 61%|██████    | 73/120 [22:09<14:13, 18.17s/it]epoch [73/120], kd_loss:1.5520
 62%|██████▏   | 74/120 [22:26<13:30, 17.62s/it]epoch [74/120], kd_loss:1.4093
 62%|██████▎   | 75/120 [22:42<12:55, 17.22s/it]epoch [75/120], kd_loss:1.5276
 63%|██████▎   | 76/120 [22:58<12:26, 16.96s/it]epoch [76/120], kd_loss:1.4255
 64%|██████▍   | 77/120 [23:15<12:01, 16.77s/it]epoch [77/120], kd_loss:1.3913
 65%|██████▌   | 78/120 [23:31<11:40, 16.67s/it]epoch [78/120], kd_loss:1.4773
 66%|██████▌   | 79/120 [23:48<11:19, 16.58s/it]epoch [79/120], kd_loss:1.5360
 67%|██████▋   | 80/120 [24:23<14:45, 22.14s/it]epoch [80/120], kd_loss:1.4784
normal: 0.8267 1.3389  anomaly: 0.8926 1.9497
thresh: 1.061108118851228
fpr: 0.31683168316831684 fnr 0.06
Pixel Auroc:0.974, Sample Auroc0.910, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:39<13:14, 20.36s/it]epoch [81/120], kd_loss:1.3782
 68%|██████▊   | 82/120 [24:55<12:07, 19.14s/it]epoch [82/120], kd_loss:1.3628
 69%|██████▉   | 83/120 [25:12<11:16, 18.29s/it]epoch [83/120], kd_loss:1.3896
 70%|███████   | 84/120 [25:28<10:37, 17.72s/it]epoch [84/120], kd_loss:1.3403
 71%|███████   | 85/120 [25:44<10:06, 17.32s/it]epoch [85/120], kd_loss:1.3374
 72%|███████▏  | 86/120 [26:01<09:38, 17.02s/it]epoch [86/120], kd_loss:1.3444
 72%|███████▎  | 87/120 [26:17<09:15, 16.82s/it]epoch [87/120], kd_loss:1.3077
 73%|███████▎  | 88/120 [26:33<08:53, 16.67s/it]epoch [88/120], kd_loss:1.3117
 74%|███████▍  | 89/120 [26:50<08:35, 16.62s/it]epoch [89/120], kd_loss:1.5640
 75%|███████▌  | 90/120 [27:25<11:10, 22.35s/it]epoch [90/120], kd_loss:1.4220
normal: 0.8086 2.1840  anomaly: 0.9474 2.4389
thresh: 1.1194150013883402
fpr: 0.21782178217821782 fnr 0.12
Pixel Auroc:0.975, Sample Auroc0.905, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:42<09:54, 20.50s/it]epoch [91/120], kd_loss:1.3414
 77%|███████▋  | 92/120 [27:58<08:59, 19.27s/it]epoch [92/120], kd_loss:1.3710
 78%|███████▊  | 93/120 [28:14<08:16, 18.38s/it]epoch [93/120], kd_loss:1.3803
 78%|███████▊  | 94/120 [28:31<07:41, 17.76s/it]epoch [94/120], kd_loss:1.3315
 79%|███████▉  | 95/120 [28:47<07:13, 17.34s/it]epoch [95/120], kd_loss:1.3309
 80%|████████  | 96/120 [29:03<06:49, 17.04s/it]epoch [96/120], kd_loss:1.3064
 81%|████████  | 97/120 [29:20<06:27, 16.83s/it]epoch [97/120], kd_loss:1.2873
 82%|████████▏ | 98/120 [29:36<06:07, 16.70s/it]epoch [98/120], kd_loss:1.2801
 82%|████████▎ | 99/120 [29:53<05:49, 16.63s/it]epoch [99/120], kd_loss:1.2709
 83%|████████▎ | 100/120 [30:28<07:24, 22.22s/it]epoch [100/120], kd_loss:1.2689
normal: 0.7453 1.3803  anomaly: 0.8131 2.4246
thresh: 1.0807456071966894
fpr: 0.16831683168316833 fnr 0.12
Pixel Auroc:0.976, Sample Auroc0.919, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:44<06:27, 20.40s/it]epoch [101/120], kd_loss:1.2697
 85%|████████▌ | 102/120 [31:00<05:44, 19.16s/it]epoch [102/120], kd_loss:1.2653
 86%|████████▌ | 103/120 [31:17<05:11, 18.32s/it]epoch [103/120], kd_loss:1.2616
 87%|████████▋ | 104/120 [31:33<04:43, 17.74s/it]epoch [104/120], kd_loss:1.2615
 88%|████████▊ | 105/120 [31:49<04:19, 17.32s/it]epoch [105/120], kd_loss:1.2544
 88%|████████▊ | 106/120 [32:06<03:58, 17.03s/it]epoch [106/120], kd_loss:1.2521
 89%|████████▉ | 107/120 [32:22<03:38, 16.84s/it]epoch [107/120], kd_loss:1.2481
 90%|█████████ | 108/120 [32:38<03:20, 16.69s/it]epoch [108/120], kd_loss:1.2491
 91%|█████████ | 109/120 [32:55<03:02, 16.59s/it]epoch [109/120], kd_loss:1.2412
 92%|█████████▏| 110/120 [33:29<03:38, 21.89s/it]epoch [110/120], kd_loss:1.2404
normal: 0.7249 1.3463  anomaly: 0.7953 2.4301
thresh: 1.0780224809984764
fpr: 0.16831683168316833 fnr 0.15
Pixel Auroc:0.979, Sample Auroc0.915, Pixel Aupro0.0
 92%|█████████▎| 111/120 [33:45<03:01, 20.20s/it]epoch [111/120], kd_loss:1.2391
 93%|█████████▎| 112/120 [34:02<02:32, 19.02s/it]epoch [112/120], kd_loss:1.2384
 94%|█████████▍| 113/120 [34:18<02:07, 18.20s/it]epoch [113/120], kd_loss:1.2368
 95%|█████████▌| 114/120 [34:34<01:45, 17.64s/it]epoch [114/120], kd_loss:1.2368
 96%|█████████▌| 115/120 [34:51<01:26, 17.27s/it]epoch [115/120], kd_loss:1.2364
 97%|█████████▋| 116/120 [35:07<01:07, 16.99s/it]epoch [116/120], kd_loss:1.2351
 98%|█████████▊| 117/120 [35:23<00:50, 16.81s/it]epoch [117/120], kd_loss:1.2340
 98%|█████████▊| 118/120 [35:40<00:33, 16.68s/it]epoch [118/120], kd_loss:1.2337
 99%|█████████▉| 119/120 [35:56<00:16, 16.57s/it]epoch [119/120], kd_loss:1.2331
100%|██████████| 120/120 [36:32<00:00, 22.41s/it]100%|██████████| 120/120 [36:32<00:00, 18.27s/it]
epoch [120/120], kd_loss:1.2330
normal: 0.7146 1.4005  anomaly: 0.7930 2.4236
thresh: 1.0533903541005305
fpr: 0.2079207920792079 fnr 0.11
Pixel Auroc:0.980, Sample Auroc0.918, Pixel Aupro0.0
training Advanced Teacher...
pcb4
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:45<1:15:03, 45.49s/it]epoch [1/100], focal_loss:0.0654	, anomaly_loss:0.5836	fnorm_loss:0.0582, a_fnorm_loss:0.0149P:0.00, R:0.01
normal: 0.1928 0.2002  anomaly: 0.1913 0.1976	P:0.00, R:0.00
Pixel Auroc:0.803, Sample Auroc0.240, Pixel Aupro0.0
test_fnorm_loss: 0.0485 test_afnorm_loss: 0.0127
  2%|▏         | 2/100 [01:06<51:00, 31.23s/it]  epoch [2/100], focal_loss:0.0494	, anomaly_loss:0.6077	fnorm_loss:0.0444, a_fnorm_loss:0.0140P:0.02, R:0.04
  3%|▎         | 3/100 [01:28<43:26, 26.87s/it]epoch [3/100], focal_loss:0.0427	, anomaly_loss:0.5464	fnorm_loss:0.0349, a_fnorm_loss:0.0263P:0.10, R:0.23
  4%|▍         | 4/100 [01:49<39:31, 24.70s/it]epoch [4/100], focal_loss:0.0378	, anomaly_loss:0.5072	fnorm_loss:0.0279, a_fnorm_loss:0.0308P:0.17, R:0.34
  5%|▌         | 5/100 [02:30<48:07, 30.40s/it]epoch [5/100], focal_loss:0.0325	, anomaly_loss:0.4811	fnorm_loss:0.0228, a_fnorm_loss:0.0337P:0.29, R:0.48
normal: 0.1629 0.4060  anomaly: 0.1741 0.4857	P:0.10, R:0.09
Pixel Auroc:0.902, Sample Auroc0.758, Pixel Aupro0.0
test_fnorm_loss: 0.0194 test_afnorm_loss: 0.0172
  6%|▌         | 6/100 [02:52<43:00, 27.45s/it]epoch [6/100], focal_loss:0.0284	, anomaly_loss:0.4460	fnorm_loss:0.0196, a_fnorm_loss:0.0365P:0.40, R:0.63
  7%|▋         | 7/100 [03:13<39:33, 25.53s/it]epoch [7/100], focal_loss:0.0239	, anomaly_loss:0.4227	fnorm_loss:0.0172, a_fnorm_loss:0.0383P:0.41, R:0.72
  8%|▊         | 8/100 [03:35<37:11, 24.25s/it]epoch [8/100], focal_loss:0.0237	, anomaly_loss:0.4303	fnorm_loss:0.0161, a_fnorm_loss:0.0380P:0.40, R:0.72
  9%|▉         | 9/100 [03:56<35:27, 23.38s/it]epoch [9/100], focal_loss:0.0218	, anomaly_loss:0.4126	fnorm_loss:0.0148, a_fnorm_loss:0.0399P:0.42, R:0.77
 10%|█         | 10/100 [04:39<44:05, 29.40s/it]epoch [10/100], focal_loss:0.0212	, anomaly_loss:0.4134	fnorm_loss:0.0139, a_fnorm_loss:0.0393P:0.40, R:0.76
normal: 0.1948 0.4293  anomaly: 0.1962 0.6392	P:0.10, R:0.17
Pixel Auroc:0.916, Sample Auroc0.864, Pixel Aupro0.0
test_fnorm_loss: 0.0127 test_afnorm_loss: 0.0231
 11%|█         | 11/100 [05:00<40:01, 26.98s/it]epoch [11/100], focal_loss:0.0192	, anomaly_loss:0.3981	fnorm_loss:0.0128, a_fnorm_loss:0.0414P:0.40, R:0.79
 12%|█▏        | 12/100 [05:22<37:07, 25.31s/it]epoch [12/100], focal_loss:0.0194	, anomaly_loss:0.4075	fnorm_loss:0.0123, a_fnorm_loss:0.0406P:0.39, R:0.77
 13%|█▎        | 13/100 [05:44<35:09, 24.24s/it]epoch [13/100], focal_loss:0.0179	, anomaly_loss:0.3943	fnorm_loss:0.0116, a_fnorm_loss:0.0426P:0.42, R:0.81
 14%|█▍        | 14/100 [06:05<33:24, 23.31s/it]epoch [14/100], focal_loss:0.0179	, anomaly_loss:0.4020	fnorm_loss:0.0112, a_fnorm_loss:0.0417P:0.41, R:0.77
 15%|█▌        | 15/100 [06:47<40:51, 28.84s/it]epoch [15/100], focal_loss:0.0176	, anomaly_loss:0.3907	fnorm_loss:0.0109, a_fnorm_loss:0.0424P:0.40, R:0.79
normal: 0.2387 0.5761  anomaly: 0.2926 0.7365	P:0.07, R:0.25
Pixel Auroc:0.918, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0316
 16%|█▌        | 16/100 [07:08<37:19, 26.66s/it]epoch [16/100], focal_loss:0.0170	, anomaly_loss:0.3913	fnorm_loss:0.0103, a_fnorm_loss:0.0432P:0.43, R:0.80
 17%|█▋        | 17/100 [07:29<34:36, 25.02s/it]epoch [17/100], focal_loss:0.0173	, anomaly_loss:0.3869	fnorm_loss:0.0102, a_fnorm_loss:0.0431P:0.42, R:0.81
 18%|█▊        | 18/100 [07:50<32:27, 23.76s/it]epoch [18/100], focal_loss:0.0162	, anomaly_loss:0.3850	fnorm_loss:0.0097, a_fnorm_loss:0.0435P:0.41, R:0.82
 19%|█▉        | 19/100 [08:11<30:54, 22.89s/it]epoch [19/100], focal_loss:0.0162	, anomaly_loss:0.3787	fnorm_loss:0.0095, a_fnorm_loss:0.0442P:0.42, R:0.83
 20%|██        | 20/100 [08:57<39:47, 29.85s/it]epoch [20/100], focal_loss:0.0174	, anomaly_loss:0.3860	fnorm_loss:0.0094, a_fnorm_loss:0.0434P:0.43, R:0.80
normal: 0.0971 0.3839  anomaly: 0.1371 0.6469	P:0.14, R:0.13
Pixel Auroc:0.932, Sample Auroc0.918, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0209
 21%|██        | 21/100 [09:18<35:56, 27.29s/it]epoch [21/100], focal_loss:0.0172	, anomaly_loss:0.3915	fnorm_loss:0.0093, a_fnorm_loss:0.0432P:0.43, R:0.79
 22%|██▏       | 22/100 [09:40<33:16, 25.60s/it]epoch [22/100], focal_loss:0.0169	, anomaly_loss:0.3857	fnorm_loss:0.0092, a_fnorm_loss:0.0436P:0.42, R:0.81
 23%|██▎       | 23/100 [10:02<31:23, 24.46s/it]epoch [23/100], focal_loss:0.0154	, anomaly_loss:0.3744	fnorm_loss:0.0088, a_fnorm_loss:0.0450P:0.44, R:0.84
 24%|██▍       | 24/100 [10:24<29:59, 23.68s/it]epoch [24/100], focal_loss:0.0170	, anomaly_loss:0.3827	fnorm_loss:0.0088, a_fnorm_loss:0.0441P:0.43, R:0.81
 25%|██▌       | 25/100 [11:10<37:54, 30.32s/it]epoch [25/100], focal_loss:0.0167	, anomaly_loss:0.3845	fnorm_loss:0.0088, a_fnorm_loss:0.0447P:0.45, R:0.82
normal: 0.0960 0.4254  anomaly: 0.1470 0.6904	P:0.15, R:0.18
Pixel Auroc:0.952, Sample Auroc0.925, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0247
 26%|██▌       | 26/100 [11:31<34:00, 27.57s/it]epoch [26/100], focal_loss:0.0139	, anomaly_loss:0.3757	fnorm_loss:0.0082, a_fnorm_loss:0.0466P:0.44, R:0.85
 27%|██▋       | 27/100 [11:52<31:14, 25.68s/it]epoch [27/100], focal_loss:0.0142	, anomaly_loss:0.3765	fnorm_loss:0.0081, a_fnorm_loss:0.0459P:0.44, R:0.84
 28%|██▊       | 28/100 [12:14<29:32, 24.61s/it]epoch [28/100], focal_loss:0.0152	, anomaly_loss:0.3751	fnorm_loss:0.0082, a_fnorm_loss:0.0459P:0.46, R:0.83
 29%|██▉       | 29/100 [12:36<28:03, 23.71s/it]epoch [29/100], focal_loss:0.0158	, anomaly_loss:0.3769	fnorm_loss:0.0083, a_fnorm_loss:0.0449P:0.46, R:0.82
 30%|███       | 30/100 [13:18<34:05, 29.23s/it]epoch [30/100], focal_loss:0.0151	, anomaly_loss:0.3748	fnorm_loss:0.0081, a_fnorm_loss:0.0458P:0.47, R:0.84
normal: 0.0734 0.4309  anomaly: 0.0944 0.7095	P:0.13, R:0.12
Pixel Auroc:0.911, Sample Auroc0.904, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0198
 31%|███       | 31/100 [13:39<30:44, 26.73s/it]epoch [31/100], focal_loss:0.0147	, anomaly_loss:0.3732	fnorm_loss:0.0079, a_fnorm_loss:0.0458P:0.46, R:0.84
 32%|███▏      | 32/100 [14:00<28:31, 25.17s/it]epoch [32/100], focal_loss:0.0156	, anomaly_loss:0.3802	fnorm_loss:0.0082, a_fnorm_loss:0.0445P:0.46, R:0.81
 33%|███▎      | 33/100 [14:21<26:37, 23.84s/it]epoch [33/100], focal_loss:0.0165	, anomaly_loss:0.3863	fnorm_loss:0.0080, a_fnorm_loss:0.0445P:0.46, R:0.82
 34%|███▍      | 34/100 [14:42<25:21, 23.05s/it]epoch [34/100], focal_loss:0.0144	, anomaly_loss:0.3683	fnorm_loss:0.0078, a_fnorm_loss:0.0462P:0.45, R:0.84
 35%|███▌      | 35/100 [15:23<30:41, 28.33s/it]epoch [35/100], focal_loss:0.0145	, anomaly_loss:0.3739	fnorm_loss:0.0076, a_fnorm_loss:0.0465P:0.47, R:0.85
normal: 0.2622 0.5495  anomaly: 0.3525 0.7088	P:0.08, R:0.30
Pixel Auroc:0.961, Sample Auroc0.913, Pixel Aupro0.0
test_fnorm_loss: 0.0099 test_afnorm_loss: 0.0375
 36%|███▌      | 36/100 [15:44<27:47, 26.06s/it]epoch [36/100], focal_loss:0.0144	, anomaly_loss:0.3732	fnorm_loss:0.0077, a_fnorm_loss:0.0458P:0.47, R:0.84
 37%|███▋      | 37/100 [16:05<25:52, 24.64s/it]epoch [37/100], focal_loss:0.0154	, anomaly_loss:0.3739	fnorm_loss:0.0078, a_fnorm_loss:0.0456P:0.43, R:0.83
 38%|███▊      | 38/100 [16:26<24:29, 23.70s/it]epoch [38/100], focal_loss:0.0156	, anomaly_loss:0.3738	fnorm_loss:0.0079, a_fnorm_loss:0.0451P:0.45, R:0.83
 39%|███▉      | 39/100 [16:49<23:37, 23.24s/it]epoch [39/100], focal_loss:0.0147	, anomaly_loss:0.3786	fnorm_loss:0.0077, a_fnorm_loss:0.0451P:0.43, R:0.83
 40%|████      | 40/100 [17:30<28:36, 28.62s/it]epoch [40/100], focal_loss:0.0141	, anomaly_loss:0.3667	fnorm_loss:0.0075, a_fnorm_loss:0.0469P:0.46, R:0.85
normal: 0.1719 0.5160  anomaly: 0.3017 0.7659	P:0.10, R:0.26
Pixel Auroc:0.952, Sample Auroc0.933, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0310
 41%|████      | 41/100 [17:51<25:50, 26.27s/it]epoch [41/100], focal_loss:0.0143	, anomaly_loss:0.3696	fnorm_loss:0.0075, a_fnorm_loss:0.0459P:0.44, R:0.84
 42%|████▏     | 42/100 [18:13<24:21, 25.20s/it]epoch [42/100], focal_loss:0.0148	, anomaly_loss:0.3717	fnorm_loss:0.0076, a_fnorm_loss:0.0460P:0.44, R:0.84
 43%|████▎     | 43/100 [18:34<22:47, 23.98s/it]epoch [43/100], focal_loss:0.0135	, anomaly_loss:0.3691	fnorm_loss:0.0074, a_fnorm_loss:0.0467P:0.44, R:0.84
 44%|████▍     | 44/100 [18:56<21:36, 23.16s/it]epoch [44/100], focal_loss:0.0150	, anomaly_loss:0.3687	fnorm_loss:0.0075, a_fnorm_loss:0.0456P:0.48, R:0.84
 45%|████▌     | 45/100 [19:37<26:13, 28.62s/it]epoch [45/100], focal_loss:0.0148	, anomaly_loss:0.3729	fnorm_loss:0.0075, a_fnorm_loss:0.0456P:0.45, R:0.83
normal: 0.1507 0.5157  anomaly: 0.1981 0.7239	P:0.11, R:0.22
Pixel Auroc:0.937, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0276
 46%|████▌     | 46/100 [19:58<23:47, 26.43s/it]epoch [46/100], focal_loss:0.0145	, anomaly_loss:0.3652	fnorm_loss:0.0074, a_fnorm_loss:0.0465P:0.46, R:0.84
 47%|████▋     | 47/100 [20:19<21:55, 24.83s/it]epoch [47/100], focal_loss:0.0135	, anomaly_loss:0.3688	fnorm_loss:0.0073, a_fnorm_loss:0.0465P:0.45, R:0.85
 48%|████▊     | 48/100 [20:41<20:45, 23.94s/it]epoch [48/100], focal_loss:0.0152	, anomaly_loss:0.3666	fnorm_loss:0.0075, a_fnorm_loss:0.0462P:0.47, R:0.84
 49%|████▉     | 49/100 [21:04<19:54, 23.43s/it]epoch [49/100], focal_loss:0.0144	, anomaly_loss:0.3631	fnorm_loss:0.0074, a_fnorm_loss:0.0470P:0.47, R:0.85
 50%|█████     | 50/100 [21:49<24:59, 30.00s/it]epoch [50/100], focal_loss:0.0128	, anomaly_loss:0.3598	fnorm_loss:0.0072, a_fnorm_loss:0.0481P:0.45, R:0.87
normal: 0.0714 0.4254  anomaly: 0.1588 0.7226	P:0.15, R:0.19
Pixel Auroc:0.948, Sample Auroc0.945, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0244
 51%|█████     | 51/100 [22:10<22:16, 27.27s/it]epoch [51/100], focal_loss:0.0135	, anomaly_loss:0.3643	fnorm_loss:0.0072, a_fnorm_loss:0.0476P:0.45, R:0.86
 52%|█████▏    | 52/100 [22:31<20:25, 25.53s/it]epoch [52/100], focal_loss:0.0147	, anomaly_loss:0.3695	fnorm_loss:0.0073, a_fnorm_loss:0.0464P:0.48, R:0.83
 53%|█████▎    | 53/100 [22:53<19:08, 24.45s/it]epoch [53/100], focal_loss:0.0137	, anomaly_loss:0.3615	fnorm_loss:0.0073, a_fnorm_loss:0.0466P:0.43, R:0.85
 54%|█████▍    | 54/100 [23:14<17:58, 23.44s/it]epoch [54/100], focal_loss:0.0140	, anomaly_loss:0.3588	fnorm_loss:0.0072, a_fnorm_loss:0.0474P:0.46, R:0.86
 55%|█████▌    | 55/100 [23:59<22:27, 29.94s/it]epoch [55/100], focal_loss:0.0139	, anomaly_loss:0.3610	fnorm_loss:0.0073, a_fnorm_loss:0.0467P:0.44, R:0.85
normal: 0.0952 0.4443  anomaly: 0.1508 0.7091	P:0.16, R:0.21
Pixel Auroc:0.962, Sample Auroc0.941, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0267
 56%|█████▌    | 56/100 [24:21<20:05, 27.39s/it]epoch [56/100], focal_loss:0.0132	, anomaly_loss:0.3662	fnorm_loss:0.0072, a_fnorm_loss:0.0468P:0.45, R:0.85
 57%|█████▋    | 57/100 [24:43<18:25, 25.71s/it]epoch [57/100], focal_loss:0.0144	, anomaly_loss:0.3626	fnorm_loss:0.0072, a_fnorm_loss:0.0476P:0.47, R:0.86
 58%|█████▊    | 58/100 [25:04<17:07, 24.47s/it]epoch [58/100], focal_loss:0.0145	, anomaly_loss:0.3647	fnorm_loss:0.0073, a_fnorm_loss:0.0467P:0.47, R:0.84
 59%|█████▉    | 59/100 [25:25<16:02, 23.48s/it]epoch [59/100], focal_loss:0.0127	, anomaly_loss:0.3597	fnorm_loss:0.0071, a_fnorm_loss:0.0477P:0.45, R:0.86
 60%|██████    | 60/100 [26:06<19:07, 28.69s/it]epoch [60/100], focal_loss:0.0140	, anomaly_loss:0.3606	fnorm_loss:0.0072, a_fnorm_loss:0.0484P:0.47, R:0.85
normal: 0.0817 0.3914  anomaly: 0.1536 0.7327	P:0.14, R:0.15
Pixel Auroc:0.928, Sample Auroc0.943, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0227
 61%|██████    | 61/100 [26:27<17:11, 26.45s/it]epoch [61/100], focal_loss:0.0132	, anomaly_loss:0.3576	fnorm_loss:0.0071, a_fnorm_loss:0.0478P:0.47, R:0.86
 62%|██████▏   | 62/100 [26:49<15:47, 24.93s/it]epoch [62/100], focal_loss:0.0135	, anomaly_loss:0.3605	fnorm_loss:0.0072, a_fnorm_loss:0.0474P:0.46, R:0.86
 63%|██████▎   | 63/100 [27:11<14:50, 24.08s/it]epoch [63/100], focal_loss:0.0140	, anomaly_loss:0.3621	fnorm_loss:0.0072, a_fnorm_loss:0.0477P:0.47, R:0.85
 64%|██████▍   | 64/100 [27:33<14:02, 23.39s/it]epoch [64/100], focal_loss:0.0137	, anomaly_loss:0.3595	fnorm_loss:0.0072, a_fnorm_loss:0.0479P:0.45, R:0.85
 65%|██████▌   | 65/100 [28:13<16:40, 28.60s/it]epoch [65/100], focal_loss:0.0134	, anomaly_loss:0.3615	fnorm_loss:0.0071, a_fnorm_loss:0.0472P:0.48, R:0.86
normal: 0.1227 0.4765  anomaly: 0.2047 0.7148	P:0.14, R:0.22
Pixel Auroc:0.953, Sample Auroc0.940, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0274
 66%|██████▌   | 66/100 [28:34<14:53, 26.29s/it]epoch [66/100], focal_loss:0.0130	, anomaly_loss:0.3607	fnorm_loss:0.0071, a_fnorm_loss:0.0477P:0.45, R:0.86
 67%|██████▋   | 67/100 [28:55<13:35, 24.72s/it]epoch [67/100], focal_loss:0.0138	, anomaly_loss:0.3598	fnorm_loss:0.0071, a_fnorm_loss:0.0476P:0.48, R:0.86
 68%|██████▊   | 68/100 [29:17<12:36, 23.65s/it]epoch [68/100], focal_loss:0.0132	, anomaly_loss:0.3593	fnorm_loss:0.0072, a_fnorm_loss:0.0475P:0.45, R:0.86
 69%|██████▉   | 69/100 [29:38<11:49, 22.90s/it]epoch [69/100], focal_loss:0.0124	, anomaly_loss:0.3537	fnorm_loss:0.0070, a_fnorm_loss:0.0485P:0.48, R:0.87
 70%|███████   | 70/100 [30:19<14:11, 28.38s/it]epoch [70/100], focal_loss:0.0130	, anomaly_loss:0.3583	fnorm_loss:0.0070, a_fnorm_loss:0.0487P:0.50, R:0.87
normal: 0.1319 0.4345  anomaly: 0.1660 0.7428	P:0.14, R:0.21
Pixel Auroc:0.945, Sample Auroc0.939, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0257
 71%|███████   | 71/100 [30:40<12:39, 26.18s/it]epoch [71/100], focal_loss:0.0139	, anomaly_loss:0.3540	fnorm_loss:0.0070, a_fnorm_loss:0.0489P:0.50, R:0.87
 72%|███████▏  | 72/100 [31:01<11:33, 24.78s/it]epoch [72/100], focal_loss:0.0130	, anomaly_loss:0.3616	fnorm_loss:0.0071, a_fnorm_loss:0.0481P:0.48, R:0.86
 73%|███████▎  | 73/100 [31:24<10:50, 24.11s/it]epoch [73/100], focal_loss:0.0127	, anomaly_loss:0.3572	fnorm_loss:0.0070, a_fnorm_loss:0.0482P:0.47, R:0.87
 74%|███████▍  | 74/100 [31:46<10:07, 23.37s/it]epoch [74/100], focal_loss:0.0128	, anomaly_loss:0.3578	fnorm_loss:0.0070, a_fnorm_loss:0.0483P:0.47, R:0.86
 75%|███████▌  | 75/100 [32:32<12:37, 30.30s/it]epoch [75/100], focal_loss:0.0148	, anomaly_loss:0.3681	fnorm_loss:0.0073, a_fnorm_loss:0.0470P:0.47, R:0.84
normal: 0.0766 0.3835  anomaly: 0.1069 0.7195	P:0.18, R:0.17
Pixel Auroc:0.951, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0207
 76%|███████▌  | 76/100 [32:53<11:00, 27.53s/it]epoch [76/100], focal_loss:0.0135	, anomaly_loss:0.3602	fnorm_loss:0.0071, a_fnorm_loss:0.0480P:0.48, R:0.86
 77%|███████▋  | 77/100 [33:14<09:47, 25.56s/it]epoch [77/100], focal_loss:0.0141	, anomaly_loss:0.3652	fnorm_loss:0.0072, a_fnorm_loss:0.0474P:0.45, R:0.85
 78%|███████▊  | 78/100 [33:36<08:59, 24.53s/it]epoch [78/100], focal_loss:0.0130	, anomaly_loss:0.3582	fnorm_loss:0.0071, a_fnorm_loss:0.0481P:0.47, R:0.86
 79%|███████▉  | 79/100 [33:58<08:14, 23.56s/it]epoch [79/100], focal_loss:0.0129	, anomaly_loss:0.3562	fnorm_loss:0.0071, a_fnorm_loss:0.0478P:0.47, R:0.87
 80%|████████  | 80/100 [34:38<09:33, 28.67s/it]epoch [80/100], focal_loss:0.0129	, anomaly_loss:0.3545	fnorm_loss:0.0071, a_fnorm_loss:0.0476P:0.46, R:0.86
normal: 0.1651 0.5105  anomaly: 0.2851 0.7651	P:0.11, R:0.25
Pixel Auroc:0.957, Sample Auroc0.929, Pixel Aupro0.0
test_fnorm_loss: 0.0075 test_afnorm_loss: 0.0314
 81%|████████  | 81/100 [34:59<08:22, 26.47s/it]epoch [81/100], focal_loss:0.0119	, anomaly_loss:0.3533	fnorm_loss:0.0069, a_fnorm_loss:0.0497P:0.47, R:0.89
 82%|████████▏ | 82/100 [35:21<07:29, 24.96s/it]epoch [82/100], focal_loss:0.0112	, anomaly_loss:0.3495	fnorm_loss:0.0068, a_fnorm_loss:0.0497P:0.48, R:0.89
 83%|████████▎ | 83/100 [35:42<06:43, 23.74s/it]epoch [83/100], focal_loss:0.0114	, anomaly_loss:0.3476	fnorm_loss:0.0068, a_fnorm_loss:0.0504P:0.48, R:0.90
 84%|████████▍ | 84/100 [36:04<06:12, 23.27s/it]epoch [84/100], focal_loss:0.0122	, anomaly_loss:0.3484	fnorm_loss:0.0069, a_fnorm_loss:0.0498P:0.49, R:0.89
 85%|████████▌ | 85/100 [36:46<07:11, 28.76s/it]epoch [85/100], focal_loss:0.0126	, anomaly_loss:0.3485	fnorm_loss:0.0069, a_fnorm_loss:0.0492P:0.48, R:0.89
normal: 0.1218 0.5030  anomaly: 0.1931 0.7804	P:0.13, R:0.22
Pixel Auroc:0.943, Sample Auroc0.939, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0266
 86%|████████▌ | 86/100 [37:07<06:11, 26.57s/it]epoch [86/100], focal_loss:0.0122	, anomaly_loss:0.3489	fnorm_loss:0.0069, a_fnorm_loss:0.0493P:0.47, R:0.89
 87%|████████▋ | 87/100 [37:29<05:26, 25.09s/it]epoch [87/100], focal_loss:0.0124	, anomaly_loss:0.3519	fnorm_loss:0.0070, a_fnorm_loss:0.0485P:0.46, R:0.88
 88%|████████▊ | 88/100 [37:50<04:47, 23.98s/it]epoch [88/100], focal_loss:0.0123	, anomaly_loss:0.3536	fnorm_loss:0.0070, a_fnorm_loss:0.0492P:0.47, R:0.88
 89%|████████▉ | 89/100 [38:11<04:15, 23.21s/it]epoch [89/100], focal_loss:0.0122	, anomaly_loss:0.3511	fnorm_loss:0.0069, a_fnorm_loss:0.0497P:0.48, R:0.88
 90%|█████████ | 90/100 [38:53<04:46, 28.63s/it]epoch [90/100], focal_loss:0.0119	, anomaly_loss:0.3450	fnorm_loss:0.0069, a_fnorm_loss:0.0494P:0.49, R:0.89
normal: 0.0989 0.5116  anomaly: 0.1863 0.7680	P:0.14, R:0.23
Pixel Auroc:0.956, Sample Auroc0.941, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0285
 91%|█████████ | 91/100 [39:14<03:58, 26.48s/it]epoch [91/100], focal_loss:0.0123	, anomaly_loss:0.3501	fnorm_loss:0.0069, a_fnorm_loss:0.0495P:0.45, R:0.88
 92%|█████████▏| 92/100 [39:35<03:19, 24.92s/it]epoch [92/100], focal_loss:0.0120	, anomaly_loss:0.3497	fnorm_loss:0.0070, a_fnorm_loss:0.0491P:0.46, R:0.88
 93%|█████████▎| 93/100 [39:57<02:46, 23.78s/it]epoch [93/100], focal_loss:0.0111	, anomaly_loss:0.3484	fnorm_loss:0.0068, a_fnorm_loss:0.0502P:0.47, R:0.89
 94%|█████████▍| 94/100 [40:18<02:18, 23.16s/it]epoch [94/100], focal_loss:0.0120	, anomaly_loss:0.3491	fnorm_loss:0.0069, a_fnorm_loss:0.0493P:0.45, R:0.88
 95%|█████████▌| 95/100 [41:00<02:23, 28.74s/it]epoch [95/100], focal_loss:0.0118	, anomaly_loss:0.3472	fnorm_loss:0.0068, a_fnorm_loss:0.0493P:0.48, R:0.89
normal: 0.0982 0.4974  anomaly: 0.2081 0.7789	P:0.13, R:0.23
Pixel Auroc:0.949, Sample Auroc0.947, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0288
 96%|█████████▌| 96/100 [41:22<01:46, 26.59s/it]epoch [96/100], focal_loss:0.0117	, anomaly_loss:0.3426	fnorm_loss:0.0069, a_fnorm_loss:0.0502P:0.48, R:0.90
 97%|█████████▋| 97/100 [41:42<01:14, 24.88s/it]epoch [97/100], focal_loss:0.0124	, anomaly_loss:0.3518	fnorm_loss:0.0069, a_fnorm_loss:0.0489P:0.45, R:0.87
 98%|█████████▊| 98/100 [42:04<00:47, 23.96s/it]epoch [98/100], focal_loss:0.0111	, anomaly_loss:0.3481	fnorm_loss:0.0068, a_fnorm_loss:0.0508P:0.47, R:0.89
 99%|█████████▉| 99/100 [42:26<00:23, 23.14s/it]epoch [99/100], focal_loss:0.0120	, anomaly_loss:0.3449	fnorm_loss:0.0068, a_fnorm_loss:0.0496P:0.47, R:0.88
100%|██████████| 100/100 [43:06<00:00, 28.39s/it]100%|██████████| 100/100 [43:06<00:00, 25.87s/it]
epoch [100/100], focal_loss:0.0124	, anomaly_loss:0.3436	fnorm_loss:0.0069, a_fnorm_loss:0.0495P:0.48, R:0.89
normal: 0.1112 0.5371  anomaly: 0.2503 0.7883	P:0.11, R:0.25
Pixel Auroc:0.948, Sample Auroc0.946, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0303
training Stubborn Student...
pcb4
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:16<32:04, 16.17s/it]epoch [1/120], kd_loss:3.8229
  2%|▏         | 2/120 [00:32<32:05, 16.32s/it]epoch [2/120], kd_loss:2.6541
  2%|▎         | 3/120 [00:48<31:52, 16.35s/it]epoch [3/120], kd_loss:2.4443
  3%|▎         | 4/120 [01:05<31:38, 16.36s/it]epoch [4/120], kd_loss:2.2588
  4%|▍         | 5/120 [01:21<31:26, 16.41s/it]epoch [5/120], kd_loss:2.1129
  5%|▌         | 6/120 [01:38<31:10, 16.41s/it]epoch [6/120], kd_loss:2.2691
  6%|▌         | 7/120 [01:54<30:55, 16.42s/it]epoch [7/120], kd_loss:1.9696
  7%|▋         | 8/120 [02:11<30:42, 16.45s/it]epoch [8/120], kd_loss:2.0091
  8%|▊         | 9/120 [02:27<30:26, 16.45s/it]epoch [9/120], kd_loss:1.9404
  8%|▊         | 10/120 [03:02<40:31, 22.11s/it]epoch [10/120], kd_loss:1.8346
normal: 1.1388 1.5989  anomaly: 1.2870 2.2218
thresh: 1.423852051142414
fpr: 0.07920792079207921 fnr 0.13
Pixel Auroc:0.961, Sample Auroc0.954, Pixel Aupro0.0
  9%|▉         | 11/120 [03:18<36:55, 20.33s/it]epoch [11/120], kd_loss:1.7505
 10%|█         | 12/120 [03:35<34:22, 19.10s/it]epoch [12/120], kd_loss:1.8924
 11%|█         | 13/120 [03:51<32:36, 18.28s/it]epoch [13/120], kd_loss:1.7279
 12%|█▏        | 14/120 [04:07<31:17, 17.71s/it]epoch [14/120], kd_loss:1.7463
 12%|█▎        | 15/120 [04:24<30:16, 17.30s/it]epoch [15/120], kd_loss:2.0415
 13%|█▎        | 16/120 [04:40<29:32, 17.04s/it]epoch [16/120], kd_loss:1.7337
 14%|█▍        | 17/120 [04:57<28:55, 16.85s/it]epoch [17/120], kd_loss:1.7068
 15%|█▌        | 18/120 [05:13<28:22, 16.70s/it]epoch [18/120], kd_loss:1.9175
 16%|█▌        | 19/120 [05:29<27:56, 16.60s/it]epoch [19/120], kd_loss:1.8880
 17%|█▋        | 20/120 [06:08<38:58, 23.38s/it]epoch [20/120], kd_loss:1.7344
normal: 1.0729 1.4930  anomaly: 1.2526 2.2035
thresh: 1.3485416770287357
fpr: 0.09900990099009901 fnr 0.04
Pixel Auroc:0.965, Sample Auroc0.975, Pixel Aupro0.0
 18%|█▊        | 21/120 [06:25<35:06, 21.28s/it]epoch [21/120], kd_loss:1.6869
 18%|█▊        | 22/120 [06:41<32:25, 19.86s/it]epoch [22/120], kd_loss:1.6527
 19%|█▉        | 23/120 [06:58<30:30, 18.87s/it]epoch [23/120], kd_loss:1.6586
 20%|██        | 24/120 [07:14<29:02, 18.15s/it]epoch [24/120], kd_loss:1.6734
 21%|██        | 25/120 [07:31<27:57, 17.66s/it]epoch [25/120], kd_loss:1.6691
 22%|██▏       | 26/120 [07:47<27:05, 17.29s/it]epoch [26/120], kd_loss:1.7282
 22%|██▎       | 27/120 [08:04<26:22, 17.02s/it]epoch [27/120], kd_loss:1.6416
 23%|██▎       | 28/120 [08:20<25:49, 16.84s/it]epoch [28/120], kd_loss:1.6432
 24%|██▍       | 29/120 [08:37<25:20, 16.71s/it]epoch [29/120], kd_loss:2.0156
 25%|██▌       | 30/120 [09:14<34:35, 23.06s/it]epoch [30/120], kd_loss:2.0334
normal: 1.0217 1.6063  anomaly: 1.2081 2.2708
thresh: 1.3490461469919626
fpr: 0.09900990099009901 fnr 0.04
Pixel Auroc:0.961, Sample Auroc0.971, Pixel Aupro0.0
 26%|██▌       | 31/120 [09:31<31:15, 21.07s/it]epoch [31/120], kd_loss:1.8257
 27%|██▋       | 32/120 [09:47<28:56, 19.73s/it]epoch [32/120], kd_loss:1.7218
 28%|██▊       | 33/120 [10:04<27:12, 18.77s/it]epoch [33/120], kd_loss:2.3951
 28%|██▊       | 34/120 [10:20<25:55, 18.09s/it]epoch [34/120], kd_loss:1.9534
 29%|██▉       | 35/120 [10:37<24:59, 17.64s/it]epoch [35/120], kd_loss:1.8296
 30%|███       | 36/120 [10:54<24:13, 17.30s/it]epoch [36/120], kd_loss:1.6978
 31%|███       | 37/120 [11:10<23:36, 17.06s/it]epoch [37/120], kd_loss:1.6387
 32%|███▏      | 38/120 [11:27<23:06, 16.91s/it]epoch [38/120], kd_loss:1.6485
 32%|███▎      | 39/120 [11:43<22:40, 16.79s/it]epoch [39/120], kd_loss:1.7673
 33%|███▎      | 40/120 [12:21<30:43, 23.04s/it]epoch [40/120], kd_loss:1.6774
normal: 1.0208 1.4700  anomaly: 1.2449 2.2501
thresh: 1.3327212857466852
fpr: 0.19801980198019803 fnr 0.09
Pixel Auroc:0.956, Sample Auroc0.949, Pixel Aupro0.0
 34%|███▍      | 41/120 [12:37<27:42, 21.04s/it]epoch [41/120], kd_loss:1.7169
 35%|███▌      | 42/120 [12:54<25:34, 19.67s/it]epoch [42/120], kd_loss:1.6161
 36%|███▌      | 43/120 [13:10<23:59, 18.70s/it]epoch [43/120], kd_loss:1.7026
 37%|███▋      | 44/120 [13:27<22:50, 18.03s/it]epoch [44/120], kd_loss:1.7006
 38%|███▊      | 45/120 [13:43<21:57, 17.57s/it]epoch [45/120], kd_loss:1.6168
 38%|███▊      | 46/120 [14:00<21:16, 17.25s/it]epoch [46/120], kd_loss:1.6096
 39%|███▉      | 47/120 [14:16<20:43, 17.03s/it]epoch [47/120], kd_loss:1.6004
 40%|████      | 48/120 [14:33<20:15, 16.88s/it]epoch [48/120], kd_loss:1.6391
 41%|████      | 49/120 [14:49<19:51, 16.78s/it]epoch [49/120], kd_loss:1.5842
 42%|████▏     | 50/120 [15:26<26:39, 22.85s/it]epoch [50/120], kd_loss:1.5662
normal: 0.9554 1.4554  anomaly: 1.2803 2.2466
thresh: 1.280306043279866
fpr: 0.1485148514851485 fnr 0.0
Pixel Auroc:0.960, Sample Auroc0.973, Pixel Aupro0.0
 42%|████▎     | 51/120 [15:43<24:02, 20.91s/it]epoch [51/120], kd_loss:1.5619
 43%|████▎     | 52/120 [15:59<22:10, 19.57s/it]epoch [52/120], kd_loss:1.5533
 44%|████▍     | 53/120 [16:15<20:47, 18.63s/it]epoch [53/120], kd_loss:1.5443
 45%|████▌     | 54/120 [16:32<19:47, 17.99s/it]epoch [54/120], kd_loss:1.5336
 46%|████▌     | 55/120 [16:48<19:00, 17.54s/it]epoch [55/120], kd_loss:1.5241
 47%|████▋     | 56/120 [17:05<18:23, 17.25s/it]epoch [56/120], kd_loss:1.6143
 48%|████▊     | 57/120 [17:21<17:51, 17.02s/it]epoch [57/120], kd_loss:2.2326
 48%|████▊     | 58/120 [17:38<17:22, 16.81s/it]epoch [58/120], kd_loss:1.6468
 49%|████▉     | 59/120 [17:54<16:58, 16.70s/it]epoch [59/120], kd_loss:1.6271
 50%|█████     | 60/120 [18:29<22:06, 22.11s/it]epoch [60/120], kd_loss:1.5892
normal: 0.9634 1.4631  anomaly: 1.1909 2.1930
thresh: 1.2784310800966823
fpr: 0.13861386138613863 fnr 0.03
Pixel Auroc:0.964, Sample Auroc0.974, Pixel Aupro0.0
 51%|█████     | 61/120 [18:45<20:02, 20.39s/it]epoch [61/120], kd_loss:1.5874
 52%|█████▏    | 62/120 [19:02<18:31, 19.16s/it]epoch [62/120], kd_loss:1.5607
 52%|█████▎    | 63/120 [19:18<17:26, 18.35s/it]epoch [63/120], kd_loss:1.5424
 53%|█████▎    | 64/120 [19:35<16:37, 17.81s/it]epoch [64/120], kd_loss:1.5374
 54%|█████▍    | 65/120 [19:51<15:56, 17.39s/it]epoch [65/120], kd_loss:1.5720
 55%|█████▌    | 66/120 [20:07<15:24, 17.12s/it]epoch [66/120], kd_loss:1.6426
 56%|█████▌    | 67/120 [20:24<14:55, 16.90s/it]epoch [67/120], kd_loss:1.5627
 57%|█████▋    | 68/120 [20:40<14:30, 16.75s/it]epoch [68/120], kd_loss:1.5251
 57%|█████▊    | 69/120 [20:57<14:08, 16.63s/it]epoch [69/120], kd_loss:1.5242
 58%|█████▊    | 70/120 [21:31<18:20, 22.02s/it]epoch [70/120], kd_loss:1.5127
normal: 0.9485 1.4733  anomaly: 1.1876 2.1879
thresh: 1.2245418764865752
fpr: 0.13861386138613863 fnr 0.03
Pixel Auroc:0.966, Sample Auroc0.965, Pixel Aupro0.0
 59%|█████▉    | 71/120 [21:47<16:33, 20.28s/it]epoch [71/120], kd_loss:1.5190
 60%|██████    | 72/120 [22:04<15:15, 19.08s/it]epoch [72/120], kd_loss:1.5264
 61%|██████    | 73/120 [22:20<14:17, 18.25s/it]epoch [73/120], kd_loss:1.5539
 62%|██████▏   | 74/120 [22:36<13:34, 17.70s/it]epoch [74/120], kd_loss:1.6083
 62%|██████▎   | 75/120 [22:53<12:58, 17.30s/it]epoch [75/120], kd_loss:1.6445
 63%|██████▎   | 76/120 [23:09<12:28, 17.02s/it]epoch [76/120], kd_loss:2.0296
 64%|██████▍   | 77/120 [23:26<12:04, 16.84s/it]epoch [77/120], kd_loss:1.5727
 65%|██████▌   | 78/120 [23:42<11:41, 16.71s/it]epoch [78/120], kd_loss:1.6065
 66%|██████▌   | 79/120 [23:58<11:21, 16.62s/it]epoch [79/120], kd_loss:1.6588
 67%|██████▋   | 80/120 [24:33<14:43, 22.09s/it]epoch [80/120], kd_loss:1.6082
normal: 0.9445 1.6809  anomaly: 1.2647 2.2482
thresh: 1.2647358693107442
fpr: 0.24752475247524752 fnr 0.0
Pixel Auroc:0.965, Sample Auroc0.944, Pixel Aupro0.0
 68%|██████▊   | 81/120 [24:49<13:12, 20.32s/it]epoch [81/120], kd_loss:1.5797
 68%|██████▊   | 82/120 [25:06<12:06, 19.11s/it]epoch [82/120], kd_loss:1.7011
 69%|██████▉   | 83/120 [25:22<11:15, 18.27s/it]epoch [83/120], kd_loss:1.5772
 70%|███████   | 84/120 [25:38<10:37, 17.69s/it]epoch [84/120], kd_loss:1.7623
 71%|███████   | 85/120 [25:55<10:05, 17.31s/it]epoch [85/120], kd_loss:1.5702
 72%|███████▏  | 86/120 [26:11<09:39, 17.03s/it]epoch [86/120], kd_loss:1.5673
 72%|███████▎  | 87/120 [26:28<09:15, 16.84s/it]epoch [87/120], kd_loss:1.5538
 73%|███████▎  | 88/120 [26:44<08:54, 16.69s/it]epoch [88/120], kd_loss:1.5291
 74%|███████▍  | 89/120 [27:00<08:34, 16.61s/it]epoch [89/120], kd_loss:1.5590
 75%|███████▌  | 90/120 [27:35<11:01, 22.05s/it]epoch [90/120], kd_loss:1.5436
normal: 0.9258 1.6516  anomaly: 1.2023 2.2278
thresh: 1.2397886401087477
fpr: 0.2376237623762376 fnr 0.01
Pixel Auroc:0.963, Sample Auroc0.942, Pixel Aupro0.0
 76%|███████▌  | 91/120 [27:51<09:48, 20.30s/it]epoch [91/120], kd_loss:1.5333
 77%|███████▋  | 92/120 [28:08<08:55, 19.13s/it]epoch [92/120], kd_loss:1.6257
 78%|███████▊  | 93/120 [28:24<08:13, 18.28s/it]epoch [93/120], kd_loss:1.5189
 78%|███████▊  | 94/120 [28:40<07:40, 17.70s/it]epoch [94/120], kd_loss:1.5178
 79%|███████▉  | 95/120 [28:57<07:12, 17.30s/it]epoch [95/120], kd_loss:1.5014
 80%|████████  | 96/120 [29:13<06:48, 17.03s/it]epoch [96/120], kd_loss:1.5049
 81%|████████  | 97/120 [29:29<06:27, 16.83s/it]epoch [97/120], kd_loss:1.4786
 82%|████████▏ | 98/120 [29:46<06:07, 16.69s/it]epoch [98/120], kd_loss:1.4751
 82%|████████▎ | 99/120 [30:02<05:48, 16.59s/it]epoch [99/120], kd_loss:1.4726
 83%|████████▎ | 100/120 [30:40<07:35, 22.80s/it]epoch [100/120], kd_loss:1.4825
normal: 0.9041 1.5080  anomaly: 1.2083 2.2161
thresh: 1.3010224711021607
fpr: 0.09900990099009901 fnr 0.05
Pixel Auroc:0.962, Sample Auroc0.968, Pixel Aupro0.0
 84%|████████▍ | 101/120 [30:56<06:36, 20.85s/it]epoch [101/120], kd_loss:1.4812
 85%|████████▌ | 102/120 [31:12<05:50, 19.50s/it]epoch [102/120], kd_loss:1.4711
 86%|████████▌ | 103/120 [31:29<05:15, 18.56s/it]epoch [103/120], kd_loss:1.4664
 87%|████████▋ | 104/120 [31:45<04:46, 17.90s/it]epoch [104/120], kd_loss:1.4628
 88%|████████▊ | 105/120 [32:01<04:21, 17.46s/it]epoch [105/120], kd_loss:1.4626
 88%|████████▊ | 106/120 [32:18<04:00, 17.14s/it]epoch [106/120], kd_loss:1.4614
 89%|████████▉ | 107/120 [32:34<03:40, 16.96s/it]epoch [107/120], kd_loss:1.4626
 90%|█████████ | 108/120 [32:51<03:21, 16.81s/it]epoch [108/120], kd_loss:1.4585
 91%|█████████ | 109/120 [33:07<03:03, 16.70s/it]epoch [109/120], kd_loss:1.4561
 92%|█████████▏| 110/120 [33:44<03:47, 22.75s/it]epoch [110/120], kd_loss:1.4551
normal: 0.8838 1.5249  anomaly: 1.1772 2.2228
thresh: 1.2653545038379113
fpr: 0.12871287128712872 fnr 0.03
Pixel Auroc:0.968, Sample Auroc0.970, Pixel Aupro0.0
 92%|█████████▎| 111/120 [34:00<03:07, 20.82s/it]epoch [111/120], kd_loss:1.4543
 93%|█████████▎| 112/120 [34:17<02:36, 19.53s/it]epoch [112/120], kd_loss:1.4534
 94%|█████████▍| 113/120 [34:33<02:10, 18.59s/it]epoch [113/120], kd_loss:1.4523
 95%|█████████▌| 114/120 [34:50<01:47, 17.93s/it]epoch [114/120], kd_loss:1.4527
 96%|█████████▌| 115/120 [35:06<01:27, 17.47s/it]epoch [115/120], kd_loss:1.4520
 97%|█████████▋| 116/120 [35:22<01:08, 17.14s/it]epoch [116/120], kd_loss:1.4516
 98%|█████████▊| 117/120 [35:39<00:50, 16.93s/it]epoch [117/120], kd_loss:1.4512
 98%|█████████▊| 118/120 [35:55<00:33, 16.80s/it]epoch [118/120], kd_loss:1.4524
 99%|█████████▉| 119/120 [36:12<00:16, 16.68s/it]epoch [119/120], kd_loss:1.4510
100%|██████████| 120/120 [36:49<00:00, 22.79s/it]100%|██████████| 120/120 [36:49<00:00, 18.41s/it]
epoch [120/120], kd_loss:1.4506
normal: 0.8712 1.5416  anomaly: 1.1804 2.2194
thresh: 1.2443662501751953
fpr: 0.12871287128712872 fnr 0.02
Pixel Auroc:0.968, Sample Auroc0.970, Pixel Aupro0.0
training Advanced Teacher...
pipe_fryum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:31<51:32, 31.23s/it]epoch [1/100], focal_loss:0.0672	, anomaly_loss:0.5322	fnorm_loss:0.0771, a_fnorm_loss:0.0136P:0.00, R:0.01
normal: 0.2285 0.2375  anomaly: 0.2173 0.2353	P:0.00, R:0.00
Pixel Auroc:0.860, Sample Auroc0.340, Pixel Aupro0.0
test_fnorm_loss: 0.0727 test_afnorm_loss: 0.0132
  2%|▏         | 2/100 [00:43<33:16, 20.37s/it]epoch [2/100], focal_loss:0.0504	, anomaly_loss:0.5577	fnorm_loss:0.0643, a_fnorm_loss:0.0114P:0.00, R:0.00
  3%|▎         | 3/100 [00:56<27:24, 16.95s/it]epoch [3/100], focal_loss:0.0409	, anomaly_loss:0.5688	fnorm_loss:0.0539, a_fnorm_loss:0.0097P:0.00, R:0.00
  4%|▍         | 4/100 [01:09<24:28, 15.30s/it]epoch [4/100], focal_loss:0.0350	, anomaly_loss:0.6025	fnorm_loss:0.0472, a_fnorm_loss:0.0089P:0.00, R:0.00
  5%|▌         | 5/100 [01:38<32:01, 20.23s/it]epoch [5/100], focal_loss:0.0343	, anomaly_loss:0.4863	fnorm_loss:0.0425, a_fnorm_loss:0.0265P:0.08, R:0.28
normal: 0.2550 0.3259  anomaly: 0.2253 0.3304	P:0.03, R:0.07
Pixel Auroc:0.921, Sample Auroc0.400, Pixel Aupro0.0
test_fnorm_loss: 0.0384 test_afnorm_loss: 0.0283
  6%|▌         | 6/100 [01:52<28:02, 17.90s/it]epoch [6/100], focal_loss:0.0293	, anomaly_loss:0.4621	fnorm_loss:0.0352, a_fnorm_loss:0.0328P:0.10, R:0.32
  7%|▋         | 7/100 [02:04<25:11, 16.25s/it]epoch [7/100], focal_loss:0.0257	, anomaly_loss:0.3610	fnorm_loss:0.0314, a_fnorm_loss:0.0351P:0.17, R:0.63
  8%|▊         | 8/100 [02:17<23:02, 15.03s/it]epoch [8/100], focal_loss:0.0218	, anomaly_loss:0.3009	fnorm_loss:0.0270, a_fnorm_loss:0.0381P:0.33, R:0.88
  9%|▉         | 9/100 [02:29<21:33, 14.21s/it]epoch [9/100], focal_loss:0.0187	, anomaly_loss:0.2867	fnorm_loss:0.0238, a_fnorm_loss:0.0410P:0.34, R:0.93
 10%|█         | 10/100 [02:59<28:22, 18.92s/it]epoch [10/100], focal_loss:0.0156	, anomaly_loss:0.2642	fnorm_loss:0.0213, a_fnorm_loss:0.0425P:0.36, R:0.91
normal: 0.0782 0.3182  anomaly: 0.1440 0.6192	P:0.13, R:0.19
Pixel Auroc:0.927, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0201 test_afnorm_loss: 0.0330
 11%|█         | 11/100 [03:11<25:03, 16.90s/it]epoch [11/100], focal_loss:0.0144	, anomaly_loss:0.2635	fnorm_loss:0.0195, a_fnorm_loss:0.0424P:0.29, R:0.88
 12%|█▏        | 12/100 [03:24<22:58, 15.67s/it]epoch [12/100], focal_loss:0.0124	, anomaly_loss:0.2472	fnorm_loss:0.0178, a_fnorm_loss:0.0450P:0.36, R:0.96
 13%|█▎        | 13/100 [03:37<21:30, 14.84s/it]epoch [13/100], focal_loss:0.0126	, anomaly_loss:0.2542	fnorm_loss:0.0167, a_fnorm_loss:0.0443P:0.38, R:0.94
 14%|█▍        | 14/100 [03:49<20:15, 14.14s/it]epoch [14/100], focal_loss:0.0114	, anomaly_loss:0.2467	fnorm_loss:0.0157, a_fnorm_loss:0.0438P:0.38, R:0.96
 15%|█▌        | 15/100 [04:21<27:37, 19.51s/it]epoch [15/100], focal_loss:0.0112	, anomaly_loss:0.2554	fnorm_loss:0.0149, a_fnorm_loss:0.0455P:0.41, R:0.95
normal: 0.0497 0.2567  anomaly: 0.0658 0.5843	P:0.13, R:0.14
Pixel Auroc:0.932, Sample Auroc0.935, Pixel Aupro0.0
test_fnorm_loss: 0.0142 test_afnorm_loss: 0.0269
 16%|█▌        | 16/100 [04:34<24:27, 17.47s/it]epoch [16/100], focal_loss:0.0112	, anomaly_loss:0.2533	fnorm_loss:0.0142, a_fnorm_loss:0.0445P:0.42, R:0.94
 17%|█▋        | 17/100 [04:46<21:58, 15.88s/it]epoch [17/100], focal_loss:0.0097	, anomaly_loss:0.2450	fnorm_loss:0.0134, a_fnorm_loss:0.0463P:0.42, R:0.95
 18%|█▊        | 18/100 [04:58<20:10, 14.76s/it]epoch [18/100], focal_loss:0.0103	, anomaly_loss:0.2484	fnorm_loss:0.0129, a_fnorm_loss:0.0453P:0.38, R:0.95
 19%|█▉        | 19/100 [05:12<19:23, 14.37s/it]epoch [19/100], focal_loss:0.0092	, anomaly_loss:0.2365	fnorm_loss:0.0123, a_fnorm_loss:0.0476P:0.43, R:0.91
 20%|██        | 20/100 [05:42<25:24, 19.06s/it]epoch [20/100], focal_loss:0.0087	, anomaly_loss:0.2413	fnorm_loss:0.0119, a_fnorm_loss:0.0481P:0.43, R:0.95
normal: 0.0417 0.2088  anomaly: 0.0594 0.5270	P:0.10, R:0.10
Pixel Auroc:0.929, Sample Auroc0.904, Pixel Aupro0.0
test_fnorm_loss: 0.0115 test_afnorm_loss: 0.0169
 21%|██        | 21/100 [05:54<22:28, 17.06s/it]epoch [21/100], focal_loss:0.0082	, anomaly_loss:0.2448	fnorm_loss:0.0115, a_fnorm_loss:0.0473P:0.47, R:0.94
 22%|██▏       | 22/100 [06:06<20:15, 15.59s/it]epoch [22/100], focal_loss:0.0076	, anomaly_loss:0.2181	fnorm_loss:0.0111, a_fnorm_loss:0.0482P:0.42, R:0.93
 23%|██▎       | 23/100 [06:19<18:46, 14.64s/it]epoch [23/100], focal_loss:0.0095	, anomaly_loss:0.2466	fnorm_loss:0.0110, a_fnorm_loss:0.0465P:0.47, R:0.93
 24%|██▍       | 24/100 [06:31<17:41, 13.97s/it]epoch [24/100], focal_loss:0.0083	, anomaly_loss:0.2406	fnorm_loss:0.0106, a_fnorm_loss:0.0474P:0.49, R:0.94
 25%|██▌       | 25/100 [07:05<25:04, 20.06s/it]epoch [25/100], focal_loss:0.0071	, anomaly_loss:0.2167	fnorm_loss:0.0102, a_fnorm_loss:0.0488P:0.46, R:0.93
normal: 0.0329 0.2547  anomaly: 0.0362 0.5944	P:0.14, R:0.13
Pixel Auroc:0.943, Sample Auroc0.879, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0278
 26%|██▌       | 26/100 [07:18<22:02, 17.88s/it]epoch [26/100], focal_loss:0.0093	, anomaly_loss:0.2402	fnorm_loss:0.0102, a_fnorm_loss:0.0480P:0.43, R:0.90
 27%|██▋       | 27/100 [07:31<19:48, 16.27s/it]epoch [27/100], focal_loss:0.0073	, anomaly_loss:0.2333	fnorm_loss:0.0099, a_fnorm_loss:0.0485P:0.47, R:0.96
 28%|██▊       | 28/100 [07:43<18:15, 15.22s/it]epoch [28/100], focal_loss:0.0079	, anomaly_loss:0.2235	fnorm_loss:0.0097, a_fnorm_loss:0.0487P:0.44, R:0.92
 29%|██▉       | 29/100 [07:56<16:59, 14.35s/it]epoch [29/100], focal_loss:0.0071	, anomaly_loss:0.2338	fnorm_loss:0.0095, a_fnorm_loss:0.0493P:0.52, R:0.97
 30%|███       | 30/100 [08:24<21:25, 18.37s/it]epoch [30/100], focal_loss:0.0064	, anomaly_loss:0.2189	fnorm_loss:0.0092, a_fnorm_loss:0.0505P:0.50, R:0.94
normal: 0.0309 0.2308  anomaly: 0.0373 0.5733	P:0.12, R:0.12
Pixel Auroc:0.937, Sample Auroc0.885, Pixel Aupro0.0
test_fnorm_loss: 0.0089 test_afnorm_loss: 0.0249
 31%|███       | 31/100 [08:35<18:54, 16.44s/it]epoch [31/100], focal_loss:0.0068	, anomaly_loss:0.2135	fnorm_loss:0.0091, a_fnorm_loss:0.0493P:0.47, R:0.94
 32%|███▏      | 32/100 [08:48<17:20, 15.31s/it]epoch [32/100], focal_loss:0.0077	, anomaly_loss:0.2239	fnorm_loss:0.0091, a_fnorm_loss:0.0487P:0.47, R:0.91
 33%|███▎      | 33/100 [09:01<16:14, 14.55s/it]epoch [33/100], focal_loss:0.0073	, anomaly_loss:0.2204	fnorm_loss:0.0089, a_fnorm_loss:0.0475P:0.44, R:0.93
 34%|███▍      | 34/100 [09:15<15:50, 14.39s/it]epoch [34/100], focal_loss:0.0076	, anomaly_loss:0.2289	fnorm_loss:0.0087, a_fnorm_loss:0.0495P:0.51, R:0.97
 35%|███▌      | 35/100 [09:42<19:44, 18.23s/it]epoch [35/100], focal_loss:0.0074	, anomaly_loss:0.2361	fnorm_loss:0.0087, a_fnorm_loss:0.0493P:0.49, R:0.97
normal: 0.0283 0.2188  anomaly: 0.0303 0.5367	P:0.10, R:0.10
Pixel Auroc:0.937, Sample Auroc0.911, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0233
 36%|███▌      | 36/100 [09:54<17:32, 16.45s/it]epoch [36/100], focal_loss:0.0060	, anomaly_loss:0.2279	fnorm_loss:0.0084, a_fnorm_loss:0.0502P:0.52, R:0.97
 37%|███▋      | 37/100 [10:07<15:58, 15.22s/it]epoch [37/100], focal_loss:0.0070	, anomaly_loss:0.2239	fnorm_loss:0.0084, a_fnorm_loss:0.0484P:0.47, R:0.96
 38%|███▊      | 38/100 [10:19<14:56, 14.47s/it]epoch [38/100], focal_loss:0.0064	, anomaly_loss:0.2247	fnorm_loss:0.0082, a_fnorm_loss:0.0497P:0.52, R:0.96
 39%|███▉      | 39/100 [10:32<14:11, 13.97s/it]epoch [39/100], focal_loss:0.0076	, anomaly_loss:0.2190	fnorm_loss:0.0084, a_fnorm_loss:0.0487P:0.47, R:0.97
 40%|████      | 40/100 [11:07<20:08, 20.15s/it]epoch [40/100], focal_loss:0.0059	, anomaly_loss:0.2165	fnorm_loss:0.0081, a_fnorm_loss:0.0495P:0.49, R:0.97
normal: 0.0269 0.2540  anomaly: 0.0303 0.6534	P:0.15, R:0.15
Pixel Auroc:0.942, Sample Auroc0.913, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0318
 41%|████      | 41/100 [11:20<17:44, 18.04s/it]epoch [41/100], focal_loss:0.0076	, anomaly_loss:0.2339	fnorm_loss:0.0081, a_fnorm_loss:0.0474P:0.50, R:0.94
 42%|████▏     | 42/100 [11:32<15:50, 16.38s/it]epoch [42/100], focal_loss:0.0069	, anomaly_loss:0.2247	fnorm_loss:0.0079, a_fnorm_loss:0.0486P:0.50, R:0.95
 43%|████▎     | 43/100 [11:45<14:21, 15.12s/it]epoch [43/100], focal_loss:0.0064	, anomaly_loss:0.2206	fnorm_loss:0.0078, a_fnorm_loss:0.0500P:0.48, R:0.97
 44%|████▍     | 44/100 [11:57<13:16, 14.22s/it]epoch [44/100], focal_loss:0.0065	, anomaly_loss:0.2158	fnorm_loss:0.0078, a_fnorm_loss:0.0509P:0.48, R:0.97
 45%|████▌     | 45/100 [12:29<18:01, 19.66s/it]epoch [45/100], focal_loss:0.0064	, anomaly_loss:0.2199	fnorm_loss:0.0078, a_fnorm_loss:0.0494P:0.50, R:0.97
normal: 0.0495 0.3611  anomaly: 0.0640 0.6332	P:0.16, R:0.17
Pixel Auroc:0.945, Sample Auroc0.835, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0316
 46%|████▌     | 46/100 [12:42<15:51, 17.63s/it]epoch [46/100], focal_loss:0.0067	, anomaly_loss:0.2131	fnorm_loss:0.0078, a_fnorm_loss:0.0481P:0.47, R:0.93
 47%|████▋     | 47/100 [12:54<14:09, 16.03s/it]epoch [47/100], focal_loss:0.0055	, anomaly_loss:0.2260	fnorm_loss:0.0076, a_fnorm_loss:0.0501P:0.52, R:0.98
 48%|████▊     | 48/100 [13:07<13:03, 15.07s/it]epoch [48/100], focal_loss:0.0059	, anomaly_loss:0.2102	fnorm_loss:0.0075, a_fnorm_loss:0.0512P:0.47, R:0.97
 49%|████▉     | 49/100 [13:20<12:11, 14.34s/it]epoch [49/100], focal_loss:0.0057	, anomaly_loss:0.2158	fnorm_loss:0.0075, a_fnorm_loss:0.0509P:0.54, R:0.97
 50%|█████     | 50/100 [13:47<15:16, 18.33s/it]epoch [50/100], focal_loss:0.0062	, anomaly_loss:0.2168	fnorm_loss:0.0075, a_fnorm_loss:0.0506P:0.49, R:0.93
normal: 0.0241 0.2390  anomaly: 0.0314 0.6667	P:0.14, R:0.15
Pixel Auroc:0.948, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0349
 51%|█████     | 51/100 [14:00<13:27, 16.48s/it]epoch [51/100], focal_loss:0.0054	, anomaly_loss:0.2167	fnorm_loss:0.0074, a_fnorm_loss:0.0516P:0.53, R:0.97
 52%|█████▏    | 52/100 [14:12<12:06, 15.14s/it]epoch [52/100], focal_loss:0.0060	, anomaly_loss:0.2180	fnorm_loss:0.0074, a_fnorm_loss:0.0510P:0.53, R:0.97
 53%|█████▎    | 53/100 [14:24<11:15, 14.36s/it]epoch [53/100], focal_loss:0.0056	, anomaly_loss:0.2150	fnorm_loss:0.0073, a_fnorm_loss:0.0502P:0.55, R:0.97
 54%|█████▍    | 54/100 [14:37<10:43, 13.99s/it]epoch [54/100], focal_loss:0.0061	, anomaly_loss:0.2213	fnorm_loss:0.0073, a_fnorm_loss:0.0509P:0.50, R:0.97
 55%|█████▌    | 55/100 [15:11<14:56, 19.92s/it]epoch [55/100], focal_loss:0.0052	, anomaly_loss:0.2104	fnorm_loss:0.0072, a_fnorm_loss:0.0509P:0.50, R:0.94
normal: 0.0242 0.2536  anomaly: 0.0334 0.6592	P:0.16, R:0.17
Pixel Auroc:0.947, Sample Auroc0.910, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0342
 56%|█████▌    | 56/100 [15:23<12:56, 17.64s/it]epoch [56/100], focal_loss:0.0071	, anomaly_loss:0.2300	fnorm_loss:0.0073, a_fnorm_loss:0.0480P:0.50, R:0.91
 57%|█████▋    | 57/100 [15:36<11:36, 16.21s/it]epoch [57/100], focal_loss:0.0052	, anomaly_loss:0.2114	fnorm_loss:0.0072, a_fnorm_loss:0.0510P:0.52, R:0.98
 58%|█████▊    | 58/100 [15:49<10:42, 15.29s/it]epoch [58/100], focal_loss:0.0064	, anomaly_loss:0.2196	fnorm_loss:0.0073, a_fnorm_loss:0.0495P:0.50, R:0.97
 59%|█████▉    | 59/100 [16:02<09:58, 14.61s/it]epoch [59/100], focal_loss:0.0069	, anomaly_loss:0.2336	fnorm_loss:0.0072, a_fnorm_loss:0.0508P:0.52, R:0.97
 60%|██████    | 60/100 [16:32<12:38, 18.97s/it]epoch [60/100], focal_loss:0.0056	, anomaly_loss:0.2168	fnorm_loss:0.0071, a_fnorm_loss:0.0510P:0.50, R:0.97
normal: 0.0243 0.2366  anomaly: 0.0527 0.6574	P:0.15, R:0.17
Pixel Auroc:0.938, Sample Auroc0.902, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0337
 61%|██████    | 61/100 [16:45<11:10, 17.18s/it]epoch [61/100], focal_loss:0.0060	, anomaly_loss:0.2296	fnorm_loss:0.0071, a_fnorm_loss:0.0496P:0.53, R:0.96
 62%|██████▏   | 62/100 [16:57<10:04, 15.91s/it]epoch [62/100], focal_loss:0.0063	, anomaly_loss:0.2149	fnorm_loss:0.0071, a_fnorm_loss:0.0505P:0.46, R:0.97
 63%|██████▎   | 63/100 [17:10<09:13, 14.95s/it]epoch [63/100], focal_loss:0.0063	, anomaly_loss:0.2199	fnorm_loss:0.0071, a_fnorm_loss:0.0510P:0.51, R:0.96
 64%|██████▍   | 64/100 [17:22<08:23, 13.98s/it]epoch [64/100], focal_loss:0.0056	, anomaly_loss:0.2134	fnorm_loss:0.0070, a_fnorm_loss:0.0520P:0.52, R:0.97
 65%|██████▌   | 65/100 [17:50<10:34, 18.12s/it]epoch [65/100], focal_loss:0.0054	, anomaly_loss:0.2100	fnorm_loss:0.0070, a_fnorm_loss:0.0518P:0.53, R:0.93
normal: 0.0412 0.2675  anomaly: 0.0687 0.6609	P:0.15, R:0.18
Pixel Auroc:0.940, Sample Auroc0.900, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0325
 66%|██████▌   | 66/100 [18:02<09:16, 16.38s/it]epoch [66/100], focal_loss:0.0087	, anomaly_loss:0.2546	fnorm_loss:0.0073, a_fnorm_loss:0.0472P:0.46, R:0.88
 67%|██████▋   | 67/100 [18:15<08:22, 15.22s/it]epoch [67/100], focal_loss:0.0069	, anomaly_loss:0.2244	fnorm_loss:0.0071, a_fnorm_loss:0.0491P:0.51, R:0.96
 68%|██████▊   | 68/100 [18:28<07:47, 14.62s/it]epoch [68/100], focal_loss:0.0051	, anomaly_loss:0.2006	fnorm_loss:0.0069, a_fnorm_loss:0.0513P:0.47, R:0.98
 69%|██████▉   | 69/100 [18:40<07:10, 13.90s/it]epoch [69/100], focal_loss:0.0060	, anomaly_loss:0.2201	fnorm_loss:0.0070, a_fnorm_loss:0.0507P:0.50, R:0.97
 70%|███████   | 70/100 [19:10<09:21, 18.71s/it]epoch [70/100], focal_loss:0.0071	, anomaly_loss:0.2216	fnorm_loss:0.0071, a_fnorm_loss:0.0486P:0.51, R:0.92
normal: 0.0276 0.2335  anomaly: 0.0324 0.6395	P:0.15, R:0.15
Pixel Auroc:0.948, Sample Auroc0.853, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0301
 71%|███████   | 71/100 [19:22<08:08, 16.83s/it]epoch [71/100], focal_loss:0.0055	, anomaly_loss:0.2103	fnorm_loss:0.0069, a_fnorm_loss:0.0515P:0.49, R:0.93
 72%|███████▏  | 72/100 [19:35<07:13, 15.50s/it]epoch [72/100], focal_loss:0.0059	, anomaly_loss:0.2080	fnorm_loss:0.0070, a_fnorm_loss:0.0502P:0.51, R:0.93
 73%|███████▎  | 73/100 [19:48<06:36, 14.68s/it]epoch [73/100], focal_loss:0.0052	, anomaly_loss:0.2209	fnorm_loss:0.0068, a_fnorm_loss:0.0522P:0.54, R:0.97
 74%|███████▍  | 74/100 [20:00<06:07, 14.12s/it]epoch [74/100], focal_loss:0.0052	, anomaly_loss:0.2018	fnorm_loss:0.0069, a_fnorm_loss:0.0519P:0.52, R:0.94
 75%|███████▌  | 75/100 [20:33<08:08, 19.56s/it]epoch [75/100], focal_loss:0.0064	, anomaly_loss:0.2164	fnorm_loss:0.0069, a_fnorm_loss:0.0498P:0.49, R:0.93
normal: 0.0253 0.3263  anomaly: 0.0337 0.6251	P:0.16, R:0.17
Pixel Auroc:0.945, Sample Auroc0.835, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0281
 76%|███████▌  | 76/100 [20:45<07:00, 17.54s/it]epoch [76/100], focal_loss:0.0051	, anomaly_loss:0.2184	fnorm_loss:0.0068, a_fnorm_loss:0.0512P:0.53, R:0.97
 77%|███████▋  | 77/100 [20:57<06:03, 15.82s/it]epoch [77/100], focal_loss:0.0053	, anomaly_loss:0.2050	fnorm_loss:0.0068, a_fnorm_loss:0.0508P:0.53, R:0.97
 78%|███████▊  | 78/100 [21:10<05:25, 14.80s/it]epoch [78/100], focal_loss:0.0062	, anomaly_loss:0.2153	fnorm_loss:0.0069, a_fnorm_loss:0.0504P:0.52, R:0.97
 79%|███████▉  | 79/100 [21:23<04:59, 14.25s/it]epoch [79/100], focal_loss:0.0061	, anomaly_loss:0.2205	fnorm_loss:0.0068, a_fnorm_loss:0.0504P:0.52, R:0.96
 80%|████████  | 80/100 [21:49<05:59, 18.00s/it]epoch [80/100], focal_loss:0.0074	, anomaly_loss:0.2258	fnorm_loss:0.0069, a_fnorm_loss:0.0508P:0.48, R:0.92
normal: 0.0305 0.3173  anomaly: 0.0332 0.6579	P:0.15, R:0.16
Pixel Auroc:0.952, Sample Auroc0.866, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0332
 81%|████████  | 81/100 [22:02<05:13, 16.52s/it]epoch [81/100], focal_loss:0.0052	, anomaly_loss:0.2158	fnorm_loss:0.0068, a_fnorm_loss:0.0517P:0.53, R:0.93
 82%|████████▏ | 82/100 [22:16<04:40, 15.56s/it]epoch [82/100], focal_loss:0.0056	, anomaly_loss:0.2169	fnorm_loss:0.0068, a_fnorm_loss:0.0508P:0.53, R:0.96
 83%|████████▎ | 83/100 [22:29<04:11, 14.78s/it]epoch [83/100], focal_loss:0.0049	, anomaly_loss:0.2112	fnorm_loss:0.0068, a_fnorm_loss:0.0514P:0.54, R:0.98
 84%|████████▍ | 84/100 [22:41<03:43, 14.00s/it]epoch [84/100], focal_loss:0.0049	, anomaly_loss:0.2194	fnorm_loss:0.0068, a_fnorm_loss:0.0517P:0.51, R:0.96
 85%|████████▌ | 85/100 [23:08<04:28, 17.91s/it]epoch [85/100], focal_loss:0.0048	, anomaly_loss:0.2077	fnorm_loss:0.0068, a_fnorm_loss:0.0523P:0.54, R:0.98
normal: 0.0277 0.3218  anomaly: 0.0549 0.6720	P:0.15, R:0.18
Pixel Auroc:0.947, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0358
 86%|████████▌ | 86/100 [23:21<03:49, 16.39s/it]epoch [86/100], focal_loss:0.0050	, anomaly_loss:0.2100	fnorm_loss:0.0068, a_fnorm_loss:0.0516P:0.56, R:0.98
 87%|████████▋ | 87/100 [23:34<03:19, 15.33s/it]epoch [87/100], focal_loss:0.0054	, anomaly_loss:0.2226	fnorm_loss:0.0068, a_fnorm_loss:0.0517P:0.54, R:0.97
 88%|████████▊ | 88/100 [23:46<02:53, 14.46s/it]epoch [88/100], focal_loss:0.0055	, anomaly_loss:0.2185	fnorm_loss:0.0067, a_fnorm_loss:0.0524P:0.53, R:0.94
 89%|████████▉ | 89/100 [23:58<02:32, 13.85s/it]epoch [89/100], focal_loss:0.0053	, anomaly_loss:0.2076	fnorm_loss:0.0068, a_fnorm_loss:0.0522P:0.53, R:0.93
 90%|█████████ | 90/100 [24:30<03:10, 19.08s/it]epoch [90/100], focal_loss:0.0049	, anomaly_loss:0.2126	fnorm_loss:0.0068, a_fnorm_loss:0.0517P:0.54, R:0.94
normal: 0.0246 0.2819  anomaly: 0.0387 0.6654	P:0.16, R:0.17
Pixel Auroc:0.951, Sample Auroc0.878, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0343
 91%|█████████ | 91/100 [24:43<02:36, 17.43s/it]epoch [91/100], focal_loss:0.0047	, anomaly_loss:0.2076	fnorm_loss:0.0067, a_fnorm_loss:0.0523P:0.56, R:0.94
 92%|█████████▏| 92/100 [24:55<02:06, 15.79s/it]epoch [92/100], focal_loss:0.0054	, anomaly_loss:0.2135	fnorm_loss:0.0068, a_fnorm_loss:0.0515P:0.55, R:0.97
 93%|█████████▎| 93/100 [25:08<01:43, 14.82s/it]epoch [93/100], focal_loss:0.0054	, anomaly_loss:0.2120	fnorm_loss:0.0068, a_fnorm_loss:0.0514P:0.53, R:0.97
 94%|█████████▍| 94/100 [25:20<01:24, 14.16s/it]epoch [94/100], focal_loss:0.0055	, anomaly_loss:0.2193	fnorm_loss:0.0068, a_fnorm_loss:0.0514P:0.52, R:0.97
 95%|█████████▌| 95/100 [25:48<01:30, 18.19s/it]epoch [95/100], focal_loss:0.0046	, anomaly_loss:0.2038	fnorm_loss:0.0067, a_fnorm_loss:0.0527P:0.52, R:0.95
normal: 0.0282 0.2993  anomaly: 0.0461 0.6784	P:0.16, R:0.18
Pixel Auroc:0.950, Sample Auroc0.875, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0363
 96%|█████████▌| 96/100 [26:01<01:06, 16.68s/it]epoch [96/100], focal_loss:0.0046	, anomaly_loss:0.2004	fnorm_loss:0.0067, a_fnorm_loss:0.0533P:0.55, R:0.98
 97%|█████████▋| 97/100 [26:13<00:46, 15.35s/it]epoch [97/100], focal_loss:0.0051	, anomaly_loss:0.2076	fnorm_loss:0.0068, a_fnorm_loss:0.0516P:0.54, R:0.94
 98%|█████████▊| 98/100 [26:25<00:28, 14.32s/it]epoch [98/100], focal_loss:0.0047	, anomaly_loss:0.2145	fnorm_loss:0.0067, a_fnorm_loss:0.0519P:0.55, R:0.97
 99%|█████████▉| 99/100 [26:38<00:13, 13.78s/it]epoch [99/100], focal_loss:0.0050	, anomaly_loss:0.2116	fnorm_loss:0.0068, a_fnorm_loss:0.0522P:0.55, R:0.98
100%|██████████| 100/100 [27:05<00:00, 17.72s/it]100%|██████████| 100/100 [27:05<00:00, 16.25s/it]
epoch [100/100], focal_loss:0.0053	, anomaly_loss:0.2114	fnorm_loss:0.0068, a_fnorm_loss:0.0522P:0.56, R:0.97
normal: 0.0306 0.2926  anomaly: 0.0550 0.6760	P:0.16, R:0.18
Pixel Auroc:0.950, Sample Auroc0.879, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0363
training Stubborn Student...
pipe_fryum
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:08<16:50,  8.49s/it]epoch [1/120], kd_loss:4.2218
  2%|▏         | 2/120 [00:17<16:44,  8.51s/it]epoch [2/120], kd_loss:3.3711
  2%|▎         | 3/120 [00:25<16:33,  8.49s/it]epoch [3/120], kd_loss:2.7253
  3%|▎         | 4/120 [00:34<16:28,  8.52s/it]epoch [4/120], kd_loss:2.3564
  4%|▍         | 5/120 [00:42<16:24,  8.56s/it]epoch [5/120], kd_loss:2.3860
  5%|▌         | 6/120 [00:51<16:18,  8.58s/it]epoch [6/120], kd_loss:1.9619
  6%|▌         | 7/120 [00:59<16:12,  8.60s/it]epoch [7/120], kd_loss:1.8713
  7%|▋         | 8/120 [01:08<16:03,  8.60s/it]epoch [8/120], kd_loss:1.6557
  8%|▊         | 9/120 [01:17<15:56,  8.62s/it]epoch [9/120], kd_loss:1.6163
  8%|▊         | 10/120 [01:40<24:18, 13.26s/it]epoch [10/120], kd_loss:1.5900
normal: 0.9240 1.4853  anomaly: 1.1656 2.5623
thresh: 1.3669496545427975
fpr: 0.06 fnr 0.02
Pixel Auroc:0.986, Sample Auroc0.993, Pixel Aupro0.0
  9%|▉         | 11/120 [01:49<21:30, 11.84s/it]epoch [11/120], kd_loss:1.9208
 10%|█         | 12/120 [01:58<19:30, 10.84s/it]epoch [12/120], kd_loss:1.6054
 11%|█         | 13/120 [02:06<18:07, 10.16s/it]epoch [13/120], kd_loss:1.5692
 12%|█▏        | 14/120 [02:15<17:06,  9.69s/it]epoch [14/120], kd_loss:1.5421
 12%|█▎        | 15/120 [02:23<16:22,  9.36s/it]epoch [15/120], kd_loss:1.4264
 13%|█▎        | 16/120 [02:32<15:49,  9.13s/it]epoch [16/120], kd_loss:1.4158
 14%|█▍        | 17/120 [02:41<15:24,  8.98s/it]epoch [17/120], kd_loss:1.3256
 15%|█▌        | 18/120 [02:49<15:03,  8.86s/it]epoch [18/120], kd_loss:1.3253
 16%|█▌        | 19/120 [02:58<14:47,  8.79s/it]epoch [19/120], kd_loss:1.2799
 17%|█▋        | 20/120 [03:20<21:36, 12.97s/it]epoch [20/120], kd_loss:1.2485
normal: 0.9540 1.3763  anomaly: 1.0278 2.5497
thresh: 1.3081759270200812
fpr: 0.04 fnr 0.01
Pixel Auroc:0.985, Sample Auroc0.993, Pixel Aupro0.0
 18%|█▊        | 21/120 [03:29<19:13, 11.65s/it]epoch [21/120], kd_loss:1.3026
 18%|█▊        | 22/120 [03:38<17:32, 10.74s/it]epoch [22/120], kd_loss:1.2364
 19%|█▉        | 23/120 [03:46<16:17, 10.08s/it]epoch [23/120], kd_loss:1.2976
 20%|██        | 24/120 [03:55<15:22,  9.61s/it]epoch [24/120], kd_loss:1.2346
 21%|██        | 25/120 [04:03<14:43,  9.30s/it]epoch [25/120], kd_loss:1.5077
 22%|██▏       | 26/120 [04:12<14:17,  9.12s/it]epoch [26/120], kd_loss:1.3303
 22%|██▎       | 27/120 [04:21<13:54,  8.98s/it]epoch [27/120], kd_loss:1.2219
 23%|██▎       | 28/120 [04:29<13:37,  8.88s/it]epoch [28/120], kd_loss:1.2082
 24%|██▍       | 29/120 [04:38<13:21,  8.81s/it]epoch [29/120], kd_loss:1.2251
 25%|██▌       | 30/120 [05:00<19:19, 12.89s/it]epoch [30/120], kd_loss:1.1956
normal: 0.8158 1.2921  anomaly: 0.9107 2.5983
thresh: 1.1702228854515229
fpr: 0.08 fnr 0.01
Pixel Auroc:0.987, Sample Auroc0.991, Pixel Aupro0.0
 26%|██▌       | 31/120 [05:09<17:10, 11.58s/it]epoch [31/120], kd_loss:1.1842
 27%|██▋       | 32/120 [05:17<15:39, 10.67s/it]epoch [32/120], kd_loss:1.1968
 28%|██▊       | 33/120 [05:26<14:35, 10.06s/it]epoch [33/120], kd_loss:1.1734
 28%|██▊       | 34/120 [05:35<13:47,  9.62s/it]epoch [34/120], kd_loss:1.1656
 29%|██▉       | 35/120 [05:43<13:13,  9.34s/it]epoch [35/120], kd_loss:1.4211
 30%|███       | 36/120 [05:52<12:46,  9.13s/it]epoch [36/120], kd_loss:1.2557
 31%|███       | 37/120 [06:01<12:27,  9.01s/it]epoch [37/120], kd_loss:1.1826
 32%|███▏      | 38/120 [06:09<12:09,  8.90s/it]epoch [38/120], kd_loss:1.2214
 32%|███▎      | 39/120 [06:18<11:53,  8.80s/it]epoch [39/120], kd_loss:1.2146
 33%|███▎      | 40/120 [06:41<17:18, 12.98s/it]epoch [40/120], kd_loss:1.1762
normal: 0.7334 1.2745  anomaly: 0.9268 2.5536
thresh: 1.2265875662062973
fpr: 0.04 fnr 0.03
Pixel Auroc:0.987, Sample Auroc0.993, Pixel Aupro0.0
 34%|███▍      | 41/120 [06:49<15:21, 11.67s/it]epoch [41/120], kd_loss:1.1422
 35%|███▌      | 42/120 [06:58<13:57, 10.74s/it]epoch [42/120], kd_loss:1.1329
 36%|███▌      | 43/120 [07:06<12:57, 10.10s/it]epoch [43/120], kd_loss:1.1236
 37%|███▋      | 44/120 [07:15<12:15,  9.68s/it]epoch [44/120], kd_loss:1.1177
 38%|███▊      | 45/120 [07:24<11:43,  9.38s/it]epoch [45/120], kd_loss:1.1252
 38%|███▊      | 46/120 [07:33<11:19,  9.18s/it]epoch [46/120], kd_loss:1.2058
 39%|███▉      | 47/120 [07:41<11:01,  9.07s/it]epoch [47/120], kd_loss:1.3294
 40%|████      | 48/120 [07:50<10:45,  8.96s/it]epoch [48/120], kd_loss:1.2860
 41%|████      | 49/120 [07:59<10:30,  8.88s/it]epoch [49/120], kd_loss:1.1654
 42%|████▏     | 50/120 [08:21<15:04, 12.93s/it]epoch [50/120], kd_loss:1.1664
normal: 0.7668 1.4451  anomaly: 0.9427 2.5537
thresh: 1.1695362602528077
fpr: 0.06 fnr 0.01
Pixel Auroc:0.987, Sample Auroc0.989, Pixel Aupro0.0
 42%|████▎     | 51/120 [08:30<13:22, 11.63s/it]epoch [51/120], kd_loss:1.1318
 43%|████▎     | 52/120 [08:38<12:08, 10.72s/it]epoch [52/120], kd_loss:1.1270
 44%|████▍     | 53/120 [08:47<11:17, 10.11s/it]epoch [53/120], kd_loss:1.1112
 45%|████▌     | 54/120 [08:56<10:38,  9.67s/it]epoch [54/120], kd_loss:1.1089
 46%|████▌     | 55/120 [09:04<10:08,  9.37s/it]epoch [55/120], kd_loss:1.0839
 47%|████▋     | 56/120 [09:13<09:44,  9.13s/it]epoch [56/120], kd_loss:1.2581
 48%|████▊     | 57/120 [09:22<09:27,  9.00s/it]epoch [57/120], kd_loss:1.2386
 48%|████▊     | 58/120 [09:30<09:11,  8.90s/it]epoch [58/120], kd_loss:1.1867
 49%|████▉     | 59/120 [09:39<08:58,  8.83s/it]epoch [59/120], kd_loss:1.4241
 50%|█████     | 60/120 [10:04<13:41, 13.68s/it]epoch [60/120], kd_loss:1.2398
normal: 0.8086 1.3235  anomaly: 0.9527 2.6025
thresh: 1.2930709504764049
fpr: 0.02 fnr 0.02
Pixel Auroc:0.987, Sample Auroc0.994, Pixel Aupro0.0
 51%|█████     | 61/120 [10:13<11:59, 12.19s/it]epoch [61/120], kd_loss:1.1724
 52%|█████▏    | 62/120 [10:21<10:44, 11.11s/it]epoch [62/120], kd_loss:1.2068
 52%|█████▎    | 63/120 [10:30<09:52, 10.39s/it]epoch [63/120], kd_loss:1.1793
 53%|█████▎    | 64/120 [10:39<09:13,  9.88s/it]epoch [64/120], kd_loss:1.1401
 54%|█████▍    | 65/120 [10:47<08:45,  9.56s/it]epoch [65/120], kd_loss:1.1890
 55%|█████▌    | 66/120 [10:56<08:22,  9.30s/it]epoch [66/120], kd_loss:1.1245
 56%|█████▌    | 67/120 [11:05<08:04,  9.14s/it]epoch [67/120], kd_loss:1.1086
 57%|█████▋    | 68/120 [11:14<07:48,  9.01s/it]epoch [68/120], kd_loss:1.2546
 57%|█████▊    | 69/120 [11:22<07:34,  8.92s/it]epoch [69/120], kd_loss:1.2231
 58%|█████▊    | 70/120 [11:46<11:07, 13.34s/it]epoch [70/120], kd_loss:1.2079
normal: 0.7002 1.2201  anomaly: 0.9662 2.5529
thresh: 1.1691937811068118
fpr: 0.04 fnr 0.02
Pixel Auroc:0.988, Sample Auroc0.995, Pixel Aupro0.0
 59%|█████▉    | 71/120 [11:55<09:43, 11.91s/it]epoch [71/120], kd_loss:1.1342
 60%|██████    | 72/120 [12:03<08:43, 10.92s/it]epoch [72/120], kd_loss:1.1296
 61%|██████    | 73/120 [12:12<08:01, 10.24s/it]epoch [73/120], kd_loss:1.1371
 62%|██████▏   | 74/120 [12:20<07:28,  9.76s/it]epoch [74/120], kd_loss:1.2746
 62%|██████▎   | 75/120 [12:29<07:04,  9.44s/it]epoch [75/120], kd_loss:1.1475
 63%|██████▎   | 76/120 [12:38<06:44,  9.18s/it]epoch [76/120], kd_loss:1.1360
 64%|██████▍   | 77/120 [12:46<06:27,  9.01s/it]epoch [77/120], kd_loss:1.1179
 65%|██████▌   | 78/120 [12:55<06:13,  8.88s/it]epoch [78/120], kd_loss:1.1060
 66%|██████▌   | 79/120 [13:04<06:01,  8.82s/it]epoch [79/120], kd_loss:1.1208
 67%|██████▋   | 80/120 [13:28<09:02, 13.56s/it]epoch [80/120], kd_loss:1.0977
normal: 0.7256 1.1945  anomaly: 0.9954 2.5367
thresh: 1.1461424928098087
fpr: 0.04 fnr 0.02
Pixel Auroc:0.987, Sample Auroc0.996, Pixel Aupro0.0
 68%|██████▊   | 81/120 [13:37<07:51, 12.09s/it]epoch [81/120], kd_loss:1.0859
 68%|██████▊   | 82/120 [13:45<06:58, 11.02s/it]epoch [82/120], kd_loss:1.0940
 69%|██████▉   | 83/120 [13:54<06:21, 10.31s/it]epoch [83/120], kd_loss:1.2767
 70%|███████   | 84/120 [14:03<05:53,  9.81s/it]epoch [84/120], kd_loss:1.1824
 71%|███████   | 85/120 [14:11<05:30,  9.45s/it]epoch [85/120], kd_loss:1.0999
 72%|███████▏  | 86/120 [14:20<05:12,  9.20s/it]epoch [86/120], kd_loss:1.0815
 72%|███████▎  | 87/120 [14:29<04:58,  9.04s/it]epoch [87/120], kd_loss:1.0921
 73%|███████▎  | 88/120 [14:37<04:45,  8.91s/it]epoch [88/120], kd_loss:1.0700
 74%|███████▍  | 89/120 [14:46<04:33,  8.83s/it]epoch [89/120], kd_loss:1.0522
 75%|███████▌  | 90/120 [15:09<06:32, 13.07s/it]epoch [90/120], kd_loss:1.1066
normal: 0.6734 1.1955  anomaly: 0.9101 2.5455
thresh: 1.1254171472544223
fpr: 0.04 fnr 0.01
Pixel Auroc:0.987, Sample Auroc0.996, Pixel Aupro0.0
 76%|███████▌  | 91/120 [15:17<05:39, 11.72s/it]epoch [91/120], kd_loss:1.0619
 77%|███████▋  | 92/120 [15:26<05:02, 10.79s/it]epoch [92/120], kd_loss:1.0645
 78%|███████▊  | 93/120 [15:35<04:33, 10.13s/it]epoch [93/120], kd_loss:1.2010
 78%|███████▊  | 94/120 [15:43<04:11,  9.68s/it]epoch [94/120], kd_loss:1.0662
 79%|███████▉  | 95/120 [15:52<03:53,  9.35s/it]epoch [95/120], kd_loss:1.0546
 80%|████████  | 96/120 [16:00<03:39,  9.14s/it]epoch [96/120], kd_loss:1.0432
 81%|████████  | 97/120 [16:09<03:27,  9.01s/it]epoch [97/120], kd_loss:1.0345
 82%|████████▏ | 98/120 [16:18<03:15,  8.88s/it]epoch [98/120], kd_loss:1.0278
 82%|████████▎ | 99/120 [16:26<03:05,  8.82s/it]epoch [99/120], kd_loss:1.0242
 83%|████████▎ | 100/120 [16:52<04:35, 13.77s/it]epoch [100/120], kd_loss:1.0219
normal: 0.6638 1.0281  anomaly: 0.8994 2.4890
thresh: 1.0778382854123996
fpr: 0.0 fnr 0.02
Pixel Auroc:0.988, Sample Auroc0.997, Pixel Aupro0.0
 84%|████████▍ | 101/120 [17:00<03:53, 12.27s/it]epoch [101/120], kd_loss:1.0183
 85%|████████▌ | 102/120 [17:09<03:20, 11.16s/it]epoch [102/120], kd_loss:1.0152
 86%|████████▌ | 103/120 [17:18<02:56, 10.38s/it]epoch [103/120], kd_loss:1.0173
 87%|████████▋ | 104/120 [17:26<02:37,  9.85s/it]epoch [104/120], kd_loss:1.0121
 88%|████████▊ | 105/120 [17:35<02:21,  9.46s/it]epoch [105/120], kd_loss:1.0144
 88%|████████▊ | 106/120 [17:43<02:09,  9.23s/it]epoch [106/120], kd_loss:1.0110
 89%|████████▉ | 107/120 [17:52<01:57,  9.06s/it]epoch [107/120], kd_loss:1.0111
 90%|█████████ | 108/120 [18:01<01:47,  8.95s/it]epoch [108/120], kd_loss:1.0102
 91%|█████████ | 109/120 [18:09<01:37,  8.84s/it]epoch [109/120], kd_loss:1.0064
 92%|█████████▏| 110/120 [18:33<02:12, 13.28s/it]epoch [110/120], kd_loss:1.0063
normal: 0.6433 1.0432  anomaly: 0.8692 2.4730
thresh: 1.0865785213527346
fpr: 0.0 fnr 0.02
Pixel Auroc:0.988, Sample Auroc0.997, Pixel Aupro0.0
 92%|█████████▎| 111/120 [18:42<01:46, 11.86s/it]epoch [111/120], kd_loss:1.0054
 93%|█████████▎| 112/120 [18:50<01:27, 10.91s/it]epoch [112/120], kd_loss:1.0033
 94%|█████████▍| 113/120 [18:59<01:11, 10.22s/it]epoch [113/120], kd_loss:1.0050
 95%|█████████▌| 114/120 [19:07<00:58,  9.72s/it]epoch [114/120], kd_loss:1.0073
 96%|█████████▌| 115/120 [19:16<00:46,  9.39s/it]epoch [115/120], kd_loss:1.0028
 97%|█████████▋| 116/120 [19:25<00:36,  9.17s/it]epoch [116/120], kd_loss:1.0035
 98%|█████████▊| 117/120 [19:33<00:27,  9.00s/it]epoch [117/120], kd_loss:1.0013
 98%|█████████▊| 118/120 [19:42<00:17,  8.89s/it]epoch [118/120], kd_loss:1.0023
 99%|█████████▉| 119/120 [19:51<00:08,  8.81s/it]epoch [119/120], kd_loss:1.0037
100%|██████████| 120/120 [20:15<00:00, 13.39s/it]100%|██████████| 120/120 [20:15<00:00, 10.13s/it]
epoch [120/120], kd_loss:1.0014
normal: 0.6445 1.0079  anomaly: 0.8663 2.4777
thresh: 1.0837103968291524
fpr: 0.0 fnr 0.02
Pixel Auroc:0.988, Sample Auroc0.997, Pixel Aupro0.0
