training Advanced Teacher...
carpet
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:29<48:08, 29.17s/it]epoch [1/100], focal_loss:0.0913	, anomaly_loss:0.5812	fnorm_loss:0.0694, a_fnorm_loss:0.0162P:0.00, R:0.00
normal: 0.2598 0.2694  anomaly: 0.2566 0.2684	P:0.00, R:0.00
Pixel Auroc:0.105, Sample Auroc0.290, Pixel Aupro0.0
test_fnorm_loss: 0.0664 test_afnorm_loss: 0.0164
  2%|▏         | 2/100 [00:38<28:49, 17.65s/it]epoch [2/100], focal_loss:0.0859	, anomaly_loss:0.5811	fnorm_loss:0.0643, a_fnorm_loss:0.0142P:0.00, R:0.00
  3%|▎         | 3/100 [00:49<23:09, 14.32s/it]epoch [3/100], focal_loss:0.0809	, anomaly_loss:0.5937	fnorm_loss:0.0592, a_fnorm_loss:0.0139P:0.00, R:0.00
  4%|▍         | 4/100 [00:58<20:03, 12.53s/it]epoch [4/100], focal_loss:0.0803	, anomaly_loss:0.5992	fnorm_loss:0.0567, a_fnorm_loss:0.0140P:0.00, R:0.00
  5%|▌         | 5/100 [01:25<27:53, 17.62s/it]epoch [5/100], focal_loss:0.0817	, anomaly_loss:0.6041	fnorm_loss:0.0560, a_fnorm_loss:0.0125P:0.00, R:0.00
normal: 0.2134 0.2187  anomaly: 0.2111 0.2193	P:0.00, R:0.00
Pixel Auroc:0.132, Sample Auroc0.277, Pixel Aupro0.0
test_fnorm_loss: 0.0545 test_afnorm_loss: 0.0138
  6%|▌         | 6/100 [01:35<23:23, 14.93s/it]epoch [6/100], focal_loss:0.0747	, anomaly_loss:0.6042	fnorm_loss:0.0538, a_fnorm_loss:0.0123P:0.00, R:0.00
  7%|▋         | 7/100 [01:44<20:30, 13.23s/it]epoch [7/100], focal_loss:0.0744	, anomaly_loss:0.5339	fnorm_loss:0.0523, a_fnorm_loss:0.0247P:0.10, R:0.25
  8%|▊         | 8/100 [01:54<18:42, 12.20s/it]epoch [8/100], focal_loss:0.0675	, anomaly_loss:0.5121	fnorm_loss:0.0457, a_fnorm_loss:0.0278P:0.13, R:0.29
  9%|▉         | 9/100 [02:05<17:31, 11.56s/it]epoch [9/100], focal_loss:0.0663	, anomaly_loss:0.5096	fnorm_loss:0.0423, a_fnorm_loss:0.0295P:0.14, R:0.30
 10%|█         | 10/100 [02:38<27:14, 18.16s/it]epoch [10/100], focal_loss:0.0660	, anomaly_loss:0.4955	fnorm_loss:0.0396, a_fnorm_loss:0.0304P:0.15, R:0.35
normal: 0.1639 0.2677  anomaly: 0.1948 0.3037	P:0.15, R:0.19
Pixel Auroc:0.988, Sample Auroc0.964, Pixel Aupro0.0
test_fnorm_loss: 0.0350 test_afnorm_loss: 0.0278
 11%|█         | 11/100 [02:48<23:24, 15.78s/it]epoch [11/100], focal_loss:0.0570	, anomaly_loss:0.4830	fnorm_loss:0.0353, a_fnorm_loss:0.0329P:0.24, R:0.49
 12%|█▏        | 12/100 [02:59<20:49, 14.20s/it]epoch [12/100], focal_loss:0.0538	, anomaly_loss:0.4685	fnorm_loss:0.0310, a_fnorm_loss:0.0333P:0.30, R:0.60
 13%|█▎        | 13/100 [03:09<18:51, 13.01s/it]epoch [13/100], focal_loss:0.0465	, anomaly_loss:0.4688	fnorm_loss:0.0277, a_fnorm_loss:0.0334P:0.29, R:0.57
 14%|█▍        | 14/100 [03:19<17:27, 12.19s/it]epoch [14/100], focal_loss:0.0440	, anomaly_loss:0.4625	fnorm_loss:0.0252, a_fnorm_loss:0.0349P:0.29, R:0.59
 15%|█▌        | 15/100 [03:52<25:57, 18.32s/it]epoch [15/100], focal_loss:0.0468	, anomaly_loss:0.4494	fnorm_loss:0.0236, a_fnorm_loss:0.0364P:0.37, R:0.63
normal: 0.1237 0.3500  anomaly: 0.2641 0.4540	P:0.29, R:0.41
Pixel Auroc:0.994, Sample Auroc0.974, Pixel Aupro0.0
test_fnorm_loss: 0.0211 test_afnorm_loss: 0.0384
 16%|█▌        | 16/100 [04:02<22:18, 15.93s/it]epoch [16/100], focal_loss:0.0440	, anomaly_loss:0.4595	fnorm_loss:0.0219, a_fnorm_loss:0.0358P:0.34, R:0.60
 17%|█▋        | 17/100 [04:13<19:54, 14.39s/it]epoch [17/100], focal_loss:0.0439	, anomaly_loss:0.4522	fnorm_loss:0.0208, a_fnorm_loss:0.0365P:0.36, R:0.60
 18%|█▊        | 18/100 [04:23<18:06, 13.25s/it]epoch [18/100], focal_loss:0.0427	, anomaly_loss:0.4572	fnorm_loss:0.0196, a_fnorm_loss:0.0359P:0.36, R:0.59
 19%|█▉        | 19/100 [04:34<16:46, 12.42s/it]epoch [19/100], focal_loss:0.0439	, anomaly_loss:0.4528	fnorm_loss:0.0193, a_fnorm_loss:0.0358P:0.36, R:0.59
 20%|██        | 20/100 [05:03<23:24, 17.56s/it]epoch [20/100], focal_loss:0.0419	, anomaly_loss:0.4516	fnorm_loss:0.0182, a_fnorm_loss:0.0369P:0.38, R:0.63
normal: 0.1382 0.3846  anomaly: 0.2930 0.5131	P:0.24, R:0.43
Pixel Auroc:0.994, Sample Auroc0.965, Pixel Aupro0.0
test_fnorm_loss: 0.0168 test_afnorm_loss: 0.0426
 21%|██        | 21/100 [05:14<20:19, 15.44s/it]epoch [21/100], focal_loss:0.0430	, anomaly_loss:0.4496	fnorm_loss:0.0176, a_fnorm_loss:0.0386P:0.39, R:0.61
 22%|██▏       | 22/100 [05:25<18:11, 14.00s/it]epoch [22/100], focal_loss:0.0410	, anomaly_loss:0.4493	fnorm_loss:0.0170, a_fnorm_loss:0.0373P:0.37, R:0.61
 23%|██▎       | 23/100 [05:34<16:23, 12.77s/it]epoch [23/100], focal_loss:0.0419	, anomaly_loss:0.4462	fnorm_loss:0.0162, a_fnorm_loss:0.0383P:0.38, R:0.62
 24%|██▍       | 24/100 [05:45<15:08, 11.96s/it]epoch [24/100], focal_loss:0.0401	, anomaly_loss:0.4429	fnorm_loss:0.0157, a_fnorm_loss:0.0375P:0.36, R:0.61
 25%|██▌       | 25/100 [06:18<23:04, 18.46s/it]epoch [25/100], focal_loss:0.0365	, anomaly_loss:0.4406	fnorm_loss:0.0151, a_fnorm_loss:0.0390P:0.40, R:0.61
normal: 0.1660 0.3391  anomaly: 0.2457 0.5386	P:0.40, R:0.44
Pixel Auroc:0.995, Sample Auroc0.976, Pixel Aupro0.0
test_fnorm_loss: 0.0140 test_afnorm_loss: 0.0367
 26%|██▌       | 26/100 [06:29<19:47, 16.04s/it]epoch [26/100], focal_loss:0.0387	, anomaly_loss:0.4376	fnorm_loss:0.0155, a_fnorm_loss:0.0368P:0.50, R:0.77
 27%|██▋       | 27/100 [06:39<17:25, 14.32s/it]epoch [27/100], focal_loss:0.0390	, anomaly_loss:0.4620	fnorm_loss:0.0145, a_fnorm_loss:0.0372P:0.35, R:0.60
 28%|██▊       | 28/100 [06:49<15:45, 13.13s/it]epoch [28/100], focal_loss:0.0399	, anomaly_loss:0.4505	fnorm_loss:0.0143, a_fnorm_loss:0.0389P:0.39, R:0.62
 29%|██▉       | 29/100 [07:00<14:31, 12.28s/it]epoch [29/100], focal_loss:0.0421	, anomaly_loss:0.4490	fnorm_loss:0.0142, a_fnorm_loss:0.0395P:0.36, R:0.61
 30%|███       | 30/100 [07:28<20:05, 17.22s/it]epoch [30/100], focal_loss:0.0375	, anomaly_loss:0.4466	fnorm_loss:0.0136, a_fnorm_loss:0.0382P:0.37, R:0.61
normal: 0.1398 0.3682  anomaly: 0.2530 0.5681	P:0.27, R:0.43
Pixel Auroc:0.995, Sample Auroc0.974, Pixel Aupro0.0
test_fnorm_loss: 0.0126 test_afnorm_loss: 0.0443
 31%|███       | 31/100 [07:38<17:22, 15.11s/it]epoch [31/100], focal_loss:0.0387	, anomaly_loss:0.4453	fnorm_loss:0.0133, a_fnorm_loss:0.0400P:0.39, R:0.62
 32%|███▏      | 32/100 [07:48<15:22, 13.57s/it]epoch [32/100], focal_loss:0.0421	, anomaly_loss:0.4460	fnorm_loss:0.0134, a_fnorm_loss:0.0382P:0.39, R:0.61
 33%|███▎      | 33/100 [07:59<13:59, 12.53s/it]epoch [33/100], focal_loss:0.0368	, anomaly_loss:0.4438	fnorm_loss:0.0128, a_fnorm_loss:0.0391P:0.39, R:0.61
 34%|███▍      | 34/100 [08:09<13:05, 11.90s/it]epoch [34/100], focal_loss:0.0402	, anomaly_loss:0.4450	fnorm_loss:0.0128, a_fnorm_loss:0.0381P:0.38, R:0.61
 35%|███▌      | 35/100 [08:38<18:17, 16.89s/it]epoch [35/100], focal_loss:0.0397	, anomaly_loss:0.4474	fnorm_loss:0.0126, a_fnorm_loss:0.0385P:0.37, R:0.60
normal: 0.2081 0.3450  anomaly: 0.2608 0.5788	P:0.25, R:0.43
Pixel Auroc:0.994, Sample Auroc0.963, Pixel Aupro0.0
test_fnorm_loss: 0.0128 test_afnorm_loss: 0.0416
 36%|███▌      | 36/100 [08:48<15:59, 14.99s/it]epoch [36/100], focal_loss:0.0372	, anomaly_loss:0.4429	fnorm_loss:0.0123, a_fnorm_loss:0.0392P:0.38, R:0.61
 37%|███▋      | 37/100 [08:58<14:15, 13.58s/it]epoch [37/100], focal_loss:0.0368	, anomaly_loss:0.4357	fnorm_loss:0.0120, a_fnorm_loss:0.0403P:0.47, R:0.64
 38%|███▊      | 38/100 [09:09<13:02, 12.62s/it]epoch [38/100], focal_loss:0.0367	, anomaly_loss:0.4321	fnorm_loss:0.0119, a_fnorm_loss:0.0399P:0.49, R:0.75
 39%|███▉      | 39/100 [09:20<12:16, 12.07s/it]epoch [39/100], focal_loss:0.0428	, anomaly_loss:0.4299	fnorm_loss:0.0129, a_fnorm_loss:0.0380P:0.51, R:0.80
 39%|███▉      | 39/100 [09:53<15:28, 15.21s/it]
epoch [40/100], focal_loss:0.0383	, anomaly_loss:0.4554	fnorm_loss:0.0195, a_fnorm_loss:0.0305P:0.43, R:0.70
normal: 0.1012 0.3334  anomaly: 0.3418 0.5601	P:0.47, R:0.59
Pixel Auroc:0.995, Sample Auroc1.000, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0362
training Stubborn Student...
carpet
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<12:20,  6.22s/it]epoch [1/120], kd_loss:4.2600
  2%|▏         | 2/120 [00:12<12:19,  6.27s/it]epoch [2/120], kd_loss:3.3200
  2%|▎         | 3/120 [00:18<12:12,  6.26s/it]epoch [3/120], kd_loss:3.3203
  3%|▎         | 4/120 [00:25<12:10,  6.29s/it]epoch [4/120], kd_loss:3.2870
  4%|▍         | 5/120 [00:31<12:02,  6.28s/it]epoch [5/120], kd_loss:2.9589
  5%|▌         | 6/120 [00:37<11:58,  6.31s/it]epoch [6/120], kd_loss:2.4123
  6%|▌         | 7/120 [00:44<11:58,  6.36s/it]epoch [7/120], kd_loss:2.7763
  7%|▋         | 8/120 [00:50<11:51,  6.36s/it]epoch [8/120], kd_loss:1.9790
  8%|▊         | 9/120 [00:56<11:45,  6.35s/it]epoch [9/120], kd_loss:1.7678
  8%|▊         | 9/120 [01:20<16:34,  8.96s/it]
epoch [10/120], kd_loss:1.6875
normal: 1.0356 1.4830  anomaly: 1.4919 2.5303
thresh: 1.4918509012869319
fpr: 0.0 fnr 0.0
Pixel Auroc:0.994, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
grid
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:17<29:23, 17.81s/it]epoch [1/100], focal_loss:0.0893	, anomaly_loss:0.6000	fnorm_loss:0.0481, a_fnorm_loss:0.0159P:0.00, R:0.02
normal: 0.2611 0.2708  anomaly: 0.2613 0.2731	P:0.00, R:0.00
Pixel Auroc:0.239, Sample Auroc0.531, Pixel Aupro0.0
test_fnorm_loss: 0.0489 test_afnorm_loss: 0.0154
  2%|▏         | 2/100 [00:25<19:19, 11.84s/it]epoch [2/100], focal_loss:0.0827	, anomaly_loss:0.5969	fnorm_loss:0.0455, a_fnorm_loss:0.0142P:0.00, R:0.00
  3%|▎         | 3/100 [00:33<16:08,  9.99s/it]epoch [3/100], focal_loss:0.0837	, anomaly_loss:0.6094	fnorm_loss:0.0424, a_fnorm_loss:0.0134P:0.00, R:0.00
  4%|▍         | 4/100 [00:41<14:38,  9.15s/it]epoch [4/100], focal_loss:0.0810	, anomaly_loss:0.6143	fnorm_loss:0.0405, a_fnorm_loss:0.0131P:0.00, R:0.00
  5%|▌         | 5/100 [00:57<18:47, 11.87s/it]epoch [5/100], focal_loss:0.0738	, anomaly_loss:0.6226	fnorm_loss:0.0388, a_fnorm_loss:0.0121P:0.00, R:0.00
normal: 0.2041 0.2108  anomaly: 0.2051 0.2120	P:0.00, R:0.00
Pixel Auroc:0.258, Sample Auroc0.541, Pixel Aupro0.0
test_fnorm_loss: 0.0388 test_afnorm_loss: 0.0124
  6%|▌         | 6/100 [01:05<16:20, 10.43s/it]epoch [6/100], focal_loss:0.0777	, anomaly_loss:0.6242	fnorm_loss:0.0389, a_fnorm_loss:0.0127P:0.00, R:0.00
  7%|▋         | 7/100 [01:13<14:43,  9.50s/it]epoch [7/100], focal_loss:0.0813	, anomaly_loss:0.6273	fnorm_loss:0.0386, a_fnorm_loss:0.0125P:0.00, R:0.00
  8%|▊         | 8/100 [01:20<13:43,  8.95s/it]epoch [8/100], focal_loss:0.0738	, anomaly_loss:0.6263	fnorm_loss:0.0373, a_fnorm_loss:0.0121P:0.00, R:0.00
  9%|▉         | 9/100 [01:28<12:57,  8.54s/it]epoch [9/100], focal_loss:0.0789	, anomaly_loss:0.6071	fnorm_loss:0.0381, a_fnorm_loss:0.0130P:0.02, R:0.04
 10%|█         | 10/100 [01:47<17:27, 11.64s/it]epoch [10/100], focal_loss:0.0661	, anomaly_loss:0.5247	fnorm_loss:0.0335, a_fnorm_loss:0.0254P:0.20, R:0.44
normal: 0.3552 0.4116  anomaly: 0.3488 0.4439	P:0.03, R:0.43
Pixel Auroc:0.940, Sample Auroc0.774, Pixel Aupro0.0
test_fnorm_loss: 0.0366 test_afnorm_loss: 0.0343
 11%|█         | 11/100 [01:54<15:28, 10.43s/it]epoch [11/100], focal_loss:0.0552	, anomaly_loss:0.4829	fnorm_loss:0.0281, a_fnorm_loss:0.0312P:0.25, R:0.63
 12%|█▏        | 12/100 [02:02<14:07,  9.63s/it]epoch [12/100], focal_loss:0.0579	, anomaly_loss:0.4922	fnorm_loss:0.0244, a_fnorm_loss:0.0313P:0.30, R:0.59
 13%|█▎        | 13/100 [02:10<13:09,  9.07s/it]epoch [13/100], focal_loss:0.0514	, anomaly_loss:0.4742	fnorm_loss:0.0214, a_fnorm_loss:0.0329P:0.30, R:0.61
 14%|█▍        | 14/100 [02:18<12:25,  8.67s/it]epoch [14/100], focal_loss:0.0475	, anomaly_loss:0.4607	fnorm_loss:0.0196, a_fnorm_loss:0.0354P:0.33, R:0.64
 15%|█▌        | 15/100 [02:40<18:12, 12.85s/it]epoch [15/100], focal_loss:0.0392	, anomaly_loss:0.4580	fnorm_loss:0.0179, a_fnorm_loss:0.0364P:0.42, R:0.74
normal: 0.1810 0.3155  anomaly: 0.2477 0.5078	P:0.21, R:0.56
Pixel Auroc:0.948, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0163 test_afnorm_loss: 0.0337
 16%|█▌        | 16/100 [02:48<15:49, 11.30s/it]epoch [16/100], focal_loss:0.0400	, anomaly_loss:0.4521	fnorm_loss:0.0170, a_fnorm_loss:0.0364P:0.47, R:0.85
 17%|█▋        | 17/100 [02:55<14:01, 10.14s/it]epoch [17/100], focal_loss:0.0321	, anomaly_loss:0.4285	fnorm_loss:0.0158, a_fnorm_loss:0.0382P:0.50, R:0.92
 18%|█▊        | 18/100 [03:03<12:57,  9.49s/it]epoch [18/100], focal_loss:0.0307	, anomaly_loss:0.4363	fnorm_loss:0.0151, a_fnorm_loss:0.0383P:0.50, R:0.91
 19%|█▉        | 19/100 [03:11<11:57,  8.86s/it]epoch [19/100], focal_loss:0.0284	, anomaly_loss:0.4359	fnorm_loss:0.0141, a_fnorm_loss:0.0377P:0.47, R:0.89
 19%|█▉        | 19/100 [03:33<15:10, 11.24s/it]
epoch [20/100], focal_loss:0.0277	, anomaly_loss:0.4313	fnorm_loss:0.0138, a_fnorm_loss:0.0399P:0.51, R:0.92
normal: 0.0726 0.1846  anomaly: 0.1857 0.5156	P:0.28, R:0.40
Pixel Auroc:0.968, Sample Auroc1.000, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0330
training Stubborn Student...
grid
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:59,  5.54s/it]epoch [1/120], kd_loss:4.4874
  2%|▏         | 2/120 [00:11<10:49,  5.51s/it]epoch [2/120], kd_loss:3.2952
  2%|▎         | 3/120 [00:16<10:46,  5.53s/it]epoch [3/120], kd_loss:3.1837
  3%|▎         | 4/120 [00:22<10:44,  5.56s/it]epoch [4/120], kd_loss:2.8130
  4%|▍         | 5/120 [00:27<10:40,  5.57s/it]epoch [5/120], kd_loss:2.3618
  5%|▌         | 6/120 [00:33<10:39,  5.61s/it]epoch [6/120], kd_loss:2.1261
  6%|▌         | 7/120 [00:39<10:35,  5.63s/it]epoch [7/120], kd_loss:1.9640
  7%|▋         | 8/120 [00:44<10:30,  5.63s/it]epoch [8/120], kd_loss:2.3024
  8%|▊         | 9/120 [00:50<10:24,  5.63s/it]epoch [9/120], kd_loss:2.1678
  8%|▊         | 10/120 [01:04<15:12,  8.30s/it]epoch [10/120], kd_loss:2.1361
normal: 1.2000 1.6475  anomaly: 1.3976 2.5883
thresh: 1.5666718062353489
fpr: 0.09523809523809523 fnr 0.017543859649122806
Pixel Auroc:0.956, Sample Auroc0.985, Pixel Aupro0.0
  9%|▉         | 11/120 [01:10<13:34,  7.47s/it]epoch [11/120], kd_loss:1.9539
 10%|█         | 12/120 [01:15<12:26,  6.91s/it]epoch [12/120], kd_loss:1.9839
 11%|█         | 13/120 [01:21<11:39,  6.53s/it]epoch [13/120], kd_loss:1.9215
 12%|█▏        | 14/120 [01:27<11:04,  6.27s/it]epoch [14/120], kd_loss:1.8689
 12%|█▎        | 15/120 [01:32<10:37,  6.07s/it]epoch [15/120], kd_loss:1.8490
 13%|█▎        | 16/120 [01:38<10:19,  5.96s/it]epoch [16/120], kd_loss:1.8250
 14%|█▍        | 17/120 [01:44<10:06,  5.89s/it]epoch [17/120], kd_loss:1.8377
 15%|█▌        | 18/120 [01:49<09:55,  5.84s/it]epoch [18/120], kd_loss:1.7364
 16%|█▌        | 19/120 [01:55<09:44,  5.79s/it]epoch [19/120], kd_loss:1.7423
 17%|█▋        | 20/120 [02:09<13:55,  8.36s/it]epoch [20/120], kd_loss:1.6852
normal: 0.9279 1.3299  anomaly: 1.0217 2.5855
thresh: 1.3572719541881786
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.968, Sample Auroc0.985, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:15<12:25,  7.53s/it]epoch [21/120], kd_loss:1.6644
 18%|█▊        | 22/120 [02:21<11:23,  6.97s/it]epoch [22/120], kd_loss:1.6417
 19%|█▉        | 23/120 [02:26<10:38,  6.58s/it]epoch [23/120], kd_loss:1.7469
 20%|██        | 24/120 [02:32<10:05,  6.31s/it]epoch [24/120], kd_loss:1.6784
 21%|██        | 25/120 [02:38<09:42,  6.13s/it]epoch [25/120], kd_loss:1.5886
 22%|██▏       | 26/120 [02:43<09:21,  5.97s/it]epoch [26/120], kd_loss:1.5859
 22%|██▎       | 27/120 [02:49<09:07,  5.88s/it]epoch [27/120], kd_loss:1.6528
 23%|██▎       | 28/120 [02:55<08:57,  5.84s/it]epoch [28/120], kd_loss:1.6364
 24%|██▍       | 29/120 [03:01<08:47,  5.79s/it]epoch [29/120], kd_loss:1.5831
 25%|██▌       | 30/120 [03:16<12:59,  8.66s/it]epoch [30/120], kd_loss:1.5612
normal: 0.8207 1.2602  anomaly: 0.9217 2.4779
thresh: 1.2812767751625436
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.968, Sample Auroc0.985, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:21<11:29,  7.74s/it]epoch [31/120], kd_loss:1.5743
 27%|██▋       | 32/120 [03:27<10:26,  7.12s/it]epoch [32/120], kd_loss:1.5379
 28%|██▊       | 33/120 [03:33<09:40,  6.68s/it]epoch [33/120], kd_loss:1.5077
 28%|██▊       | 34/120 [03:38<09:08,  6.38s/it]epoch [34/120], kd_loss:1.5343
 29%|██▉       | 35/120 [03:44<08:46,  6.20s/it]epoch [35/120], kd_loss:1.6250
 30%|███       | 36/120 [03:50<08:27,  6.04s/it]epoch [36/120], kd_loss:1.5212
 31%|███       | 37/120 [03:56<08:11,  5.92s/it]epoch [37/120], kd_loss:1.4930
 32%|███▏      | 38/120 [04:01<07:59,  5.84s/it]epoch [38/120], kd_loss:1.4809
 32%|███▎      | 39/120 [04:07<07:49,  5.79s/it]epoch [39/120], kd_loss:1.4671
 33%|███▎      | 40/120 [04:23<11:45,  8.82s/it]epoch [40/120], kd_loss:1.7420
normal: 1.0711 1.3888  anomaly: 1.1768 2.3456
thresh: 1.4299903279915482
fpr: 0.0 fnr 0.03508771929824561
Pixel Auroc:0.968, Sample Auroc0.990, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:28<10:20,  7.86s/it]epoch [41/120], kd_loss:2.0511
 35%|███▌      | 42/120 [04:34<09:20,  7.19s/it]epoch [42/120], kd_loss:1.7142
 36%|███▌      | 43/120 [04:40<08:37,  6.72s/it]epoch [43/120], kd_loss:1.7165
 37%|███▋      | 44/120 [04:45<08:05,  6.39s/it]epoch [44/120], kd_loss:1.5941
 38%|███▊      | 45/120 [04:51<07:42,  6.16s/it]epoch [45/120], kd_loss:1.5340
 38%|███▊      | 46/120 [04:57<07:25,  6.02s/it]epoch [46/120], kd_loss:1.5322
 39%|███▉      | 47/120 [05:02<07:14,  5.95s/it]epoch [47/120], kd_loss:1.5236
 40%|████      | 48/120 [05:08<07:02,  5.87s/it]epoch [48/120], kd_loss:1.5176
 41%|████      | 49/120 [05:14<06:53,  5.82s/it]epoch [49/120], kd_loss:1.4745
 42%|████▏     | 50/120 [05:29<10:12,  8.75s/it]epoch [50/120], kd_loss:1.4513
normal: 0.9526 1.4083  anomaly: 1.2557 2.6457
thresh: 1.4096667698962435
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.971, Sample Auroc0.994, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:35<08:58,  7.80s/it]epoch [51/120], kd_loss:1.5329
 43%|████▎     | 52/120 [05:41<08:04,  7.13s/it]epoch [52/120], kd_loss:1.4797
 44%|████▍     | 53/120 [05:46<07:27,  6.68s/it]epoch [53/120], kd_loss:1.4970
 45%|████▌     | 54/120 [05:52<07:00,  6.36s/it]epoch [54/120], kd_loss:1.5154
 46%|████▌     | 55/120 [05:57<06:39,  6.15s/it]epoch [55/120], kd_loss:1.4715
 47%|████▋     | 56/120 [06:03<06:24,  6.01s/it]epoch [56/120], kd_loss:1.4454
 48%|████▊     | 57/120 [06:09<06:12,  5.92s/it]epoch [57/120], kd_loss:1.5595
 48%|████▊     | 58/120 [06:14<06:02,  5.84s/it]epoch [58/120], kd_loss:1.4349
 49%|████▉     | 59/120 [06:20<05:54,  5.80s/it]epoch [59/120], kd_loss:1.4144
 50%|█████     | 60/120 [06:34<08:14,  8.24s/it]epoch [60/120], kd_loss:1.4154
normal: 0.8472 1.3201  anomaly: 0.9991 2.7026
thresh: 1.3369904920317541
fpr: 0.0 fnr 0.03508771929824561
Pixel Auroc:0.972, Sample Auroc0.991, Pixel Aupro0.0
 51%|█████     | 61/120 [06:40<07:19,  7.44s/it]epoch [61/120], kd_loss:1.4003
 52%|█████▏    | 62/120 [06:45<06:41,  6.91s/it]epoch [62/120], kd_loss:1.3736
 52%|█████▎    | 63/120 [06:51<06:11,  6.51s/it]epoch [63/120], kd_loss:1.3688
 53%|█████▎    | 64/120 [06:57<05:49,  6.25s/it]epoch [64/120], kd_loss:1.3662
 54%|█████▍    | 65/120 [07:02<05:35,  6.09s/it]epoch [65/120], kd_loss:1.3784
 55%|█████▌    | 66/120 [07:08<05:21,  5.95s/it]epoch [66/120], kd_loss:1.3588
 56%|█████▌    | 67/120 [07:14<05:11,  5.87s/it]epoch [67/120], kd_loss:1.4119
 57%|█████▋    | 68/120 [07:19<05:03,  5.83s/it]epoch [68/120], kd_loss:1.3759
 57%|█████▊    | 69/120 [07:25<04:54,  5.78s/it]epoch [69/120], kd_loss:1.3668
 58%|█████▊    | 70/120 [07:39<06:57,  8.35s/it]epoch [70/120], kd_loss:1.3553
normal: 0.8076 1.2079  anomaly: 0.8994 2.4868
thresh: 1.2321882950751444
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.974, Sample Auroc0.989, Pixel Aupro0.0
 59%|█████▉    | 71/120 [07:45<06:08,  7.52s/it]epoch [71/120], kd_loss:1.3721
 60%|██████    | 72/120 [07:51<05:33,  6.94s/it]epoch [72/120], kd_loss:1.5161
 61%|██████    | 73/120 [07:56<05:07,  6.54s/it]epoch [73/120], kd_loss:1.3796
 62%|██████▏   | 74/120 [08:02<04:49,  6.28s/it]epoch [74/120], kd_loss:1.4079
 62%|██████▎   | 75/120 [08:07<04:34,  6.09s/it]epoch [75/120], kd_loss:1.3637
 63%|██████▎   | 76/120 [08:13<04:22,  5.96s/it]epoch [76/120], kd_loss:1.3894
 64%|██████▍   | 77/120 [08:19<04:12,  5.88s/it]epoch [77/120], kd_loss:1.3410
 65%|██████▌   | 78/120 [08:25<04:04,  5.83s/it]epoch [78/120], kd_loss:1.3512
 66%|██████▌   | 79/120 [08:30<03:57,  5.79s/it]epoch [79/120], kd_loss:1.3257
 67%|██████▋   | 80/120 [08:45<05:39,  8.48s/it]epoch [80/120], kd_loss:1.4588
normal: 0.9872 1.4671  anomaly: 1.1931 2.6608
thresh: 1.5382527415615277
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.955, Sample Auroc0.988, Pixel Aupro0.0
 68%|██████▊   | 81/120 [08:51<04:56,  7.61s/it]epoch [81/120], kd_loss:1.5679
 68%|██████▊   | 82/120 [08:56<04:28,  7.05s/it]epoch [82/120], kd_loss:1.4573
 69%|██████▉   | 83/120 [09:02<04:05,  6.64s/it]epoch [83/120], kd_loss:1.4126
 70%|███████   | 84/120 [09:08<03:48,  6.35s/it]epoch [84/120], kd_loss:1.3880
 71%|███████   | 85/120 [09:13<03:35,  6.15s/it]epoch [85/120], kd_loss:1.5471
 72%|███████▏  | 86/120 [09:19<03:24,  6.01s/it]epoch [86/120], kd_loss:1.4742
 72%|███████▎  | 87/120 [09:25<03:15,  5.91s/it]epoch [87/120], kd_loss:1.4340
 73%|███████▎  | 88/120 [09:30<03:07,  5.86s/it]epoch [88/120], kd_loss:1.4805
 74%|███████▍  | 89/120 [09:36<02:59,  5.80s/it]epoch [89/120], kd_loss:1.3929
 75%|███████▌  | 90/120 [09:53<04:29,  8.99s/it]epoch [90/120], kd_loss:1.3746
normal: 0.8013 1.1997  anomaly: 1.0044 2.5009
thresh: 1.2399808594359043
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.972, Sample Auroc0.995, Pixel Aupro0.0
 76%|███████▌  | 91/120 [09:58<03:51,  7.97s/it]epoch [91/120], kd_loss:1.4679
 77%|███████▋  | 92/120 [10:04<03:23,  7.25s/it]epoch [92/120], kd_loss:1.4754
 78%|███████▊  | 93/120 [10:09<03:03,  6.78s/it]epoch [93/120], kd_loss:1.4242
 78%|███████▊  | 94/120 [10:15<02:47,  6.45s/it]epoch [94/120], kd_loss:1.4377
 79%|███████▉  | 95/120 [10:21<02:35,  6.23s/it]epoch [95/120], kd_loss:1.4249
 80%|████████  | 96/120 [10:26<02:25,  6.06s/it]epoch [96/120], kd_loss:1.4247
 81%|████████  | 97/120 [10:32<02:17,  5.98s/it]epoch [97/120], kd_loss:1.4102
 82%|████████▏ | 98/120 [10:38<02:10,  5.91s/it]epoch [98/120], kd_loss:1.3870
 82%|████████▎ | 99/120 [10:44<02:02,  5.85s/it]epoch [99/120], kd_loss:1.3759
 83%|████████▎ | 100/120 [10:59<02:54,  8.70s/it]epoch [100/120], kd_loss:1.3767
normal: 0.7817 1.1107  anomaly: 0.9307 2.6915
thresh: 1.2070294353900397
fpr: 0.0 fnr 0.017543859649122806
Pixel Auroc:0.973, Sample Auroc0.992, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:05<02:27,  7.77s/it]epoch [101/120], kd_loss:1.3624
 85%|████████▌ | 102/120 [11:10<02:08,  7.15s/it]epoch [102/120], kd_loss:1.3629
 86%|████████▌ | 103/120 [11:16<01:53,  6.70s/it]epoch [103/120], kd_loss:1.3506
 87%|████████▋ | 104/120 [11:22<01:42,  6.39s/it]epoch [104/120], kd_loss:1.3482
 88%|████████▊ | 105/120 [11:27<01:33,  6.20s/it]epoch [105/120], kd_loss:1.3503
 88%|████████▊ | 106/120 [11:33<01:24,  6.06s/it]epoch [106/120], kd_loss:1.3463
 89%|████████▉ | 107/120 [11:39<01:17,  5.93s/it]epoch [107/120], kd_loss:1.3476
 90%|█████████ | 108/120 [11:45<01:10,  5.91s/it]epoch [108/120], kd_loss:1.3357
 91%|█████████ | 109/120 [11:50<01:04,  5.86s/it]epoch [109/120], kd_loss:1.3334
 92%|█████████▏| 110/120 [12:05<01:25,  8.53s/it]epoch [110/120], kd_loss:1.3329
normal: 0.7845 1.1580  anomaly: 0.9909 2.5605
thresh: 1.1515860314566244
fpr: 0.047619047619047616 fnr 0.017543859649122806
Pixel Auroc:0.975, Sample Auroc0.993, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:11<01:08,  7.66s/it]epoch [111/120], kd_loss:1.3349
 93%|█████████▎| 112/120 [12:16<00:56,  7.06s/it]epoch [112/120], kd_loss:1.3324
 94%|█████████▍| 113/120 [12:22<00:46,  6.64s/it]epoch [113/120], kd_loss:1.3309
 95%|█████████▌| 114/120 [12:28<00:38,  6.36s/it]epoch [114/120], kd_loss:1.3320
 96%|█████████▌| 115/120 [12:34<00:30,  6.18s/it]epoch [115/120], kd_loss:1.3284
 97%|█████████▋| 116/120 [12:39<00:24,  6.04s/it]epoch [116/120], kd_loss:1.3373
 98%|█████████▊| 117/120 [12:45<00:17,  5.95s/it]epoch [117/120], kd_loss:1.3245
 98%|█████████▊| 118/120 [12:51<00:11,  5.88s/it]epoch [118/120], kd_loss:1.3337
 99%|█████████▉| 119/120 [12:56<00:05,  5.83s/it]epoch [119/120], kd_loss:1.3243
100%|██████████| 120/120 [13:11<00:00,  8.47s/it]100%|██████████| 120/120 [13:11<00:00,  6.60s/it]
epoch [120/120], kd_loss:1.3246
normal: 0.7756 1.1427  anomaly: 0.9666 2.4964
thresh: 1.1419033716175797
fpr: 0.047619047619047616 fnr 0.017543859649122806
Pixel Auroc:0.975, Sample Auroc0.992, Pixel Aupro0.0
training Advanced Teacher...
leather
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:30<49:50, 30.20s/it]epoch [1/100], focal_loss:0.0918	, anomaly_loss:0.6043	fnorm_loss:0.0655, a_fnorm_loss:0.0173P:0.00, R:0.04
normal: 0.2670 0.2729  anomaly: 0.2612 0.2714	P:0.00, R:0.00
Pixel Auroc:0.174, Sample Auroc0.184, Pixel Aupro0.0
test_fnorm_loss: 0.0641 test_afnorm_loss: 0.0190
  2%|▏         | 2/100 [00:39<28:54, 17.70s/it]epoch [2/100], focal_loss:0.0831	, anomaly_loss:0.5987	fnorm_loss:0.0635, a_fnorm_loss:0.0156P:0.00, R:0.00
  3%|▎         | 3/100 [00:48<22:06, 13.68s/it]epoch [3/100], focal_loss:0.0796	, anomaly_loss:0.6088	fnorm_loss:0.0575, a_fnorm_loss:0.0142P:0.00, R:0.00
  4%|▍         | 4/100 [00:56<18:51, 11.78s/it]epoch [4/100], focal_loss:0.0783	, anomaly_loss:0.6219	fnorm_loss:0.0542, a_fnorm_loss:0.0136P:0.00, R:0.00
  5%|▌         | 5/100 [01:24<27:37, 17.44s/it]epoch [5/100], focal_loss:0.0774	, anomaly_loss:0.6201	fnorm_loss:0.0527, a_fnorm_loss:0.0132P:0.00, R:0.00
normal: 0.2080 0.2120  anomaly: 0.2048 0.2111	P:0.00, R:0.00
Pixel Auroc:0.199, Sample Auroc0.199, Pixel Aupro0.0
test_fnorm_loss: 0.0509 test_afnorm_loss: 0.0154
  6%|▌         | 6/100 [01:33<22:40, 14.47s/it]epoch [6/100], focal_loss:0.0764	, anomaly_loss:0.6247	fnorm_loss:0.0520, a_fnorm_loss:0.0132P:0.00, R:0.00
  7%|▋         | 7/100 [01:41<19:30, 12.59s/it]epoch [7/100], focal_loss:0.0782	, anomaly_loss:0.6110	fnorm_loss:0.0532, a_fnorm_loss:0.0150P:0.02, R:0.04
  8%|▊         | 8/100 [01:50<17:31, 11.43s/it]epoch [8/100], focal_loss:0.0769	, anomaly_loss:0.6010	fnorm_loss:0.0513, a_fnorm_loss:0.0174P:0.14, R:0.08
  9%|▉         | 9/100 [01:59<16:08, 10.64s/it]epoch [9/100], focal_loss:0.0741	, anomaly_loss:0.5460	fnorm_loss:0.0481, a_fnorm_loss:0.0288P:0.13, R:0.28
 10%|█         | 10/100 [02:28<24:09, 16.10s/it]epoch [10/100], focal_loss:0.0657	, anomaly_loss:0.5315	fnorm_loss:0.0429, a_fnorm_loss:0.0317P:0.13, R:0.32
normal: 0.1738 0.2701  anomaly: 0.2342 0.3111	P:0.06, R:0.18
Pixel Auroc:0.991, Sample Auroc0.993, Pixel Aupro0.0
test_fnorm_loss: 0.0389 test_afnorm_loss: 0.0398
 11%|█         | 11/100 [02:36<20:36, 13.89s/it]epoch [11/100], focal_loss:0.0617	, anomaly_loss:0.5140	fnorm_loss:0.0385, a_fnorm_loss:0.0350P:0.25, R:0.49
 12%|█▏        | 12/100 [02:46<18:17, 12.47s/it]epoch [12/100], focal_loss:0.0536	, anomaly_loss:0.4958	fnorm_loss:0.0331, a_fnorm_loss:0.0369P:0.29, R:0.61
 13%|█▎        | 13/100 [02:55<16:34, 11.43s/it]epoch [13/100], focal_loss:0.0455	, anomaly_loss:0.4733	fnorm_loss:0.0290, a_fnorm_loss:0.0392P:0.33, R:0.64
 14%|█▍        | 14/100 [03:03<15:08, 10.56s/it]epoch [14/100], focal_loss:0.0419	, anomaly_loss:0.4752	fnorm_loss:0.0259, a_fnorm_loss:0.0399P:0.40, R:0.72
 14%|█▍        | 14/100 [03:36<22:09, 15.45s/it]
epoch [15/100], focal_loss:0.0324	, anomaly_loss:0.4509	fnorm_loss:0.0238, a_fnorm_loss:0.0414P:0.47, R:0.91
normal: 0.0996 0.2414  anomaly: 0.2639 0.5137	P:0.36, R:0.44
Pixel Auroc:0.993, Sample Auroc1.000, Pixel Aupro0.0
test_fnorm_loss: 0.0210 test_afnorm_loss: 0.0474
training Stubborn Student...
leather
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<11:16,  5.68s/it]epoch [1/120], kd_loss:4.2800
  2%|▏         | 2/120 [00:11<11:05,  5.64s/it]epoch [2/120], kd_loss:3.0865
  2%|▎         | 3/120 [00:16<10:55,  5.60s/it]epoch [3/120], kd_loss:2.6724
  3%|▎         | 4/120 [00:22<10:45,  5.57s/it]epoch [4/120], kd_loss:2.3168
  4%|▍         | 5/120 [00:27<10:37,  5.54s/it]epoch [5/120], kd_loss:2.0707
  5%|▌         | 6/120 [00:33<10:33,  5.56s/it]epoch [6/120], kd_loss:2.2608
  6%|▌         | 7/120 [00:39<10:28,  5.56s/it]epoch [7/120], kd_loss:1.9656
  7%|▋         | 8/120 [00:44<10:24,  5.58s/it]epoch [8/120], kd_loss:1.7658
  8%|▊         | 9/120 [00:50<10:21,  5.60s/it]epoch [9/120], kd_loss:1.6670
  8%|▊         | 9/120 [01:14<15:21,  8.30s/it]
epoch [10/120], kd_loss:1.8267
normal: 1.1084 1.7967  anomaly: 1.8582 2.8121
thresh: 1.8581837529338727
fpr: 0.0 fnr 0.0
Pixel Auroc:0.994, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
tile
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:26<43:05, 26.12s/it]epoch [1/100], focal_loss:0.0919	, anomaly_loss:0.5925	fnorm_loss:0.0645, a_fnorm_loss:0.0174P:0.00, R:0.04
normal: 0.2669 0.2742  anomaly: 0.2616 0.2729	P:0.00, R:0.00
Pixel Auroc:0.248, Sample Auroc0.078, Pixel Aupro0.0
test_fnorm_loss: 0.0692 test_afnorm_loss: 0.0196
  2%|▏         | 2/100 [00:33<25:02, 15.33s/it]epoch [2/100], focal_loss:0.0859	, anomaly_loss:0.5841	fnorm_loss:0.0633, a_fnorm_loss:0.0162P:0.00, R:0.00
  3%|▎         | 3/100 [00:41<19:04, 11.80s/it]epoch [3/100], focal_loss:0.0844	, anomaly_loss:0.5966	fnorm_loss:0.0589, a_fnorm_loss:0.0160P:0.00, R:0.00
  4%|▍         | 4/100 [00:49<16:19, 10.21s/it]epoch [4/100], focal_loss:0.0837	, anomaly_loss:0.6061	fnorm_loss:0.0558, a_fnorm_loss:0.0174P:0.00, R:0.00
  5%|▌         | 5/100 [01:13<24:13, 15.30s/it]epoch [5/100], focal_loss:0.0778	, anomaly_loss:0.6074	fnorm_loss:0.0536, a_fnorm_loss:0.0138P:0.00, R:0.00
normal: 0.2126 0.2168  anomaly: 0.2085 0.2156	P:0.00, R:0.00
Pixel Auroc:0.287, Sample Auroc0.073, Pixel Aupro0.0
test_fnorm_loss: 0.0558 test_afnorm_loss: 0.0161
  6%|▌         | 6/100 [01:21<19:58, 12.74s/it]epoch [6/100], focal_loss:0.0787	, anomaly_loss:0.6164	fnorm_loss:0.0526, a_fnorm_loss:0.0140P:0.00, R:0.00
  7%|▋         | 7/100 [01:28<17:09, 11.07s/it]epoch [7/100], focal_loss:0.0753	, anomaly_loss:0.6139	fnorm_loss:0.0521, a_fnorm_loss:0.0151P:0.00, R:0.00
  8%|▊         | 8/100 [01:36<15:24, 10.05s/it]epoch [8/100], focal_loss:0.0838	, anomaly_loss:0.6161	fnorm_loss:0.0525, a_fnorm_loss:0.0138P:0.00, R:0.00
  9%|▉         | 9/100 [01:44<14:19,  9.44s/it]epoch [9/100], focal_loss:0.0857	, anomaly_loss:0.6113	fnorm_loss:0.0535, a_fnorm_loss:0.0140P:0.00, R:0.02
 10%|█         | 10/100 [02:10<21:42, 14.47s/it]epoch [10/100], focal_loss:0.0773	, anomaly_loss:0.5827	fnorm_loss:0.0521, a_fnorm_loss:0.0158P:0.10, R:0.17
normal: 0.2013 0.2469  anomaly: 0.2006 0.2773	P:0.15, R:0.06
Pixel Auroc:0.794, Sample Auroc0.921, Pixel Aupro0.0
test_fnorm_loss: 0.0517 test_afnorm_loss: 0.0171
 11%|█         | 11/100 [02:18<18:38, 12.56s/it]epoch [11/100], focal_loss:0.0607	, anomaly_loss:0.5163	fnorm_loss:0.0459, a_fnorm_loss:0.0250P:0.18, R:0.50
 12%|█▏        | 12/100 [02:26<16:18, 11.12s/it]epoch [12/100], focal_loss:0.0546	, anomaly_loss:0.4890	fnorm_loss:0.0376, a_fnorm_loss:0.0307P:0.25, R:0.57
 13%|█▎        | 13/100 [02:34<14:45, 10.17s/it]epoch [13/100], focal_loss:0.0568	, anomaly_loss:0.4872	fnorm_loss:0.0337, a_fnorm_loss:0.0315P:0.27, R:0.57
 14%|█▍        | 14/100 [02:42<13:33,  9.46s/it]epoch [14/100], focal_loss:0.0522	, anomaly_loss:0.4804	fnorm_loss:0.0301, a_fnorm_loss:0.0328P:0.29, R:0.59
 15%|█▌        | 15/100 [03:11<21:52, 15.45s/it]epoch [15/100], focal_loss:0.0473	, anomaly_loss:0.4700	fnorm_loss:0.0275, a_fnorm_loss:0.0348P:0.32, R:0.62
normal: 0.1632 0.3179  anomaly: 0.2194 0.4571	P:0.35, R:0.28
Pixel Auroc:0.966, Sample Auroc0.957, Pixel Aupro0.0
test_fnorm_loss: 0.0259 test_afnorm_loss: 0.0223
 16%|█▌        | 16/100 [03:20<18:36, 13.29s/it]epoch [16/100], focal_loss:0.0487	, anomaly_loss:0.4844	fnorm_loss:0.0255, a_fnorm_loss:0.0333P:0.30, R:0.59
 17%|█▋        | 17/100 [03:27<16:05, 11.63s/it]epoch [17/100], focal_loss:0.0438	, anomaly_loss:0.4733	fnorm_loss:0.0233, a_fnorm_loss:0.0350P:0.32, R:0.59
 18%|█▊        | 18/100 [03:35<14:23, 10.54s/it]epoch [18/100], focal_loss:0.0493	, anomaly_loss:0.4732	fnorm_loss:0.0228, a_fnorm_loss:0.0349P:0.32, R:0.60
 19%|█▉        | 19/100 [03:43<13:00,  9.64s/it]epoch [19/100], focal_loss:0.0398	, anomaly_loss:0.4507	fnorm_loss:0.0208, a_fnorm_loss:0.0377P:0.52, R:0.76
 20%|██        | 20/100 [04:12<20:32, 15.41s/it]epoch [20/100], focal_loss:0.0373	, anomaly_loss:0.4450	fnorm_loss:0.0201, a_fnorm_loss:0.0375P:0.51, R:0.83
normal: 0.1239 0.3654  anomaly: 0.1948 0.6010	P:0.54, R:0.44
Pixel Auroc:0.973, Sample Auroc0.985, Pixel Aupro0.0
test_fnorm_loss: 0.0194 test_afnorm_loss: 0.0327
 21%|██        | 21/100 [04:20<17:19, 13.16s/it]epoch [21/100], focal_loss:0.0313	, anomaly_loss:0.4378	fnorm_loss:0.0192, a_fnorm_loss:0.0386P:0.49, R:0.89
 22%|██▏       | 22/100 [04:28<15:05, 11.60s/it]epoch [22/100], focal_loss:0.0279	, anomaly_loss:0.4361	fnorm_loss:0.0181, a_fnorm_loss:0.0396P:0.51, R:0.90
 23%|██▎       | 23/100 [04:36<13:26, 10.48s/it]epoch [23/100], focal_loss:0.0318	, anomaly_loss:0.4298	fnorm_loss:0.0176, a_fnorm_loss:0.0401P:0.52, R:0.89
 24%|██▍       | 24/100 [04:43<12:17,  9.70s/it]epoch [24/100], focal_loss:0.0244	, anomaly_loss:0.4303	fnorm_loss:0.0165, a_fnorm_loss:0.0404P:0.51, R:0.90
 25%|██▌       | 25/100 [05:12<19:19, 15.47s/it]epoch [25/100], focal_loss:0.0237	, anomaly_loss:0.4239	fnorm_loss:0.0159, a_fnorm_loss:0.0413P:0.54, R:0.92
normal: 0.0767 0.3299  anomaly: 0.2213 0.6474	P:0.56, R:0.42
Pixel Auroc:0.975, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0154 test_afnorm_loss: 0.0337
 26%|██▌       | 26/100 [05:20<16:19, 13.23s/it]epoch [26/100], focal_loss:0.0269	, anomaly_loss:0.4343	fnorm_loss:0.0156, a_fnorm_loss:0.0410P:0.56, R:0.89
 27%|██▋       | 27/100 [05:28<14:11, 11.67s/it]epoch [27/100], focal_loss:0.0241	, anomaly_loss:0.4243	fnorm_loss:0.0153, a_fnorm_loss:0.0419P:0.57, R:0.92
 28%|██▊       | 28/100 [05:36<12:38, 10.54s/it]epoch [28/100], focal_loss:0.0231	, anomaly_loss:0.4306	fnorm_loss:0.0145, a_fnorm_loss:0.0430P:0.56, R:0.88
 29%|██▉       | 29/100 [05:44<11:34,  9.77s/it]epoch [29/100], focal_loss:0.0254	, anomaly_loss:0.4308	fnorm_loss:0.0146, a_fnorm_loss:0.0411P:0.59, R:0.88
 30%|███       | 30/100 [06:13<17:51, 15.31s/it]epoch [30/100], focal_loss:0.0220	, anomaly_loss:0.4169	fnorm_loss:0.0142, a_fnorm_loss:0.0417P:0.52, R:0.92
normal: 0.0784 0.3435  anomaly: 0.2124 0.6987	P:0.57, R:0.47
Pixel Auroc:0.980, Sample Auroc0.988, Pixel Aupro0.0
test_fnorm_loss: 0.0135 test_afnorm_loss: 0.0352
 31%|███       | 31/100 [06:20<15:03, 13.09s/it]epoch [31/100], focal_loss:0.0218	, anomaly_loss:0.4207	fnorm_loss:0.0138, a_fnorm_loss:0.0418P:0.54, R:0.90
 32%|███▏      | 32/100 [06:28<13:02, 11.51s/it]epoch [32/100], focal_loss:0.0238	, anomaly_loss:0.4271	fnorm_loss:0.0136, a_fnorm_loss:0.0421P:0.56, R:0.89
 33%|███▎      | 33/100 [06:36<11:40, 10.46s/it]epoch [33/100], focal_loss:0.0228	, anomaly_loss:0.4190	fnorm_loss:0.0134, a_fnorm_loss:0.0422P:0.57, R:0.90
 34%|███▍      | 34/100 [06:44<10:38,  9.68s/it]epoch [34/100], focal_loss:0.0209	, anomaly_loss:0.4222	fnorm_loss:0.0128, a_fnorm_loss:0.0427P:0.60, R:0.91
 35%|███▌      | 35/100 [07:08<15:00, 13.85s/it]epoch [35/100], focal_loss:0.0210	, anomaly_loss:0.4187	fnorm_loss:0.0127, a_fnorm_loss:0.0433P:0.57, R:0.92
normal: 0.1223 0.4322  anomaly: 0.3636 0.7341	P:0.54, R:0.56
Pixel Auroc:0.985, Sample Auroc0.995, Pixel Aupro0.0
test_fnorm_loss: 0.0124 test_afnorm_loss: 0.0388
 36%|███▌      | 36/100 [07:15<12:48, 12.00s/it]epoch [36/100], focal_loss:0.0196	, anomaly_loss:0.4178	fnorm_loss:0.0122, a_fnorm_loss:0.0432P:0.57, R:0.92
 37%|███▋      | 37/100 [07:23<11:19, 10.79s/it]epoch [37/100], focal_loss:0.0215	, anomaly_loss:0.4220	fnorm_loss:0.0123, a_fnorm_loss:0.0431P:0.61, R:0.91
 38%|███▊      | 38/100 [07:31<10:10,  9.84s/it]epoch [38/100], focal_loss:0.0181	, anomaly_loss:0.4186	fnorm_loss:0.0119, a_fnorm_loss:0.0431P:0.58, R:0.92
 39%|███▉      | 39/100 [07:39<09:29,  9.33s/it]epoch [39/100], focal_loss:0.0209	, anomaly_loss:0.4154	fnorm_loss:0.0118, a_fnorm_loss:0.0430P:0.59, R:0.91
 40%|████      | 40/100 [08:02<13:25, 13.42s/it]epoch [40/100], focal_loss:0.0197	, anomaly_loss:0.4211	fnorm_loss:0.0116, a_fnorm_loss:0.0442P:0.61, R:0.90
normal: 0.1078 0.4234  anomaly: 0.3214 0.7419	P:0.55, R:0.54
Pixel Auroc:0.986, Sample Auroc0.993, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0324
 41%|████      | 41/100 [08:10<11:31, 11.72s/it]epoch [41/100], focal_loss:0.0180	, anomaly_loss:0.4178	fnorm_loss:0.0113, a_fnorm_loss:0.0437P:0.60, R:0.92
 42%|████▏     | 42/100 [08:18<10:10, 10.53s/it]epoch [42/100], focal_loss:0.0190	, anomaly_loss:0.4143	fnorm_loss:0.0113, a_fnorm_loss:0.0431P:0.58, R:0.92
 43%|████▎     | 43/100 [08:25<09:11,  9.67s/it]epoch [43/100], focal_loss:0.0197	, anomaly_loss:0.4170	fnorm_loss:0.0109, a_fnorm_loss:0.0447P:0.61, R:0.91
 44%|████▍     | 44/100 [08:33<08:27,  9.07s/it]epoch [44/100], focal_loss:0.0175	, anomaly_loss:0.4189	fnorm_loss:0.0109, a_fnorm_loss:0.0441P:0.59, R:0.92
 45%|████▌     | 45/100 [08:57<12:24, 13.53s/it]epoch [45/100], focal_loss:0.0206	, anomaly_loss:0.4134	fnorm_loss:0.0112, a_fnorm_loss:0.0421P:0.62, R:0.92
normal: 0.1154 0.4535  anomaly: 0.3660 0.7209	P:0.53, R:0.57
Pixel Auroc:0.988, Sample Auroc0.997, Pixel Aupro0.0
test_fnorm_loss: 0.0106 test_afnorm_loss: 0.0329
 46%|████▌     | 46/100 [09:05<10:39, 11.85s/it]epoch [46/100], focal_loss:0.0207	, anomaly_loss:0.4166	fnorm_loss:0.0111, a_fnorm_loss:0.0418P:0.58, R:0.91
 47%|████▋     | 47/100 [09:13<09:22, 10.62s/it]epoch [47/100], focal_loss:0.0173	, anomaly_loss:0.4107	fnorm_loss:0.0107, a_fnorm_loss:0.0434P:0.57, R:0.92
 48%|████▊     | 48/100 [09:20<08:27,  9.76s/it]epoch [48/100], focal_loss:0.0290	, anomaly_loss:0.4363	fnorm_loss:0.0108, a_fnorm_loss:0.0424P:0.61, R:0.84
 49%|████▉     | 49/100 [09:28<07:43,  9.08s/it]epoch [49/100], focal_loss:0.0215	, anomaly_loss:0.4223	fnorm_loss:0.0104, a_fnorm_loss:0.0441P:0.57, R:0.91
 50%|█████     | 50/100 [09:56<12:23, 14.87s/it]epoch [50/100], focal_loss:0.0185	, anomaly_loss:0.4092	fnorm_loss:0.0103, a_fnorm_loss:0.0440P:0.56, R:0.93
normal: 0.0573 0.3424  anomaly: 0.3003 0.7538	P:0.58, R:0.50
Pixel Auroc:0.986, Sample Auroc0.997, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0332
 51%|█████     | 51/100 [10:04<10:25, 12.77s/it]epoch [51/100], focal_loss:0.0176	, anomaly_loss:0.4117	fnorm_loss:0.0100, a_fnorm_loss:0.0432P:0.56, R:0.91
 52%|█████▏    | 52/100 [10:12<08:57, 11.20s/it]epoch [52/100], focal_loss:0.0184	, anomaly_loss:0.4107	fnorm_loss:0.0101, a_fnorm_loss:0.0453P:0.63, R:0.92
 53%|█████▎    | 53/100 [10:20<08:00, 10.22s/it]epoch [53/100], focal_loss:0.0191	, anomaly_loss:0.4138	fnorm_loss:0.0101, a_fnorm_loss:0.0444P:0.64, R:0.92
 54%|█████▍    | 54/100 [10:27<07:18,  9.53s/it]epoch [54/100], focal_loss:0.0203	, anomaly_loss:0.4215	fnorm_loss:0.0099, a_fnorm_loss:0.0434P:0.62, R:0.90
 55%|█████▌    | 55/100 [10:56<11:24, 15.22s/it]epoch [55/100], focal_loss:0.0172	, anomaly_loss:0.4094	fnorm_loss:0.0099, a_fnorm_loss:0.0441P:0.60, R:0.94
normal: 0.0588 0.3055  anomaly: 0.2990 0.7659	P:0.58, R:0.51
Pixel Auroc:0.986, Sample Auroc0.999, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0345
 56%|█████▌    | 56/100 [11:04<09:34, 13.06s/it]epoch [56/100], focal_loss:0.0238	, anomaly_loss:0.4250	fnorm_loss:0.0101, a_fnorm_loss:0.0446P:0.61, R:0.89
 57%|█████▋    | 57/100 [11:12<08:16, 11.54s/it]epoch [57/100], focal_loss:0.0167	, anomaly_loss:0.4120	fnorm_loss:0.0097, a_fnorm_loss:0.0452P:0.64, R:0.91
 58%|█████▊    | 58/100 [11:20<07:19, 10.45s/it]epoch [58/100], focal_loss:0.0199	, anomaly_loss:0.4113	fnorm_loss:0.0098, a_fnorm_loss:0.0440P:0.58, R:0.91
 59%|█████▉    | 59/100 [11:27<06:33,  9.59s/it]epoch [59/100], focal_loss:0.0206	, anomaly_loss:0.4140	fnorm_loss:0.0096, a_fnorm_loss:0.0450P:0.63, R:0.91
 59%|█████▉    | 59/100 [11:51<08:14, 12.06s/it]
epoch [60/100], focal_loss:0.0175	, anomaly_loss:0.4128	fnorm_loss:0.0094, a_fnorm_loss:0.0447P:0.63, R:0.91
normal: 0.1234 0.4451  anomaly: 0.4396 0.7823	P:0.55, R:0.58
Pixel Auroc:0.989, Sample Auroc1.000, Pixel Aupro0.0
test_fnorm_loss: 0.0094 test_afnorm_loss: 0.0412
training Stubborn Student...
tile
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:17,  5.19s/it]epoch [1/120], kd_loss:4.5613
  2%|▏         | 2/120 [00:10<10:14,  5.21s/it]epoch [2/120], kd_loss:3.4146
  2%|▎         | 3/120 [00:15<10:11,  5.23s/it]epoch [3/120], kd_loss:3.0780
  3%|▎         | 4/120 [00:20<10:08,  5.24s/it]epoch [4/120], kd_loss:2.5284
  4%|▍         | 5/120 [00:26<10:00,  5.22s/it]epoch [5/120], kd_loss:2.2466
  5%|▌         | 6/120 [00:31<09:58,  5.25s/it]epoch [6/120], kd_loss:2.1548
  6%|▌         | 7/120 [00:36<09:55,  5.27s/it]epoch [7/120], kd_loss:2.4500
  7%|▋         | 8/120 [00:42<09:50,  5.27s/it]epoch [8/120], kd_loss:2.0464
  8%|▊         | 9/120 [00:47<09:44,  5.26s/it]epoch [9/120], kd_loss:2.0258
  8%|▊         | 9/120 [01:08<14:06,  7.62s/it]
epoch [10/120], kd_loss:2.4418
normal: 1.1993 1.7582  anomaly: 1.7891 2.6313
thresh: 1.7891073018579409
fpr: 0.0 fnr 0.0
Pixel Auroc:0.978, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
wood
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:24<40:09, 24.33s/it]epoch [1/100], focal_loss:0.0942	, anomaly_loss:0.6082	fnorm_loss:0.0664, a_fnorm_loss:0.0145P:0.00, R:0.03
normal: 0.2639 0.2719  anomaly: 0.2589 0.2715	P:0.00, R:0.00
Pixel Auroc:0.202, Sample Auroc0.280, Pixel Aupro0.0
test_fnorm_loss: 0.0690 test_afnorm_loss: 0.0178
  2%|▏         | 2/100 [00:33<25:04, 15.35s/it]epoch [2/100], focal_loss:0.0839	, anomaly_loss:0.6017	fnorm_loss:0.0634, a_fnorm_loss:0.0139P:0.00, R:0.00
  3%|▎         | 3/100 [00:42<20:10, 12.48s/it]epoch [3/100], focal_loss:0.0829	, anomaly_loss:0.6219	fnorm_loss:0.0583, a_fnorm_loss:0.0129P:0.00, R:0.00
  4%|▍         | 4/100 [00:51<17:55, 11.21s/it]epoch [4/100], focal_loss:0.0825	, anomaly_loss:0.6154	fnorm_loss:0.0573, a_fnorm_loss:0.0131P:0.00, R:0.02
  5%|▌         | 5/100 [01:13<23:39, 14.94s/it]epoch [5/100], focal_loss:0.0753	, anomaly_loss:0.6283	fnorm_loss:0.0531, a_fnorm_loss:0.0120P:0.00, R:0.00
normal: 0.2076 0.2123  anomaly: 0.2038 0.2122	P:0.00, R:0.00
Pixel Auroc:0.236, Sample Auroc0.268, Pixel Aupro0.0
test_fnorm_loss: 0.0542 test_afnorm_loss: 0.0143
  6%|▌         | 6/100 [01:22<20:15, 12.93s/it]epoch [6/100], focal_loss:0.0796	, anomaly_loss:0.6303	fnorm_loss:0.0520, a_fnorm_loss:0.0117P:0.00, R:0.00
  7%|▋         | 7/100 [01:31<18:12, 11.75s/it]epoch [7/100], focal_loss:0.0770	, anomaly_loss:0.6370	fnorm_loss:0.0513, a_fnorm_loss:0.0116P:0.00, R:0.00
  8%|▊         | 8/100 [01:41<16:55, 11.04s/it]epoch [8/100], focal_loss:0.0761	, anomaly_loss:0.6307	fnorm_loss:0.0521, a_fnorm_loss:0.0119P:0.00, R:0.00
  9%|▉         | 9/100 [01:50<15:57, 10.52s/it]epoch [9/100], focal_loss:0.0806	, anomaly_loss:0.6348	fnorm_loss:0.0505, a_fnorm_loss:0.0114P:0.00, R:0.00
 10%|█         | 10/100 [02:13<21:22, 14.25s/it]epoch [10/100], focal_loss:0.0759	, anomaly_loss:0.6277	fnorm_loss:0.0509, a_fnorm_loss:0.0123P:0.00, R:0.00
normal: 0.1989 0.2039  anomaly: 0.1928 0.2040	P:0.00, R:0.00
Pixel Auroc:0.330, Sample Auroc0.294, Pixel Aupro0.0
test_fnorm_loss: 0.0514 test_afnorm_loss: 0.0141
 11%|█         | 11/100 [02:22<18:52, 12.72s/it]epoch [11/100], focal_loss:0.0750	, anomaly_loss:0.6267	fnorm_loss:0.0485, a_fnorm_loss:0.0118P:0.00, R:0.02
 12%|█▏        | 12/100 [02:32<17:16, 11.78s/it]epoch [12/100], focal_loss:0.0763	, anomaly_loss:0.6159	fnorm_loss:0.0491, a_fnorm_loss:0.0133P:0.05, R:0.03
 13%|█▎        | 13/100 [02:41<16:06, 11.11s/it]epoch [13/100], focal_loss:0.0581	, anomaly_loss:0.5310	fnorm_loss:0.0428, a_fnorm_loss:0.0243P:0.34, R:0.54
 14%|█▍        | 14/100 [02:51<15:14, 10.63s/it]epoch [14/100], focal_loss:0.0403	, anomaly_loss:0.4728	fnorm_loss:0.0351, a_fnorm_loss:0.0320P:0.45, R:0.89
 15%|█▌        | 15/100 [03:17<21:50, 15.42s/it]epoch [15/100], focal_loss:0.0464	, anomaly_loss:0.4915	fnorm_loss:0.0313, a_fnorm_loss:0.0309P:0.49, R:0.79
normal: 0.2807 0.5153  anomaly: 0.4514 0.5433	P:0.25, R:0.67
Pixel Auroc:0.966, Sample Auroc0.815, Pixel Aupro0.0
test_fnorm_loss: 0.0358 test_afnorm_loss: 0.0420
 16%|█▌        | 16/100 [03:26<18:59, 13.56s/it]epoch [16/100], focal_loss:0.0350	, anomaly_loss:0.4500	fnorm_loss:0.0283, a_fnorm_loss:0.0338P:0.44, R:0.93
 17%|█▋        | 17/100 [03:36<17:01, 12.31s/it]epoch [17/100], focal_loss:0.0295	, anomaly_loss:0.4454	fnorm_loss:0.0250, a_fnorm_loss:0.0368P:0.51, R:0.93
 18%|█▊        | 18/100 [03:45<15:32, 11.37s/it]epoch [18/100], focal_loss:0.0272	, anomaly_loss:0.4415	fnorm_loss:0.0227, a_fnorm_loss:0.0372P:0.53, R:0.93
 19%|█▉        | 19/100 [03:54<14:27, 10.71s/it]epoch [19/100], focal_loss:0.0265	, anomaly_loss:0.4439	fnorm_loss:0.0213, a_fnorm_loss:0.0381P:0.50, R:0.92
 20%|██        | 20/100 [04:20<20:18, 15.24s/it]epoch [20/100], focal_loss:0.0243	, anomaly_loss:0.4429	fnorm_loss:0.0201, a_fnorm_loss:0.0387P:0.56, R:0.92
normal: 0.0782 0.4737  anomaly: 0.1830 0.5756	P:0.53, R:0.55
Pixel Auroc:0.975, Sample Auroc0.952, Pixel Aupro0.0
test_fnorm_loss: 0.0192 test_afnorm_loss: 0.0377
 21%|██        | 21/100 [04:30<17:51, 13.56s/it]epoch [21/100], focal_loss:0.0279	, anomaly_loss:0.4455	fnorm_loss:0.0194, a_fnorm_loss:0.0379P:0.53, R:0.92
 22%|██▏       | 22/100 [04:40<16:13, 12.48s/it]epoch [22/100], focal_loss:0.0207	, anomaly_loss:0.4379	fnorm_loss:0.0181, a_fnorm_loss:0.0404P:0.56, R:0.94
 23%|██▎       | 23/100 [04:49<14:45, 11.50s/it]epoch [23/100], focal_loss:0.0269	, anomaly_loss:0.4444	fnorm_loss:0.0176, a_fnorm_loss:0.0394P:0.55, R:0.91
 24%|██▍       | 24/100 [04:58<13:42, 10.82s/it]epoch [24/100], focal_loss:0.0234	, anomaly_loss:0.4364	fnorm_loss:0.0168, a_fnorm_loss:0.0410P:0.59, R:0.92
 25%|██▌       | 25/100 [05:25<19:24, 15.53s/it]epoch [25/100], focal_loss:0.0206	, anomaly_loss:0.4349	fnorm_loss:0.0162, a_fnorm_loss:0.0406P:0.60, R:0.93
normal: 0.0614 0.5116  anomaly: 0.2066 0.6317	P:0.53, R:0.55
Pixel Auroc:0.976, Sample Auroc0.932, Pixel Aupro0.0
test_fnorm_loss: 0.0158 test_afnorm_loss: 0.0432
 26%|██▌       | 26/100 [05:34<16:54, 13.71s/it]epoch [26/100], focal_loss:0.0181	, anomaly_loss:0.4355	fnorm_loss:0.0154, a_fnorm_loss:0.0423P:0.60, R:0.94
 27%|██▋       | 27/100 [05:43<15:01, 12.36s/it]epoch [27/100], focal_loss:0.0187	, anomaly_loss:0.4269	fnorm_loss:0.0148, a_fnorm_loss:0.0424P:0.61, R:0.94
 28%|██▊       | 28/100 [05:52<13:42, 11.43s/it]epoch [28/100], focal_loss:0.0188	, anomaly_loss:0.4298	fnorm_loss:0.0143, a_fnorm_loss:0.0426P:0.65, R:0.94
 29%|██▉       | 29/100 [06:02<12:53, 10.89s/it]epoch [29/100], focal_loss:0.0201	, anomaly_loss:0.4348	fnorm_loss:0.0143, a_fnorm_loss:0.0418P:0.62, R:0.94
 30%|███       | 30/100 [06:29<18:09, 15.56s/it]epoch [30/100], focal_loss:0.0174	, anomaly_loss:0.4276	fnorm_loss:0.0137, a_fnorm_loss:0.0423P:0.59, R:0.94
normal: 0.0509 0.5099  anomaly: 0.1376 0.6579	P:0.56, R:0.47
Pixel Auroc:0.973, Sample Auroc0.922, Pixel Aupro0.0
test_fnorm_loss: 0.0128 test_afnorm_loss: 0.0357
 31%|███       | 31/100 [06:38<15:43, 13.67s/it]epoch [31/100], focal_loss:0.0186	, anomaly_loss:0.4297	fnorm_loss:0.0134, a_fnorm_loss:0.0425P:0.61, R:0.93
 32%|███▏      | 32/100 [06:47<13:55, 12.28s/it]epoch [32/100], focal_loss:0.0188	, anomaly_loss:0.4292	fnorm_loss:0.0131, a_fnorm_loss:0.0420P:0.61, R:0.94
 33%|███▎      | 33/100 [06:56<12:38, 11.33s/it]epoch [33/100], focal_loss:0.0164	, anomaly_loss:0.4197	fnorm_loss:0.0127, a_fnorm_loss:0.0452P:0.66, R:0.95
 34%|███▍      | 34/100 [07:05<11:41, 10.64s/it]epoch [34/100], focal_loss:0.0221	, anomaly_loss:0.4326	fnorm_loss:0.0124, a_fnorm_loss:0.0422P:0.63, R:0.90
 35%|███▌      | 35/100 [07:32<16:46, 15.49s/it]epoch [35/100], focal_loss:0.0167	, anomaly_loss:0.4271	fnorm_loss:0.0122, a_fnorm_loss:0.0435P:0.61, R:0.94
normal: 0.0443 0.4951  anomaly: 0.1093 0.6459	P:0.56, R:0.45
Pixel Auroc:0.974, Sample Auroc0.931, Pixel Aupro0.0
test_fnorm_loss: 0.0115 test_afnorm_loss: 0.0408
 36%|███▌      | 36/100 [07:41<14:29, 13.59s/it]epoch [36/100], focal_loss:0.0156	, anomaly_loss:0.4265	fnorm_loss:0.0118, a_fnorm_loss:0.0436P:0.63, R:0.94
 37%|███▋      | 37/100 [07:50<12:56, 12.32s/it]epoch [37/100], focal_loss:0.0162	, anomaly_loss:0.4218	fnorm_loss:0.0116, a_fnorm_loss:0.0434P:0.64, R:0.94
 38%|███▊      | 38/100 [08:00<11:46, 11.39s/it]epoch [38/100], focal_loss:0.0151	, anomaly_loss:0.4245	fnorm_loss:0.0112, a_fnorm_loss:0.0435P:0.63, R:0.94
 39%|███▉      | 39/100 [08:09<10:54, 10.73s/it]epoch [39/100], focal_loss:0.0155	, anomaly_loss:0.4265	fnorm_loss:0.0110, a_fnorm_loss:0.0435P:0.64, R:0.94
 40%|████      | 40/100 [08:30<13:50, 13.84s/it]epoch [40/100], focal_loss:0.0155	, anomaly_loss:0.4147	fnorm_loss:0.0110, a_fnorm_loss:0.0436P:0.62, R:0.94
normal: 0.0410 0.5207  anomaly: 0.1193 0.6908	P:0.56, R:0.45
Pixel Auroc:0.973, Sample Auroc0.916, Pixel Aupro0.0
test_fnorm_loss: 0.0105 test_afnorm_loss: 0.0395
 41%|████      | 41/100 [08:39<12:16, 12.48s/it]epoch [41/100], focal_loss:0.0182	, anomaly_loss:0.4300	fnorm_loss:0.0109, a_fnorm_loss:0.0441P:0.64, R:0.91
 42%|████▏     | 42/100 [08:48<11:04, 11.45s/it]epoch [42/100], focal_loss:0.0151	, anomaly_loss:0.4182	fnorm_loss:0.0106, a_fnorm_loss:0.0442P:0.59, R:0.95
 43%|████▎     | 43/100 [08:57<10:12, 10.75s/it]epoch [43/100], focal_loss:0.0149	, anomaly_loss:0.4274	fnorm_loss:0.0104, a_fnorm_loss:0.0456P:0.63, R:0.95
 44%|████▍     | 44/100 [09:07<09:39, 10.36s/it]epoch [44/100], focal_loss:0.0146	, anomaly_loss:0.4184	fnorm_loss:0.0102, a_fnorm_loss:0.0453P:0.67, R:0.95
 45%|████▌     | 45/100 [09:27<12:19, 13.44s/it]epoch [45/100], focal_loss:0.0135	, anomaly_loss:0.4234	fnorm_loss:0.0100, a_fnorm_loss:0.0453P:0.65, R:0.95
normal: 0.0393 0.5277  anomaly: 0.1198 0.6790	P:0.56, R:0.48
Pixel Auroc:0.976, Sample Auroc0.919, Pixel Aupro0.0
test_fnorm_loss: 0.0096 test_afnorm_loss: 0.0386
 46%|████▌     | 46/100 [09:37<10:58, 12.20s/it]epoch [46/100], focal_loss:0.0145	, anomaly_loss:0.4213	fnorm_loss:0.0100, a_fnorm_loss:0.0453P:0.66, R:0.95
 47%|████▋     | 47/100 [09:46<09:57, 11.28s/it]epoch [47/100], focal_loss:0.0148	, anomaly_loss:0.4161	fnorm_loss:0.0099, a_fnorm_loss:0.0447P:0.63, R:0.95
 48%|████▊     | 48/100 [09:55<09:09, 10.58s/it]epoch [48/100], focal_loss:0.0150	, anomaly_loss:0.4174	fnorm_loss:0.0098, a_fnorm_loss:0.0453P:0.65, R:0.95
 49%|████▉     | 49/100 [10:04<08:42, 10.24s/it]epoch [49/100], focal_loss:0.0149	, anomaly_loss:0.4202	fnorm_loss:0.0098, a_fnorm_loss:0.0420P:0.64, R:0.95
 50%|█████     | 50/100 [10:26<11:18, 13.57s/it]epoch [50/100], focal_loss:0.0147	, anomaly_loss:0.4211	fnorm_loss:0.0097, a_fnorm_loss:0.0464P:0.68, R:0.96
normal: 0.0336 0.5298  anomaly: 0.1207 0.6883	P:0.56, R:0.51
Pixel Auroc:0.977, Sample Auroc0.925, Pixel Aupro0.0
test_fnorm_loss: 0.0090 test_afnorm_loss: 0.0437
 51%|█████     | 51/100 [10:35<09:58, 12.21s/it]epoch [51/100], focal_loss:0.0150	, anomaly_loss:0.4209	fnorm_loss:0.0094, a_fnorm_loss:0.0452P:0.65, R:0.95
 52%|█████▏    | 52/100 [10:44<09:03, 11.33s/it]epoch [52/100], focal_loss:0.0149	, anomaly_loss:0.4178	fnorm_loss:0.0095, a_fnorm_loss:0.0450P:0.66, R:0.94
 53%|█████▎    | 53/100 [10:54<08:32, 10.90s/it]epoch [53/100], focal_loss:0.0147	, anomaly_loss:0.4235	fnorm_loss:0.0095, a_fnorm_loss:0.0449P:0.68, R:0.96
 54%|█████▍    | 54/100 [11:03<08:03, 10.52s/it]epoch [54/100], focal_loss:0.0134	, anomaly_loss:0.4183	fnorm_loss:0.0091, a_fnorm_loss:0.0465P:0.67, R:0.95
 55%|█████▌    | 55/100 [11:25<10:21, 13.81s/it]epoch [55/100], focal_loss:0.0136	, anomaly_loss:0.4184	fnorm_loss:0.0090, a_fnorm_loss:0.0452P:0.66, R:0.94
normal: 0.0329 0.5500  anomaly: 0.1455 0.6942	P:0.56, R:0.51
Pixel Auroc:0.977, Sample Auroc0.909, Pixel Aupro0.0
test_fnorm_loss: 0.0085 test_afnorm_loss: 0.0386
 56%|█████▌    | 56/100 [11:34<09:05, 12.41s/it]epoch [56/100], focal_loss:0.0126	, anomaly_loss:0.4195	fnorm_loss:0.0087, a_fnorm_loss:0.0464P:0.66, R:0.95
 57%|█████▋    | 57/100 [11:43<08:11, 11.43s/it]epoch [57/100], focal_loss:0.0118	, anomaly_loss:0.4115	fnorm_loss:0.0088, a_fnorm_loss:0.0475P:0.67, R:0.96
 58%|█████▊    | 58/100 [11:52<07:31, 10.75s/it]epoch [58/100], focal_loss:0.0122	, anomaly_loss:0.4120	fnorm_loss:0.0086, a_fnorm_loss:0.0456P:0.66, R:0.95
 59%|█████▉    | 59/100 [12:02<07:02, 10.30s/it]epoch [59/100], focal_loss:0.0148	, anomaly_loss:0.4186	fnorm_loss:0.0086, a_fnorm_loss:0.0465P:0.62, R:0.94
 60%|██████    | 60/100 [12:23<09:02, 13.55s/it]epoch [60/100], focal_loss:0.0146	, anomaly_loss:0.4217	fnorm_loss:0.0088, a_fnorm_loss:0.0458P:0.66, R:0.94
normal: 0.0526 0.6275  anomaly: 0.2129 0.7194	P:0.49, R:0.56
Pixel Auroc:0.976, Sample Auroc0.875, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0434
 61%|██████    | 61/100 [12:32<07:55, 12.20s/it]epoch [61/100], focal_loss:0.0135	, anomaly_loss:0.4149	fnorm_loss:0.0085, a_fnorm_loss:0.0470P:0.65, R:0.96
 62%|██████▏   | 62/100 [12:41<07:07, 11.25s/it]epoch [62/100], focal_loss:0.0141	, anomaly_loss:0.4167	fnorm_loss:0.0084, a_fnorm_loss:0.0454P:0.68, R:0.94
 63%|██████▎   | 63/100 [12:50<06:32, 10.61s/it]epoch [63/100], focal_loss:0.0159	, anomaly_loss:0.4165	fnorm_loss:0.0088, a_fnorm_loss:0.0456P:0.68, R:0.95
 64%|██████▍   | 64/100 [12:59<06:04, 10.11s/it]epoch [64/100], focal_loss:0.0266	, anomaly_loss:0.4447	fnorm_loss:0.0086, a_fnorm_loss:0.0447P:0.57, R:0.78
 65%|██████▌   | 65/100 [13:20<07:53, 13.52s/it]epoch [65/100], focal_loss:0.0204	, anomaly_loss:0.4360	fnorm_loss:0.0084, a_fnorm_loss:0.0460P:0.64, R:0.92
normal: 0.0334 0.5448  anomaly: 0.1412 0.6386	P:0.54, R:0.53
Pixel Auroc:0.977, Sample Auroc0.918, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0435
 66%|██████▌   | 66/100 [13:29<06:54, 12.19s/it]epoch [66/100], focal_loss:0.0129	, anomaly_loss:0.4199	fnorm_loss:0.0082, a_fnorm_loss:0.0467P:0.66, R:0.96
 67%|██████▋   | 67/100 [13:39<06:14, 11.35s/it]epoch [67/100], focal_loss:0.0139	, anomaly_loss:0.4151	fnorm_loss:0.0084, a_fnorm_loss:0.0462P:0.64, R:0.96
 68%|██████▊   | 68/100 [13:48<05:42, 10.70s/it]epoch [68/100], focal_loss:0.0126	, anomaly_loss:0.4158	fnorm_loss:0.0081, a_fnorm_loss:0.0459P:0.68, R:0.95
 69%|██████▉   | 69/100 [13:57<05:17, 10.23s/it]epoch [69/100], focal_loss:0.0155	, anomaly_loss:0.4166	fnorm_loss:0.0082, a_fnorm_loss:0.0456P:0.63, R:0.94
 70%|███████   | 70/100 [14:19<06:50, 13.69s/it]epoch [70/100], focal_loss:0.0141	, anomaly_loss:0.4185	fnorm_loss:0.0081, a_fnorm_loss:0.0460P:0.66, R:0.94
normal: 0.0309 0.5606  anomaly: 0.1366 0.6930	P:0.54, R:0.54
Pixel Auroc:0.978, Sample Auroc0.919, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0465
 71%|███████   | 71/100 [14:28<05:58, 12.36s/it]epoch [71/100], focal_loss:0.0129	, anomaly_loss:0.4125	fnorm_loss:0.0081, a_fnorm_loss:0.0463P:0.67, R:0.95
 72%|███████▏  | 72/100 [14:37<05:18, 11.36s/it]epoch [72/100], focal_loss:0.0130	, anomaly_loss:0.4157	fnorm_loss:0.0080, a_fnorm_loss:0.0463P:0.65, R:0.96
 73%|███████▎  | 73/100 [14:46<04:50, 10.74s/it]epoch [73/100], focal_loss:0.0138	, anomaly_loss:0.4228	fnorm_loss:0.0080, a_fnorm_loss:0.0458P:0.64, R:0.94
 74%|███████▍  | 74/100 [14:56<04:26, 10.24s/it]epoch [74/100], focal_loss:0.0128	, anomaly_loss:0.4051	fnorm_loss:0.0080, a_fnorm_loss:0.0471P:0.69, R:0.96
 75%|███████▌  | 75/100 [15:17<05:40, 13.60s/it]epoch [75/100], focal_loss:0.0164	, anomaly_loss:0.4233	fnorm_loss:0.0083, a_fnorm_loss:0.0434P:0.65, R:0.92
normal: 0.0281 0.5797  anomaly: 0.0950 0.6977	P:0.55, R:0.50
Pixel Auroc:0.977, Sample Auroc0.906, Pixel Aupro0.0
test_fnorm_loss: 0.0075 test_afnorm_loss: 0.0414
 76%|███████▌  | 76/100 [15:26<04:54, 12.26s/it]epoch [76/100], focal_loss:0.0129	, anomaly_loss:0.4138	fnorm_loss:0.0078, a_fnorm_loss:0.0468P:0.67, R:0.95
 77%|███████▋  | 77/100 [15:35<04:19, 11.30s/it]epoch [77/100], focal_loss:0.0132	, anomaly_loss:0.4100	fnorm_loss:0.0078, a_fnorm_loss:0.0456P:0.65, R:0.95
 78%|███████▊  | 78/100 [15:44<03:54, 10.65s/it]epoch [78/100], focal_loss:0.0122	, anomaly_loss:0.4038	fnorm_loss:0.0076, a_fnorm_loss:0.0467P:0.68, R:0.95
 79%|███████▉  | 79/100 [15:54<03:35, 10.26s/it]epoch [79/100], focal_loss:0.0136	, anomaly_loss:0.4112	fnorm_loss:0.0078, a_fnorm_loss:0.0461P:0.66, R:0.95
 80%|████████  | 80/100 [16:21<05:06, 15.34s/it]epoch [80/100], focal_loss:0.0135	, anomaly_loss:0.4161	fnorm_loss:0.0079, a_fnorm_loss:0.0469P:0.67, R:0.95
normal: 0.0255 0.5537  anomaly: 0.0871 0.7068	P:0.58, R:0.48
Pixel Auroc:0.977, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0417
 81%|████████  | 81/100 [16:30<04:15, 13.46s/it]epoch [81/100], focal_loss:0.0121	, anomaly_loss:0.4038	fnorm_loss:0.0077, a_fnorm_loss:0.0468P:0.65, R:0.96
 82%|████████▏ | 82/100 [16:39<03:38, 12.15s/it]epoch [82/100], focal_loss:0.0141	, anomaly_loss:0.4166	fnorm_loss:0.0075, a_fnorm_loss:0.0469P:0.69, R:0.94
 83%|████████▎ | 83/100 [16:48<03:11, 11.24s/it]epoch [83/100], focal_loss:0.0118	, anomaly_loss:0.4080	fnorm_loss:0.0077, a_fnorm_loss:0.0472P:0.66, R:0.97
 84%|████████▍ | 84/100 [16:57<02:48, 10.56s/it]epoch [84/100], focal_loss:0.0114	, anomaly_loss:0.4149	fnorm_loss:0.0074, a_fnorm_loss:0.0475P:0.68, R:0.96
 85%|████████▌ | 85/100 [17:17<03:22, 13.50s/it]epoch [85/100], focal_loss:0.0119	, anomaly_loss:0.4151	fnorm_loss:0.0075, a_fnorm_loss:0.0467P:0.68, R:0.95
normal: 0.0263 0.6018  anomaly: 0.1210 0.7204	P:0.55, R:0.52
Pixel Auroc:0.978, Sample Auroc0.901, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0438
 86%|████████▌ | 86/100 [17:26<02:50, 12.15s/it]epoch [86/100], focal_loss:0.0118	, anomaly_loss:0.4072	fnorm_loss:0.0075, a_fnorm_loss:0.0467P:0.68, R:0.95
 87%|████████▋ | 87/100 [17:36<02:26, 11.28s/it]epoch [87/100], focal_loss:0.0112	, anomaly_loss:0.4088	fnorm_loss:0.0074, a_fnorm_loss:0.0474P:0.70, R:0.96
 88%|████████▊ | 88/100 [17:45<02:07, 10.62s/it]epoch [88/100], focal_loss:0.0118	, anomaly_loss:0.4155	fnorm_loss:0.0074, a_fnorm_loss:0.0474P:0.71, R:0.96
 89%|████████▉ | 89/100 [17:54<01:52, 10.18s/it]epoch [89/100], focal_loss:0.0125	, anomaly_loss:0.4149	fnorm_loss:0.0076, a_fnorm_loss:0.0462P:0.66, R:0.95
 90%|█████████ | 90/100 [18:15<02:15, 13.58s/it]epoch [90/100], focal_loss:0.0118	, anomaly_loss:0.4094	fnorm_loss:0.0075, a_fnorm_loss:0.0476P:0.67, R:0.95
normal: 0.0263 0.5823  anomaly: 0.1056 0.7144	P:0.57, R:0.51
Pixel Auroc:0.978, Sample Auroc0.911, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0439
 91%|█████████ | 91/100 [18:25<01:50, 12.25s/it]epoch [91/100], focal_loss:0.0125	, anomaly_loss:0.4034	fnorm_loss:0.0077, a_fnorm_loss:0.0480P:0.69, R:0.96
 92%|█████████▏| 92/100 [18:34<01:30, 11.30s/it]epoch [92/100], focal_loss:0.0139	, anomaly_loss:0.4195	fnorm_loss:0.0077, a_fnorm_loss:0.0480P:0.68, R:0.95
 93%|█████████▎| 93/100 [18:43<01:14, 10.62s/it]epoch [93/100], focal_loss:0.0111	, anomaly_loss:0.4057	fnorm_loss:0.0075, a_fnorm_loss:0.0474P:0.66, R:0.96
 94%|█████████▍| 94/100 [18:52<01:01, 10.23s/it]epoch [94/100], focal_loss:0.0127	, anomaly_loss:0.4088	fnorm_loss:0.0075, a_fnorm_loss:0.0467P:0.66, R:0.95
 95%|█████████▌| 95/100 [19:14<01:08, 13.63s/it]epoch [95/100], focal_loss:0.0118	, anomaly_loss:0.4082	fnorm_loss:0.0074, a_fnorm_loss:0.0467P:0.69, R:0.95
normal: 0.0279 0.5967  anomaly: 0.1121 0.7191	P:0.56, R:0.51
Pixel Auroc:0.978, Sample Auroc0.904, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0434
 96%|█████████▌| 96/100 [19:23<00:49, 12.26s/it]epoch [96/100], focal_loss:0.0118	, anomaly_loss:0.4058	fnorm_loss:0.0075, a_fnorm_loss:0.0481P:0.70, R:0.97
 97%|█████████▋| 97/100 [19:32<00:33, 11.33s/it]epoch [97/100], focal_loss:0.0123	, anomaly_loss:0.4114	fnorm_loss:0.0076, a_fnorm_loss:0.0473P:0.69, R:0.95
 98%|█████████▊| 98/100 [19:41<00:21, 10.64s/it]epoch [98/100], focal_loss:0.0153	, anomaly_loss:0.4142	fnorm_loss:0.0075, a_fnorm_loss:0.0466P:0.66, R:0.94
 99%|█████████▉| 99/100 [19:50<00:10, 10.15s/it]epoch [99/100], focal_loss:0.0125	, anomaly_loss:0.4074	fnorm_loss:0.0076, a_fnorm_loss:0.0461P:0.66, R:0.96
100%|██████████| 100/100 [20:11<00:00, 13.41s/it]100%|██████████| 100/100 [20:11<00:00, 12.11s/it]
epoch [100/100], focal_loss:0.0111	, anomaly_loss:0.4132	fnorm_loss:0.0074, a_fnorm_loss:0.0474P:0.66, R:0.96
normal: 0.0268 0.5871  anomaly: 0.1159 0.7162	P:0.56, R:0.50
Pixel Auroc:0.978, Sample Auroc0.903, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0432
training Stubborn Student...
wood
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<11:37,  5.86s/it]epoch [1/120], kd_loss:4.3912
  2%|▏         | 2/120 [00:11<11:27,  5.83s/it]epoch [2/120], kd_loss:3.2869
  2%|▎         | 3/120 [00:17<11:17,  5.79s/it]epoch [3/120], kd_loss:2.9054
  3%|▎         | 4/120 [00:23<11:10,  5.78s/it]epoch [4/120], kd_loss:2.3423
  4%|▍         | 5/120 [00:28<11:02,  5.76s/it]epoch [5/120], kd_loss:2.5338
  5%|▌         | 6/120 [00:34<11:00,  5.79s/it]epoch [6/120], kd_loss:2.1481
  6%|▌         | 7/120 [00:40<10:54,  5.79s/it]epoch [7/120], kd_loss:2.0011
  7%|▋         | 8/120 [00:46<10:49,  5.80s/it]epoch [8/120], kd_loss:2.0512
  8%|▊         | 9/120 [00:52<10:43,  5.80s/it]epoch [9/120], kd_loss:1.9151
  8%|▊         | 10/120 [01:09<17:02,  9.30s/it]epoch [10/120], kd_loss:1.8709
normal: 1.1774 2.3849  anomaly: 1.4654 2.8224
thresh: 1.6553755720466075
fpr: 0.21052631578947367 fnr 0.016666666666666666
Pixel Auroc:0.974, Sample Auroc0.967, Pixel Aupro0.0
  9%|▉         | 11/120 [01:15<14:58,  8.24s/it]epoch [11/120], kd_loss:2.1695
 10%|█         | 12/120 [01:20<13:28,  7.49s/it]epoch [12/120], kd_loss:1.9274
 11%|█         | 13/120 [01:26<12:30,  7.02s/it]epoch [13/120], kd_loss:1.9563
 12%|█▏        | 14/120 [01:32<11:43,  6.64s/it]epoch [14/120], kd_loss:1.7914
 12%|█▎        | 15/120 [01:38<11:09,  6.38s/it]epoch [15/120], kd_loss:1.7560
 13%|█▎        | 16/120 [01:44<10:42,  6.18s/it]epoch [16/120], kd_loss:1.8269
 14%|█▍        | 17/120 [01:49<10:24,  6.06s/it]epoch [17/120], kd_loss:1.7427
 15%|█▌        | 18/120 [01:55<10:10,  5.99s/it]epoch [18/120], kd_loss:2.3831
 16%|█▌        | 19/120 [02:01<09:59,  5.94s/it]epoch [19/120], kd_loss:3.0422
 17%|█▋        | 20/120 [02:20<16:13,  9.74s/it]epoch [20/120], kd_loss:1.9649
normal: 1.2079 2.2892  anomaly: 1.4507 2.7495
thresh: 1.782833497152544
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.974, Sample Auroc0.971, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:25<14:06,  8.55s/it]epoch [21/120], kd_loss:1.8648
 18%|█▊        | 22/120 [02:31<12:35,  7.71s/it]epoch [22/120], kd_loss:1.8291
 19%|█▉        | 23/120 [02:37<11:32,  7.14s/it]epoch [23/120], kd_loss:1.7853
 20%|██        | 24/120 [02:43<10:47,  6.74s/it]epoch [24/120], kd_loss:1.7763
 21%|██        | 25/120 [02:49<10:12,  6.45s/it]epoch [25/120], kd_loss:1.7498
 22%|██▏       | 26/120 [02:54<09:46,  6.24s/it]epoch [26/120], kd_loss:1.9434
 22%|██▎       | 27/120 [03:00<09:28,  6.11s/it]epoch [27/120], kd_loss:1.7676
 23%|██▎       | 28/120 [03:06<09:14,  6.03s/it]epoch [28/120], kd_loss:1.7193
 24%|██▍       | 29/120 [03:12<09:04,  5.98s/it]epoch [29/120], kd_loss:1.6935
 25%|██▌       | 30/120 [03:28<13:41,  9.13s/it]epoch [30/120], kd_loss:1.6813
normal: 1.1272 2.1835  anomaly: 1.3456 2.8028
thresh: 1.650677133818686
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.973, Sample Auroc0.971, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:34<12:01,  8.11s/it]epoch [31/120], kd_loss:1.7627
 27%|██▋       | 32/120 [03:40<10:51,  7.40s/it]epoch [32/120], kd_loss:1.6637
 28%|██▊       | 33/120 [03:46<10:01,  6.92s/it]epoch [33/120], kd_loss:1.7063
 28%|██▊       | 34/120 [03:51<09:27,  6.59s/it]epoch [34/120], kd_loss:1.6867
 29%|██▉       | 35/120 [03:57<08:59,  6.35s/it]epoch [35/120], kd_loss:1.6417
 30%|███       | 36/120 [04:03<08:39,  6.19s/it]epoch [36/120], kd_loss:1.7293
 31%|███       | 37/120 [04:09<08:24,  6.07s/it]epoch [37/120], kd_loss:1.6752
 32%|███▏      | 38/120 [04:15<08:12,  6.00s/it]epoch [38/120], kd_loss:1.6498
 32%|███▎      | 39/120 [04:20<08:02,  5.95s/it]epoch [39/120], kd_loss:1.7053
 33%|███▎      | 40/120 [04:37<12:18,  9.23s/it]epoch [40/120], kd_loss:1.7254
normal: 1.0166 2.2608  anomaly: 1.3385 2.8419
thresh: 1.5718784478347925
fpr: 0.21052631578947367 fnr 0.016666666666666666
Pixel Auroc:0.973, Sample Auroc0.970, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:43<10:46,  8.18s/it]epoch [41/120], kd_loss:1.6823
 35%|███▌      | 42/120 [04:49<09:43,  7.47s/it]epoch [42/120], kd_loss:1.6589
 36%|███▌      | 43/120 [04:55<08:56,  6.96s/it]epoch [43/120], kd_loss:1.6165
 37%|███▋      | 44/120 [05:00<08:23,  6.62s/it]epoch [44/120], kd_loss:1.5956
 38%|███▊      | 45/120 [05:06<07:58,  6.38s/it]epoch [45/120], kd_loss:1.7416
 38%|███▊      | 46/120 [05:12<07:39,  6.21s/it]epoch [46/120], kd_loss:1.7045
 39%|███▉      | 47/120 [05:18<07:24,  6.09s/it]epoch [47/120], kd_loss:1.6471
 40%|████      | 48/120 [05:24<07:12,  6.00s/it]epoch [48/120], kd_loss:1.6548
 41%|████      | 49/120 [05:30<07:02,  5.95s/it]epoch [49/120], kd_loss:1.6000
 42%|████▏     | 50/120 [05:46<10:43,  9.19s/it]epoch [50/120], kd_loss:1.5874
normal: 0.8916 2.1037  anomaly: 1.2918 2.7259
thresh: 1.5686363668522307
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.976, Sample Auroc0.970, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:52<09:22,  8.16s/it]epoch [51/120], kd_loss:1.5934
 43%|████▎     | 52/120 [05:58<08:24,  7.43s/it]epoch [52/120], kd_loss:1.5681
 44%|████▍     | 53/120 [06:04<07:44,  6.93s/it]epoch [53/120], kd_loss:1.5599
 45%|████▌     | 54/120 [06:09<07:16,  6.61s/it]epoch [54/120], kd_loss:1.5541
 46%|████▌     | 55/120 [06:15<06:54,  6.38s/it]epoch [55/120], kd_loss:1.5482
 47%|████▋     | 56/120 [06:21<06:36,  6.19s/it]epoch [56/120], kd_loss:1.5596
 48%|████▊     | 57/120 [06:27<06:23,  6.09s/it]epoch [57/120], kd_loss:1.5573
 48%|████▊     | 58/120 [06:33<06:12,  6.01s/it]epoch [58/120], kd_loss:1.7542
 49%|████▉     | 59/120 [06:38<06:02,  5.95s/it]epoch [59/120], kd_loss:1.5999
 50%|█████     | 60/120 [06:57<09:38,  9.65s/it]epoch [60/120], kd_loss:1.5577
normal: 0.8856 2.0881  anomaly: 1.3282 2.6956
thresh: 1.4853301491146225
fpr: 0.21052631578947367 fnr 0.016666666666666666
Pixel Auroc:0.976, Sample Auroc0.972, Pixel Aupro0.0
 51%|█████     | 61/120 [07:03<08:20,  8.48s/it]epoch [61/120], kd_loss:1.5491
 52%|█████▏    | 62/120 [07:08<07:24,  7.66s/it]epoch [62/120], kd_loss:1.5385
 52%|█████▎    | 63/120 [07:14<06:44,  7.09s/it]epoch [63/120], kd_loss:1.8762
 53%|█████▎    | 64/120 [07:20<06:14,  6.70s/it]epoch [64/120], kd_loss:1.6401
 54%|█████▍    | 65/120 [07:26<05:53,  6.42s/it]epoch [65/120], kd_loss:1.6407
 55%|█████▌    | 66/120 [07:31<05:36,  6.23s/it]epoch [66/120], kd_loss:1.6333
 56%|█████▌    | 67/120 [07:37<05:23,  6.10s/it]epoch [67/120], kd_loss:1.6069
 57%|█████▋    | 68/120 [07:43<05:12,  6.02s/it]epoch [68/120], kd_loss:1.6009
 57%|█████▊    | 69/120 [07:49<05:03,  5.95s/it]epoch [69/120], kd_loss:1.5761
 58%|█████▊    | 70/120 [08:06<07:49,  9.39s/it]epoch [70/120], kd_loss:1.5762
normal: 0.9019 2.0879  anomaly: 1.2812 2.7017
thresh: 1.4135044059551802
fpr: 0.21052631578947367 fnr 0.016666666666666666
Pixel Auroc:0.975, Sample Auroc0.969, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:12<06:47,  8.31s/it]epoch [71/120], kd_loss:1.5978
 60%|██████    | 72/120 [08:18<06:02,  7.55s/it]epoch [72/120], kd_loss:1.6648
 61%|██████    | 73/120 [08:24<05:29,  7.01s/it]epoch [73/120], kd_loss:1.9004
 62%|██████▏   | 74/120 [08:29<05:04,  6.63s/it]epoch [74/120], kd_loss:1.7076
 62%|██████▎   | 75/120 [08:35<04:46,  6.37s/it]epoch [75/120], kd_loss:1.6511
 63%|██████▎   | 76/120 [08:41<04:34,  6.23s/it]epoch [76/120], kd_loss:1.6322
 64%|██████▍   | 77/120 [08:47<04:22,  6.10s/it]epoch [77/120], kd_loss:1.6280
 65%|██████▌   | 78/120 [08:53<04:12,  6.01s/it]epoch [78/120], kd_loss:1.5894
 66%|██████▌   | 79/120 [08:58<04:03,  5.95s/it]epoch [79/120], kd_loss:1.7874
 67%|██████▋   | 80/120 [09:17<06:31,  9.78s/it]epoch [80/120], kd_loss:2.3212
normal: 1.5743 2.2170  anomaly: 1.8400 2.7022
thresh: 1.8637066663641322
fpr: 0.10526315789473684 fnr 0.03333333333333333
Pixel Auroc:0.968, Sample Auroc0.981, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:23<05:34,  8.58s/it]epoch [81/120], kd_loss:2.1577
 68%|██████▊   | 82/120 [09:29<04:55,  7.77s/it]epoch [82/120], kd_loss:1.7291
 69%|██████▉   | 83/120 [09:34<04:25,  7.17s/it]epoch [83/120], kd_loss:1.6567
 70%|███████   | 84/120 [09:40<04:03,  6.76s/it]epoch [84/120], kd_loss:1.6330
 71%|███████   | 85/120 [09:46<03:46,  6.46s/it]epoch [85/120], kd_loss:1.6608
 72%|███████▏  | 86/120 [09:52<03:32,  6.26s/it]epoch [86/120], kd_loss:1.6479
 72%|███████▎  | 87/120 [09:58<03:21,  6.11s/it]epoch [87/120], kd_loss:1.6320
 73%|███████▎  | 88/120 [10:03<03:12,  6.00s/it]epoch [88/120], kd_loss:1.6254
 74%|███████▍  | 89/120 [10:09<03:04,  5.95s/it]epoch [89/120], kd_loss:1.6177
 75%|███████▌  | 90/120 [10:26<04:40,  9.34s/it]epoch [90/120], kd_loss:1.5954
normal: 0.9074 1.9266  anomaly: 1.3157 2.6372
thresh: 1.4385904153349647
fpr: 0.21052631578947367 fnr 0.016666666666666666
Pixel Auroc:0.974, Sample Auroc0.975, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:32<03:59,  8.27s/it]epoch [91/120], kd_loss:1.6070
 77%|███████▋  | 92/120 [10:38<03:30,  7.51s/it]epoch [92/120], kd_loss:1.9727
 78%|███████▊  | 93/120 [10:44<03:09,  7.00s/it]epoch [93/120], kd_loss:2.3895
 78%|███████▊  | 94/120 [10:50<02:52,  6.63s/it]epoch [94/120], kd_loss:1.8001
 79%|███████▉  | 95/120 [10:55<02:39,  6.39s/it]epoch [95/120], kd_loss:1.7803
 80%|████████  | 96/120 [11:01<02:28,  6.19s/it]epoch [96/120], kd_loss:1.7726
 81%|████████  | 97/120 [11:07<02:20,  6.09s/it]epoch [97/120], kd_loss:1.7541
 82%|████████▏ | 98/120 [11:13<02:12,  6.02s/it]epoch [98/120], kd_loss:1.7401
 82%|████████▎ | 99/120 [11:19<02:05,  5.97s/it]epoch [99/120], kd_loss:1.7455
 83%|████████▎ | 100/120 [11:36<03:05,  9.29s/it]epoch [100/120], kd_loss:1.7347
normal: 1.0466 2.1142  anomaly: 1.3770 2.6879
thresh: 1.6448587539555188
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.975, Sample Auroc0.968, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:41<02:36,  8.23s/it]epoch [101/120], kd_loss:1.7304
 85%|████████▌ | 102/120 [11:47<02:14,  7.48s/it]epoch [102/120], kd_loss:1.7269
 86%|████████▌ | 103/120 [11:53<01:58,  6.95s/it]epoch [103/120], kd_loss:1.7246
 87%|████████▋ | 104/120 [11:59<01:45,  6.60s/it]epoch [104/120], kd_loss:1.7215
 88%|████████▊ | 105/120 [12:04<01:35,  6.36s/it]epoch [105/120], kd_loss:1.7142
 88%|████████▊ | 106/120 [12:10<01:26,  6.20s/it]epoch [106/120], kd_loss:1.7139
 89%|████████▉ | 107/120 [12:16<01:19,  6.09s/it]epoch [107/120], kd_loss:1.7068
 90%|█████████ | 108/120 [12:22<01:11,  6.00s/it]epoch [108/120], kd_loss:1.7020
 91%|█████████ | 109/120 [12:28<01:05,  5.94s/it]epoch [109/120], kd_loss:1.7116
 92%|█████████▏| 110/120 [12:44<01:31,  9.14s/it]epoch [110/120], kd_loss:1.7027
normal: 0.9909 2.1627  anomaly: 1.3380 2.7184
thresh: 1.6316870488504143
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.974, Sample Auroc0.967, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:50<01:13,  8.12s/it]epoch [111/120], kd_loss:1.7035
 93%|█████████▎| 112/120 [12:56<00:59,  7.42s/it]epoch [112/120], kd_loss:1.7012
 94%|█████████▍| 113/120 [13:01<00:48,  6.90s/it]epoch [113/120], kd_loss:1.6969
 95%|█████████▌| 114/120 [13:07<00:39,  6.57s/it]epoch [114/120], kd_loss:1.6987
 96%|█████████▌| 115/120 [13:13<00:31,  6.34s/it]epoch [115/120], kd_loss:1.6929
 97%|█████████▋| 116/120 [13:19<00:24,  6.17s/it]epoch [116/120], kd_loss:1.6924
 98%|█████████▊| 117/120 [13:25<00:18,  6.07s/it]epoch [117/120], kd_loss:1.6912
 98%|█████████▊| 118/120 [13:31<00:11,  5.99s/it]epoch [118/120], kd_loss:1.6918
 99%|█████████▉| 119/120 [13:36<00:05,  5.95s/it]epoch [119/120], kd_loss:1.6889
100%|██████████| 120/120 [13:54<00:00,  9.31s/it]100%|██████████| 120/120 [13:54<00:00,  6.95s/it]
epoch [120/120], kd_loss:1.6875
normal: 0.9626 2.1755  anomaly: 1.3434 2.7444
thresh: 1.6319272176256936
fpr: 0.15789473684210525 fnr 0.03333333333333333
Pixel Auroc:0.974, Sample Auroc0.966, Pixel Aupro0.0
training Advanced Teacher...
bottle
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:19<32:05, 19.45s/it]epoch [1/100], focal_loss:0.0885	, anomaly_loss:0.5725	fnorm_loss:0.0552, a_fnorm_loss:0.0153P:0.01, R:0.01
normal: 0.2584 0.2630  anomaly: 0.2537 0.2640	P:0.00, R:0.00
Pixel Auroc:0.246, Sample Auroc0.275, Pixel Aupro0.0
test_fnorm_loss: 0.0582 test_afnorm_loss: 0.0193
  2%|▏         | 2/100 [00:27<20:25, 12.51s/it]epoch [2/100], focal_loss:0.0836	, anomaly_loss:0.6062	fnorm_loss:0.0538, a_fnorm_loss:0.0149P:0.00, R:0.00
  3%|▎         | 3/100 [00:34<16:06,  9.97s/it]epoch [3/100], focal_loss:0.0746	, anomaly_loss:0.5745	fnorm_loss:0.0493, a_fnorm_loss:0.0138P:0.00, R:0.00
  4%|▍         | 4/100 [00:41<14:02,  8.78s/it]epoch [4/100], focal_loss:0.0755	, anomaly_loss:0.6332	fnorm_loss:0.0466, a_fnorm_loss:0.0129P:0.00, R:0.00
  5%|▌         | 5/100 [00:58<19:03, 12.04s/it]epoch [5/100], focal_loss:0.0711	, anomaly_loss:0.6329	fnorm_loss:0.0441, a_fnorm_loss:0.0124P:0.00, R:0.00
normal: 0.1980 0.2009  anomaly: 0.1950 0.2013	P:0.00, R:0.00
Pixel Auroc:0.263, Sample Auroc0.250, Pixel Aupro0.0
test_fnorm_loss: 0.0448 test_afnorm_loss: 0.0151
  6%|▌         | 6/100 [01:05<16:12, 10.35s/it]epoch [6/100], focal_loss:0.0667	, anomaly_loss:0.6426	fnorm_loss:0.0422, a_fnorm_loss:0.0122P:0.00, R:0.00
  7%|▋         | 7/100 [01:12<14:23,  9.29s/it]epoch [7/100], focal_loss:0.0673	, anomaly_loss:0.5970	fnorm_loss:0.0415, a_fnorm_loss:0.0125P:0.00, R:0.00
  8%|▊         | 8/100 [01:20<13:08,  8.57s/it]epoch [8/100], focal_loss:0.0708	, anomaly_loss:0.6476	fnorm_loss:0.0407, a_fnorm_loss:0.0117P:0.00, R:0.00
  9%|▉         | 9/100 [01:27<12:17,  8.10s/it]epoch [9/100], focal_loss:0.0661	, anomaly_loss:0.6350	fnorm_loss:0.0404, a_fnorm_loss:0.0130P:0.02, R:0.04
 10%|█         | 10/100 [01:45<17:09, 11.44s/it]epoch [10/100], focal_loss:0.0639	, anomaly_loss:0.5638	fnorm_loss:0.0393, a_fnorm_loss:0.0251P:0.13, R:0.24
normal: 0.2959 0.3159  anomaly: 0.2871 0.3222	P:0.06, R:0.22
Pixel Auroc:0.870, Sample Auroc0.560, Pixel Aupro0.0
test_fnorm_loss: 0.0421 test_afnorm_loss: 0.0340
 11%|█         | 11/100 [01:52<14:56, 10.07s/it]epoch [11/100], focal_loss:0.0604	, anomaly_loss:0.5479	fnorm_loss:0.0351, a_fnorm_loss:0.0289P:0.10, R:0.30
 12%|█▏        | 12/100 [02:00<13:41,  9.34s/it]epoch [12/100], focal_loss:0.0598	, anomaly_loss:0.5045	fnorm_loss:0.0326, a_fnorm_loss:0.0302P:0.10, R:0.28
 13%|█▎        | 13/100 [02:07<12:34,  8.67s/it]epoch [13/100], focal_loss:0.0593	, anomaly_loss:0.5343	fnorm_loss:0.0302, a_fnorm_loss:0.0307P:0.14, R:0.30
 14%|█▍        | 14/100 [02:14<11:45,  8.20s/it]epoch [14/100], focal_loss:0.0496	, anomaly_loss:0.5028	fnorm_loss:0.0278, a_fnorm_loss:0.0350P:0.20, R:0.57
 15%|█▌        | 15/100 [02:38<18:01, 12.72s/it]epoch [15/100], focal_loss:0.0445	, anomaly_loss:0.5057	fnorm_loss:0.0248, a_fnorm_loss:0.0339P:0.26, R:0.57
normal: 0.1522 0.2620  anomaly: 0.1756 0.4153	P:0.42, R:0.24
Pixel Auroc:0.892, Sample Auroc0.958, Pixel Aupro0.0
test_fnorm_loss: 0.0235 test_afnorm_loss: 0.0195
 16%|█▌        | 16/100 [02:45<15:29, 11.07s/it]epoch [16/100], focal_loss:0.0462	, anomaly_loss:0.4944	fnorm_loss:0.0236, a_fnorm_loss:0.0357P:0.39, R:0.67
 17%|█▋        | 17/100 [02:52<13:45,  9.94s/it]epoch [17/100], focal_loss:0.0331	, anomaly_loss:0.4396	fnorm_loss:0.0215, a_fnorm_loss:0.0384P:0.37, R:0.77
 18%|█▊        | 18/100 [02:59<12:29,  9.14s/it]epoch [18/100], focal_loss:0.0324	, anomaly_loss:0.4669	fnorm_loss:0.0202, a_fnorm_loss:0.0398P:0.41, R:0.88
 19%|█▉        | 19/100 [03:07<11:31,  8.53s/it]epoch [19/100], focal_loss:0.0308	, anomaly_loss:0.4417	fnorm_loss:0.0189, a_fnorm_loss:0.0383P:0.44, R:0.75
 20%|██        | 20/100 [03:31<17:34, 13.18s/it]epoch [20/100], focal_loss:0.0302	, anomaly_loss:0.4395	fnorm_loss:0.0180, a_fnorm_loss:0.0390P:0.44, R:0.78
normal: 0.1171 0.2507  anomaly: 0.1589 0.5202	P:0.56, R:0.30
Pixel Auroc:0.882, Sample Auroc0.942, Pixel Aupro0.0
test_fnorm_loss: 0.0169 test_afnorm_loss: 0.0207
 21%|██        | 21/100 [03:38<14:56, 11.35s/it]epoch [21/100], focal_loss:0.0379	, anomaly_loss:0.4712	fnorm_loss:0.0180, a_fnorm_loss:0.0388P:0.47, R:0.80
 22%|██▏       | 22/100 [03:45<13:03, 10.04s/it]epoch [22/100], focal_loss:0.0288	, anomaly_loss:0.4702	fnorm_loss:0.0168, a_fnorm_loss:0.0391P:0.44, R:0.85
 23%|██▎       | 23/100 [03:52<11:45,  9.17s/it]epoch [23/100], focal_loss:0.0271	, anomaly_loss:0.4629	fnorm_loss:0.0163, a_fnorm_loss:0.0394P:0.43, R:0.88
 24%|██▍       | 24/100 [03:59<10:49,  8.54s/it]epoch [24/100], focal_loss:0.0281	, anomaly_loss:0.4531	fnorm_loss:0.0156, a_fnorm_loss:0.0423P:0.52, R:0.86
 25%|██▌       | 25/100 [04:16<14:02, 11.23s/it]epoch [25/100], focal_loss:0.0238	, anomaly_loss:0.4566	fnorm_loss:0.0150, a_fnorm_loss:0.0400P:0.52, R:0.89
normal: 0.2174 0.4807  anomaly: 0.3081 0.6110	P:0.44, R:0.47
Pixel Auroc:0.916, Sample Auroc0.956, Pixel Aupro0.0
test_fnorm_loss: 0.0149 test_afnorm_loss: 0.0359
 26%|██▌       | 26/100 [04:24<12:27, 10.10s/it]epoch [26/100], focal_loss:0.0262	, anomaly_loss:0.4581	fnorm_loss:0.0146, a_fnorm_loss:0.0418P:0.47, R:0.89
 27%|██▋       | 27/100 [04:31<11:20,  9.33s/it]epoch [27/100], focal_loss:0.0254	, anomaly_loss:0.4538	fnorm_loss:0.0143, a_fnorm_loss:0.0407P:0.49, R:0.88
 28%|██▊       | 28/100 [04:38<10:24,  8.67s/it]epoch [28/100], focal_loss:0.0255	, anomaly_loss:0.4594	fnorm_loss:0.0140, a_fnorm_loss:0.0408P:0.51, R:0.86
 29%|██▉       | 29/100 [04:46<09:44,  8.23s/it]epoch [29/100], focal_loss:0.0266	, anomaly_loss:0.4696	fnorm_loss:0.0137, a_fnorm_loss:0.0399P:0.50, R:0.86
 30%|███       | 30/100 [05:03<12:55, 11.07s/it]epoch [30/100], focal_loss:0.0200	, anomaly_loss:0.4544	fnorm_loss:0.0128, a_fnorm_loss:0.0423P:0.54, R:0.88
normal: 0.2193 0.4126  anomaly: 0.3001 0.6225	P:0.45, R:0.45
Pixel Auroc:0.950, Sample Auroc0.956, Pixel Aupro0.0
test_fnorm_loss: 0.0149 test_afnorm_loss: 0.0330
 31%|███       | 31/100 [05:10<11:22,  9.88s/it]epoch [31/100], focal_loss:0.0185	, anomaly_loss:0.4377	fnorm_loss:0.0128, a_fnorm_loss:0.0441P:0.54, R:0.92
 32%|███▏      | 32/100 [05:18<10:24,  9.19s/it]epoch [32/100], focal_loss:0.0278	, anomaly_loss:0.4597	fnorm_loss:0.0129, a_fnorm_loss:0.0395P:0.54, R:0.83
 33%|███▎      | 33/100 [05:25<09:38,  8.64s/it]epoch [33/100], focal_loss:0.0225	, anomaly_loss:0.4373	fnorm_loss:0.0128, a_fnorm_loss:0.0431P:0.54, R:0.91
 34%|███▍      | 34/100 [05:32<08:55,  8.12s/it]epoch [34/100], focal_loss:0.0228	, anomaly_loss:0.4455	fnorm_loss:0.0122, a_fnorm_loss:0.0437P:0.55, R:0.91
 35%|███▌      | 35/100 [05:57<14:06, 13.03s/it]epoch [35/100], focal_loss:0.0256	, anomaly_loss:0.4566	fnorm_loss:0.0127, a_fnorm_loss:0.0431P:0.53, R:0.82
normal: 0.0780 0.2472  anomaly: 0.1460 0.5826	P:0.59, R:0.30
Pixel Auroc:0.920, Sample Auroc0.959, Pixel Aupro0.0
test_fnorm_loss: 0.0108 test_afnorm_loss: 0.0226
 36%|███▌      | 36/100 [06:04<12:06, 11.36s/it]epoch [36/100], focal_loss:0.0195	, anomaly_loss:0.4167	fnorm_loss:0.0115, a_fnorm_loss:0.0438P:0.50, R:0.83
 37%|███▋      | 37/100 [06:11<10:36, 10.10s/it]epoch [37/100], focal_loss:0.0212	, anomaly_loss:0.4519	fnorm_loss:0.0115, a_fnorm_loss:0.0436P:0.49, R:0.89
 38%|███▊      | 38/100 [06:19<09:30,  9.20s/it]epoch [38/100], focal_loss:0.0193	, anomaly_loss:0.4473	fnorm_loss:0.0110, a_fnorm_loss:0.0440P:0.55, R:0.90
 39%|███▉      | 39/100 [06:26<08:48,  8.67s/it]epoch [39/100], focal_loss:0.0220	, anomaly_loss:0.4494	fnorm_loss:0.0118, a_fnorm_loss:0.0411P:0.54, R:0.91
 40%|████      | 40/100 [06:44<11:22, 11.37s/it]epoch [40/100], focal_loss:0.0212	, anomaly_loss:0.4194	fnorm_loss:0.0110, a_fnorm_loss:0.0423P:0.50, R:0.80
normal: 0.1135 0.3794  anomaly: 0.2162 0.6477	P:0.52, R:0.44
Pixel Auroc:0.951, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0106 test_afnorm_loss: 0.0347
 41%|████      | 41/100 [06:50<09:49, 10.00s/it]epoch [41/100], focal_loss:0.0154	, anomaly_loss:0.4039	fnorm_loss:0.0105, a_fnorm_loss:0.0444P:0.50, R:0.85
 42%|████▏     | 42/100 [06:58<08:52,  9.18s/it]epoch [42/100], focal_loss:0.0199	, anomaly_loss:0.4443	fnorm_loss:0.0106, a_fnorm_loss:0.0442P:0.54, R:0.89
 43%|████▎     | 43/100 [07:05<08:11,  8.62s/it]epoch [43/100], focal_loss:0.0173	, anomaly_loss:0.4324	fnorm_loss:0.0104, a_fnorm_loss:0.0443P:0.53, R:0.91
 44%|████▍     | 44/100 [07:12<07:41,  8.23s/it]epoch [44/100], focal_loss:0.0151	, anomaly_loss:0.4361	fnorm_loss:0.0100, a_fnorm_loss:0.0458P:0.54, R:0.93
 45%|████▌     | 45/100 [07:30<10:13, 11.16s/it]epoch [45/100], focal_loss:0.0176	, anomaly_loss:0.4377	fnorm_loss:0.0097, a_fnorm_loss:0.0469P:0.60, R:0.90
normal: 0.1829 0.4922  anomaly: 0.3917 0.6871	P:0.44, R:0.51
Pixel Auroc:0.956, Sample Auroc0.973, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0409
 46%|████▌     | 46/100 [07:37<08:52,  9.86s/it]epoch [46/100], focal_loss:0.0169	, anomaly_loss:0.4005	fnorm_loss:0.0097, a_fnorm_loss:0.0460P:0.51, R:0.86
 47%|████▋     | 47/100 [07:44<07:58,  9.02s/it]epoch [47/100], focal_loss:0.0176	, anomaly_loss:0.4458	fnorm_loss:0.0097, a_fnorm_loss:0.0445P:0.59, R:0.89
 48%|████▊     | 48/100 [07:51<07:17,  8.41s/it]epoch [48/100], focal_loss:0.0163	, anomaly_loss:0.4358	fnorm_loss:0.0094, a_fnorm_loss:0.0468P:0.58, R:0.92
 49%|████▉     | 49/100 [07:59<06:55,  8.15s/it]epoch [49/100], focal_loss:0.0166	, anomaly_loss:0.4299	fnorm_loss:0.0094, a_fnorm_loss:0.0470P:0.57, R:0.94
 50%|█████     | 50/100 [08:16<09:09, 11.00s/it]epoch [50/100], focal_loss:0.0140	, anomaly_loss:0.4028	fnorm_loss:0.0090, a_fnorm_loss:0.0472P:0.55, R:0.85
normal: 0.0610 0.2821  anomaly: 0.1590 0.6462	P:0.57, R:0.31
Pixel Auroc:0.945, Sample Auroc0.973, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0299
 51%|█████     | 51/100 [08:23<08:00,  9.80s/it]epoch [51/100], focal_loss:0.0156	, anomaly_loss:0.4074	fnorm_loss:0.0091, a_fnorm_loss:0.0451P:0.51, R:0.83
 52%|█████▏    | 52/100 [08:30<07:11,  8.98s/it]epoch [52/100], focal_loss:0.0145	, anomaly_loss:0.3991	fnorm_loss:0.0090, a_fnorm_loss:0.0469P:0.53, R:0.85
 53%|█████▎    | 53/100 [08:38<06:36,  8.44s/it]epoch [53/100], focal_loss:0.0151	, anomaly_loss:0.4044	fnorm_loss:0.0088, a_fnorm_loss:0.0463P:0.55, R:0.85
 54%|█████▍    | 54/100 [08:45<06:11,  8.07s/it]epoch [54/100], focal_loss:0.0260	, anomaly_loss:0.4465	fnorm_loss:0.0094, a_fnorm_loss:0.0435P:0.60, R:0.84
 55%|█████▌    | 55/100 [09:08<09:24, 12.54s/it]epoch [55/100], focal_loss:0.0155	, anomaly_loss:0.4388	fnorm_loss:0.0088, a_fnorm_loss:0.0450P:0.53, R:0.89
normal: 0.0617 0.2163  anomaly: 0.0928 0.6547	P:0.62, R:0.32
Pixel Auroc:0.936, Sample Auroc0.973, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0239
 56%|█████▌    | 56/100 [09:15<07:58, 10.88s/it]epoch [56/100], focal_loss:0.0164	, anomaly_loss:0.4343	fnorm_loss:0.0088, a_fnorm_loss:0.0447P:0.56, R:0.92
 57%|█████▋    | 57/100 [09:22<06:59,  9.75s/it]epoch [57/100], focal_loss:0.0152	, anomaly_loss:0.4043	fnorm_loss:0.0084, a_fnorm_loss:0.0457P:0.55, R:0.84
 58%|█████▊    | 58/100 [09:29<06:14,  8.91s/it]epoch [58/100], focal_loss:0.0149	, anomaly_loss:0.4279	fnorm_loss:0.0084, a_fnorm_loss:0.0480P:0.62, R:0.93
 59%|█████▉    | 59/100 [09:36<05:45,  8.42s/it]epoch [59/100], focal_loss:0.0184	, anomaly_loss:0.4353	fnorm_loss:0.0085, a_fnorm_loss:0.0469P:0.60, R:0.91
 60%|██████    | 60/100 [09:54<07:28, 11.21s/it]epoch [60/100], focal_loss:0.0168	, anomaly_loss:0.4111	fnorm_loss:0.0085, a_fnorm_loss:0.0465P:0.52, R:0.83
normal: 0.0575 0.2731  anomaly: 0.1353 0.6547	P:0.61, R:0.32
Pixel Auroc:0.946, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0296
 61%|██████    | 61/100 [10:01<06:26,  9.91s/it]epoch [61/100], focal_loss:0.0185	, anomaly_loss:0.4370	fnorm_loss:0.0086, a_fnorm_loss:0.0455P:0.56, R:0.91
 62%|██████▏   | 62/100 [10:08<05:44,  9.06s/it]epoch [62/100], focal_loss:0.0162	, anomaly_loss:0.4103	fnorm_loss:0.0085, a_fnorm_loss:0.0431P:0.54, R:0.83
 63%|██████▎   | 63/100 [10:15<05:17,  8.58s/it]epoch [63/100], focal_loss:0.0181	, anomaly_loss:0.4383	fnorm_loss:0.0085, a_fnorm_loss:0.0458P:0.60, R:0.89
 64%|██████▍   | 64/100 [10:23<04:56,  8.23s/it]epoch [64/100], focal_loss:0.0157	, anomaly_loss:0.4264	fnorm_loss:0.0083, a_fnorm_loss:0.0483P:0.59, R:0.93
 65%|██████▌   | 65/100 [10:41<06:30, 11.16s/it]epoch [65/100], focal_loss:0.0159	, anomaly_loss:0.4237	fnorm_loss:0.0083, a_fnorm_loss:0.0472P:0.56, R:0.93
normal: 0.0379 0.1575  anomaly: 0.0513 0.5374	P:0.55, R:0.18
Pixel Auroc:0.934, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0183
 66%|██████▌   | 66/100 [10:48<05:36,  9.89s/it]epoch [66/100], focal_loss:0.0166	, anomaly_loss:0.4532	fnorm_loss:0.0080, a_fnorm_loss:0.0430P:0.58, R:0.88
 67%|██████▋   | 67/100 [10:55<04:58,  9.05s/it]epoch [67/100], focal_loss:0.0181	, anomaly_loss:0.4361	fnorm_loss:0.0087, a_fnorm_loss:0.0445P:0.58, R:0.92
 68%|██████▊   | 68/100 [11:02<04:29,  8.42s/it]epoch [68/100], focal_loss:0.0148	, anomaly_loss:0.3990	fnorm_loss:0.0079, a_fnorm_loss:0.0482P:0.56, R:0.86
 69%|██████▉   | 69/100 [11:09<04:06,  7.95s/it]epoch [69/100], focal_loss:0.0197	, anomaly_loss:0.4366	fnorm_loss:0.0084, a_fnorm_loss:0.0468P:0.54, R:0.90
 70%|███████   | 70/100 [11:26<05:25, 10.84s/it]epoch [70/100], focal_loss:0.0172	, anomaly_loss:0.4417	fnorm_loss:0.0080, a_fnorm_loss:0.0440P:0.61, R:0.89
normal: 0.1207 0.3319  anomaly: 0.1441 0.6951	P:0.56, R:0.39
Pixel Auroc:0.938, Sample Auroc0.960, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0245
 71%|███████   | 71/100 [11:33<04:41,  9.69s/it]epoch [71/100], focal_loss:0.0154	, anomaly_loss:0.4314	fnorm_loss:0.0078, a_fnorm_loss:0.0477P:0.58, R:0.92
 72%|███████▏  | 72/100 [11:40<04:07,  8.83s/it]epoch [72/100], focal_loss:0.0144	, anomaly_loss:0.4282	fnorm_loss:0.0077, a_fnorm_loss:0.0477P:0.60, R:0.93
 73%|███████▎  | 73/100 [11:47<03:45,  8.35s/it]epoch [73/100], focal_loss:0.0170	, anomaly_loss:0.4438	fnorm_loss:0.0080, a_fnorm_loss:0.0441P:0.60, R:0.90
 74%|███████▍  | 74/100 [11:54<03:28,  8.02s/it]epoch [74/100], focal_loss:0.0138	, anomaly_loss:0.3973	fnorm_loss:0.0078, a_fnorm_loss:0.0470P:0.53, R:0.87
 75%|███████▌  | 75/100 [12:13<04:36, 11.06s/it]epoch [75/100], focal_loss:0.0140	, anomaly_loss:0.4255	fnorm_loss:0.0076, a_fnorm_loss:0.0477P:0.58, R:0.93
normal: 0.0460 0.3327  anomaly: 0.1300 0.6810	P:0.62, R:0.34
Pixel Auroc:0.947, Sample Auroc0.978, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0278
 76%|███████▌  | 76/100 [12:20<03:59,  9.96s/it]epoch [76/100], focal_loss:0.0150	, anomaly_loss:0.4262	fnorm_loss:0.0077, a_fnorm_loss:0.0478P:0.63, R:0.93
 77%|███████▋  | 77/100 [12:27<03:29,  9.12s/it]epoch [77/100], focal_loss:0.0162	, anomaly_loss:0.4395	fnorm_loss:0.0078, a_fnorm_loss:0.0459P:0.56, R:0.92
 78%|███████▊  | 78/100 [12:35<03:11,  8.71s/it]epoch [78/100], focal_loss:0.0159	, anomaly_loss:0.4085	fnorm_loss:0.0075, a_fnorm_loss:0.0459P:0.55, R:0.83
 79%|███████▉  | 79/100 [12:42<02:52,  8.21s/it]epoch [79/100], focal_loss:0.0143	, anomaly_loss:0.3951	fnorm_loss:0.0075, a_fnorm_loss:0.0465P:0.54, R:0.87
 80%|████████  | 80/100 [13:01<03:46, 11.34s/it]epoch [80/100], focal_loss:0.0163	, anomaly_loss:0.4298	fnorm_loss:0.0075, a_fnorm_loss:0.0467P:0.60, R:0.92
normal: 0.0453 0.2185  anomaly: 0.0984 0.6050	P:0.56, R:0.23
Pixel Auroc:0.954, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0269
 81%|████████  | 81/100 [13:08<03:11, 10.06s/it]epoch [81/100], focal_loss:0.0183	, anomaly_loss:0.4461	fnorm_loss:0.0075, a_fnorm_loss:0.0446P:0.65, R:0.87
 82%|████████▏ | 82/100 [13:15<02:44,  9.12s/it]epoch [82/100], focal_loss:0.0132	, anomaly_loss:0.4187	fnorm_loss:0.0073, a_fnorm_loss:0.0482P:0.58, R:0.95
 83%|████████▎ | 83/100 [13:22<02:25,  8.56s/it]epoch [83/100], focal_loss:0.0157	, anomaly_loss:0.4276	fnorm_loss:0.0075, a_fnorm_loss:0.0462P:0.59, R:0.92
 84%|████████▍ | 84/100 [13:29<02:10,  8.13s/it]epoch [84/100], focal_loss:0.0157	, anomaly_loss:0.4352	fnorm_loss:0.0074, a_fnorm_loss:0.0470P:0.60, R:0.92
 85%|████████▌ | 85/100 [13:47<02:48, 11.21s/it]epoch [85/100], focal_loss:0.0144	, anomaly_loss:0.4262	fnorm_loss:0.0076, a_fnorm_loss:0.0476P:0.57, R:0.93
normal: 0.0991 0.3637  anomaly: 0.1621 0.6982	P:0.60, R:0.42
Pixel Auroc:0.964, Sample Auroc0.984, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0347
 86%|████████▌ | 86/100 [13:54<02:19,  9.97s/it]epoch [86/100], focal_loss:0.0158	, anomaly_loss:0.4260	fnorm_loss:0.0075, a_fnorm_loss:0.0459P:0.59, R:0.92
 87%|████████▋ | 87/100 [14:02<01:59,  9.16s/it]epoch [87/100], focal_loss:0.0135	, anomaly_loss:0.4291	fnorm_loss:0.0072, a_fnorm_loss:0.0477P:0.63, R:0.92
 88%|████████▊ | 88/100 [14:09<01:43,  8.65s/it]epoch [88/100], focal_loss:0.0128	, anomaly_loss:0.4177	fnorm_loss:0.0072, a_fnorm_loss:0.0484P:0.63, R:0.94
 89%|████████▉ | 89/100 [14:17<01:31,  8.28s/it]epoch [89/100], focal_loss:0.0145	, anomaly_loss:0.4260	fnorm_loss:0.0073, a_fnorm_loss:0.0486P:0.61, R:0.94
 90%|█████████ | 90/100 [14:35<01:54, 11.43s/it]epoch [90/100], focal_loss:0.0127	, anomaly_loss:0.4195	fnorm_loss:0.0070, a_fnorm_loss:0.0486P:0.63, R:0.93
normal: 0.0870 0.4443  anomaly: 0.1917 0.7097	P:0.57, R:0.44
Pixel Auroc:0.961, Sample Auroc0.983, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0361
 91%|█████████ | 91/100 [14:43<01:31, 10.17s/it]epoch [91/100], focal_loss:0.0133	, anomaly_loss:0.4189	fnorm_loss:0.0073, a_fnorm_loss:0.0509P:0.63, R:0.95
 92%|█████████▏| 92/100 [14:49<01:13,  9.16s/it]epoch [92/100], focal_loss:0.0147	, anomaly_loss:0.4321	fnorm_loss:0.0072, a_fnorm_loss:0.0480P:0.64, R:0.92
 93%|█████████▎| 93/100 [14:57<01:00,  8.60s/it]epoch [93/100], focal_loss:0.0127	, anomaly_loss:0.4191	fnorm_loss:0.0072, a_fnorm_loss:0.0486P:0.61, R:0.93
 94%|█████████▍| 94/100 [15:04<00:49,  8.26s/it]epoch [94/100], focal_loss:0.0151	, anomaly_loss:0.4321	fnorm_loss:0.0075, a_fnorm_loss:0.0474P:0.62, R:0.92
 95%|█████████▌| 95/100 [15:22<00:56, 11.26s/it]epoch [95/100], focal_loss:0.0118	, anomaly_loss:0.3946	fnorm_loss:0.0071, a_fnorm_loss:0.0492P:0.55, R:0.87
normal: 0.0810 0.4034  anomaly: 0.1573 0.7035	P:0.60, R:0.42
Pixel Auroc:0.959, Sample Auroc0.983, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0332
 96%|█████████▌| 96/100 [15:30<00:40, 10.05s/it]epoch [96/100], focal_loss:0.0139	, anomaly_loss:0.4266	fnorm_loss:0.0072, a_fnorm_loss:0.0477P:0.62, R:0.93
 97%|█████████▋| 97/100 [15:37<00:27,  9.23s/it]epoch [97/100], focal_loss:0.0138	, anomaly_loss:0.4273	fnorm_loss:0.0072, a_fnorm_loss:0.0475P:0.59, R:0.91
 98%|█████████▊| 98/100 [15:44<00:17,  8.60s/it]epoch [98/100], focal_loss:0.0132	, anomaly_loss:0.3909	fnorm_loss:0.0072, a_fnorm_loss:0.0485P:0.55, R:0.87
 99%|█████████▉| 99/100 [15:51<00:08,  8.18s/it]epoch [99/100], focal_loss:0.0133	, anomaly_loss:0.4239	fnorm_loss:0.0072, a_fnorm_loss:0.0461P:0.62, R:0.91
100%|██████████| 100/100 [16:09<00:00, 11.01s/it]100%|██████████| 100/100 [16:09<00:00,  9.69s/it]
epoch [100/100], focal_loss:0.0139	, anomaly_loss:0.4214	fnorm_loss:0.0072, a_fnorm_loss:0.0491P:0.60, R:0.94
normal: 0.0977 0.3945  anomaly: 0.1601 0.7012	P:0.58, R:0.42
Pixel Auroc:0.961, Sample Auroc0.983, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0341
training Stubborn Student...
bottle
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:04<09:22,  4.73s/it]epoch [1/120], kd_loss:4.6952
  2%|▏         | 2/120 [00:09<09:19,  4.74s/it]epoch [2/120], kd_loss:3.7959
  2%|▎         | 3/120 [00:14<09:14,  4.74s/it]epoch [3/120], kd_loss:3.3430
  3%|▎         | 4/120 [00:18<09:11,  4.75s/it]epoch [4/120], kd_loss:2.8721
  4%|▍         | 5/120 [00:23<09:10,  4.79s/it]epoch [5/120], kd_loss:2.5200
  5%|▌         | 6/120 [00:28<09:06,  4.79s/it]epoch [6/120], kd_loss:2.1656
  6%|▌         | 7/120 [00:33<09:02,  4.80s/it]epoch [7/120], kd_loss:2.1373
  7%|▋         | 8/120 [00:38<09:01,  4.84s/it]epoch [8/120], kd_loss:3.0254
  8%|▊         | 9/120 [00:43<08:57,  4.84s/it]epoch [9/120], kd_loss:2.5225
  8%|▊         | 10/120 [00:59<15:11,  8.29s/it]epoch [10/120], kd_loss:2.3065
normal: 1.3084 1.6751  anomaly: 1.5320 2.5377
thresh: 1.5319718504554536
fpr: 0.1 fnr 0.0
Pixel Auroc:0.967, Sample Auroc0.994, Pixel Aupro0.0
  9%|▉         | 11/120 [01:04<13:06,  7.22s/it]epoch [11/120], kd_loss:1.9202
 10%|█         | 12/120 [01:08<11:40,  6.49s/it]epoch [12/120], kd_loss:2.0372
 11%|█         | 13/120 [01:13<10:40,  5.99s/it]epoch [13/120], kd_loss:1.8133
 12%|█▏        | 14/120 [01:18<09:58,  5.65s/it]epoch [14/120], kd_loss:1.7488
 12%|█▎        | 15/120 [01:23<09:27,  5.41s/it]epoch [15/120], kd_loss:1.7455
 13%|█▎        | 16/120 [01:28<09:03,  5.22s/it]epoch [16/120], kd_loss:1.6886
 14%|█▍        | 17/120 [01:33<08:45,  5.11s/it]epoch [17/120], kd_loss:1.7102
 15%|█▌        | 18/120 [01:37<08:32,  5.02s/it]epoch [18/120], kd_loss:1.6576
 16%|█▌        | 19/120 [01:42<08:22,  4.97s/it]epoch [19/120], kd_loss:1.5633
 17%|█▋        | 20/120 [01:59<14:04,  8.45s/it]epoch [20/120], kd_loss:1.6135
normal: 1.0014 1.3523  anomaly: 1.2964 2.3326
thresh: 1.29642025184887
fpr: 0.05 fnr 0.0
Pixel Auroc:0.968, Sample Auroc0.998, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:04<12:10,  7.38s/it]epoch [21/120], kd_loss:1.5112
 18%|█▊        | 22/120 [02:08<10:46,  6.60s/it]epoch [22/120], kd_loss:2.2849
 19%|█▉        | 23/120 [02:13<09:50,  6.08s/it]epoch [23/120], kd_loss:2.0396
 20%|██        | 24/120 [02:18<09:08,  5.71s/it]epoch [24/120], kd_loss:1.7279
 21%|██        | 25/120 [02:23<08:37,  5.45s/it]epoch [25/120], kd_loss:1.6177
 22%|██▏       | 26/120 [02:28<08:14,  5.26s/it]epoch [26/120], kd_loss:1.6935
 22%|██▎       | 27/120 [02:33<07:58,  5.14s/it]epoch [27/120], kd_loss:1.6112
 23%|██▎       | 28/120 [02:38<07:45,  5.05s/it]epoch [28/120], kd_loss:2.5360
 24%|██▍       | 29/120 [02:42<07:33,  4.99s/it]epoch [29/120], kd_loss:1.6582
 25%|██▌       | 30/120 [02:57<12:01,  8.02s/it]epoch [30/120], kd_loss:1.5440
normal: 0.9974 1.3477  anomaly: 1.3070 2.7087
thresh: 1.3069952777484617
fpr: 0.05 fnr 0.0
Pixel Auroc:0.970, Sample Auroc0.998, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:02<10:27,  7.05s/it]epoch [31/120], kd_loss:1.5161
 27%|██▋       | 32/120 [03:07<09:24,  6.41s/it]epoch [32/120], kd_loss:1.5193
 28%|██▊       | 33/120 [03:12<08:37,  5.95s/it]epoch [33/120], kd_loss:1.4633
 28%|██▊       | 34/120 [03:17<08:03,  5.62s/it]epoch [34/120], kd_loss:1.9267
 29%|██▉       | 35/120 [03:22<07:36,  5.38s/it]epoch [35/120], kd_loss:1.5316
 30%|███       | 36/120 [03:27<07:18,  5.22s/it]epoch [36/120], kd_loss:1.7287
 31%|███       | 37/120 [03:31<07:03,  5.10s/it]epoch [37/120], kd_loss:2.5710
 32%|███▏      | 38/120 [03:36<06:52,  5.03s/it]epoch [38/120], kd_loss:2.3150
 32%|███▎      | 39/120 [03:41<06:41,  4.96s/it]epoch [39/120], kd_loss:1.7323
 33%|███▎      | 40/120 [03:58<11:14,  8.44s/it]epoch [40/120], kd_loss:1.6205
normal: 1.0379 1.3006  anomaly: 1.2912 2.3521
thresh: 1.2911878688178817
fpr: 0.05 fnr 0.0
Pixel Auroc:0.970, Sample Auroc0.999, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:02<09:41,  7.36s/it]epoch [41/120], kd_loss:1.5830
 35%|███▌      | 42/120 [04:07<08:33,  6.59s/it]epoch [42/120], kd_loss:1.5324
 36%|███▌      | 43/120 [04:12<07:47,  6.07s/it]epoch [43/120], kd_loss:1.6816
 37%|███▋      | 44/120 [04:17<07:12,  5.69s/it]epoch [44/120], kd_loss:2.2787
 38%|███▊      | 45/120 [04:22<06:48,  5.44s/it]epoch [45/120], kd_loss:2.5284
 38%|███▊      | 46/120 [04:27<06:28,  5.25s/it]epoch [46/120], kd_loss:1.8939
 39%|███▉      | 47/120 [04:31<06:13,  5.12s/it]epoch [47/120], kd_loss:1.7204
 40%|████      | 48/120 [04:36<06:02,  5.03s/it]epoch [48/120], kd_loss:1.8982
 41%|████      | 49/120 [04:41<05:53,  4.98s/it]epoch [49/120], kd_loss:1.5916
 42%|████▏     | 50/120 [04:56<09:26,  8.09s/it]epoch [50/120], kd_loss:1.5685
normal: 1.6243 1.8822  anomaly: 1.7552 2.4685
thresh: 1.8046725966266906
fpr: 0.1 fnr 0.047619047619047616
Pixel Auroc:0.930, Sample Auroc0.980, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:01<08:09,  7.09s/it]epoch [51/120], kd_loss:1.6256
 43%|████▎     | 52/120 [05:06<07:15,  6.40s/it]epoch [52/120], kd_loss:1.8085
 44%|████▍     | 53/120 [05:11<06:36,  5.91s/it]epoch [53/120], kd_loss:1.5725
 45%|████▌     | 54/120 [05:15<06:08,  5.58s/it]epoch [54/120], kd_loss:1.5659
 46%|████▌     | 55/120 [05:20<05:46,  5.33s/it]epoch [55/120], kd_loss:1.7403
 47%|████▋     | 56/120 [05:25<05:32,  5.20s/it]epoch [56/120], kd_loss:1.5655
 48%|████▊     | 57/120 [05:30<05:21,  5.11s/it]epoch [57/120], kd_loss:1.5340
 48%|████▊     | 58/120 [05:35<05:11,  5.02s/it]epoch [58/120], kd_loss:1.5247
 49%|████▉     | 59/120 [05:40<05:03,  4.98s/it]epoch [59/120], kd_loss:1.5146
 50%|█████     | 60/120 [05:55<07:59,  8.00s/it]epoch [60/120], kd_loss:1.5003
normal: 1.0025 1.3052  anomaly: 1.2864 2.4017
thresh: 1.2863816019689391
fpr: 0.05 fnr 0.0
Pixel Auroc:0.971, Sample Auroc0.999, Pixel Aupro0.0
 51%|█████     | 61/120 [06:00<06:55,  7.04s/it]epoch [61/120], kd_loss:1.4574
 52%|█████▏    | 62/120 [06:04<06:10,  6.38s/it]epoch [62/120], kd_loss:1.4620
 52%|█████▎    | 63/120 [06:09<05:37,  5.92s/it]epoch [63/120], kd_loss:1.4341
 53%|█████▎    | 64/120 [06:14<05:13,  5.60s/it]epoch [64/120], kd_loss:1.4174
 54%|█████▍    | 65/120 [06:19<04:55,  5.37s/it]epoch [65/120], kd_loss:1.4241
 55%|█████▌    | 66/120 [06:24<04:40,  5.19s/it]epoch [66/120], kd_loss:1.4309
 56%|█████▌    | 67/120 [06:28<04:28,  5.07s/it]epoch [67/120], kd_loss:1.4336
 57%|█████▋    | 68/120 [06:33<04:20,  5.02s/it]epoch [68/120], kd_loss:1.4136
 57%|█████▊    | 69/120 [06:38<04:13,  4.97s/it]epoch [69/120], kd_loss:1.6528
 58%|█████▊    | 70/120 [06:53<06:41,  8.03s/it]epoch [70/120], kd_loss:2.6343
normal: 1.6836 1.7396  anomaly: 1.7013 2.4340
thresh: 1.7589923139278416
fpr: 0.0 fnr 0.07936507936507936
Pixel Auroc:0.947, Sample Auroc0.975, Pixel Aupro0.0
 59%|█████▉    | 71/120 [06:58<05:46,  7.06s/it]epoch [71/120], kd_loss:2.0439
 60%|██████    | 72/120 [07:03<05:06,  6.39s/it]epoch [72/120], kd_loss:1.6133
 61%|██████    | 73/120 [07:08<04:38,  5.93s/it]epoch [73/120], kd_loss:2.0993
 62%|██████▏   | 74/120 [07:13<04:17,  5.60s/it]epoch [74/120], kd_loss:2.8312
 62%|██████▎   | 75/120 [07:17<04:01,  5.36s/it]epoch [75/120], kd_loss:1.9416
 63%|██████▎   | 76/120 [07:22<03:49,  5.21s/it]epoch [76/120], kd_loss:1.9681
 64%|██████▍   | 77/120 [07:27<03:39,  5.12s/it]epoch [77/120], kd_loss:1.7782
 65%|██████▌   | 78/120 [07:32<03:31,  5.04s/it]epoch [78/120], kd_loss:1.7833
 66%|██████▌   | 79/120 [07:37<03:24,  4.98s/it]epoch [79/120], kd_loss:1.6616
 67%|██████▋   | 80/120 [07:51<05:13,  7.85s/it]epoch [80/120], kd_loss:1.6240
normal: 1.0221 1.3364  anomaly: 1.3229 2.3831
thresh: 1.3229388535345281
fpr: 0.05 fnr 0.0
Pixel Auroc:0.970, Sample Auroc0.999, Pixel Aupro0.0
 68%|██████▊   | 81/120 [07:56<04:30,  6.95s/it]epoch [81/120], kd_loss:1.5698
 68%|██████▊   | 82/120 [08:01<03:59,  6.31s/it]epoch [82/120], kd_loss:1.5490
 69%|██████▉   | 83/120 [08:06<03:37,  5.87s/it]epoch [83/120], kd_loss:1.5351
 70%|███████   | 84/120 [08:11<03:19,  5.55s/it]epoch [84/120], kd_loss:1.5297
 71%|███████   | 85/120 [08:16<03:06,  5.33s/it]epoch [85/120], kd_loss:1.5791
 72%|███████▏  | 86/120 [08:21<02:57,  5.21s/it]epoch [86/120], kd_loss:1.7408
 72%|███████▎  | 87/120 [08:25<02:48,  5.10s/it]epoch [87/120], kd_loss:1.5062
 73%|███████▎  | 88/120 [08:30<02:40,  5.03s/it]epoch [88/120], kd_loss:1.4738
 74%|███████▍  | 89/120 [08:35<02:34,  4.97s/it]epoch [89/120], kd_loss:1.4495
 75%|███████▌  | 90/120 [08:50<03:57,  7.91s/it]epoch [90/120], kd_loss:1.4446
normal: 0.9993 1.3077  anomaly: 1.2270 2.4533
thresh: 1.2270371425033737
fpr: 0.05 fnr 0.0
Pixel Auroc:0.969, Sample Auroc0.999, Pixel Aupro0.0
 76%|███████▌  | 91/120 [08:55<03:22,  6.97s/it]epoch [91/120], kd_loss:1.5858
 77%|███████▋  | 92/120 [08:59<02:57,  6.32s/it]epoch [92/120], kd_loss:1.5284
 78%|███████▊  | 93/120 [09:04<02:38,  5.88s/it]epoch [93/120], kd_loss:1.6619
 78%|███████▊  | 94/120 [09:09<02:25,  5.58s/it]epoch [94/120], kd_loss:1.5084
 79%|███████▉  | 95/120 [09:14<02:13,  5.35s/it]epoch [95/120], kd_loss:1.4652
 80%|████████  | 96/120 [09:19<02:05,  5.21s/it]epoch [96/120], kd_loss:1.4552
 81%|████████  | 97/120 [09:24<01:57,  5.09s/it]epoch [97/120], kd_loss:1.4384
 82%|████████▏ | 98/120 [09:29<01:50,  5.01s/it]epoch [98/120], kd_loss:1.4293
 82%|████████▎ | 99/120 [09:33<01:44,  4.95s/it]epoch [99/120], kd_loss:1.4358
 83%|████████▎ | 100/120 [09:48<02:39,  7.98s/it]epoch [100/120], kd_loss:1.4276
normal: 0.9480 1.2805  anomaly: 1.2572 2.3686
thresh: 1.2571771997993255
fpr: 0.05 fnr 0.0
Pixel Auroc:0.971, Sample Auroc0.999, Pixel Aupro0.0
 84%|████████▍ | 101/120 [09:53<02:13,  7.01s/it]epoch [101/120], kd_loss:1.4192
 85%|████████▌ | 102/120 [09:58<01:54,  6.34s/it]epoch [102/120], kd_loss:1.4221
 86%|████████▌ | 103/120 [10:03<01:40,  5.88s/it]epoch [103/120], kd_loss:1.4181
 87%|████████▋ | 104/120 [10:08<01:29,  5.56s/it]epoch [104/120], kd_loss:1.4136
 88%|████████▊ | 105/120 [10:12<01:20,  5.35s/it]epoch [105/120], kd_loss:1.4132
 88%|████████▊ | 106/120 [10:17<01:12,  5.19s/it]epoch [106/120], kd_loss:1.4154
 89%|████████▉ | 107/120 [10:22<01:05,  5.07s/it]epoch [107/120], kd_loss:1.4057
 90%|█████████ | 108/120 [10:27<00:59,  5.00s/it]epoch [108/120], kd_loss:1.3980
 91%|█████████ | 109/120 [10:32<00:54,  4.95s/it]epoch [109/120], kd_loss:1.4048
 92%|█████████▏| 110/120 [10:47<01:21,  8.15s/it]epoch [110/120], kd_loss:1.4014
normal: 0.9349 1.3136  anomaly: 1.2765 2.3634
thresh: 1.2765212266187107
fpr: 0.05 fnr 0.0
Pixel Auroc:0.972, Sample Auroc0.999, Pixel Aupro0.0
 92%|█████████▎| 111/120 [10:52<01:04,  7.17s/it]epoch [111/120], kd_loss:1.3985
 93%|█████████▎| 112/120 [10:57<00:51,  6.47s/it]epoch [112/120], kd_loss:1.3975
 94%|█████████▍| 113/120 [11:02<00:41,  5.97s/it]epoch [113/120], kd_loss:1.3939
 95%|█████████▌| 114/120 [11:07<00:33,  5.61s/it]epoch [114/120], kd_loss:1.4048
 96%|█████████▌| 115/120 [11:11<00:26,  5.37s/it]epoch [115/120], kd_loss:1.3992
 97%|█████████▋| 116/120 [11:16<00:20,  5.21s/it]epoch [116/120], kd_loss:1.4027
 98%|█████████▊| 117/120 [11:21<00:15,  5.10s/it]epoch [117/120], kd_loss:1.3949
 98%|█████████▊| 118/120 [11:26<00:10,  5.02s/it]epoch [118/120], kd_loss:1.3966
 99%|█████████▉| 119/120 [11:31<00:04,  4.96s/it]epoch [119/120], kd_loss:1.3979
 99%|█████████▉| 119/120 [11:47<00:05,  5.95s/it]
epoch [120/120], kd_loss:1.3972
normal: 0.9530 1.2998  anomaly: 1.3010 2.3674
thresh: 1.3009803139640042
fpr: 0.0 fnr 0.0
Pixel Auroc:0.972, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
cable
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:33<55:48, 33.83s/it]epoch [1/100], focal_loss:0.0873	, anomaly_loss:0.6247	fnorm_loss:0.0552, a_fnorm_loss:0.0158P:0.00, R:0.05
normal: 0.2502 0.2603  anomaly: 0.2486 0.2606	P:0.00, R:0.00
Pixel Auroc:0.471, Sample Auroc0.401, Pixel Aupro0.0
test_fnorm_loss: 0.0561 test_afnorm_loss: 0.0243
  2%|▏         | 2/100 [00:42<31:03, 19.02s/it]epoch [2/100], focal_loss:0.0792	, anomaly_loss:0.6197	fnorm_loss:0.0535, a_fnorm_loss:0.0154P:0.00, R:0.00
  3%|▎         | 3/100 [00:51<23:19, 14.43s/it]epoch [3/100], focal_loss:0.0714	, anomaly_loss:0.6324	fnorm_loss:0.0487, a_fnorm_loss:0.0142P:0.00, R:0.00
  4%|▍         | 4/100 [01:00<19:32, 12.22s/it]epoch [4/100], focal_loss:0.0700	, anomaly_loss:0.6432	fnorm_loss:0.0455, a_fnorm_loss:0.0145P:0.00, R:0.00
  5%|▌         | 5/100 [01:31<30:11, 19.06s/it]epoch [5/100], focal_loss:0.0668	, anomaly_loss:0.6499	fnorm_loss:0.0429, a_fnorm_loss:0.0126P:0.00, R:0.00
normal: 0.1881 0.1944  anomaly: 0.1874 0.1948	P:0.00, R:0.00
Pixel Auroc:0.472, Sample Auroc0.412, Pixel Aupro0.0
test_fnorm_loss: 0.0419 test_afnorm_loss: 0.0184
  6%|▌         | 6/100 [01:40<24:26, 15.60s/it]epoch [6/100], focal_loss:0.0680	, anomaly_loss:0.6566	fnorm_loss:0.0411, a_fnorm_loss:0.0123P:0.00, R:0.00
  7%|▋         | 7/100 [01:49<20:42, 13.36s/it]epoch [7/100], focal_loss:0.0663	, anomaly_loss:0.6524	fnorm_loss:0.0413, a_fnorm_loss:0.0130P:0.00, R:0.00
  8%|▊         | 8/100 [01:57<18:15, 11.91s/it]epoch [8/100], focal_loss:0.0711	, anomaly_loss:0.6555	fnorm_loss:0.0412, a_fnorm_loss:0.0129P:0.00, R:0.00
  9%|▉         | 9/100 [02:06<16:40, 11.00s/it]epoch [9/100], focal_loss:0.0706	, anomaly_loss:0.6600	fnorm_loss:0.0399, a_fnorm_loss:0.0117P:0.00, R:0.00
 10%|█         | 10/100 [02:41<27:21, 18.24s/it]epoch [10/100], focal_loss:0.0657	, anomaly_loss:0.6560	fnorm_loss:0.0397, a_fnorm_loss:0.0127P:0.00, R:0.00
normal: 0.2000 0.2072  anomaly: 0.1993 0.2064	P:0.00, R:0.00
Pixel Auroc:0.511, Sample Auroc0.339, Pixel Aupro0.0
test_fnorm_loss: 0.0446 test_afnorm_loss: 0.0221
 11%|█         | 11/100 [02:50<22:47, 15.36s/it]epoch [11/100], focal_loss:0.0690	, anomaly_loss:0.6192	fnorm_loss:0.0405, a_fnorm_loss:0.0175P:0.06, R:0.11
 12%|█▏        | 12/100 [02:59<19:44, 13.46s/it]epoch [12/100], focal_loss:0.0650	, anomaly_loss:0.5690	fnorm_loss:0.0361, a_fnorm_loss:0.0278P:0.09, R:0.27
 13%|█▎        | 13/100 [03:08<17:37, 12.15s/it]epoch [13/100], focal_loss:0.0605	, anomaly_loss:0.5606	fnorm_loss:0.0331, a_fnorm_loss:0.0303P:0.12, R:0.27
 14%|█▍        | 14/100 [03:17<15:57, 11.13s/it]epoch [14/100], focal_loss:0.0634	, anomaly_loss:0.5501	fnorm_loss:0.0327, a_fnorm_loss:0.0310P:0.10, R:0.28
 15%|█▌        | 15/100 [03:53<26:40, 18.83s/it]epoch [15/100], focal_loss:0.0573	, anomaly_loss:0.5459	fnorm_loss:0.0303, a_fnorm_loss:0.0325P:0.11, R:0.29
normal: 0.2155 0.2903  anomaly: 0.1854 0.2987	P:0.07, R:0.04
Pixel Auroc:0.870, Sample Auroc0.515, Pixel Aupro0.0
test_fnorm_loss: 0.0284 test_afnorm_loss: 0.0177
 16%|█▌        | 16/100 [04:03<22:19, 15.94s/it]epoch [16/100], focal_loss:0.0581	, anomaly_loss:0.5440	fnorm_loss:0.0299, a_fnorm_loss:0.0328P:0.13, R:0.30
 17%|█▋        | 17/100 [04:11<19:05, 13.80s/it]epoch [17/100], focal_loss:0.0517	, anomaly_loss:0.5485	fnorm_loss:0.0277, a_fnorm_loss:0.0328P:0.13, R:0.31
 18%|█▊        | 18/100 [04:20<16:45, 12.26s/it]epoch [18/100], focal_loss:0.0544	, anomaly_loss:0.5380	fnorm_loss:0.0269, a_fnorm_loss:0.0339P:0.24, R:0.37
 19%|█▉        | 19/100 [04:29<15:06, 11.19s/it]epoch [19/100], focal_loss:0.0452	, anomaly_loss:0.5149	fnorm_loss:0.0248, a_fnorm_loss:0.0355P:0.37, R:0.68
 20%|██        | 20/100 [05:06<25:14, 18.93s/it]epoch [20/100], focal_loss:0.0383	, anomaly_loss:0.5107	fnorm_loss:0.0227, a_fnorm_loss:0.0360P:0.33, R:0.77
normal: 0.1556 0.3078  anomaly: 0.1487 0.3915	P:0.18, R:0.07
Pixel Auroc:0.834, Sample Auroc0.644, Pixel Aupro0.0
test_fnorm_loss: 0.0201 test_afnorm_loss: 0.0138
 21%|██        | 21/100 [05:15<21:06, 16.04s/it]epoch [21/100], focal_loss:0.0371	, anomaly_loss:0.5079	fnorm_loss:0.0213, a_fnorm_loss:0.0359P:0.37, R:0.76
 22%|██▏       | 22/100 [05:24<17:55, 13.79s/it]epoch [22/100], focal_loss:0.0322	, anomaly_loss:0.4866	fnorm_loss:0.0196, a_fnorm_loss:0.0400P:0.39, R:0.83
 23%|██▎       | 23/100 [05:32<15:42, 12.24s/it]epoch [23/100], focal_loss:0.0328	, anomaly_loss:0.4920	fnorm_loss:0.0188, a_fnorm_loss:0.0390P:0.42, R:0.81
 24%|██▍       | 24/100 [05:41<14:13, 11.23s/it]epoch [24/100], focal_loss:0.0303	, anomaly_loss:0.4783	fnorm_loss:0.0179, a_fnorm_loss:0.0418P:0.42, R:0.87
 25%|██▌       | 25/100 [06:12<21:34, 17.26s/it]epoch [25/100], focal_loss:0.0350	, anomaly_loss:0.5088	fnorm_loss:0.0181, a_fnorm_loss:0.0352P:0.41, R:0.76
normal: 0.1621 0.3147  anomaly: 0.1395 0.3936	P:0.15, R:0.09
Pixel Auroc:0.899, Sample Auroc0.684, Pixel Aupro0.0
test_fnorm_loss: 0.0163 test_afnorm_loss: 0.0172
 26%|██▌       | 26/100 [06:21<18:04, 14.66s/it]epoch [26/100], focal_loss:0.0339	, anomaly_loss:0.4931	fnorm_loss:0.0174, a_fnorm_loss:0.0376P:0.42, R:0.79
 27%|██▋       | 27/100 [06:30<15:39, 12.87s/it]epoch [27/100], focal_loss:0.0285	, anomaly_loss:0.4835	fnorm_loss:0.0162, a_fnorm_loss:0.0411P:0.44, R:0.83
 28%|██▊       | 28/100 [06:39<14:06, 11.76s/it]epoch [28/100], focal_loss:0.0302	, anomaly_loss:0.4901	fnorm_loss:0.0156, a_fnorm_loss:0.0403P:0.46, R:0.78
 29%|██▉       | 29/100 [06:47<12:45, 10.78s/it]epoch [29/100], focal_loss:0.0267	, anomaly_loss:0.4816	fnorm_loss:0.0152, a_fnorm_loss:0.0408P:0.44, R:0.83
 30%|███       | 30/100 [07:25<22:06, 18.95s/it]epoch [30/100], focal_loss:0.0264	, anomaly_loss:0.4782	fnorm_loss:0.0147, a_fnorm_loss:0.0416P:0.51, R:0.86
normal: 0.1983 0.4487  anomaly: 0.1816 0.5276	P:0.19, R:0.18
Pixel Auroc:0.901, Sample Auroc0.745, Pixel Aupro0.0
test_fnorm_loss: 0.0134 test_afnorm_loss: 0.0184
 31%|███       | 31/100 [07:34<18:12, 15.83s/it]epoch [31/100], focal_loss:0.0269	, anomaly_loss:0.4776	fnorm_loss:0.0144, a_fnorm_loss:0.0415P:0.45, R:0.82
 32%|███▏      | 32/100 [07:43<15:29, 13.67s/it]epoch [32/100], focal_loss:0.0272	, anomaly_loss:0.4826	fnorm_loss:0.0143, a_fnorm_loss:0.0407P:0.46, R:0.82
 33%|███▎      | 33/100 [07:51<13:35, 12.17s/it]epoch [33/100], focal_loss:0.0251	, anomaly_loss:0.4759	fnorm_loss:0.0140, a_fnorm_loss:0.0417P:0.49, R:0.82
 34%|███▍      | 34/100 [08:00<12:12, 11.10s/it]epoch [34/100], focal_loss:0.0256	, anomaly_loss:0.4782	fnorm_loss:0.0136, a_fnorm_loss:0.0416P:0.50, R:0.82
 35%|███▌      | 35/100 [08:35<19:42, 18.19s/it]epoch [35/100], focal_loss:0.0301	, anomaly_loss:0.4834	fnorm_loss:0.0138, a_fnorm_loss:0.0414P:0.53, R:0.79
normal: 0.1215 0.3427  anomaly: 0.1357 0.4741	P:0.22, R:0.10
Pixel Auroc:0.911, Sample Auroc0.758, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0166
 36%|███▌      | 36/100 [08:43<16:17, 15.28s/it]epoch [36/100], focal_loss:0.0243	, anomaly_loss:0.4837	fnorm_loss:0.0130, a_fnorm_loss:0.0413P:0.49, R:0.82
 37%|███▋      | 37/100 [08:52<13:59, 13.32s/it]epoch [37/100], focal_loss:0.0244	, anomaly_loss:0.4776	fnorm_loss:0.0128, a_fnorm_loss:0.0419P:0.50, R:0.83
 38%|███▊      | 38/100 [09:01<12:25, 12.02s/it]epoch [38/100], focal_loss:0.0335	, anomaly_loss:0.4683	fnorm_loss:0.0137, a_fnorm_loss:0.0438P:0.49, R:0.84
 39%|███▉      | 39/100 [09:10<11:16, 11.10s/it]epoch [39/100], focal_loss:0.0444	, anomaly_loss:0.5404	fnorm_loss:0.0179, a_fnorm_loss:0.0325P:0.33, R:0.45
 40%|████      | 40/100 [09:40<16:54, 16.91s/it]epoch [40/100], focal_loss:0.0359	, anomaly_loss:0.5010	fnorm_loss:0.0135, a_fnorm_loss:0.0398P:0.46, R:0.66
normal: 0.1296 0.2560  anomaly: 0.1315 0.3903	P:0.11, R:0.04
Pixel Auroc:0.904, Sample Auroc0.756, Pixel Aupro0.0
test_fnorm_loss: 0.0129 test_afnorm_loss: 0.0142
 41%|████      | 41/100 [09:49<14:13, 14.47s/it]epoch [41/100], focal_loss:0.0252	, anomaly_loss:0.4779	fnorm_loss:0.0128, a_fnorm_loss:0.0431P:0.51, R:0.85
 42%|████▏     | 42/100 [09:58<12:20, 12.77s/it]epoch [42/100], focal_loss:0.0271	, anomaly_loss:0.4754	fnorm_loss:0.0125, a_fnorm_loss:0.0421P:0.48, R:0.84
 43%|████▎     | 43/100 [10:07<11:04, 11.66s/it]epoch [43/100], focal_loss:0.0237	, anomaly_loss:0.4702	fnorm_loss:0.0121, a_fnorm_loss:0.0427P:0.50, R:0.86
 44%|████▍     | 44/100 [10:15<09:59, 10.71s/it]epoch [44/100], focal_loss:0.0205	, anomaly_loss:0.4605	fnorm_loss:0.0117, a_fnorm_loss:0.0443P:0.49, R:0.86
 45%|████▌     | 45/100 [10:51<16:44, 18.26s/it]epoch [45/100], focal_loss:0.0226	, anomaly_loss:0.4645	fnorm_loss:0.0115, a_fnorm_loss:0.0438P:0.54, R:0.86
normal: 0.1294 0.3377  anomaly: 0.1359 0.5076	P:0.23, R:0.11
Pixel Auroc:0.914, Sample Auroc0.782, Pixel Aupro0.0
test_fnorm_loss: 0.0106 test_afnorm_loss: 0.0173
 46%|████▌     | 46/100 [11:00<13:51, 15.40s/it]epoch [46/100], focal_loss:0.0214	, anomaly_loss:0.4648	fnorm_loss:0.0113, a_fnorm_loss:0.0449P:0.55, R:0.87
 47%|████▋     | 47/100 [11:09<11:53, 13.46s/it]epoch [47/100], focal_loss:0.0224	, anomaly_loss:0.4685	fnorm_loss:0.0112, a_fnorm_loss:0.0446P:0.54, R:0.85
 48%|████▊     | 48/100 [11:18<10:30, 12.12s/it]epoch [48/100], focal_loss:0.0206	, anomaly_loss:0.4663	fnorm_loss:0.0111, a_fnorm_loss:0.0439P:0.51, R:0.86
 49%|████▉     | 49/100 [11:27<09:26, 11.10s/it]epoch [49/100], focal_loss:0.0185	, anomaly_loss:0.4597	fnorm_loss:0.0106, a_fnorm_loss:0.0459P:0.54, R:0.87
 50%|█████     | 50/100 [12:03<15:30, 18.60s/it]epoch [50/100], focal_loss:0.0197	, anomaly_loss:0.4595	fnorm_loss:0.0105, a_fnorm_loss:0.0451P:0.51, R:0.86
normal: 0.1113 0.4009  anomaly: 0.1348 0.5717	P:0.26, R:0.14
Pixel Auroc:0.913, Sample Auroc0.778, Pixel Aupro0.0
test_fnorm_loss: 0.0096 test_afnorm_loss: 0.0182
 51%|█████     | 51/100 [12:12<12:48, 15.69s/it]epoch [51/100], focal_loss:0.0196	, anomaly_loss:0.4619	fnorm_loss:0.0103, a_fnorm_loss:0.0448P:0.52, R:0.85
 52%|█████▏    | 52/100 [12:21<10:57, 13.70s/it]epoch [52/100], focal_loss:0.0218	, anomaly_loss:0.4621	fnorm_loss:0.0108, a_fnorm_loss:0.0447P:0.55, R:0.87
 53%|█████▎    | 53/100 [12:30<09:34, 12.23s/it]epoch [53/100], focal_loss:0.0213	, anomaly_loss:0.4749	fnorm_loss:0.0105, a_fnorm_loss:0.0425P:0.54, R:0.82
 54%|█████▍    | 54/100 [12:38<08:37, 11.25s/it]epoch [54/100], focal_loss:0.0222	, anomaly_loss:0.4648	fnorm_loss:0.0105, a_fnorm_loss:0.0437P:0.54, R:0.85
 55%|█████▌    | 55/100 [13:10<13:02, 17.40s/it]epoch [55/100], focal_loss:0.0254	, anomaly_loss:0.4654	fnorm_loss:0.0106, a_fnorm_loss:0.0449P:0.57, R:0.85
normal: 0.1018 0.3222  anomaly: 0.1059 0.4784	P:0.24, R:0.11
Pixel Auroc:0.929, Sample Auroc0.851, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0179
 56%|█████▌    | 56/100 [13:19<10:50, 14.78s/it]epoch [56/100], focal_loss:0.0190	, anomaly_loss:0.4620	fnorm_loss:0.0101, a_fnorm_loss:0.0444P:0.52, R:0.85
 57%|█████▋    | 57/100 [13:28<09:18, 12.98s/it]epoch [57/100], focal_loss:0.0287	, anomaly_loss:0.4766	fnorm_loss:0.0107, a_fnorm_loss:0.0445P:0.59, R:0.80
 58%|█████▊    | 58/100 [13:36<08:11, 11.71s/it]epoch [58/100], focal_loss:0.0243	, anomaly_loss:0.4664	fnorm_loss:0.0103, a_fnorm_loss:0.0441P:0.55, R:0.84
 59%|█████▉    | 59/100 [13:45<07:21, 10.77s/it]epoch [59/100], focal_loss:0.0198	, anomaly_loss:0.4591	fnorm_loss:0.0101, a_fnorm_loss:0.0457P:0.52, R:0.87
 60%|██████    | 60/100 [14:16<11:15, 16.88s/it]epoch [60/100], focal_loss:0.0192	, anomaly_loss:0.4554	fnorm_loss:0.0097, a_fnorm_loss:0.0455P:0.57, R:0.87
normal: 0.1114 0.4051  anomaly: 0.1422 0.5663	P:0.25, R:0.15
Pixel Auroc:0.922, Sample Auroc0.819, Pixel Aupro0.0
test_fnorm_loss: 0.0089 test_afnorm_loss: 0.0193
 61%|██████    | 61/100 [14:25<09:23, 14.44s/it]epoch [61/100], focal_loss:0.0182	, anomaly_loss:0.4509	fnorm_loss:0.0094, a_fnorm_loss:0.0474P:0.55, R:0.87
 62%|██████▏   | 62/100 [14:34<08:02, 12.70s/it]epoch [62/100], focal_loss:0.0190	, anomaly_loss:0.4631	fnorm_loss:0.0096, a_fnorm_loss:0.0450P:0.51, R:0.87
 63%|██████▎   | 63/100 [14:42<07:05, 11.49s/it]epoch [63/100], focal_loss:0.0195	, anomaly_loss:0.4546	fnorm_loss:0.0095, a_fnorm_loss:0.0469P:0.59, R:0.88
 64%|██████▍   | 64/100 [14:51<06:24, 10.68s/it]epoch [64/100], focal_loss:0.0209	, anomaly_loss:0.4569	fnorm_loss:0.0096, a_fnorm_loss:0.0452P:0.54, R:0.86
 65%|██████▌   | 65/100 [15:27<10:44, 18.42s/it]epoch [65/100], focal_loss:0.0198	, anomaly_loss:0.4543	fnorm_loss:0.0092, a_fnorm_loss:0.0459P:0.59, R:0.87
normal: 0.1531 0.4300  anomaly: 0.1676 0.5656	P:0.26, R:0.16
Pixel Auroc:0.922, Sample Auroc0.791, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0192
 66%|██████▌   | 66/100 [15:36<08:45, 15.46s/it]epoch [66/100], focal_loss:0.0193	, anomaly_loss:0.4557	fnorm_loss:0.0094, a_fnorm_loss:0.0453P:0.54, R:0.88
 67%|██████▋   | 67/100 [15:45<07:23, 13.43s/it]epoch [67/100], focal_loss:0.0187	, anomaly_loss:0.4606	fnorm_loss:0.0090, a_fnorm_loss:0.0447P:0.55, R:0.87
 68%|██████▊   | 68/100 [15:53<06:24, 12.02s/it]epoch [68/100], focal_loss:0.0202	, anomaly_loss:0.4686	fnorm_loss:0.0093, a_fnorm_loss:0.0448P:0.55, R:0.84
 69%|██████▉   | 69/100 [16:02<05:40, 10.98s/it]epoch [69/100], focal_loss:0.0230	, anomaly_loss:0.4638	fnorm_loss:0.0094, a_fnorm_loss:0.0445P:0.55, R:0.85
 70%|███████   | 70/100 [16:33<08:30, 17.02s/it]epoch [70/100], focal_loss:0.0184	, anomaly_loss:0.4537	fnorm_loss:0.0089, a_fnorm_loss:0.0473P:0.59, R:0.88
normal: 0.1199 0.4117  anomaly: 0.1536 0.6065	P:0.25, R:0.17
Pixel Auroc:0.929, Sample Auroc0.825, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0215
 71%|███████   | 71/100 [16:42<07:01, 14.55s/it]epoch [71/100], focal_loss:0.0208	, anomaly_loss:0.4531	fnorm_loss:0.0092, a_fnorm_loss:0.0458P:0.54, R:0.87
 72%|███████▏  | 72/100 [16:50<05:57, 12.76s/it]epoch [72/100], focal_loss:0.0191	, anomaly_loss:0.4518	fnorm_loss:0.0088, a_fnorm_loss:0.0471P:0.57, R:0.88
 73%|███████▎  | 73/100 [16:59<05:11, 11.54s/it]epoch [73/100], focal_loss:0.0229	, anomaly_loss:0.4665	fnorm_loss:0.0091, a_fnorm_loss:0.0445P:0.55, R:0.84
 74%|███████▍  | 74/100 [17:08<04:38, 10.72s/it]epoch [74/100], focal_loss:0.0225	, anomaly_loss:0.4561	fnorm_loss:0.0093, a_fnorm_loss:0.0465P:0.56, R:0.86
 75%|███████▌  | 75/100 [17:40<07:05, 17.04s/it]epoch [75/100], focal_loss:0.0188	, anomaly_loss:0.4570	fnorm_loss:0.0088, a_fnorm_loss:0.0463P:0.57, R:0.87
normal: 0.0702 0.3282  anomaly: 0.0759 0.5104	P:0.23, R:0.09
Pixel Auroc:0.922, Sample Auroc0.817, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0142
 76%|███████▌  | 76/100 [17:49<05:51, 14.66s/it]epoch [76/100], focal_loss:0.0216	, anomaly_loss:0.4558	fnorm_loss:0.0089, a_fnorm_loss:0.0458P:0.58, R:0.86
 77%|███████▋  | 77/100 [17:58<04:58, 12.98s/it]epoch [77/100], focal_loss:0.0172	, anomaly_loss:0.4502	fnorm_loss:0.0085, a_fnorm_loss:0.0474P:0.58, R:0.89
 78%|███████▊  | 78/100 [18:07<04:19, 11.79s/it]epoch [78/100], focal_loss:0.0191	, anomaly_loss:0.4508	fnorm_loss:0.0086, a_fnorm_loss:0.0463P:0.58, R:0.88
 79%|███████▉  | 79/100 [18:16<03:48, 10.90s/it]epoch [79/100], focal_loss:0.0189	, anomaly_loss:0.4552	fnorm_loss:0.0084, a_fnorm_loss:0.0462P:0.56, R:0.87
 80%|████████  | 80/100 [18:52<06:10, 18.55s/it]epoch [80/100], focal_loss:0.0199	, anomaly_loss:0.4537	fnorm_loss:0.0087, a_fnorm_loss:0.0467P:0.58, R:0.88
normal: 0.1238 0.3844  anomaly: 0.1338 0.5879	P:0.28, R:0.16
Pixel Auroc:0.930, Sample Auroc0.820, Pixel Aupro0.0
test_fnorm_loss: 0.0080 test_afnorm_loss: 0.0196
 81%|████████  | 81/100 [19:01<04:56, 15.63s/it]epoch [81/100], focal_loss:0.0172	, anomaly_loss:0.4478	fnorm_loss:0.0086, a_fnorm_loss:0.0463P:0.55, R:0.90
 82%|████████▏ | 82/100 [19:10<04:06, 13.67s/it]epoch [82/100], focal_loss:0.0161	, anomaly_loss:0.4457	fnorm_loss:0.0083, a_fnorm_loss:0.0476P:0.57, R:0.89
 83%|████████▎ | 83/100 [19:19<03:28, 12.25s/it]epoch [83/100], focal_loss:0.0182	, anomaly_loss:0.4513	fnorm_loss:0.0084, a_fnorm_loss:0.0475P:0.54, R:0.88
 84%|████████▍ | 84/100 [19:28<02:59, 11.25s/it]epoch [84/100], focal_loss:0.0191	, anomaly_loss:0.4556	fnorm_loss:0.0084, a_fnorm_loss:0.0470P:0.58, R:0.88
 85%|████████▌ | 85/100 [19:59<04:18, 17.26s/it]epoch [85/100], focal_loss:0.0180	, anomaly_loss:0.4518	fnorm_loss:0.0085, a_fnorm_loss:0.0469P:0.56, R:0.87
normal: 0.1038 0.3844  anomaly: 0.1279 0.5855	P:0.28, R:0.16
Pixel Auroc:0.936, Sample Auroc0.834, Pixel Aupro0.0
test_fnorm_loss: 0.0080 test_afnorm_loss: 0.0207
 86%|████████▌ | 86/100 [20:08<03:25, 14.70s/it]epoch [86/100], focal_loss:0.0167	, anomaly_loss:0.4531	fnorm_loss:0.0084, a_fnorm_loss:0.0469P:0.55, R:0.87
 87%|████████▋ | 87/100 [20:17<02:48, 12.95s/it]epoch [87/100], focal_loss:0.0189	, anomaly_loss:0.4523	fnorm_loss:0.0084, a_fnorm_loss:0.0476P:0.60, R:0.88
 88%|████████▊ | 88/100 [20:26<02:20, 11.69s/it]epoch [88/100], focal_loss:0.0167	, anomaly_loss:0.4471	fnorm_loss:0.0082, a_fnorm_loss:0.0474P:0.56, R:0.89
 89%|████████▉ | 89/100 [20:34<01:59, 10.84s/it]epoch [89/100], focal_loss:0.0162	, anomaly_loss:0.4496	fnorm_loss:0.0082, a_fnorm_loss:0.0475P:0.57, R:0.88
 90%|█████████ | 90/100 [21:11<03:06, 18.65s/it]epoch [90/100], focal_loss:0.0199	, anomaly_loss:0.4546	fnorm_loss:0.0084, a_fnorm_loss:0.0468P:0.58, R:0.87
normal: 0.0898 0.3770  anomaly: 0.1153 0.5824	P:0.29, R:0.15
Pixel Auroc:0.935, Sample Auroc0.837, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0193
 91%|█████████ | 91/100 [21:20<02:21, 15.74s/it]epoch [91/100], focal_loss:0.0182	, anomaly_loss:0.4598	fnorm_loss:0.0084, a_fnorm_loss:0.0448P:0.53, R:0.86
 92%|█████████▏| 92/100 [21:29<01:49, 13.66s/it]epoch [92/100], focal_loss:0.0147	, anomaly_loss:0.4462	fnorm_loss:0.0082, a_fnorm_loss:0.0475P:0.54, R:0.89
 93%|█████████▎| 93/100 [21:39<01:26, 12.41s/it]epoch [93/100], focal_loss:0.0182	, anomaly_loss:0.4514	fnorm_loss:0.0083, a_fnorm_loss:0.0477P:0.57, R:0.88
 94%|█████████▍| 94/100 [21:47<01:08, 11.37s/it]epoch [94/100], focal_loss:0.0186	, anomaly_loss:0.4544	fnorm_loss:0.0084, a_fnorm_loss:0.0463P:0.56, R:0.87
 95%|█████████▌| 95/100 [22:19<01:27, 17.52s/it]epoch [95/100], focal_loss:0.0159	, anomaly_loss:0.4430	fnorm_loss:0.0083, a_fnorm_loss:0.0481P:0.57, R:0.90
normal: 0.0848 0.3717  anomaly: 0.1054 0.5844	P:0.28, R:0.14
Pixel Auroc:0.935, Sample Auroc0.834, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0189
 96%|█████████▌| 96/100 [22:28<00:59, 14.90s/it]epoch [96/100], focal_loss:0.0173	, anomaly_loss:0.4468	fnorm_loss:0.0083, a_fnorm_loss:0.0482P:0.58, R:0.89
 97%|█████████▋| 97/100 [22:37<00:39, 13.10s/it]epoch [97/100], focal_loss:0.0192	, anomaly_loss:0.4483	fnorm_loss:0.0085, a_fnorm_loss:0.0481P:0.57, R:0.89
 98%|█████████▊| 98/100 [22:46<00:23, 11.74s/it]epoch [98/100], focal_loss:0.0175	, anomaly_loss:0.4569	fnorm_loss:0.0082, a_fnorm_loss:0.0467P:0.55, R:0.87
 99%|█████████▉| 99/100 [22:54<00:10, 10.89s/it]epoch [99/100], focal_loss:0.0182	, anomaly_loss:0.4565	fnorm_loss:0.0084, a_fnorm_loss:0.0455P:0.54, R:0.86
100%|██████████| 100/100 [23:27<00:00, 17.44s/it]100%|██████████| 100/100 [23:27<00:00, 14.08s/it]
epoch [100/100], focal_loss:0.0176	, anomaly_loss:0.4469	fnorm_loss:0.0083, a_fnorm_loss:0.0478P:0.59, R:0.90
normal: 0.0802 0.3643  anomaly: 0.0989 0.5867	P:0.28, R:0.14
Pixel Auroc:0.935, Sample Auroc0.836, Pixel Aupro0.0
test_fnorm_loss: 0.0075 test_afnorm_loss: 0.0183
training Stubborn Student...
cable
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:31,  5.31s/it]epoch [1/120], kd_loss:4.7954
  2%|▏         | 2/120 [00:10<10:37,  5.40s/it]epoch [2/120], kd_loss:3.9831
  2%|▎         | 3/120 [00:16<10:27,  5.37s/it]epoch [3/120], kd_loss:3.6931
  3%|▎         | 4/120 [00:21<10:22,  5.36s/it]epoch [4/120], kd_loss:3.1973
  4%|▍         | 5/120 [00:26<10:13,  5.34s/it]epoch [5/120], kd_loss:2.8238
  5%|▌         | 6/120 [00:32<10:09,  5.34s/it]epoch [6/120], kd_loss:2.7230
  6%|▌         | 7/120 [00:37<10:05,  5.36s/it]epoch [7/120], kd_loss:2.7560
  7%|▋         | 8/120 [00:42<10:03,  5.39s/it]epoch [8/120], kd_loss:2.6101
  8%|▊         | 9/120 [00:48<10:00,  5.41s/it]epoch [9/120], kd_loss:2.7787
  8%|▊         | 10/120 [01:15<21:59, 11.99s/it]epoch [10/120], kd_loss:2.6031
normal: 1.5274 1.9508  anomaly: 1.5890 2.2818
thresh: 1.6903251126019616
fpr: 0.3275862068965517 fnr 0.07608695652173914
Pixel Auroc:0.926, Sample Auroc0.888, Pixel Aupro0.0
  9%|▉         | 11/120 [01:20<18:07,  9.98s/it]epoch [11/120], kd_loss:2.5191
 10%|█         | 12/120 [01:25<15:23,  8.55s/it]epoch [12/120], kd_loss:2.4581
 11%|█         | 13/120 [01:31<13:31,  7.58s/it]epoch [13/120], kd_loss:2.3147
 12%|█▏        | 14/120 [01:36<12:12,  6.91s/it]epoch [14/120], kd_loss:2.2786
 12%|█▎        | 15/120 [01:41<11:16,  6.44s/it]epoch [15/120], kd_loss:2.3136
 13%|█▎        | 16/120 [01:47<10:39,  6.15s/it]epoch [16/120], kd_loss:2.3053
 14%|█▍        | 17/120 [01:52<10:09,  5.92s/it]epoch [17/120], kd_loss:2.9456
 15%|█▌        | 18/120 [01:58<09:48,  5.77s/it]epoch [18/120], kd_loss:2.3578
 16%|█▌        | 19/120 [02:03<09:31,  5.66s/it]epoch [19/120], kd_loss:2.3186
 17%|█▋        | 20/120 [02:31<20:34, 12.35s/it]epoch [20/120], kd_loss:2.4397
normal: 1.4215 1.8601  anomaly: 1.4989 2.1418
thresh: 1.5981527304499692
fpr: 0.39655172413793105 fnr 0.07608695652173914
Pixel Auroc:0.890, Sample Auroc0.885, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:36<16:56, 10.27s/it]epoch [21/120], kd_loss:2.4663
 18%|█▊        | 22/120 [02:42<14:21,  8.79s/it]epoch [22/120], kd_loss:2.4662
 19%|█▉        | 23/120 [02:47<12:33,  7.77s/it]epoch [23/120], kd_loss:2.2887
 20%|██        | 24/120 [02:53<11:17,  7.05s/it]epoch [24/120], kd_loss:2.2100
 21%|██        | 25/120 [02:58<10:22,  6.55s/it]epoch [25/120], kd_loss:2.1534
 22%|██▏       | 26/120 [03:03<09:43,  6.21s/it]epoch [26/120], kd_loss:2.0901
 22%|██▎       | 27/120 [03:09<09:13,  5.95s/it]epoch [27/120], kd_loss:2.0897
 23%|██▎       | 28/120 [03:14<08:50,  5.77s/it]epoch [28/120], kd_loss:2.0194
 24%|██▍       | 29/120 [03:19<08:34,  5.65s/it]epoch [29/120], kd_loss:1.9850
 25%|██▌       | 30/120 [03:47<18:28, 12.31s/it]epoch [30/120], kd_loss:2.4488
normal: 1.3667 1.8314  anomaly: 1.3888 2.2071
thresh: 1.5723969184411453
fpr: 0.25862068965517243 fnr 0.06521739130434782
Pixel Auroc:0.923, Sample Auroc0.920, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:53<15:09, 10.22s/it]epoch [31/120], kd_loss:2.1746
 27%|██▋       | 32/120 [03:58<12:49,  8.75s/it]epoch [32/120], kd_loss:2.0428
 28%|██▊       | 33/120 [04:03<11:11,  7.72s/it]epoch [33/120], kd_loss:1.9877
 28%|██▊       | 34/120 [04:09<10:02,  7.01s/it]epoch [34/120], kd_loss:2.0643
 29%|██▉       | 35/120 [04:14<09:14,  6.52s/it]epoch [35/120], kd_loss:1.9961
 30%|███       | 36/120 [04:19<08:38,  6.17s/it]epoch [36/120], kd_loss:1.9377
 31%|███       | 37/120 [04:25<08:12,  5.94s/it]epoch [37/120], kd_loss:1.9226
 32%|███▏      | 38/120 [04:30<07:52,  5.77s/it]epoch [38/120], kd_loss:1.9048
 32%|███▎      | 39/120 [04:36<07:39,  5.67s/it]epoch [39/120], kd_loss:2.0301
 33%|███▎      | 40/120 [05:03<16:18, 12.23s/it]epoch [40/120], kd_loss:1.9461
normal: 1.1418 1.7584  anomaly: 1.2548 2.1368
thresh: 1.4448518216031265
fpr: 0.1896551724137931 fnr 0.11956521739130435
Pixel Auroc:0.947, Sample Auroc0.909, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:08<13:23, 10.17s/it]epoch [41/120], kd_loss:1.8996
 35%|███▌      | 42/120 [05:14<11:19,  8.71s/it]epoch [42/120], kd_loss:1.8770
 36%|███▌      | 43/120 [05:19<09:53,  7.71s/it]epoch [43/120], kd_loss:1.9988
 37%|███▋      | 44/120 [05:25<08:53,  7.02s/it]epoch [44/120], kd_loss:1.8815
 38%|███▊      | 45/120 [05:30<08:11,  6.55s/it]epoch [45/120], kd_loss:1.9107
 38%|███▊      | 46/120 [05:35<07:39,  6.22s/it]epoch [46/120], kd_loss:1.8973
 39%|███▉      | 47/120 [05:41<07:16,  5.97s/it]epoch [47/120], kd_loss:2.4190
 40%|████      | 48/120 [05:46<06:58,  5.82s/it]epoch [48/120], kd_loss:1.9622
 41%|████      | 49/120 [05:52<06:44,  5.70s/it]epoch [49/120], kd_loss:1.9075
 42%|████▏     | 50/120 [06:18<13:53, 11.91s/it]epoch [50/120], kd_loss:1.9273
normal: 1.2309 1.8423  anomaly: 1.2902 2.1797
thresh: 1.420135350411962
fpr: 0.3275862068965517 fnr 0.05434782608695652
Pixel Auroc:0.944, Sample Auroc0.910, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:24<11:29,  9.99s/it]epoch [51/120], kd_loss:1.8888
 43%|████▎     | 52/120 [06:29<09:47,  8.64s/it]epoch [52/120], kd_loss:1.8475
 44%|████▍     | 53/120 [06:34<08:33,  7.67s/it]epoch [53/120], kd_loss:1.8441
 45%|████▌     | 54/120 [06:40<07:42,  7.00s/it]epoch [54/120], kd_loss:1.8358
 46%|████▌     | 55/120 [06:45<07:04,  6.53s/it]epoch [55/120], kd_loss:1.8821
 47%|████▋     | 56/120 [06:51<06:35,  6.19s/it]epoch [56/120], kd_loss:1.8531
 48%|████▊     | 57/120 [06:56<06:16,  5.98s/it]epoch [57/120], kd_loss:1.8147
 48%|████▊     | 58/120 [07:02<05:59,  5.80s/it]epoch [58/120], kd_loss:1.8715
 49%|████▉     | 59/120 [07:07<05:47,  5.69s/it]epoch [59/120], kd_loss:1.7917
 50%|█████     | 60/120 [07:35<12:23, 12.39s/it]epoch [60/120], kd_loss:1.7764
normal: 1.0660 1.6713  anomaly: 1.1650 2.1075
thresh: 1.2625984009835163
fpr: 0.27586206896551724 fnr 0.05434782608695652
Pixel Auroc:0.950, Sample Auroc0.923, Pixel Aupro0.0
 51%|█████     | 61/120 [07:41<10:09, 10.33s/it]epoch [61/120], kd_loss:1.7817
 52%|█████▏    | 62/120 [07:46<08:33,  8.86s/it]epoch [62/120], kd_loss:1.7643
 52%|█████▎    | 63/120 [07:52<07:27,  7.86s/it]epoch [63/120], kd_loss:1.7902
 53%|█████▎    | 64/120 [07:57<06:39,  7.13s/it]epoch [64/120], kd_loss:1.7640
 54%|█████▍    | 65/120 [08:02<06:04,  6.63s/it]epoch [65/120], kd_loss:1.7448
 55%|█████▌    | 66/120 [08:08<05:40,  6.30s/it]epoch [66/120], kd_loss:2.1923
 56%|█████▌    | 67/120 [08:13<05:20,  6.05s/it]epoch [67/120], kd_loss:2.7738
 57%|█████▋    | 68/120 [08:19<05:06,  5.89s/it]epoch [68/120], kd_loss:2.0034
 57%|█████▊    | 69/120 [08:25<04:55,  5.79s/it]epoch [69/120], kd_loss:1.9123
 58%|█████▊    | 70/120 [08:52<10:10, 12.20s/it]epoch [70/120], kd_loss:1.8978
normal: 2.5929 2.8690  anomaly: 2.5917 2.9197
thresh: 2.6348417558167565
fpr: 0.9137931034482759 fnr 0.03260869565217391
Pixel Auroc:0.740, Sample Auroc0.537, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:57<08:17, 10.15s/it]epoch [71/120], kd_loss:2.3533
 60%|██████    | 72/120 [09:03<07:00,  8.77s/it]epoch [72/120], kd_loss:1.8887
 61%|██████    | 73/120 [09:08<06:03,  7.74s/it]epoch [73/120], kd_loss:1.8447
 62%|██████▏   | 74/120 [09:13<05:23,  7.02s/it]epoch [74/120], kd_loss:1.8456
 62%|██████▎   | 75/120 [09:19<04:53,  6.52s/it]epoch [75/120], kd_loss:1.8018
 63%|██████▎   | 76/120 [09:24<04:32,  6.20s/it]epoch [76/120], kd_loss:1.8722
 64%|██████▍   | 77/120 [09:30<04:17,  5.99s/it]epoch [77/120], kd_loss:1.9026
 65%|██████▌   | 78/120 [09:35<04:06,  5.86s/it]epoch [78/120], kd_loss:2.0160
 66%|██████▌   | 79/120 [09:41<03:55,  5.74s/it]epoch [79/120], kd_loss:1.7971
 67%|██████▋   | 80/120 [10:09<08:19, 12.48s/it]epoch [80/120], kd_loss:1.7816
normal: 1.0552 1.6157  anomaly: 1.1646 2.0698
thresh: 1.3284535738708294
fpr: 0.20689655172413793 fnr 0.08695652173913043
Pixel Auroc:0.956, Sample Auroc0.936, Pixel Aupro0.0
 68%|██████▊   | 81/120 [10:14<06:44, 10.37s/it]epoch [81/120], kd_loss:1.7679
 68%|██████▊   | 82/120 [10:20<05:38,  8.90s/it]epoch [82/120], kd_loss:1.7865
 69%|██████▉   | 83/120 [10:25<04:50,  7.85s/it]epoch [83/120], kd_loss:1.7421
 70%|███████   | 84/120 [10:30<04:15,  7.10s/it]epoch [84/120], kd_loss:1.7425
 71%|███████   | 85/120 [10:36<03:50,  6.58s/it]epoch [85/120], kd_loss:1.7531
 72%|███████▏  | 86/120 [10:41<03:31,  6.23s/it]epoch [86/120], kd_loss:1.8359
 72%|███████▎  | 87/120 [10:47<03:18,  6.01s/it]epoch [87/120], kd_loss:1.8150
 73%|███████▎  | 88/120 [10:52<03:07,  5.86s/it]epoch [88/120], kd_loss:1.7613
 74%|███████▍  | 89/120 [10:58<02:58,  5.75s/it]epoch [89/120], kd_loss:1.8823
 75%|███████▌  | 90/120 [11:25<06:03, 12.11s/it]epoch [90/120], kd_loss:2.1332
normal: 1.0806 1.6755  anomaly: 1.1751 2.1147
thresh: 1.365163779491232
fpr: 0.20689655172413793 fnr 0.10869565217391304
Pixel Auroc:0.955, Sample Auroc0.917, Pixel Aupro0.0
 76%|███████▌  | 91/120 [11:30<04:52, 10.09s/it]epoch [91/120], kd_loss:1.8081
 77%|███████▋  | 92/120 [11:35<04:03,  8.68s/it]epoch [92/120], kd_loss:2.0943
 78%|███████▊  | 93/120 [11:41<03:27,  7.70s/it]epoch [93/120], kd_loss:1.8541
 78%|███████▊  | 94/120 [11:46<03:03,  7.04s/it]epoch [94/120], kd_loss:1.7798
 79%|███████▉  | 95/120 [11:52<02:44,  6.59s/it]epoch [95/120], kd_loss:1.7600
 80%|████████  | 96/120 [11:57<02:30,  6.26s/it]epoch [96/120], kd_loss:1.7581
 81%|████████  | 97/120 [12:03<02:19,  6.05s/it]epoch [97/120], kd_loss:1.7585
 82%|████████▏ | 98/120 [12:09<02:09,  5.90s/it]epoch [98/120], kd_loss:1.7388
 82%|████████▎ | 99/120 [12:14<02:01,  5.81s/it]epoch [99/120], kd_loss:1.7311
 83%|████████▎ | 100/120 [12:43<04:14, 12.74s/it]epoch [100/120], kd_loss:1.7273
normal: 1.0440 1.5521  anomaly: 1.1466 2.0706
thresh: 1.2938374982005985
fpr: 0.1896551724137931 fnr 0.08695652173913043
Pixel Auroc:0.959, Sample Auroc0.937, Pixel Aupro0.0
 84%|████████▍ | 101/120 [12:48<03:19, 10.52s/it]epoch [101/120], kd_loss:1.7211
 85%|████████▌ | 102/120 [12:54<02:41,  8.99s/it]epoch [102/120], kd_loss:1.7169
 86%|████████▌ | 103/120 [12:59<02:14,  7.93s/it]epoch [103/120], kd_loss:1.7149
 87%|████████▋ | 104/120 [13:05<01:55,  7.20s/it]epoch [104/120], kd_loss:1.7108
 88%|████████▊ | 105/120 [13:10<01:39,  6.64s/it]epoch [105/120], kd_loss:1.7056
 88%|████████▊ | 106/120 [13:15<01:27,  6.26s/it]epoch [106/120], kd_loss:1.7035
 89%|████████▉ | 107/120 [13:21<01:18,  6.04s/it]epoch [107/120], kd_loss:1.6997
 90%|█████████ | 108/120 [13:26<01:10,  5.86s/it]epoch [108/120], kd_loss:1.6979
 91%|█████████ | 109/120 [13:32<01:03,  5.74s/it]epoch [109/120], kd_loss:1.6936
 92%|█████████▏| 110/120 [13:58<01:59, 11.95s/it]epoch [110/120], kd_loss:1.6926
normal: 1.0070 1.6110  anomaly: 1.1209 2.0690
thresh: 1.288241298794107
fpr: 0.1724137931034483 fnr 0.10869565217391304
Pixel Auroc:0.961, Sample Auroc0.934, Pixel Aupro0.0
 92%|█████████▎| 111/120 [14:04<01:30, 10.03s/it]epoch [111/120], kd_loss:1.6919
 93%|█████████▎| 112/120 [14:09<01:09,  8.66s/it]epoch [112/120], kd_loss:1.6906
 94%|█████████▍| 113/120 [14:15<00:53,  7.69s/it]epoch [113/120], kd_loss:1.6899
 95%|█████████▌| 114/120 [14:20<00:41,  6.98s/it]epoch [114/120], kd_loss:1.6890
 96%|█████████▌| 115/120 [14:25<00:32,  6.51s/it]epoch [115/120], kd_loss:1.6887
 97%|█████████▋| 116/120 [14:31<00:24,  6.18s/it]epoch [116/120], kd_loss:1.6888
 98%|█████████▊| 117/120 [14:36<00:17,  5.94s/it]epoch [117/120], kd_loss:1.6879
 98%|█████████▊| 118/120 [14:42<00:11,  5.80s/it]epoch [118/120], kd_loss:1.6874
 99%|█████████▉| 119/120 [14:47<00:05,  5.68s/it]epoch [119/120], kd_loss:1.6859
100%|██████████| 120/120 [15:14<00:00, 12.07s/it]100%|██████████| 120/120 [15:14<00:00,  7.62s/it]
epoch [120/120], kd_loss:1.6859
normal: 1.0049 1.6067  anomaly: 1.1271 2.0749
thresh: 1.2584623326408941
fpr: 0.22413793103448276 fnr 0.07608695652173914
Pixel Auroc:0.961, Sample Auroc0.937, Pixel Aupro0.0
training Advanced Teacher...
capsule
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:29<48:11, 29.20s/it]epoch [1/100], focal_loss:0.0793	, anomaly_loss:0.5792	fnorm_loss:0.0751, a_fnorm_loss:0.0171P:0.00, R:0.02
normal: 0.2586 0.2652  anomaly: 0.2479 0.2644	P:0.00, R:0.00
Pixel Auroc:0.712, Sample Auroc0.298, Pixel Aupro0.0
test_fnorm_loss: 0.0778 test_afnorm_loss: 0.0193
  2%|▏         | 2/100 [00:38<28:39, 17.54s/it]epoch [2/100], focal_loss:0.0693	, anomaly_loss:0.5667	fnorm_loss:0.0727, a_fnorm_loss:0.0167P:0.00, R:0.00
  3%|▎         | 3/100 [00:47<21:49, 13.50s/it]epoch [3/100], focal_loss:0.0601	, anomaly_loss:0.5880	fnorm_loss:0.0654, a_fnorm_loss:0.0152P:0.00, R:0.00
  4%|▍         | 4/100 [00:56<18:39, 11.66s/it]epoch [4/100], focal_loss:0.0557	, anomaly_loss:0.6018	fnorm_loss:0.0593, a_fnorm_loss:0.0136P:0.00, R:0.00
  5%|▌         | 5/100 [01:24<28:06, 17.75s/it]epoch [5/100], focal_loss:0.0481	, anomaly_loss:0.6071	fnorm_loss:0.0548, a_fnorm_loss:0.0128P:0.00, R:0.00
normal: 0.1782 0.1827  anomaly: 0.1741 0.1830	P:0.00, R:0.00
Pixel Auroc:0.730, Sample Auroc0.349, Pixel Aupro0.0
test_fnorm_loss: 0.0537 test_afnorm_loss: 0.0135
  6%|▌         | 6/100 [01:33<23:13, 14.83s/it]epoch [6/100], focal_loss:0.0487	, anomaly_loss:0.6230	fnorm_loss:0.0512, a_fnorm_loss:0.0120P:0.00, R:0.00
  7%|▋         | 7/100 [01:42<19:56, 12.86s/it]epoch [7/100], focal_loss:0.0509	, anomaly_loss:0.6203	fnorm_loss:0.0520, a_fnorm_loss:0.0132P:0.00, R:0.02
  8%|▊         | 8/100 [01:51<18:00, 11.75s/it]epoch [8/100], focal_loss:0.0442	, anomaly_loss:0.5428	fnorm_loss:0.0476, a_fnorm_loss:0.0265P:0.06, R:0.24
  9%|▉         | 9/100 [02:00<16:28, 10.87s/it]epoch [9/100], focal_loss:0.0392	, anomaly_loss:0.5194	fnorm_loss:0.0419, a_fnorm_loss:0.0341P:0.08, R:0.30
 10%|█         | 10/100 [02:31<25:15, 16.84s/it]epoch [10/100], focal_loss:0.0370	, anomaly_loss:0.5064	fnorm_loss:0.0383, a_fnorm_loss:0.0377P:0.10, R:0.31
normal: 0.1300 0.2091  anomaly: 0.1302 0.2624	P:0.10, R:0.11
Pixel Auroc:0.904, Sample Auroc0.834, Pixel Aupro0.0
test_fnorm_loss: 0.0367 test_afnorm_loss: 0.0231
 11%|█         | 11/100 [02:40<21:29, 14.49s/it]epoch [11/100], focal_loss:0.0377	, anomaly_loss:0.5063	fnorm_loss:0.0360, a_fnorm_loss:0.0386P:0.12, R:0.31
 12%|█▏        | 12/100 [02:49<18:41, 12.75s/it]epoch [12/100], focal_loss:0.0416	, anomaly_loss:0.5125	fnorm_loss:0.0355, a_fnorm_loss:0.0392P:0.12, R:0.31
 13%|█▎        | 13/100 [02:58<16:51, 11.62s/it]epoch [13/100], focal_loss:0.0337	, anomaly_loss:0.5130	fnorm_loss:0.0324, a_fnorm_loss:0.0386P:0.10, R:0.31
 14%|█▍        | 14/100 [03:06<15:26, 10.78s/it]epoch [14/100], focal_loss:0.0356	, anomaly_loss:0.5109	fnorm_loss:0.0317, a_fnorm_loss:0.0390P:0.11, R:0.33
 15%|█▌        | 15/100 [03:39<24:34, 17.35s/it]epoch [15/100], focal_loss:0.0349	, anomaly_loss:0.4902	fnorm_loss:0.0297, a_fnorm_loss:0.0412P:0.15, R:0.40
normal: 0.2123 0.2810  anomaly: 0.2136 0.3799	P:0.13, R:0.30
Pixel Auroc:0.940, Sample Auroc0.818, Pixel Aupro0.0
test_fnorm_loss: 0.0286 test_afnorm_loss: 0.0243
 16%|█▌        | 16/100 [03:48<20:52, 14.91s/it]epoch [16/100], focal_loss:0.0291	, anomaly_loss:0.4698	fnorm_loss:0.0276, a_fnorm_loss:0.0432P:0.18, R:0.58
 17%|█▋        | 17/100 [03:57<18:10, 13.13s/it]epoch [17/100], focal_loss:0.0275	, anomaly_loss:0.4519	fnorm_loss:0.0254, a_fnorm_loss:0.0444P:0.22, R:0.60
 18%|█▊        | 18/100 [04:06<16:17, 11.92s/it]epoch [18/100], focal_loss:0.0268	, anomaly_loss:0.4440	fnorm_loss:0.0239, a_fnorm_loss:0.0454P:0.25, R:0.62
 19%|█▉        | 19/100 [04:15<14:48, 10.96s/it]epoch [19/100], focal_loss:0.0283	, anomaly_loss:0.4617	fnorm_loss:0.0228, a_fnorm_loss:0.0446P:0.25, R:0.58
 20%|██        | 20/100 [04:48<23:30, 17.63s/it]epoch [20/100], focal_loss:0.0273	, anomaly_loss:0.4488	fnorm_loss:0.0218, a_fnorm_loss:0.0454P:0.28, R:0.61
normal: 0.0975 0.2520  anomaly: 0.1026 0.4881	P:0.21, R:0.25
Pixel Auroc:0.951, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0206 test_afnorm_loss: 0.0306
 21%|██        | 21/100 [04:57<19:50, 15.06s/it]epoch [21/100], focal_loss:0.0266	, anomaly_loss:0.4474	fnorm_loss:0.0206, a_fnorm_loss:0.0469P:0.29, R:0.61
 22%|██▏       | 22/100 [05:06<17:08, 13.19s/it]epoch [22/100], focal_loss:0.0272	, anomaly_loss:0.4489	fnorm_loss:0.0201, a_fnorm_loss:0.0468P:0.30, R:0.60
 23%|██▎       | 23/100 [05:15<15:20, 11.96s/it]epoch [23/100], focal_loss:0.0229	, anomaly_loss:0.4380	fnorm_loss:0.0190, a_fnorm_loss:0.0482P:0.30, R:0.62
 24%|██▍       | 24/100 [05:24<13:57, 11.02s/it]epoch [24/100], focal_loss:0.0231	, anomaly_loss:0.4318	fnorm_loss:0.0180, a_fnorm_loss:0.0496P:0.32, R:0.63
 25%|██▌       | 25/100 [05:53<20:27, 16.36s/it]epoch [25/100], focal_loss:0.0248	, anomaly_loss:0.4404	fnorm_loss:0.0178, a_fnorm_loss:0.0487P:0.31, R:0.62
normal: 0.0911 0.1707  anomaly: 0.0869 0.4626	P:0.14, R:0.15
Pixel Auroc:0.946, Sample Auroc0.889, Pixel Aupro0.0
test_fnorm_loss: 0.0169 test_afnorm_loss: 0.0264
 26%|██▌       | 26/100 [06:02<17:20, 14.06s/it]epoch [26/100], focal_loss:0.0217	, anomaly_loss:0.4267	fnorm_loss:0.0171, a_fnorm_loss:0.0503P:0.27, R:0.63
 27%|██▋       | 27/100 [06:10<15:12, 12.50s/it]epoch [27/100], focal_loss:0.0207	, anomaly_loss:0.4314	fnorm_loss:0.0163, a_fnorm_loss:0.0503P:0.32, R:0.63
 28%|██▊       | 28/100 [06:19<13:43, 11.44s/it]epoch [28/100], focal_loss:0.0227	, anomaly_loss:0.4329	fnorm_loss:0.0160, a_fnorm_loss:0.0498P:0.35, R:0.62
 29%|██▉       | 29/100 [06:28<12:32, 10.60s/it]epoch [29/100], focal_loss:0.0253	, anomaly_loss:0.4487	fnorm_loss:0.0160, a_fnorm_loss:0.0475P:0.33, R:0.56
 30%|███       | 30/100 [06:57<18:47, 16.11s/it]epoch [30/100], focal_loss:0.0223	, anomaly_loss:0.4387	fnorm_loss:0.0153, a_fnorm_loss:0.0494P:0.30, R:0.63
normal: 0.0863 0.2092  anomaly: 0.0896 0.4677	P:0.20, R:0.19
Pixel Auroc:0.955, Sample Auroc0.903, Pixel Aupro0.0
test_fnorm_loss: 0.0145 test_afnorm_loss: 0.0246
 31%|███       | 31/100 [07:06<16:09, 14.04s/it]epoch [31/100], focal_loss:0.0209	, anomaly_loss:0.4287	fnorm_loss:0.0148, a_fnorm_loss:0.0492P:0.32, R:0.62
 32%|███▏      | 32/100 [07:15<14:05, 12.44s/it]epoch [32/100], focal_loss:0.0223	, anomaly_loss:0.4277	fnorm_loss:0.0147, a_fnorm_loss:0.0495P:0.30, R:0.62
 33%|███▎      | 33/100 [07:24<12:42, 11.38s/it]epoch [33/100], focal_loss:0.0196	, anomaly_loss:0.4228	fnorm_loss:0.0139, a_fnorm_loss:0.0527P:0.33, R:0.64
 34%|███▍      | 34/100 [07:33<11:42, 10.64s/it]epoch [34/100], focal_loss:0.0210	, anomaly_loss:0.4312	fnorm_loss:0.0138, a_fnorm_loss:0.0521P:0.33, R:0.63
 35%|███▌      | 35/100 [08:05<18:39, 17.23s/it]epoch [35/100], focal_loss:0.0243	, anomaly_loss:0.4393	fnorm_loss:0.0140, a_fnorm_loss:0.0496P:0.32, R:0.58
normal: 0.1175 0.2481  anomaly: 0.1189 0.4926	P:0.21, R:0.24
Pixel Auroc:0.957, Sample Auroc0.902, Pixel Aupro0.0
test_fnorm_loss: 0.0134 test_afnorm_loss: 0.0323
 36%|███▌      | 36/100 [08:15<15:49, 14.83s/it]epoch [36/100], focal_loss:0.0223	, anomaly_loss:0.4371	fnorm_loss:0.0136, a_fnorm_loss:0.0495P:0.32, R:0.62
 37%|███▋      | 37/100 [08:24<13:47, 13.14s/it]epoch [37/100], focal_loss:0.0201	, anomaly_loss:0.4068	fnorm_loss:0.0134, a_fnorm_loss:0.0509P:0.30, R:0.73
 38%|███▊      | 38/100 [08:33<12:16, 11.89s/it]epoch [38/100], focal_loss:0.0188	, anomaly_loss:0.4089	fnorm_loss:0.0130, a_fnorm_loss:0.0517P:0.44, R:0.79
 39%|███▉      | 39/100 [08:42<11:15, 11.08s/it]epoch [39/100], focal_loss:0.0191	, anomaly_loss:0.4252	fnorm_loss:0.0143, a_fnorm_loss:0.0455P:0.38, R:0.77
 40%|████      | 40/100 [09:15<17:43, 17.72s/it]epoch [40/100], focal_loss:0.0153	, anomaly_loss:0.3910	fnorm_loss:0.0128, a_fnorm_loss:0.0530P:0.43, R:0.88
normal: 0.1352 0.2913  anomaly: 0.1299 0.5902	P:0.31, R:0.40
Pixel Auroc:0.957, Sample Auroc0.882, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0331
 41%|████      | 41/100 [09:24<14:50, 15.09s/it]epoch [41/100], focal_loss:0.0140	, anomaly_loss:0.3720	fnorm_loss:0.0125, a_fnorm_loss:0.0530P:0.44, R:0.92
 42%|████▏     | 42/100 [09:33<12:53, 13.34s/it]epoch [42/100], focal_loss:0.0134	, anomaly_loss:0.3790	fnorm_loss:0.0121, a_fnorm_loss:0.0524P:0.48, R:0.92
 43%|████▎     | 43/100 [09:42<11:25, 12.03s/it]epoch [43/100], focal_loss:0.0111	, anomaly_loss:0.3527	fnorm_loss:0.0117, a_fnorm_loss:0.0564P:0.46, R:0.94
 44%|████▍     | 44/100 [09:51<10:21, 11.09s/it]epoch [44/100], focal_loss:0.0117	, anomaly_loss:0.3634	fnorm_loss:0.0116, a_fnorm_loss:0.0572P:0.51, R:0.94
 45%|████▌     | 45/100 [10:21<15:24, 16.81s/it]epoch [45/100], focal_loss:0.0116	, anomaly_loss:0.3680	fnorm_loss:0.0114, a_fnorm_loss:0.0552P:0.48, R:0.93
normal: 0.1162 0.2369  anomaly: 0.1072 0.6412	P:0.26, R:0.35
Pixel Auroc:0.947, Sample Auroc0.913, Pixel Aupro0.0
test_fnorm_loss: 0.0109 test_afnorm_loss: 0.0313
 46%|████▌     | 46/100 [10:30<12:58, 14.42s/it]epoch [46/100], focal_loss:0.0105	, anomaly_loss:0.3653	fnorm_loss:0.0112, a_fnorm_loss:0.0563P:0.48, R:0.94
 47%|████▋     | 47/100 [10:39<11:20, 12.83s/it]epoch [47/100], focal_loss:0.0122	, anomaly_loss:0.3683	fnorm_loss:0.0113, a_fnorm_loss:0.0562P:0.53, R:0.94
 48%|████▊     | 48/100 [10:48<10:05, 11.64s/it]epoch [48/100], focal_loss:0.0106	, anomaly_loss:0.3525	fnorm_loss:0.0109, a_fnorm_loss:0.0556P:0.52, R:0.93
 49%|████▉     | 49/100 [10:57<09:08, 10.75s/it]epoch [49/100], focal_loss:0.0110	, anomaly_loss:0.3685	fnorm_loss:0.0110, a_fnorm_loss:0.0554P:0.47, R:0.93
 50%|█████     | 50/100 [11:28<14:02, 16.86s/it]epoch [50/100], focal_loss:0.0137	, anomaly_loss:0.3586	fnorm_loss:0.0108, a_fnorm_loss:0.0585P:0.48, R:0.92
normal: 0.0595 0.1850  anomaly: 0.0740 0.4858	P:0.17, R:0.18
Pixel Auroc:0.964, Sample Auroc0.890, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0263
 51%|█████     | 51/100 [11:38<11:57, 14.65s/it]epoch [51/100], focal_loss:0.0116	, anomaly_loss:0.3705	fnorm_loss:0.0105, a_fnorm_loss:0.0558P:0.52, R:0.89
 52%|█████▏    | 52/100 [11:46<10:20, 12.93s/it]epoch [52/100], focal_loss:0.0101	, anomaly_loss:0.3607	fnorm_loss:0.0104, a_fnorm_loss:0.0573P:0.52, R:0.94
 53%|█████▎    | 53/100 [11:56<09:14, 11.80s/it]epoch [53/100], focal_loss:0.0098	, anomaly_loss:0.3585	fnorm_loss:0.0104, a_fnorm_loss:0.0571P:0.52, R:0.94
 54%|█████▍    | 54/100 [12:05<08:29, 11.08s/it]epoch [54/100], focal_loss:0.0098	, anomaly_loss:0.3609	fnorm_loss:0.0103, a_fnorm_loss:0.0565P:0.55, R:0.94
 55%|█████▌    | 55/100 [12:35<12:35, 16.78s/it]epoch [55/100], focal_loss:0.0092	, anomaly_loss:0.3541	fnorm_loss:0.0102, a_fnorm_loss:0.0568P:0.55, R:0.96
normal: 0.0423 0.1619  anomaly: 0.0384 0.6566	P:0.29, R:0.26
Pixel Auroc:0.951, Sample Auroc0.911, Pixel Aupro0.0
test_fnorm_loss: 0.0094 test_afnorm_loss: 0.0282
 56%|█████▌    | 56/100 [12:44<10:34, 14.43s/it]epoch [56/100], focal_loss:0.0099	, anomaly_loss:0.3505	fnorm_loss:0.0100, a_fnorm_loss:0.0572P:0.54, R:0.94
 57%|█████▋    | 57/100 [12:53<09:07, 12.74s/it]epoch [57/100], focal_loss:0.0090	, anomaly_loss:0.3569	fnorm_loss:0.0098, a_fnorm_loss:0.0574P:0.56, R:0.94
 58%|█████▊    | 58/100 [13:02<08:05, 11.55s/it]epoch [58/100], focal_loss:0.0099	, anomaly_loss:0.3599	fnorm_loss:0.0099, a_fnorm_loss:0.0552P:0.49, R:0.94
 59%|█████▉    | 59/100 [13:10<07:19, 10.73s/it]epoch [59/100], focal_loss:0.0111	, anomaly_loss:0.3723	fnorm_loss:0.0099, a_fnorm_loss:0.0564P:0.54, R:0.92
 60%|██████    | 60/100 [13:45<11:59, 17.99s/it]epoch [60/100], focal_loss:0.0094	, anomaly_loss:0.3562	fnorm_loss:0.0097, a_fnorm_loss:0.0571P:0.56, R:0.94
normal: 0.0754 0.2712  anomaly: 0.0809 0.6472	P:0.38, R:0.36
Pixel Auroc:0.966, Sample Auroc0.919, Pixel Aupro0.0
test_fnorm_loss: 0.0092 test_afnorm_loss: 0.0296
 61%|██████    | 61/100 [13:55<10:05, 15.52s/it]epoch [61/100], focal_loss:0.0099	, anomaly_loss:0.3507	fnorm_loss:0.0097, a_fnorm_loss:0.0585P:0.56, R:0.94
 62%|██████▏   | 62/100 [14:05<08:40, 13.69s/it]epoch [62/100], focal_loss:0.0123	, anomaly_loss:0.3781	fnorm_loss:0.0100, a_fnorm_loss:0.0521P:0.57, R:0.90
 63%|██████▎   | 63/100 [14:14<07:37, 12.37s/it]epoch [63/100], focal_loss:0.0084	, anomaly_loss:0.3421	fnorm_loss:0.0094, a_fnorm_loss:0.0588P:0.54, R:0.95
 64%|██████▍   | 64/100 [14:23<06:48, 11.34s/it]epoch [64/100], focal_loss:0.0092	, anomaly_loss:0.3499	fnorm_loss:0.0095, a_fnorm_loss:0.0559P:0.52, R:0.93
 65%|██████▌   | 65/100 [15:02<11:26, 19.63s/it]epoch [65/100], focal_loss:0.0091	, anomaly_loss:0.3570	fnorm_loss:0.0093, a_fnorm_loss:0.0568P:0.50, R:0.94
normal: 0.0418 0.2599  anomaly: 0.0488 0.6579	P:0.38, R:0.35
Pixel Auroc:0.956, Sample Auroc0.914, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0317
 66%|██████▌   | 66/100 [15:11<09:20, 16.48s/it]epoch [66/100], focal_loss:0.0095	, anomaly_loss:0.3567	fnorm_loss:0.0092, a_fnorm_loss:0.0572P:0.53, R:0.94
 67%|██████▋   | 67/100 [15:20<07:49, 14.22s/it]epoch [67/100], focal_loss:0.0094	, anomaly_loss:0.3486	fnorm_loss:0.0092, a_fnorm_loss:0.0575P:0.52, R:0.94
 68%|██████▊   | 68/100 [15:29<06:42, 12.59s/it]epoch [68/100], focal_loss:0.0081	, anomaly_loss:0.3493	fnorm_loss:0.0090, a_fnorm_loss:0.0584P:0.58, R:0.96
 69%|██████▉   | 69/100 [15:38<05:57, 11.54s/it]epoch [69/100], focal_loss:0.0093	, anomaly_loss:0.3560	fnorm_loss:0.0091, a_fnorm_loss:0.0570P:0.54, R:0.94
 70%|███████   | 70/100 [16:08<08:37, 17.24s/it]epoch [70/100], focal_loss:0.0088	, anomaly_loss:0.3553	fnorm_loss:0.0088, a_fnorm_loss:0.0590P:0.59, R:0.95
normal: 0.0500 0.2417  anomaly: 0.0398 0.6751	P:0.35, R:0.32
Pixel Auroc:0.958, Sample Auroc0.919, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0336
 71%|███████   | 71/100 [16:18<07:14, 15.00s/it]epoch [71/100], focal_loss:0.0090	, anomaly_loss:0.3616	fnorm_loss:0.0089, a_fnorm_loss:0.0566P:0.58, R:0.95
 72%|███████▏  | 72/100 [16:27<06:07, 13.12s/it]epoch [72/100], focal_loss:0.0087	, anomaly_loss:0.3496	fnorm_loss:0.0088, a_fnorm_loss:0.0571P:0.55, R:0.94
 73%|███████▎  | 73/100 [16:36<05:20, 11.85s/it]epoch [73/100], focal_loss:0.0101	, anomaly_loss:0.3579	fnorm_loss:0.0089, a_fnorm_loss:0.0571P:0.51, R:0.93
 74%|███████▍  | 74/100 [16:44<04:44, 10.94s/it]epoch [74/100], focal_loss:0.0094	, anomaly_loss:0.3523	fnorm_loss:0.0090, a_fnorm_loss:0.0569P:0.55, R:0.93
 75%|███████▌  | 75/100 [17:11<06:31, 15.67s/it]epoch [75/100], focal_loss:0.0078	, anomaly_loss:0.3487	fnorm_loss:0.0086, a_fnorm_loss:0.0585P:0.57, R:0.95
normal: 0.0439 0.2166  anomaly: 0.0406 0.6721	P:0.35, R:0.33
Pixel Auroc:0.958, Sample Auroc0.913, Pixel Aupro0.0
test_fnorm_loss: 0.0081 test_afnorm_loss: 0.0324
 76%|███████▌  | 76/100 [17:20<05:29, 13.73s/it]epoch [76/100], focal_loss:0.0083	, anomaly_loss:0.3479	fnorm_loss:0.0086, a_fnorm_loss:0.0586P:0.59, R:0.96
 77%|███████▋  | 77/100 [17:29<04:43, 12.34s/it]epoch [77/100], focal_loss:0.0084	, anomaly_loss:0.3488	fnorm_loss:0.0086, a_fnorm_loss:0.0587P:0.56, R:0.95
 78%|███████▊  | 78/100 [17:38<04:06, 11.22s/it]epoch [78/100], focal_loss:0.0082	, anomaly_loss:0.3522	fnorm_loss:0.0084, a_fnorm_loss:0.0585P:0.56, R:0.95
 79%|███████▉  | 79/100 [17:47<03:40, 10.49s/it]epoch [79/100], focal_loss:0.0101	, anomaly_loss:0.3544	fnorm_loss:0.0086, a_fnorm_loss:0.0590P:0.55, R:0.94
 80%|████████  | 80/100 [18:17<05:26, 16.33s/it]epoch [80/100], focal_loss:0.0091	, anomaly_loss:0.3583	fnorm_loss:0.0084, a_fnorm_loss:0.0575P:0.57, R:0.93
normal: 0.1004 0.2688  anomaly: 0.0899 0.6789	P:0.32, R:0.41
Pixel Auroc:0.967, Sample Auroc0.893, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0364
 81%|████████  | 81/100 [18:25<04:26, 14.03s/it]epoch [81/100], focal_loss:0.0079	, anomaly_loss:0.3408	fnorm_loss:0.0084, a_fnorm_loss:0.0599P:0.53, R:0.96
 82%|████████▏ | 82/100 [18:34<03:45, 12.53s/it]epoch [82/100], focal_loss:0.0082	, anomaly_loss:0.3470	fnorm_loss:0.0084, a_fnorm_loss:0.0597P:0.59, R:0.95
 83%|████████▎ | 83/100 [18:43<03:14, 11.44s/it]epoch [83/100], focal_loss:0.0074	, anomaly_loss:0.3383	fnorm_loss:0.0083, a_fnorm_loss:0.0591P:0.53, R:0.96
 84%|████████▍ | 84/100 [18:53<02:52, 10.78s/it]epoch [84/100], focal_loss:0.0072	, anomaly_loss:0.3466	fnorm_loss:0.0082, a_fnorm_loss:0.0609P:0.59, R:0.96
 85%|████████▌ | 85/100 [19:21<04:02, 16.16s/it]epoch [85/100], focal_loss:0.0075	, anomaly_loss:0.3390	fnorm_loss:0.0082, a_fnorm_loss:0.0603P:0.58, R:0.96
normal: 0.0401 0.2134  anomaly: 0.0347 0.6756	P:0.36, R:0.31
Pixel Auroc:0.964, Sample Auroc0.915, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0314
 86%|████████▌ | 86/100 [19:31<03:18, 14.17s/it]epoch [86/100], focal_loss:0.0070	, anomaly_loss:0.3482	fnorm_loss:0.0081, a_fnorm_loss:0.0590P:0.57, R:0.95
 87%|████████▋ | 87/100 [19:40<02:44, 12.66s/it]epoch [87/100], focal_loss:0.0071	, anomaly_loss:0.3511	fnorm_loss:0.0082, a_fnorm_loss:0.0586P:0.56, R:0.96
 88%|████████▊ | 88/100 [19:50<02:21, 11.81s/it]epoch [88/100], focal_loss:0.0071	, anomaly_loss:0.3333	fnorm_loss:0.0081, a_fnorm_loss:0.0620P:0.57, R:0.97
 89%|████████▉ | 89/100 [19:59<02:00, 10.97s/it]epoch [89/100], focal_loss:0.0079	, anomaly_loss:0.3546	fnorm_loss:0.0082, a_fnorm_loss:0.0589P:0.62, R:0.94
 90%|█████████ | 90/100 [20:27<02:41, 16.17s/it]epoch [90/100], focal_loss:0.0071	, anomaly_loss:0.3387	fnorm_loss:0.0082, a_fnorm_loss:0.0592P:0.53, R:0.96
normal: 0.0394 0.2361  anomaly: 0.0429 0.6800	P:0.35, R:0.33
Pixel Auroc:0.963, Sample Auroc0.922, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0334
 91%|█████████ | 91/100 [20:37<02:08, 14.24s/it]epoch [91/100], focal_loss:0.0076	, anomaly_loss:0.3453	fnorm_loss:0.0082, a_fnorm_loss:0.0601P:0.60, R:0.97
 92%|█████████▏| 92/100 [20:46<01:41, 12.66s/it]epoch [92/100], focal_loss:0.0068	, anomaly_loss:0.3437	fnorm_loss:0.0081, a_fnorm_loss:0.0599P:0.61, R:0.97
 93%|█████████▎| 93/100 [20:54<01:20, 11.43s/it]epoch [93/100], focal_loss:0.0079	, anomaly_loss:0.3484	fnorm_loss:0.0082, a_fnorm_loss:0.0604P:0.54, R:0.95
 94%|█████████▍| 94/100 [21:03<01:03, 10.58s/it]epoch [94/100], focal_loss:0.0095	, anomaly_loss:0.3572	fnorm_loss:0.0082, a_fnorm_loss:0.0589P:0.64, R:0.93
 95%|█████████▌| 95/100 [21:31<01:19, 15.95s/it]epoch [95/100], focal_loss:0.0077	, anomaly_loss:0.3377	fnorm_loss:0.0082, a_fnorm_loss:0.0570P:0.50, R:0.94
normal: 0.0439 0.2750  anomaly: 0.0491 0.6827	P:0.37, R:0.35
Pixel Auroc:0.967, Sample Auroc0.922, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0340
 96%|█████████▌| 96/100 [21:41<00:56, 14.02s/it]epoch [96/100], focal_loss:0.0105	, anomaly_loss:0.3577	fnorm_loss:0.0082, a_fnorm_loss:0.0587P:0.57, R:0.92
 97%|█████████▋| 97/100 [21:50<00:37, 12.55s/it]epoch [97/100], focal_loss:0.0071	, anomaly_loss:0.3389	fnorm_loss:0.0082, a_fnorm_loss:0.0603P:0.53, R:0.96
 98%|█████████▊| 98/100 [21:59<00:22, 11.44s/it]epoch [98/100], focal_loss:0.0075	, anomaly_loss:0.3456	fnorm_loss:0.0082, a_fnorm_loss:0.0600P:0.57, R:0.95
 99%|█████████▉| 99/100 [22:08<00:10, 10.65s/it]epoch [99/100], focal_loss:0.0075	, anomaly_loss:0.3466	fnorm_loss:0.0082, a_fnorm_loss:0.0604P:0.57, R:0.95
100%|██████████| 100/100 [22:37<00:00, 16.08s/it]100%|██████████| 100/100 [22:37<00:00, 13.57s/it]
epoch [100/100], focal_loss:0.0075	, anomaly_loss:0.3431	fnorm_loss:0.0082, a_fnorm_loss:0.0593P:0.56, R:0.96
normal: 0.0419 0.2527  anomaly: 0.0413 0.6784	P:0.36, R:0.33
Pixel Auroc:0.966, Sample Auroc0.918, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0329
training Stubborn Student...
capsule
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:21,  5.23s/it]epoch [1/120], kd_loss:4.7809
  2%|▏         | 2/120 [00:10<10:15,  5.22s/it]epoch [2/120], kd_loss:3.8753
  2%|▎         | 3/120 [00:15<10:11,  5.22s/it]epoch [3/120], kd_loss:3.6307
  3%|▎         | 4/120 [00:20<10:06,  5.23s/it]epoch [4/120], kd_loss:3.0113
  4%|▍         | 5/120 [00:26<10:02,  5.24s/it]epoch [5/120], kd_loss:2.8765
  5%|▌         | 6/120 [00:31<09:57,  5.24s/it]epoch [6/120], kd_loss:2.6703
  6%|▌         | 7/120 [00:36<09:56,  5.28s/it]epoch [7/120], kd_loss:2.3385
  7%|▋         | 8/120 [00:42<09:52,  5.29s/it]epoch [8/120], kd_loss:2.2307
  8%|▊         | 9/120 [00:47<09:46,  5.29s/it]epoch [9/120], kd_loss:2.0740
  8%|▊         | 10/120 [01:11<20:37, 11.25s/it]epoch [10/120], kd_loss:2.3834
normal: 1.2964 1.7595  anomaly: 1.3795 2.5891
thresh: 1.4274092783877792
fpr: 0.5217391304347826 fnr 0.009174311926605505
Pixel Auroc:0.958, Sample Auroc0.920, Pixel Aupro0.0
  9%|▉         | 11/120 [01:17<17:05,  9.41s/it]epoch [11/120], kd_loss:2.1738
 10%|█         | 12/120 [01:22<14:39,  8.14s/it]epoch [12/120], kd_loss:2.0620
 11%|█         | 13/120 [01:27<12:56,  7.26s/it]epoch [13/120], kd_loss:2.0048
 12%|█▏        | 14/120 [01:32<11:46,  6.67s/it]epoch [14/120], kd_loss:1.8436
 12%|█▎        | 15/120 [01:38<10:59,  6.28s/it]epoch [15/120], kd_loss:2.0847
 13%|█▎        | 16/120 [01:43<10:22,  5.99s/it]epoch [16/120], kd_loss:1.9735
 14%|█▍        | 17/120 [01:48<09:56,  5.79s/it]epoch [17/120], kd_loss:2.0395
 15%|█▌        | 18/120 [01:54<09:39,  5.68s/it]epoch [18/120], kd_loss:1.8119
 16%|█▌        | 19/120 [01:59<09:24,  5.59s/it]epoch [19/120], kd_loss:1.7500
 17%|█▋        | 20/120 [02:24<18:59, 11.39s/it]epoch [20/120], kd_loss:1.7746
normal: 1.1624 1.5748  anomaly: 1.2199 2.6215
thresh: 1.2199397668100052
fpr: 0.6956521739130435 fnr 0.0
Pixel Auroc:0.968, Sample Auroc0.909, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:30<15:46,  9.56s/it]epoch [21/120], kd_loss:1.8287
 18%|█▊        | 22/120 [02:35<13:30,  8.27s/it]epoch [22/120], kd_loss:1.7948
 19%|█▉        | 23/120 [02:40<11:54,  7.37s/it]epoch [23/120], kd_loss:1.7197
 20%|██        | 24/120 [02:45<10:46,  6.74s/it]epoch [24/120], kd_loss:1.9972
 21%|██        | 25/120 [02:51<09:58,  6.30s/it]epoch [25/120], kd_loss:2.2344
 22%|██▏       | 26/120 [02:56<09:23,  5.99s/it]epoch [26/120], kd_loss:1.8301
 22%|██▎       | 27/120 [03:01<08:58,  5.79s/it]epoch [27/120], kd_loss:1.8452
 23%|██▎       | 28/120 [03:06<08:38,  5.63s/it]epoch [28/120], kd_loss:1.7981
 24%|██▍       | 29/120 [03:12<08:21,  5.51s/it]epoch [29/120], kd_loss:1.7183
 25%|██▌       | 30/120 [03:37<17:02, 11.37s/it]epoch [30/120], kd_loss:1.8149
normal: 1.1095 1.7149  anomaly: 1.1508 2.7082
thresh: 1.2259223342706356
fpr: 0.4782608695652174 fnr 0.03669724770642202
Pixel Auroc:0.970, Sample Auroc0.907, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:42<14:07,  9.52s/it]epoch [31/120], kd_loss:1.6403
 27%|██▋       | 32/120 [03:47<12:06,  8.26s/it]epoch [32/120], kd_loss:2.0416
 28%|██▊       | 33/120 [03:52<10:40,  7.36s/it]epoch [33/120], kd_loss:1.7028
 28%|██▊       | 34/120 [03:58<09:39,  6.73s/it]epoch [34/120], kd_loss:1.6265
 29%|██▉       | 35/120 [04:03<08:55,  6.31s/it]epoch [35/120], kd_loss:1.5483
 30%|███       | 36/120 [04:08<08:23,  6.00s/it]epoch [36/120], kd_loss:1.5726
 31%|███       | 37/120 [04:14<08:00,  5.79s/it]epoch [37/120], kd_loss:1.5771
 32%|███▏      | 38/120 [04:19<07:42,  5.64s/it]epoch [38/120], kd_loss:1.4977
 32%|███▎      | 39/120 [04:24<07:28,  5.53s/it]epoch [39/120], kd_loss:1.4925
 33%|███▎      | 40/120 [04:49<15:11, 11.39s/it]epoch [40/120], kd_loss:1.4448
normal: 0.9435 1.3913  anomaly: 0.9589 2.6622
thresh: 1.0229884945895067
fpr: 0.5217391304347826 fnr 0.03669724770642202
Pixel Auroc:0.964, Sample Auroc0.914, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:55<12:33,  9.54s/it]epoch [41/120], kd_loss:1.4549
 35%|███▌      | 42/120 [05:00<10:43,  8.24s/it]epoch [42/120], kd_loss:1.4419
 36%|███▌      | 43/120 [05:05<09:25,  7.34s/it]epoch [43/120], kd_loss:1.5008
 37%|███▋      | 44/120 [05:10<08:32,  6.74s/it]epoch [44/120], kd_loss:1.4352
 38%|███▊      | 45/120 [05:16<07:54,  6.33s/it]epoch [45/120], kd_loss:1.8295
 38%|███▊      | 46/120 [05:21<07:24,  6.01s/it]epoch [46/120], kd_loss:1.5439
 39%|███▉      | 47/120 [05:26<07:03,  5.80s/it]epoch [47/120], kd_loss:1.3981
 40%|████      | 48/120 [05:32<06:46,  5.65s/it]epoch [48/120], kd_loss:1.4718
 41%|████      | 49/120 [05:37<06:34,  5.56s/it]epoch [49/120], kd_loss:1.3578
 42%|████▏     | 50/120 [06:02<13:19, 11.43s/it]epoch [50/120], kd_loss:1.3313
normal: 0.8042 1.2276  anomaly: 0.8544 2.3344
thresh: 0.9161141205625924
fpr: 0.4782608695652174 fnr 0.01834862385321101
Pixel Auroc:0.966, Sample Auroc0.932, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:07<11:00,  9.58s/it]epoch [51/120], kd_loss:1.3135
 43%|████▎     | 52/120 [06:13<09:23,  8.28s/it]epoch [52/120], kd_loss:1.2939
 44%|████▍     | 53/120 [06:18<08:13,  7.37s/it]epoch [53/120], kd_loss:1.3112
 45%|████▌     | 54/120 [06:23<07:25,  6.74s/it]epoch [54/120], kd_loss:1.3328
 46%|████▌     | 55/120 [06:28<06:48,  6.28s/it]epoch [55/120], kd_loss:1.2700
 47%|████▋     | 56/120 [06:34<06:22,  5.98s/it]epoch [56/120], kd_loss:1.2696
 48%|████▊     | 57/120 [06:39<06:03,  5.76s/it]epoch [57/120], kd_loss:1.2536
 48%|████▊     | 58/120 [06:44<05:48,  5.62s/it]epoch [58/120], kd_loss:1.2693
 49%|████▉     | 59/120 [06:49<05:37,  5.53s/it]epoch [59/120], kd_loss:1.3287
 50%|█████     | 60/120 [07:16<11:45, 11.77s/it]epoch [60/120], kd_loss:1.3880
normal: 0.7539 1.1897  anomaly: 0.8039 2.7759
thresh: 0.8822907648205895
fpr: 0.4782608695652174 fnr 0.009174311926605505
Pixel Auroc:0.973, Sample Auroc0.945, Pixel Aupro0.0
 51%|█████     | 61/120 [07:21<09:40,  9.84s/it]epoch [61/120], kd_loss:1.4857
 52%|█████▏    | 62/120 [07:26<08:09,  8.45s/it]epoch [62/120], kd_loss:2.6209
 52%|█████▎    | 63/120 [07:31<07:06,  7.49s/it]epoch [63/120], kd_loss:1.7642
 53%|█████▎    | 64/120 [07:37<06:22,  6.83s/it]epoch [64/120], kd_loss:1.4380
 54%|█████▍    | 65/120 [07:42<05:49,  6.36s/it]epoch [65/120], kd_loss:1.3709
 55%|█████▌    | 66/120 [07:47<05:25,  6.02s/it]epoch [66/120], kd_loss:1.3320
 56%|█████▌    | 67/120 [07:52<05:06,  5.78s/it]epoch [67/120], kd_loss:1.4351
 57%|█████▋    | 68/120 [07:58<04:52,  5.63s/it]epoch [68/120], kd_loss:1.2981
 57%|█████▊    | 69/120 [08:03<04:43,  5.55s/it]epoch [69/120], kd_loss:1.5935
 58%|█████▊    | 70/120 [08:28<09:26, 11.34s/it]epoch [70/120], kd_loss:1.8843
normal: 1.1033 2.0507  anomaly: 1.1917 2.5834
thresh: 1.1917415360683754
fpr: 0.7391304347826086 fnr 0.0
Pixel Auroc:0.944, Sample Auroc0.896, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:33<07:46,  9.51s/it]epoch [71/120], kd_loss:1.5942
 60%|██████    | 72/120 [08:39<06:36,  8.27s/it]epoch [72/120], kd_loss:1.4030
 61%|██████    | 73/120 [08:44<05:46,  7.38s/it]epoch [73/120], kd_loss:1.3678
 62%|██████▏   | 74/120 [08:49<05:11,  6.77s/it]epoch [74/120], kd_loss:1.2975
 62%|██████▎   | 75/120 [08:54<04:43,  6.31s/it]epoch [75/120], kd_loss:1.3518
 63%|██████▎   | 76/120 [09:00<04:24,  6.00s/it]epoch [76/120], kd_loss:1.8196
 64%|██████▍   | 77/120 [09:05<04:09,  5.81s/it]epoch [77/120], kd_loss:1.6593
 65%|██████▌   | 78/120 [09:10<03:57,  5.65s/it]epoch [78/120], kd_loss:1.4080
 66%|██████▌   | 79/120 [09:16<03:47,  5.55s/it]epoch [79/120], kd_loss:1.3526
 67%|██████▋   | 80/120 [09:40<07:26, 11.16s/it]epoch [80/120], kd_loss:1.3184
normal: 0.7876 1.3821  anomaly: 0.8462 2.3747
thresh: 0.9001278730724516
fpr: 0.5217391304347826 fnr 0.009174311926605505
Pixel Auroc:0.967, Sample Auroc0.933, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:45<06:06,  9.40s/it]epoch [81/120], kd_loss:1.4158
 68%|██████▊   | 82/120 [09:50<05:09,  8.14s/it]epoch [82/120], kd_loss:1.3183
 69%|██████▉   | 83/120 [09:56<04:29,  7.28s/it]epoch [83/120], kd_loss:1.3329
 70%|███████   | 84/120 [10:01<04:01,  6.71s/it]epoch [84/120], kd_loss:1.4554
 71%|███████   | 85/120 [10:06<03:39,  6.28s/it]epoch [85/120], kd_loss:1.4048
 72%|███████▏  | 86/120 [10:12<03:23,  5.99s/it]epoch [86/120], kd_loss:1.4391
 72%|███████▎  | 87/120 [10:17<03:10,  5.78s/it]epoch [87/120], kd_loss:1.3601
 73%|███████▎  | 88/120 [10:22<03:00,  5.63s/it]epoch [88/120], kd_loss:1.2929
 74%|███████▍  | 89/120 [10:28<02:51,  5.53s/it]epoch [89/120], kd_loss:1.2989
 75%|███████▌  | 90/120 [10:53<05:44, 11.47s/it]epoch [90/120], kd_loss:1.2799
normal: 0.7545 1.4640  anomaly: 0.8402 2.3507
thresh: 0.8666538345193838
fpr: 0.43478260869565216 fnr 0.01834862385321101
Pixel Auroc:0.974, Sample Auroc0.941, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:58<04:38,  9.60s/it]epoch [91/120], kd_loss:1.2548
 77%|███████▋  | 92/120 [11:03<03:52,  8.29s/it]epoch [92/120], kd_loss:1.2423
 78%|███████▊  | 93/120 [11:09<03:19,  7.38s/it]epoch [93/120], kd_loss:1.2355
 78%|███████▊  | 94/120 [11:14<02:55,  6.74s/it]epoch [94/120], kd_loss:1.2292
 79%|███████▉  | 95/120 [11:19<02:37,  6.30s/it]epoch [95/120], kd_loss:1.2220
 80%|████████  | 96/120 [11:24<02:23,  5.99s/it]epoch [96/120], kd_loss:1.2246
 81%|████████  | 97/120 [11:30<02:12,  5.78s/it]epoch [97/120], kd_loss:1.2053
 82%|████████▏ | 98/120 [11:35<02:03,  5.60s/it]epoch [98/120], kd_loss:1.1977
 82%|████████▎ | 99/120 [11:40<01:55,  5.51s/it]epoch [99/120], kd_loss:1.2004
 83%|████████▎ | 100/120 [12:06<03:52, 11.61s/it]epoch [100/120], kd_loss:1.1931
normal: 0.7132 1.2039  anomaly: 0.7817 2.3342
thresh: 0.8669033420888531
fpr: 0.2608695652173913 fnr 0.03669724770642202
Pixel Auroc:0.973, Sample Auroc0.951, Pixel Aupro0.0
 84%|████████▍ | 101/120 [12:12<03:06,  9.83s/it]epoch [101/120], kd_loss:1.1905
 85%|████████▌ | 102/120 [12:17<02:33,  8.50s/it]epoch [102/120], kd_loss:1.1858
 86%|████████▌ | 103/120 [12:22<02:08,  7.54s/it]epoch [103/120], kd_loss:1.1822
 87%|████████▋ | 104/120 [12:28<01:50,  6.88s/it]epoch [104/120], kd_loss:1.1795
 88%|████████▊ | 105/120 [12:33<01:36,  6.43s/it]epoch [105/120], kd_loss:1.1759
 88%|████████▊ | 106/120 [12:38<01:25,  6.11s/it]epoch [106/120], kd_loss:1.1733
 89%|████████▉ | 107/120 [12:44<01:16,  5.88s/it]epoch [107/120], kd_loss:1.1722
 90%|█████████ | 108/120 [12:49<01:08,  5.71s/it]epoch [108/120], kd_loss:1.1705
 91%|█████████ | 109/120 [12:55<01:02,  5.64s/it]epoch [109/120], kd_loss:1.1671
 92%|█████████▏| 110/120 [13:18<01:50, 11.04s/it]epoch [110/120], kd_loss:1.1649
normal: 0.7035 1.1747  anomaly: 0.7631 2.3302
thresh: 0.7952622175982298
fpr: 0.43478260869565216 fnr 0.009174311926605505
Pixel Auroc:0.974, Sample Auroc0.950, Pixel Aupro0.0
 92%|█████████▎| 111/120 [13:24<01:23,  9.32s/it]epoch [111/120], kd_loss:1.1648
 93%|█████████▎| 112/120 [13:29<01:04,  8.09s/it]epoch [112/120], kd_loss:1.1644
 94%|█████████▍| 113/120 [13:34<00:50,  7.25s/it]epoch [113/120], kd_loss:1.1637
 95%|█████████▌| 114/120 [13:39<00:39,  6.65s/it]epoch [114/120], kd_loss:1.1640
 96%|█████████▌| 115/120 [13:45<00:31,  6.23s/it]epoch [115/120], kd_loss:1.1622
 97%|█████████▋| 116/120 [13:50<00:23,  5.95s/it]epoch [116/120], kd_loss:1.1627
 98%|█████████▊| 117/120 [13:55<00:17,  5.74s/it]epoch [117/120], kd_loss:1.1618
 98%|█████████▊| 118/120 [14:00<00:11,  5.60s/it]epoch [118/120], kd_loss:1.1604
 99%|█████████▉| 119/120 [14:06<00:05,  5.51s/it]epoch [119/120], kd_loss:1.1611
100%|██████████| 120/120 [14:31<00:00, 11.42s/it]100%|██████████| 120/120 [14:31<00:00,  7.26s/it]
epoch [120/120], kd_loss:1.1598
normal: 0.6960 1.1724  anomaly: 0.7573 2.3507
thresh: 0.7572533652873235
fpr: 0.4782608695652174 fnr 0.0
Pixel Auroc:0.974, Sample Auroc0.949, Pixel Aupro0.0
training Advanced Teacher...
hazelnut
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:32<53:43, 32.56s/it]epoch [1/100], focal_loss:0.0752	, anomaly_loss:0.5940	fnorm_loss:0.0656, a_fnorm_loss:0.0152P:0.00, R:0.03
normal: 0.2335 0.2434  anomaly: 0.2300 0.2429	P:0.00, R:0.00
Pixel Auroc:0.525, Sample Auroc0.263, Pixel Aupro0.0
test_fnorm_loss: 0.0636 test_afnorm_loss: 0.0173
  2%|▏         | 2/100 [00:46<35:05, 21.48s/it]epoch [2/100], focal_loss:0.0634	, anomaly_loss:0.6100	fnorm_loss:0.0570, a_fnorm_loss:0.0134P:0.00, R:0.00
  3%|▎         | 3/100 [00:59<28:40, 17.74s/it]epoch [3/100], focal_loss:0.0543	, anomaly_loss:0.6280	fnorm_loss:0.0492, a_fnorm_loss:0.0116P:0.00, R:0.00
  4%|▍         | 4/100 [01:13<25:59, 16.25s/it]epoch [4/100], focal_loss:0.0510	, anomaly_loss:0.6419	fnorm_loss:0.0444, a_fnorm_loss:0.0106P:0.00, R:0.00
  5%|▌         | 5/100 [01:43<33:26, 21.12s/it]epoch [5/100], focal_loss:0.0506	, anomaly_loss:0.6340	fnorm_loss:0.0431, a_fnorm_loss:0.0122P:0.02, R:0.02
normal: 0.2310 0.2458  anomaly: 0.2230 0.2452	P:0.05, R:0.20
Pixel Auroc:0.906, Sample Auroc0.259, Pixel Aupro0.0
test_fnorm_loss: 0.0430 test_afnorm_loss: 0.0267
  6%|▌         | 6/100 [01:56<29:04, 18.56s/it]epoch [6/100], focal_loss:0.0471	, anomaly_loss:0.5459	fnorm_loss:0.0375, a_fnorm_loss:0.0289P:0.10, R:0.30
  7%|▋         | 7/100 [02:10<26:05, 16.84s/it]epoch [7/100], focal_loss:0.0417	, anomaly_loss:0.5333	fnorm_loss:0.0333, a_fnorm_loss:0.0322P:0.09, R:0.30
  8%|▊         | 8/100 [02:23<24:09, 15.76s/it]epoch [8/100], focal_loss:0.0421	, anomaly_loss:0.5248	fnorm_loss:0.0306, a_fnorm_loss:0.0338P:0.11, R:0.30
  9%|▉         | 9/100 [02:37<22:47, 15.03s/it]epoch [9/100], focal_loss:0.0391	, anomaly_loss:0.5196	fnorm_loss:0.0287, a_fnorm_loss:0.0348P:0.10, R:0.33
 10%|█         | 10/100 [03:08<30:03, 20.04s/it]epoch [10/100], focal_loss:0.0358	, anomaly_loss:0.5000	fnorm_loss:0.0271, a_fnorm_loss:0.0373P:0.20, R:0.50
normal: 0.1098 0.2179  anomaly: 0.1417 0.3626	P:0.26, R:0.19
Pixel Auroc:0.941, Sample Auroc0.951, Pixel Aupro0.0
test_fnorm_loss: 0.0260 test_afnorm_loss: 0.0180
 11%|█         | 11/100 [03:22<26:53, 18.13s/it]epoch [11/100], focal_loss:0.0321	, anomaly_loss:0.4952	fnorm_loss:0.0260, a_fnorm_loss:0.0372P:0.23, R:0.55
 12%|█▏        | 12/100 [03:35<24:30, 16.71s/it]epoch [12/100], focal_loss:0.0283	, anomaly_loss:0.4583	fnorm_loss:0.0242, a_fnorm_loss:0.0407P:0.32, R:0.74
 13%|█▎        | 13/100 [03:49<22:54, 15.80s/it]epoch [13/100], focal_loss:0.0210	, anomaly_loss:0.4297	fnorm_loss:0.0206, a_fnorm_loss:0.0437P:0.41, R:0.90
 14%|█▍        | 14/100 [04:02<21:38, 15.09s/it]epoch [14/100], focal_loss:0.0222	, anomaly_loss:0.4225	fnorm_loss:0.0189, a_fnorm_loss:0.0419P:0.38, R:0.89
 15%|█▌        | 15/100 [04:32<27:34, 19.47s/it]epoch [15/100], focal_loss:0.0192	, anomaly_loss:0.4228	fnorm_loss:0.0173, a_fnorm_loss:0.0438P:0.40, R:0.89
normal: 0.5638 0.7030  anomaly: 0.5861 0.6920	P:0.09, R:0.63
Pixel Auroc:0.960, Sample Auroc0.617, Pixel Aupro0.0
test_fnorm_loss: 0.0237 test_afnorm_loss: 0.0603
 16%|█▌        | 16/100 [04:45<24:45, 17.69s/it]epoch [16/100], focal_loss:0.0239	, anomaly_loss:0.4284	fnorm_loss:0.0167, a_fnorm_loss:0.0432P:0.43, R:0.88
 17%|█▋        | 17/100 [04:59<22:46, 16.47s/it]epoch [17/100], focal_loss:0.0167	, anomaly_loss:0.4135	fnorm_loss:0.0154, a_fnorm_loss:0.0446P:0.44, R:0.91
 18%|█▊        | 18/100 [05:13<21:17, 15.58s/it]epoch [18/100], focal_loss:0.0167	, anomaly_loss:0.4057	fnorm_loss:0.0145, a_fnorm_loss:0.0459P:0.46, R:0.91
 19%|█▉        | 19/100 [05:26<20:08, 14.92s/it]epoch [19/100], focal_loss:0.0163	, anomaly_loss:0.4046	fnorm_loss:0.0138, a_fnorm_loss:0.0465P:0.48, R:0.91
 20%|██        | 20/100 [06:01<27:50, 20.88s/it]epoch [20/100], focal_loss:0.0144	, anomaly_loss:0.4043	fnorm_loss:0.0132, a_fnorm_loss:0.0468P:0.48, R:0.90
normal: 0.0629 0.2466  anomaly: 0.1271 0.6088	P:0.46, R:0.34
Pixel Auroc:0.975, Sample Auroc0.974, Pixel Aupro0.0
test_fnorm_loss: 0.0125 test_afnorm_loss: 0.0335
 21%|██        | 21/100 [06:14<24:33, 18.65s/it]epoch [21/100], focal_loss:0.0133	, anomaly_loss:0.3984	fnorm_loss:0.0125, a_fnorm_loss:0.0490P:0.51, R:0.92
 22%|██▏       | 22/100 [06:28<22:29, 17.30s/it]epoch [22/100], focal_loss:0.0141	, anomaly_loss:0.4007	fnorm_loss:0.0121, a_fnorm_loss:0.0470P:0.53, R:0.90
 23%|██▎       | 23/100 [06:42<20:47, 16.20s/it]epoch [23/100], focal_loss:0.0118	, anomaly_loss:0.3934	fnorm_loss:0.0116, a_fnorm_loss:0.0497P:0.54, R:0.94
 24%|██▍       | 24/100 [06:55<19:25, 15.33s/it]epoch [24/100], focal_loss:0.0134	, anomaly_loss:0.3947	fnorm_loss:0.0113, a_fnorm_loss:0.0485P:0.53, R:0.89
 25%|██▌       | 25/100 [07:30<26:25, 21.14s/it]epoch [25/100], focal_loss:0.0132	, anomaly_loss:0.3933	fnorm_loss:0.0110, a_fnorm_loss:0.0489P:0.50, R:0.91
normal: 0.0490 0.1513  anomaly: 0.0978 0.5922	P:0.47, R:0.25
Pixel Auroc:0.976, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0102 test_afnorm_loss: 0.0299
 26%|██▌       | 26/100 [07:44<23:22, 18.95s/it]epoch [26/100], focal_loss:0.0134	, anomaly_loss:0.3975	fnorm_loss:0.0107, a_fnorm_loss:0.0487P:0.53, R:0.92
 27%|██▋       | 27/100 [07:57<21:04, 17.32s/it]epoch [27/100], focal_loss:0.0148	, anomaly_loss:0.3999	fnorm_loss:0.0104, a_fnorm_loss:0.0484P:0.50, R:0.85
 28%|██▊       | 28/100 [08:11<19:18, 16.09s/it]epoch [28/100], focal_loss:0.0150	, anomaly_loss:0.4139	fnorm_loss:0.0103, a_fnorm_loss:0.0483P:0.55, R:0.87
 29%|██▉       | 29/100 [08:24<18:01, 15.23s/it]epoch [29/100], focal_loss:0.0112	, anomaly_loss:0.3854	fnorm_loss:0.0099, a_fnorm_loss:0.0495P:0.50, R:0.93
 30%|███       | 30/100 [08:59<24:53, 21.33s/it]epoch [30/100], focal_loss:0.0106	, anomaly_loss:0.3859	fnorm_loss:0.0096, a_fnorm_loss:0.0509P:0.56, R:0.94
normal: 0.0479 0.2176  anomaly: 0.1377 0.6967	P:0.47, R:0.36
Pixel Auroc:0.977, Sample Auroc0.980, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0348
 31%|███       | 31/100 [09:13<21:53, 19.04s/it]epoch [31/100], focal_loss:0.0114	, anomaly_loss:0.3853	fnorm_loss:0.0095, a_fnorm_loss:0.0507P:0.57, R:0.94
 32%|███▏      | 32/100 [09:27<19:50, 17.51s/it]epoch [32/100], focal_loss:0.0118	, anomaly_loss:0.3904	fnorm_loss:0.0096, a_fnorm_loss:0.0485P:0.56, R:0.93
 33%|███▎      | 33/100 [09:41<18:19, 16.42s/it]epoch [33/100], focal_loss:0.0118	, anomaly_loss:0.3898	fnorm_loss:0.0092, a_fnorm_loss:0.0494P:0.56, R:0.92
 34%|███▍      | 34/100 [09:55<17:19, 15.74s/it]epoch [34/100], focal_loss:0.0111	, anomaly_loss:0.3918	fnorm_loss:0.0091, a_fnorm_loss:0.0495P:0.52, R:0.92
 35%|███▌      | 35/100 [10:30<23:10, 21.40s/it]epoch [35/100], focal_loss:0.0107	, anomaly_loss:0.3848	fnorm_loss:0.0088, a_fnorm_loss:0.0508P:0.57, R:0.93
normal: 0.0400 0.2678  anomaly: 0.1145 0.6473	P:0.49, R:0.37
Pixel Auroc:0.980, Sample Auroc0.990, Pixel Aupro0.0
test_fnorm_loss: 0.0081 test_afnorm_loss: 0.0327
 36%|███▌      | 36/100 [10:43<20:19, 19.05s/it]epoch [36/100], focal_loss:0.0103	, anomaly_loss:0.3865	fnorm_loss:0.0087, a_fnorm_loss:0.0509P:0.57, R:0.94
 37%|███▋      | 37/100 [10:57<18:14, 17.38s/it]epoch [37/100], focal_loss:0.0098	, anomaly_loss:0.3825	fnorm_loss:0.0084, a_fnorm_loss:0.0518P:0.56, R:0.93
 38%|███▊      | 38/100 [11:10<16:46, 16.23s/it]epoch [38/100], focal_loss:0.0099	, anomaly_loss:0.3844	fnorm_loss:0.0083, a_fnorm_loss:0.0509P:0.56, R:0.94
 39%|███▉      | 39/100 [11:24<15:45, 15.49s/it]epoch [39/100], focal_loss:0.0086	, anomaly_loss:0.3784	fnorm_loss:0.0081, a_fnorm_loss:0.0519P:0.56, R:0.95
 40%|████      | 40/100 [11:58<21:11, 21.18s/it]epoch [40/100], focal_loss:0.0126	, anomaly_loss:0.3888	fnorm_loss:0.0085, a_fnorm_loss:0.0490P:0.55, R:0.92
normal: 0.0689 0.1882  anomaly: 0.1466 0.6244	P:0.50, R:0.37
Pixel Auroc:0.979, Sample Auroc0.995, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0313
 41%|████      | 41/100 [12:12<18:38, 18.96s/it]epoch [41/100], focal_loss:0.0107	, anomaly_loss:0.3910	fnorm_loss:0.0085, a_fnorm_loss:0.0488P:0.52, R:0.94
 42%|████▏     | 42/100 [12:26<16:47, 17.38s/it]epoch [42/100], focal_loss:0.0093	, anomaly_loss:0.3842	fnorm_loss:0.0081, a_fnorm_loss:0.0506P:0.56, R:0.94
 43%|████▎     | 43/100 [12:40<15:27, 16.28s/it]epoch [43/100], focal_loss:0.0090	, anomaly_loss:0.3773	fnorm_loss:0.0079, a_fnorm_loss:0.0524P:0.59, R:0.95
 44%|████▍     | 44/100 [12:53<14:17, 15.32s/it]epoch [44/100], focal_loss:0.0097	, anomaly_loss:0.3725	fnorm_loss:0.0078, a_fnorm_loss:0.0514P:0.59, R:0.94
 45%|████▌     | 45/100 [13:28<19:30, 21.28s/it]epoch [45/100], focal_loss:0.0144	, anomaly_loss:0.4009	fnorm_loss:0.0081, a_fnorm_loss:0.0491P:0.57, R:0.89
normal: 0.0381 0.1528  anomaly: 0.1163 0.6561	P:0.51, R:0.37
Pixel Auroc:0.976, Sample Auroc0.997, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0365
 46%|████▌     | 46/100 [13:42<17:08, 19.04s/it]epoch [46/100], focal_loss:0.0123	, anomaly_loss:0.3826	fnorm_loss:0.0079, a_fnorm_loss:0.0507P:0.57, R:0.94
 47%|████▋     | 47/100 [13:55<15:18, 17.33s/it]epoch [47/100], focal_loss:0.0104	, anomaly_loss:0.3895	fnorm_loss:0.0076, a_fnorm_loss:0.0522P:0.57, R:0.93
 48%|████▊     | 48/100 [14:09<14:08, 16.32s/it]epoch [48/100], focal_loss:0.0119	, anomaly_loss:0.3903	fnorm_loss:0.0078, a_fnorm_loss:0.0495P:0.59, R:0.92
 49%|████▉     | 49/100 [14:23<13:17, 15.64s/it]epoch [49/100], focal_loss:0.0095	, anomaly_loss:0.3788	fnorm_loss:0.0075, a_fnorm_loss:0.0526P:0.58, R:0.95
 50%|█████     | 50/100 [14:53<16:34, 19.88s/it]epoch [50/100], focal_loss:0.0080	, anomaly_loss:0.3757	fnorm_loss:0.0072, a_fnorm_loss:0.0519P:0.59, R:0.94
normal: 0.0472 0.1964  anomaly: 0.1373 0.7513	P:0.50, R:0.43
Pixel Auroc:0.980, Sample Auroc0.995, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0413
 51%|█████     | 51/100 [15:06<14:38, 17.93s/it]epoch [51/100], focal_loss:0.0109	, anomaly_loss:0.3821	fnorm_loss:0.0075, a_fnorm_loss:0.0511P:0.56, R:0.92
 52%|█████▏    | 52/100 [15:20<13:17, 16.62s/it]epoch [52/100], focal_loss:0.0099	, anomaly_loss:0.3852	fnorm_loss:0.0074, a_fnorm_loss:0.0509P:0.60, R:0.93
 53%|█████▎    | 53/100 [15:34<12:22, 15.80s/it]epoch [53/100], focal_loss:0.0091	, anomaly_loss:0.3795	fnorm_loss:0.0072, a_fnorm_loss:0.0527P:0.59, R:0.94
 54%|█████▍    | 54/100 [15:47<11:33, 15.07s/it]epoch [54/100], focal_loss:0.0098	, anomaly_loss:0.3857	fnorm_loss:0.0073, a_fnorm_loss:0.0514P:0.56, R:0.93
 55%|█████▌    | 55/100 [16:17<14:34, 19.44s/it]epoch [55/100], focal_loss:0.0107	, anomaly_loss:0.3820	fnorm_loss:0.0072, a_fnorm_loss:0.0513P:0.58, R:0.92
normal: 0.0529 0.3051  anomaly: 0.1331 0.7209	P:0.50, R:0.44
Pixel Auroc:0.981, Sample Auroc0.987, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0429
 56%|█████▌    | 56/100 [16:30<12:58, 17.70s/it]epoch [56/100], focal_loss:0.0085	, anomaly_loss:0.3736	fnorm_loss:0.0071, a_fnorm_loss:0.0522P:0.59, R:0.95
 57%|█████▋    | 57/100 [16:44<11:49, 16.51s/it]epoch [57/100], focal_loss:0.0105	, anomaly_loss:0.3790	fnorm_loss:0.0072, a_fnorm_loss:0.0522P:0.58, R:0.94
 58%|█████▊    | 58/100 [16:58<10:56, 15.62s/it]epoch [58/100], focal_loss:0.0081	, anomaly_loss:0.3818	fnorm_loss:0.0069, a_fnorm_loss:0.0523P:0.61, R:0.95
 59%|█████▉    | 59/100 [17:11<10:14, 14.98s/it]epoch [59/100], focal_loss:0.0083	, anomaly_loss:0.3717	fnorm_loss:0.0069, a_fnorm_loss:0.0532P:0.59, R:0.95
 60%|██████    | 60/100 [17:42<13:14, 19.85s/it]epoch [60/100], focal_loss:0.0122	, anomaly_loss:0.3882	fnorm_loss:0.0073, a_fnorm_loss:0.0497P:0.57, R:0.91
normal: 0.0436 0.1661  anomaly: 0.1097 0.7462	P:0.51, R:0.37
Pixel Auroc:0.981, Sample Auroc0.993, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0381
 61%|██████    | 61/100 [17:56<11:37, 17.89s/it]epoch [61/100], focal_loss:0.0081	, anomaly_loss:0.3727	fnorm_loss:0.0069, a_fnorm_loss:0.0528P:0.56, R:0.94
 62%|██████▏   | 62/100 [18:09<10:34, 16.69s/it]epoch [62/100], focal_loss:0.0090	, anomaly_loss:0.3688	fnorm_loss:0.0069, a_fnorm_loss:0.0524P:0.58, R:0.95
 63%|██████▎   | 63/100 [18:23<09:43, 15.77s/it]epoch [63/100], focal_loss:0.0188	, anomaly_loss:0.4204	fnorm_loss:0.0079, a_fnorm_loss:0.0468P:0.49, R:0.77
 64%|██████▍   | 64/100 [18:37<09:09, 15.26s/it]epoch [64/100], focal_loss:0.0100	, anomaly_loss:0.3947	fnorm_loss:0.0072, a_fnorm_loss:0.0500P:0.53, R:0.93
 65%|██████▌   | 65/100 [19:12<12:23, 21.25s/it]epoch [65/100], focal_loss:0.0099	, anomaly_loss:0.3809	fnorm_loss:0.0070, a_fnorm_loss:0.0521P:0.56, R:0.94
normal: 0.0388 0.1661  anomaly: 0.0741 0.7181	P:0.52, R:0.37
Pixel Auroc:0.978, Sample Auroc0.990, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0368
 66%|██████▌   | 66/100 [19:26<10:45, 19.00s/it]epoch [66/100], focal_loss:0.0090	, anomaly_loss:0.3702	fnorm_loss:0.0068, a_fnorm_loss:0.0533P:0.58, R:0.94
 67%|██████▋   | 67/100 [19:40<09:33, 17.37s/it]epoch [67/100], focal_loss:0.0116	, anomaly_loss:0.3864	fnorm_loss:0.0070, a_fnorm_loss:0.0505P:0.57, R:0.93
 68%|██████▊   | 68/100 [19:54<08:45, 16.41s/it]epoch [68/100], focal_loss:0.0096	, anomaly_loss:0.3832	fnorm_loss:0.0069, a_fnorm_loss:0.0526P:0.57, R:0.94
 69%|██████▉   | 69/100 [20:08<08:03, 15.60s/it]epoch [69/100], focal_loss:0.0147	, anomaly_loss:0.3983	fnorm_loss:0.0070, a_fnorm_loss:0.0509P:0.59, R:0.90
 70%|███████   | 70/100 [20:38<10:03, 20.12s/it]epoch [70/100], focal_loss:0.0092	, anomaly_loss:0.3765	fnorm_loss:0.0067, a_fnorm_loss:0.0521P:0.57, R:0.95
normal: 0.0481 0.2523  anomaly: 0.1637 0.7449	P:0.48, R:0.46
Pixel Auroc:0.980, Sample Auroc0.993, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0399
 71%|███████   | 71/100 [20:52<08:48, 18.24s/it]epoch [71/100], focal_loss:0.0090	, anomaly_loss:0.3780	fnorm_loss:0.0067, a_fnorm_loss:0.0524P:0.56, R:0.94
 72%|███████▏  | 72/100 [21:06<07:52, 16.87s/it]epoch [72/100], focal_loss:0.0079	, anomaly_loss:0.3756	fnorm_loss:0.0065, a_fnorm_loss:0.0539P:0.60, R:0.95
 73%|███████▎  | 73/100 [21:20<07:16, 16.18s/it]epoch [73/100], focal_loss:0.0088	, anomaly_loss:0.3799	fnorm_loss:0.0066, a_fnorm_loss:0.0528P:0.58, R:0.95
 74%|███████▍  | 74/100 [21:34<06:39, 15.38s/it]epoch [74/100], focal_loss:0.0091	, anomaly_loss:0.3708	fnorm_loss:0.0065, a_fnorm_loss:0.0533P:0.61, R:0.95
 75%|███████▌  | 75/100 [22:05<08:22, 20.08s/it]epoch [75/100], focal_loss:0.0080	, anomaly_loss:0.3808	fnorm_loss:0.0065, a_fnorm_loss:0.0545P:0.61, R:0.96
normal: 0.0370 0.2573  anomaly: 0.1401 0.7527	P:0.50, R:0.41
Pixel Auroc:0.980, Sample Auroc0.994, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0426
 76%|███████▌  | 76/100 [22:18<07:15, 18.13s/it]epoch [76/100], focal_loss:0.0089	, anomaly_loss:0.3792	fnorm_loss:0.0066, a_fnorm_loss:0.0527P:0.58, R:0.94
 77%|███████▋  | 77/100 [22:32<06:26, 16.79s/it]epoch [77/100], focal_loss:0.0091	, anomaly_loss:0.3775	fnorm_loss:0.0066, a_fnorm_loss:0.0527P:0.60, R:0.94
 78%|███████▊  | 78/100 [22:46<05:48, 15.86s/it]epoch [78/100], focal_loss:0.0091	, anomaly_loss:0.3727	fnorm_loss:0.0065, a_fnorm_loss:0.0528P:0.58, R:0.94
 79%|███████▉  | 79/100 [22:59<05:18, 15.18s/it]epoch [79/100], focal_loss:0.0116	, anomaly_loss:0.3932	fnorm_loss:0.0067, a_fnorm_loss:0.0520P:0.56, R:0.88
 80%|████████  | 80/100 [23:29<06:28, 19.44s/it]epoch [80/100], focal_loss:0.0094	, anomaly_loss:0.3906	fnorm_loss:0.0065, a_fnorm_loss:0.0520P:0.58, R:0.90
normal: 0.0352 0.2229  anomaly: 0.0831 0.7183	P:0.50, R:0.39
Pixel Auroc:0.980, Sample Auroc0.981, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0380
 81%|████████  | 81/100 [23:43<05:38, 17.79s/it]epoch [81/100], focal_loss:0.0078	, anomaly_loss:0.3702	fnorm_loss:0.0063, a_fnorm_loss:0.0541P:0.58, R:0.96
 82%|████████▏ | 82/100 [23:57<04:58, 16.60s/it]epoch [82/100], focal_loss:0.0086	, anomaly_loss:0.3691	fnorm_loss:0.0064, a_fnorm_loss:0.0533P:0.60, R:0.95
 83%|████████▎ | 83/100 [24:11<04:28, 15.81s/it]epoch [83/100], focal_loss:0.0079	, anomaly_loss:0.3758	fnorm_loss:0.0064, a_fnorm_loss:0.0533P:0.58, R:0.96
 84%|████████▍ | 84/100 [24:25<04:07, 15.49s/it]epoch [84/100], focal_loss:0.0106	, anomaly_loss:0.3759	fnorm_loss:0.0065, a_fnorm_loss:0.0521P:0.56, R:0.93
 85%|████████▌ | 85/100 [24:55<04:57, 19.81s/it]epoch [85/100], focal_loss:0.0081	, anomaly_loss:0.3759	fnorm_loss:0.0065, a_fnorm_loss:0.0518P:0.54, R:0.94
normal: 0.0557 0.2744  anomaly: 0.1059 0.7388	P:0.48, R:0.43
Pixel Auroc:0.982, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0405
 86%|████████▌ | 86/100 [25:09<04:12, 18.01s/it]epoch [86/100], focal_loss:0.0085	, anomaly_loss:0.3803	fnorm_loss:0.0064, a_fnorm_loss:0.0526P:0.59, R:0.94
 87%|████████▋ | 87/100 [25:23<03:37, 16.74s/it]epoch [87/100], focal_loss:0.0086	, anomaly_loss:0.3742	fnorm_loss:0.0064, a_fnorm_loss:0.0542P:0.59, R:0.95
 88%|████████▊ | 88/100 [25:37<03:11, 15.96s/it]epoch [88/100], focal_loss:0.0088	, anomaly_loss:0.3744	fnorm_loss:0.0063, a_fnorm_loss:0.0535P:0.62, R:0.95
 89%|████████▉ | 89/100 [25:51<02:49, 15.42s/it]epoch [89/100], focal_loss:0.0072	, anomaly_loss:0.3666	fnorm_loss:0.0063, a_fnorm_loss:0.0555P:0.64, R:0.97
 90%|█████████ | 90/100 [26:21<03:18, 19.88s/it]epoch [90/100], focal_loss:0.0084	, anomaly_loss:0.3749	fnorm_loss:0.0063, a_fnorm_loss:0.0543P:0.61, R:0.95
normal: 0.0481 0.2238  anomaly: 0.1186 0.7438	P:0.51, R:0.41
Pixel Auroc:0.981, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0382
 91%|█████████ | 91/100 [26:35<02:42, 18.06s/it]epoch [91/100], focal_loss:0.0078	, anomaly_loss:0.3800	fnorm_loss:0.0064, a_fnorm_loss:0.0534P:0.57, R:0.96
 92%|█████████▏| 92/100 [26:49<02:13, 16.74s/it]epoch [92/100], focal_loss:0.0092	, anomaly_loss:0.3787	fnorm_loss:0.0063, a_fnorm_loss:0.0537P:0.60, R:0.94
 93%|█████████▎| 93/100 [27:04<01:52, 16.14s/it]epoch [93/100], focal_loss:0.0087	, anomaly_loss:0.3777	fnorm_loss:0.0064, a_fnorm_loss:0.0539P:0.61, R:0.95
 94%|█████████▍| 94/100 [27:17<01:32, 15.46s/it]epoch [94/100], focal_loss:0.0081	, anomaly_loss:0.3716	fnorm_loss:0.0064, a_fnorm_loss:0.0537P:0.58, R:0.95
 95%|█████████▌| 95/100 [27:48<01:39, 19.90s/it]epoch [95/100], focal_loss:0.0079	, anomaly_loss:0.3696	fnorm_loss:0.0063, a_fnorm_loss:0.0553P:0.60, R:0.96
normal: 0.0449 0.2346  anomaly: 0.0968 0.7453	P:0.50, R:0.40
Pixel Auroc:0.981, Sample Auroc0.984, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0378
 96%|█████████▌| 96/100 [28:01<01:12, 18.08s/it]epoch [96/100], focal_loss:0.0078	, anomaly_loss:0.3682	fnorm_loss:0.0063, a_fnorm_loss:0.0538P:0.61, R:0.95
 97%|█████████▋| 97/100 [28:16<00:50, 16.88s/it]epoch [97/100], focal_loss:0.0081	, anomaly_loss:0.3743	fnorm_loss:0.0063, a_fnorm_loss:0.0540P:0.60, R:0.95
 98%|█████████▊| 98/100 [28:30<00:31, 16.00s/it]epoch [98/100], focal_loss:0.0086	, anomaly_loss:0.3762	fnorm_loss:0.0064, a_fnorm_loss:0.0547P:0.57, R:0.95
 99%|█████████▉| 99/100 [28:43<00:15, 15.14s/it]epoch [99/100], focal_loss:0.0080	, anomaly_loss:0.3731	fnorm_loss:0.0063, a_fnorm_loss:0.0528P:0.58, R:0.94
100%|██████████| 100/100 [29:12<00:00, 19.43s/it]100%|██████████| 100/100 [29:12<00:00, 17.53s/it]
epoch [100/100], focal_loss:0.0076	, anomaly_loss:0.3730	fnorm_loss:0.0064, a_fnorm_loss:0.0554P:0.60, R:0.96
normal: 0.0435 0.2491  anomaly: 0.1015 0.7465	P:0.49, R:0.41
Pixel Auroc:0.981, Sample Auroc0.986, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0401
training Stubborn Student...
hazelnut
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:08<16:30,  8.32s/it]epoch [1/120], kd_loss:4.3895
  2%|▏         | 2/120 [00:16<16:21,  8.31s/it]epoch [2/120], kd_loss:3.6256
  2%|▎         | 3/120 [00:25<16:17,  8.36s/it]epoch [3/120], kd_loss:2.9690
  3%|▎         | 4/120 [00:33<16:07,  8.34s/it]epoch [4/120], kd_loss:2.4427
  4%|▍         | 5/120 [00:41<16:03,  8.38s/it]epoch [5/120], kd_loss:2.3336
  5%|▌         | 6/120 [00:50<15:55,  8.38s/it]epoch [6/120], kd_loss:2.0877
  6%|▌         | 7/120 [00:58<15:46,  8.37s/it]epoch [7/120], kd_loss:2.4239
  7%|▋         | 8/120 [01:06<15:36,  8.36s/it]epoch [8/120], kd_loss:2.5912
  8%|▊         | 9/120 [01:15<15:27,  8.36s/it]epoch [9/120], kd_loss:2.3721
  8%|▊         | 10/120 [01:38<24:00, 13.09s/it]epoch [10/120], kd_loss:2.2941
normal: 1.8832 2.3791  anomaly: 1.9974 2.8864
thresh: 2.067664886538746
fpr: 0.075 fnr 0.014285714285714285
Pixel Auroc:0.976, Sample Auroc0.983, Pixel Aupro0.0
  9%|▉         | 11/120 [01:47<21:10, 11.66s/it]epoch [11/120], kd_loss:2.6403
 10%|█         | 12/120 [01:55<19:05, 10.61s/it]epoch [12/120], kd_loss:2.3943
 11%|█         | 13/120 [02:03<17:38,  9.89s/it]epoch [13/120], kd_loss:2.1678
 12%|█▏        | 14/120 [02:12<16:37,  9.41s/it]epoch [14/120], kd_loss:2.0490
 12%|█▎        | 15/120 [02:20<15:53,  9.08s/it]epoch [15/120], kd_loss:2.0336
 13%|█▎        | 16/120 [02:28<15:20,  8.85s/it]epoch [16/120], kd_loss:2.0156
 14%|█▍        | 17/120 [02:37<14:56,  8.71s/it]epoch [17/120], kd_loss:2.0033
 15%|█▌        | 18/120 [02:45<14:37,  8.61s/it]epoch [18/120], kd_loss:1.9892
 16%|█▌        | 19/120 [02:53<14:20,  8.52s/it]epoch [19/120], kd_loss:1.9747
 17%|█▋        | 20/120 [03:18<22:24, 13.44s/it]epoch [20/120], kd_loss:1.9292
normal: 1.2876 1.6122  anomaly: 1.5827 2.7655
thresh: 1.669222653384393
fpr: 0.0 fnr 0.014285714285714285
Pixel Auroc:0.987, Sample Auroc0.999, Pixel Aupro0.0
 18%|█▊        | 21/120 [03:27<19:40, 11.93s/it]epoch [21/120], kd_loss:1.9118
 18%|█▊        | 22/120 [03:35<17:42, 10.84s/it]epoch [22/120], kd_loss:1.8925
 19%|█▉        | 23/120 [03:43<16:18, 10.09s/it]epoch [23/120], kd_loss:2.0120
 20%|██        | 24/120 [03:52<15:20,  9.59s/it]epoch [24/120], kd_loss:1.9581
 21%|██        | 25/120 [04:00<14:37,  9.23s/it]epoch [25/120], kd_loss:1.9821
 22%|██▏       | 26/120 [04:08<14:04,  8.98s/it]epoch [26/120], kd_loss:1.8619
 22%|██▎       | 27/120 [04:17<13:38,  8.80s/it]epoch [27/120], kd_loss:1.8336
 23%|██▎       | 28/120 [04:25<13:18,  8.68s/it]epoch [28/120], kd_loss:1.8187
 24%|██▍       | 29/120 [04:34<13:01,  8.59s/it]epoch [29/120], kd_loss:1.7824
 25%|██▌       | 30/120 [04:57<19:38, 13.09s/it]epoch [30/120], kd_loss:2.6399
normal: 1.3918 1.9359  anomaly: 1.6139 2.7721
thresh: 1.7329207935175295
fpr: 0.025 fnr 0.014285714285714285
Pixel Auroc:0.986, Sample Auroc0.994, Pixel Aupro0.0
 26%|██▌       | 31/120 [05:06<17:17, 11.66s/it]epoch [31/120], kd_loss:2.0672
 27%|██▋       | 32/120 [05:14<15:38, 10.66s/it]epoch [32/120], kd_loss:1.9707
 28%|██▊       | 33/120 [05:22<14:26,  9.96s/it]epoch [33/120], kd_loss:1.9180
 28%|██▊       | 34/120 [05:31<13:36,  9.49s/it]epoch [34/120], kd_loss:2.3626
 29%|██▉       | 35/120 [05:39<12:55,  9.12s/it]epoch [35/120], kd_loss:2.1422
 30%|███       | 36/120 [05:47<12:29,  8.93s/it]epoch [36/120], kd_loss:1.9888
 31%|███       | 37/120 [05:56<12:09,  8.79s/it]epoch [37/120], kd_loss:1.9310
 32%|███▏      | 38/120 [06:04<11:51,  8.67s/it]epoch [38/120], kd_loss:1.8770
 32%|███▎      | 39/120 [06:13<11:37,  8.61s/it]epoch [39/120], kd_loss:1.8174
 33%|███▎      | 40/120 [06:36<17:15, 12.94s/it]epoch [40/120], kd_loss:1.8137
normal: 1.1598 1.6936  anomaly: 1.5324 2.7552
thresh: 1.5324416453469818
fpr: 0.05 fnr 0.0
Pixel Auroc:0.989, Sample Auroc0.994, Pixel Aupro0.0
 34%|███▍      | 41/120 [06:44<15:13, 11.57s/it]epoch [41/120], kd_loss:1.7673
 35%|███▌      | 42/120 [06:52<13:45, 10.59s/it]epoch [42/120], kd_loss:1.7583
 36%|███▌      | 43/120 [07:01<12:44,  9.93s/it]epoch [43/120], kd_loss:1.7388
 37%|███▋      | 44/120 [07:09<11:57,  9.44s/it]epoch [44/120], kd_loss:1.7292
 38%|███▊      | 45/120 [07:17<11:23,  9.11s/it]epoch [45/120], kd_loss:1.7342
 38%|███▊      | 46/120 [07:26<10:58,  8.90s/it]epoch [46/120], kd_loss:2.0867
 39%|███▉      | 47/120 [07:34<10:40,  8.77s/it]epoch [47/120], kd_loss:1.9461
 40%|████      | 48/120 [07:43<10:23,  8.66s/it]epoch [48/120], kd_loss:1.8322
 41%|████      | 49/120 [07:51<10:08,  8.57s/it]epoch [49/120], kd_loss:1.7698
 42%|████▏     | 50/120 [08:14<15:00, 12.86s/it]epoch [50/120], kd_loss:1.7743
normal: 1.1144 1.7493  anomaly: 1.5759 2.7104
thresh: 1.5758879548507563
fpr: 0.15 fnr 0.0
Pixel Auroc:0.989, Sample Auroc0.985, Pixel Aupro0.0
 42%|████▎     | 51/120 [08:22<13:11, 11.46s/it]epoch [51/120], kd_loss:1.7377
 43%|████▎     | 52/120 [08:30<11:54, 10.51s/it]epoch [52/120], kd_loss:1.8600
 44%|████▍     | 53/120 [08:39<10:58,  9.82s/it]epoch [53/120], kd_loss:1.7712
 45%|████▌     | 54/120 [08:47<10:19,  9.39s/it]epoch [54/120], kd_loss:1.7517
 46%|████▌     | 55/120 [08:55<09:50,  9.08s/it]epoch [55/120], kd_loss:1.7311
 47%|████▋     | 56/120 [09:04<09:28,  8.88s/it]epoch [56/120], kd_loss:1.7159
 48%|████▊     | 57/120 [09:12<09:12,  8.77s/it]epoch [57/120], kd_loss:2.0502
 48%|████▊     | 58/120 [09:21<08:55,  8.64s/it]epoch [58/120], kd_loss:2.1133
 49%|████▉     | 59/120 [09:29<08:42,  8.57s/it]epoch [59/120], kd_loss:1.8142
 50%|█████     | 60/120 [09:52<12:56, 12.93s/it]epoch [60/120], kd_loss:1.7236
normal: 1.1245 1.6294  anomaly: 1.5487 2.7116
thresh: 1.5486642400090704
fpr: 0.05 fnr 0.0
Pixel Auroc:0.989, Sample Auroc0.996, Pixel Aupro0.0
 51%|█████     | 61/120 [10:00<11:19, 11.52s/it]epoch [61/120], kd_loss:1.7139
 52%|█████▏    | 62/120 [10:09<10:12, 10.56s/it]epoch [62/120], kd_loss:1.7055
 52%|█████▎    | 63/120 [10:17<09:22,  9.88s/it]epoch [63/120], kd_loss:1.7094
 53%|█████▎    | 64/120 [10:25<08:46,  9.40s/it]epoch [64/120], kd_loss:1.7654
 54%|█████▍    | 65/120 [10:34<08:19,  9.09s/it]epoch [65/120], kd_loss:1.7591
 55%|█████▌    | 66/120 [10:42<07:58,  8.86s/it]epoch [66/120], kd_loss:1.7065
 56%|█████▌    | 67/120 [10:50<07:40,  8.70s/it]epoch [67/120], kd_loss:1.7082
 57%|█████▋    | 68/120 [10:59<07:26,  8.59s/it]epoch [68/120], kd_loss:1.6898
 57%|█████▊    | 69/120 [11:07<07:14,  8.53s/it]epoch [69/120], kd_loss:1.6842
 57%|█████▊    | 69/120 [11:32<08:31, 10.03s/it]
epoch [70/120], kd_loss:1.6742
normal: 1.1119 1.4829  anomaly: 1.5133 2.6213
thresh: 1.5132786658518294
fpr: 0.0 fnr 0.0
Pixel Auroc:0.990, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
metal_nut
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:21<34:51, 21.13s/it]epoch [1/100], focal_loss:0.0850	, anomaly_loss:0.5997	fnorm_loss:0.0579, a_fnorm_loss:0.0152P:0.00, R:0.01
normal: 0.2549 0.2626  anomaly: 0.2532 0.2626	P:0.00, R:0.00
Pixel Auroc:0.431, Sample Auroc0.450, Pixel Aupro0.0
test_fnorm_loss: 0.0692 test_afnorm_loss: 0.0161
  2%|▏         | 2/100 [00:27<20:36, 12.62s/it]epoch [2/100], focal_loss:0.0735	, anomaly_loss:0.5923	fnorm_loss:0.0555, a_fnorm_loss:0.0148P:0.00, R:0.00
  3%|▎         | 3/100 [00:34<16:05,  9.95s/it]epoch [3/100], focal_loss:0.0643	, anomaly_loss:0.6088	fnorm_loss:0.0500, a_fnorm_loss:0.0134P:0.00, R:0.00
  4%|▍         | 4/100 [00:41<13:50,  8.65s/it]epoch [4/100], focal_loss:0.0606	, anomaly_loss:0.6226	fnorm_loss:0.0459, a_fnorm_loss:0.0124P:0.00, R:0.00
  5%|▌         | 5/100 [01:02<20:38, 13.03s/it]epoch [5/100], focal_loss:0.0597	, anomaly_loss:0.6317	fnorm_loss:0.0431, a_fnorm_loss:0.0120P:0.00, R:0.00
normal: 0.1845 0.1888  anomaly: 0.1831 0.1889	P:0.00, R:0.00
Pixel Auroc:0.449, Sample Auroc0.443, Pixel Aupro0.0
test_fnorm_loss: 0.0500 test_afnorm_loss: 0.0119
  6%|▌         | 6/100 [01:08<17:06, 10.92s/it]epoch [6/100], focal_loss:0.0641	, anomaly_loss:0.6339	fnorm_loss:0.0423, a_fnorm_loss:0.0116P:0.00, R:0.00
  7%|▋         | 7/100 [01:15<14:55,  9.63s/it]epoch [7/100], focal_loss:0.0568	, anomaly_loss:0.6405	fnorm_loss:0.0406, a_fnorm_loss:0.0114P:0.00, R:0.00
  8%|▊         | 8/100 [01:22<13:21,  8.71s/it]epoch [8/100], focal_loss:0.0610	, anomaly_loss:0.6369	fnorm_loss:0.0412, a_fnorm_loss:0.0118P:0.00, R:0.02
  9%|▉         | 9/100 [01:29<12:18,  8.11s/it]epoch [9/100], focal_loss:0.0589	, anomaly_loss:0.6395	fnorm_loss:0.0397, a_fnorm_loss:0.0116P:0.00, R:0.00
 10%|█         | 10/100 [01:50<18:21, 12.24s/it]epoch [10/100], focal_loss:0.0575	, anomaly_loss:0.5866	fnorm_loss:0.0384, a_fnorm_loss:0.0187P:0.06, R:0.15
normal: 0.2654 0.2953  anomaly: 0.2602 0.2958	P:0.11, R:0.16
Pixel Auroc:0.724, Sample Auroc0.582, Pixel Aupro0.0
test_fnorm_loss: 0.0453 test_afnorm_loss: 0.0225
 11%|█         | 11/100 [01:58<15:53, 10.72s/it]epoch [11/100], focal_loss:0.0525	, anomaly_loss:0.5418	fnorm_loss:0.0349, a_fnorm_loss:0.0273P:0.09, R:0.27
 12%|█▏        | 12/100 [02:04<13:52,  9.46s/it]epoch [12/100], focal_loss:0.0555	, anomaly_loss:0.5437	fnorm_loss:0.0326, a_fnorm_loss:0.0268P:0.10, R:0.26
 13%|█▎        | 13/100 [02:11<12:45,  8.80s/it]epoch [13/100], focal_loss:0.0476	, anomaly_loss:0.5192	fnorm_loss:0.0300, a_fnorm_loss:0.0302P:0.11, R:0.30
 14%|█▍        | 14/100 [02:18<11:42,  8.17s/it]epoch [14/100], focal_loss:0.0416	, anomaly_loss:0.5082	fnorm_loss:0.0275, a_fnorm_loss:0.0307P:0.19, R:0.51
 15%|█▌        | 15/100 [02:44<19:13, 13.57s/it]epoch [15/100], focal_loss:0.0392	, anomaly_loss:0.4915	fnorm_loss:0.0249, a_fnorm_loss:0.0330P:0.22, R:0.58
normal: 0.2026 0.3562  anomaly: 0.2816 0.4554	P:0.37, R:0.27
Pixel Auroc:0.670, Sample Auroc0.976, Pixel Aupro0.0
test_fnorm_loss: 0.0276 test_afnorm_loss: 0.0217
 16%|█▌        | 16/100 [02:51<16:10, 11.55s/it]epoch [16/100], focal_loss:0.0392	, anomaly_loss:0.4974	fnorm_loss:0.0231, a_fnorm_loss:0.0333P:0.21, R:0.56
 17%|█▋        | 17/100 [02:58<14:13, 10.28s/it]epoch [17/100], focal_loss:0.0367	, anomaly_loss:0.4838	fnorm_loss:0.0216, a_fnorm_loss:0.0345P:0.26, R:0.59
 18%|█▊        | 18/100 [03:05<12:38,  9.25s/it]epoch [18/100], focal_loss:0.0384	, anomaly_loss:0.5013	fnorm_loss:0.0207, a_fnorm_loss:0.0332P:0.23, R:0.57
 19%|█▉        | 19/100 [03:12<11:29,  8.51s/it]epoch [19/100], focal_loss:0.0356	, anomaly_loss:0.4855	fnorm_loss:0.0196, a_fnorm_loss:0.0350P:0.26, R:0.58
 20%|██        | 20/100 [03:32<16:06, 12.08s/it]epoch [20/100], focal_loss:0.0389	, anomaly_loss:0.5029	fnorm_loss:0.0189, a_fnorm_loss:0.0319P:0.27, R:0.54
normal: 0.3408 0.4440  anomaly: 0.3692 0.4871	P:0.25, R:0.39
Pixel Auroc:0.817, Sample Auroc0.894, Pixel Aupro0.0
test_fnorm_loss: 0.0289 test_afnorm_loss: 0.0378
 21%|██        | 21/100 [03:39<13:53, 10.55s/it]epoch [21/100], focal_loss:0.0420	, anomaly_loss:0.5086	fnorm_loss:0.0195, a_fnorm_loss:0.0298P:0.30, R:0.52
 22%|██▏       | 22/100 [03:46<12:14,  9.42s/it]epoch [22/100], focal_loss:0.0356	, anomaly_loss:0.4820	fnorm_loss:0.0177, a_fnorm_loss:0.0341P:0.28, R:0.57
 23%|██▎       | 23/100 [03:53<11:03,  8.62s/it]epoch [23/100], focal_loss:0.0306	, anomaly_loss:0.4612	fnorm_loss:0.0168, a_fnorm_loss:0.0370P:0.38, R:0.66
 24%|██▍       | 24/100 [04:00<10:16,  8.11s/it]epoch [24/100], focal_loss:0.0292	, anomaly_loss:0.4645	fnorm_loss:0.0162, a_fnorm_loss:0.0369P:0.44, R:0.73
 25%|██▌       | 25/100 [04:20<14:37, 11.70s/it]epoch [25/100], focal_loss:0.0346	, anomaly_loss:0.4843	fnorm_loss:0.0170, a_fnorm_loss:0.0355P:0.32, R:0.67
normal: 0.1095 0.2197  anomaly: 0.1679 0.3061	P:0.21, R:0.12
Pixel Auroc:0.741, Sample Auroc0.971, Pixel Aupro0.0
test_fnorm_loss: 0.0245 test_afnorm_loss: 0.0197
 26%|██▌       | 26/100 [04:27<12:34, 10.20s/it]epoch [26/100], focal_loss:0.0350	, anomaly_loss:0.4949	fnorm_loss:0.0183, a_fnorm_loss:0.0349P:0.35, R:0.57
 27%|██▋       | 27/100 [04:34<11:14,  9.25s/it]epoch [27/100], focal_loss:0.0296	, anomaly_loss:0.4717	fnorm_loss:0.0168, a_fnorm_loss:0.0363P:0.41, R:0.77
 28%|██▊       | 28/100 [04:41<10:18,  8.59s/it]epoch [28/100], focal_loss:0.0268	, anomaly_loss:0.4469	fnorm_loss:0.0151, a_fnorm_loss:0.0384P:0.42, R:0.87
 29%|██▉       | 29/100 [04:48<09:30,  8.04s/it]epoch [29/100], focal_loss:0.0283	, anomaly_loss:0.4700	fnorm_loss:0.0150, a_fnorm_loss:0.0353P:0.39, R:0.78
 30%|███       | 30/100 [05:13<15:34, 13.35s/it]epoch [30/100], focal_loss:0.0222	, anomaly_loss:0.4474	fnorm_loss:0.0140, a_fnorm_loss:0.0391P:0.41, R:0.86
normal: 0.1781 0.3572  anomaly: 0.2594 0.5423	P:0.55, R:0.33
Pixel Auroc:0.793, Sample Auroc0.969, Pixel Aupro0.0
test_fnorm_loss: 0.0156 test_afnorm_loss: 0.0249
 31%|███       | 31/100 [05:20<13:10, 11.46s/it]epoch [31/100], focal_loss:0.0271	, anomaly_loss:0.4564	fnorm_loss:0.0144, a_fnorm_loss:0.0359P:0.41, R:0.84
 32%|███▏      | 32/100 [05:27<11:28, 10.12s/it]epoch [32/100], focal_loss:0.0291	, anomaly_loss:0.4627	fnorm_loss:0.0143, a_fnorm_loss:0.0360P:0.43, R:0.81
 33%|███▎      | 33/100 [05:34<10:08,  9.07s/it]epoch [33/100], focal_loss:0.0231	, anomaly_loss:0.4487	fnorm_loss:0.0136, a_fnorm_loss:0.0377P:0.43, R:0.83
 34%|███▍      | 34/100 [05:41<09:23,  8.54s/it]epoch [34/100], focal_loss:0.0224	, anomaly_loss:0.4439	fnorm_loss:0.0132, a_fnorm_loss:0.0395P:0.48, R:0.87
 35%|███▌      | 35/100 [06:02<13:17, 12.27s/it]epoch [35/100], focal_loss:0.0211	, anomaly_loss:0.4443	fnorm_loss:0.0129, a_fnorm_loss:0.0390P:0.46, R:0.84
normal: 0.0839 0.2922  anomaly: 0.1671 0.5382	P:0.54, R:0.26
Pixel Auroc:0.764, Sample Auroc0.977, Pixel Aupro0.0
test_fnorm_loss: 0.0135 test_afnorm_loss: 0.0214
 36%|███▌      | 36/100 [06:09<11:22, 10.66s/it]epoch [36/100], focal_loss:0.0250	, anomaly_loss:0.4420	fnorm_loss:0.0129, a_fnorm_loss:0.0387P:0.47, R:0.85
 37%|███▋      | 37/100 [06:16<10:04,  9.60s/it]epoch [37/100], focal_loss:0.0242	, anomaly_loss:0.4420	fnorm_loss:0.0128, a_fnorm_loss:0.0384P:0.44, R:0.84
 38%|███▊      | 38/100 [06:23<09:08,  8.84s/it]epoch [38/100], focal_loss:0.0220	, anomaly_loss:0.4420	fnorm_loss:0.0125, a_fnorm_loss:0.0388P:0.46, R:0.85
 39%|███▉      | 39/100 [06:31<08:30,  8.38s/it]epoch [39/100], focal_loss:0.0202	, anomaly_loss:0.4387	fnorm_loss:0.0121, a_fnorm_loss:0.0401P:0.47, R:0.86
 40%|████      | 40/100 [06:51<11:57, 11.96s/it]epoch [40/100], focal_loss:0.0223	, anomaly_loss:0.4437	fnorm_loss:0.0121, a_fnorm_loss:0.0389P:0.47, R:0.83
normal: 0.1001 0.2319  anomaly: 0.1578 0.5130	P:0.48, R:0.24
Pixel Auroc:0.765, Sample Auroc0.988, Pixel Aupro0.0
test_fnorm_loss: 0.0124 test_afnorm_loss: 0.0228
 41%|████      | 41/100 [06:58<10:12, 10.38s/it]epoch [41/100], focal_loss:0.0211	, anomaly_loss:0.4306	fnorm_loss:0.0119, a_fnorm_loss:0.0398P:0.47, R:0.86
 42%|████▏     | 42/100 [07:05<09:06,  9.43s/it]epoch [42/100], focal_loss:0.0221	, anomaly_loss:0.4352	fnorm_loss:0.0118, a_fnorm_loss:0.0391P:0.47, R:0.85
 43%|████▎     | 43/100 [07:12<08:17,  8.72s/it]epoch [43/100], focal_loss:0.0203	, anomaly_loss:0.4375	fnorm_loss:0.0114, a_fnorm_loss:0.0397P:0.49, R:0.82
 44%|████▍     | 44/100 [07:19<07:35,  8.13s/it]epoch [44/100], focal_loss:0.0207	, anomaly_loss:0.4292	fnorm_loss:0.0110, a_fnorm_loss:0.0427P:0.48, R:0.88
 45%|████▌     | 45/100 [07:39<10:46, 11.75s/it]epoch [45/100], focal_loss:0.0193	, anomaly_loss:0.4302	fnorm_loss:0.0109, a_fnorm_loss:0.0406P:0.50, R:0.86
normal: 0.2073 0.4122  anomaly: 0.3195 0.6353	P:0.49, R:0.42
Pixel Auroc:0.775, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0126 test_afnorm_loss: 0.0294
 46%|████▌     | 46/100 [07:46<09:11, 10.22s/it]epoch [46/100], focal_loss:0.0183	, anomaly_loss:0.4255	fnorm_loss:0.0107, a_fnorm_loss:0.0414P:0.53, R:0.88
 47%|████▋     | 47/100 [07:52<08:04,  9.15s/it]epoch [47/100], focal_loss:0.0214	, anomaly_loss:0.4405	fnorm_loss:0.0109, a_fnorm_loss:0.0402P:0.47, R:0.83
 48%|████▊     | 48/100 [07:59<07:16,  8.40s/it]epoch [48/100], focal_loss:0.0218	, anomaly_loss:0.4378	fnorm_loss:0.0109, a_fnorm_loss:0.0397P:0.52, R:0.85
 49%|████▉     | 49/100 [08:06<06:44,  7.92s/it]epoch [49/100], focal_loss:0.0166	, anomaly_loss:0.4304	fnorm_loss:0.0104, a_fnorm_loss:0.0423P:0.50, R:0.87
 50%|█████     | 50/100 [08:26<09:40, 11.61s/it]epoch [50/100], focal_loss:0.0199	, anomaly_loss:0.4269	fnorm_loss:0.0106, a_fnorm_loss:0.0408P:0.50, R:0.86
normal: 0.0797 0.2268  anomaly: 0.1009 0.5690	P:0.53, R:0.24
Pixel Auroc:0.753, Sample Auroc0.979, Pixel Aupro0.0
test_fnorm_loss: 0.0105 test_afnorm_loss: 0.0190
 51%|█████     | 51/100 [08:33<08:25, 10.31s/it]epoch [51/100], focal_loss:0.0201	, anomaly_loss:0.4309	fnorm_loss:0.0103, a_fnorm_loss:0.0416P:0.55, R:0.87
 52%|█████▏    | 52/100 [08:40<07:28,  9.34s/it]epoch [52/100], focal_loss:0.0243	, anomaly_loss:0.4399	fnorm_loss:0.0106, a_fnorm_loss:0.0406P:0.55, R:0.83
 53%|█████▎    | 53/100 [08:47<06:45,  8.62s/it]epoch [53/100], focal_loss:0.0167	, anomaly_loss:0.4217	fnorm_loss:0.0099, a_fnorm_loss:0.0424P:0.53, R:0.88
 54%|█████▍    | 54/100 [08:54<06:17,  8.21s/it]epoch [54/100], focal_loss:0.0180	, anomaly_loss:0.4329	fnorm_loss:0.0099, a_fnorm_loss:0.0405P:0.47, R:0.86
 55%|█████▌    | 55/100 [09:18<09:43, 12.97s/it]epoch [55/100], focal_loss:0.0196	, anomaly_loss:0.4241	fnorm_loss:0.0101, a_fnorm_loss:0.0416P:0.48, R:0.86
normal: 0.1334 0.3199  anomaly: 0.2203 0.5831	P:0.57, R:0.32
Pixel Auroc:0.777, Sample Auroc0.986, Pixel Aupro0.0
test_fnorm_loss: 0.0105 test_afnorm_loss: 0.0255
 56%|█████▌    | 56/100 [09:26<08:18, 11.32s/it]epoch [56/100], focal_loss:0.0170	, anomaly_loss:0.4246	fnorm_loss:0.0097, a_fnorm_loss:0.0414P:0.51, R:0.86
 57%|█████▋    | 57/100 [09:33<07:10, 10.01s/it]epoch [57/100], focal_loss:0.0186	, anomaly_loss:0.4227	fnorm_loss:0.0097, a_fnorm_loss:0.0420P:0.51, R:0.88
 58%|█████▊    | 58/100 [09:40<06:19,  9.04s/it]epoch [58/100], focal_loss:0.0182	, anomaly_loss:0.4300	fnorm_loss:0.0096, a_fnorm_loss:0.0419P:0.52, R:0.87
 59%|█████▉    | 59/100 [09:46<05:43,  8.37s/it]epoch [59/100], focal_loss:0.0255	, anomaly_loss:0.4532	fnorm_loss:0.0102, a_fnorm_loss:0.0373P:0.50, R:0.79
 60%|██████    | 60/100 [10:11<08:46, 13.17s/it]epoch [60/100], focal_loss:0.0156	, anomaly_loss:0.4314	fnorm_loss:0.0093, a_fnorm_loss:0.0406P:0.51, R:0.88
normal: 0.1063 0.3162  anomaly: 0.1896 0.6252	P:0.60, R:0.31
Pixel Auroc:0.780, Sample Auroc0.982, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0267
 61%|██████    | 61/100 [10:18<07:27, 11.48s/it]epoch [61/100], focal_loss:0.0152	, anomaly_loss:0.4206	fnorm_loss:0.0091, a_fnorm_loss:0.0431P:0.53, R:0.89
 62%|██████▏   | 62/100 [10:25<06:23, 10.09s/it]epoch [62/100], focal_loss:0.0190	, anomaly_loss:0.4291	fnorm_loss:0.0092, a_fnorm_loss:0.0426P:0.50, R:0.84
 63%|██████▎   | 63/100 [10:32<05:39,  9.17s/it]epoch [63/100], focal_loss:0.0247	, anomaly_loss:0.4539	fnorm_loss:0.0091, a_fnorm_loss:0.0413P:0.56, R:0.70
 64%|██████▍   | 64/100 [10:39<05:09,  8.58s/it]epoch [64/100], focal_loss:0.0191	, anomaly_loss:0.4349	fnorm_loss:0.0093, a_fnorm_loss:0.0406P:0.48, R:0.84
 65%|██████▌   | 65/100 [11:01<07:14, 12.42s/it]epoch [65/100], focal_loss:0.0188	, anomaly_loss:0.4273	fnorm_loss:0.0092, a_fnorm_loss:0.0423P:0.46, R:0.87
normal: 0.0832 0.3362  anomaly: 0.2414 0.6072	P:0.60, R:0.34
Pixel Auroc:0.787, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0096 test_afnorm_loss: 0.0269
 66%|██████▌   | 66/100 [11:08<06:07, 10.80s/it]epoch [66/100], focal_loss:0.0170	, anomaly_loss:0.4210	fnorm_loss:0.0089, a_fnorm_loss:0.0425P:0.54, R:0.89
 67%|██████▋   | 67/100 [11:15<05:21,  9.73s/it]epoch [67/100], focal_loss:0.0182	, anomaly_loss:0.4297	fnorm_loss:0.0091, a_fnorm_loss:0.0417P:0.51, R:0.88
 68%|██████▊   | 68/100 [11:22<04:42,  8.82s/it]epoch [68/100], focal_loss:0.0135	, anomaly_loss:0.4061	fnorm_loss:0.0085, a_fnorm_loss:0.0459P:0.54, R:0.93
 69%|██████▉   | 69/100 [11:29<04:19,  8.36s/it]epoch [69/100], focal_loss:0.0152	, anomaly_loss:0.4143	fnorm_loss:0.0086, a_fnorm_loss:0.0436P:0.55, R:0.91
 70%|███████   | 70/100 [11:55<06:51, 13.72s/it]epoch [70/100], focal_loss:0.0156	, anomaly_loss:0.4127	fnorm_loss:0.0084, a_fnorm_loss:0.0448P:0.57, R:0.91
normal: 0.0930 0.2902  anomaly: 0.1773 0.6346	P:0.62, R:0.33
Pixel Auroc:0.759, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0250
 71%|███████   | 71/100 [12:02<05:36, 11.60s/it]epoch [71/100], focal_loss:0.0144	, anomaly_loss:0.4222	fnorm_loss:0.0083, a_fnorm_loss:0.0440P:0.51, R:0.89
 72%|███████▏  | 72/100 [12:09<04:42, 10.09s/it]epoch [72/100], focal_loss:0.0180	, anomaly_loss:0.4247	fnorm_loss:0.0088, a_fnorm_loss:0.0416P:0.51, R:0.86
 73%|███████▎  | 73/100 [12:15<04:06,  9.13s/it]epoch [73/100], focal_loss:0.0290	, anomaly_loss:0.4867	fnorm_loss:0.0099, a_fnorm_loss:0.0339P:0.48, R:0.63
 74%|███████▍  | 74/100 [12:22<03:37,  8.36s/it]epoch [74/100], focal_loss:0.0190	, anomaly_loss:0.4497	fnorm_loss:0.0095, a_fnorm_loss:0.0363P:0.46, R:0.83
 75%|███████▌  | 75/100 [12:42<04:58, 11.96s/it]epoch [75/100], focal_loss:0.0225	, anomaly_loss:0.4408	fnorm_loss:0.0094, a_fnorm_loss:0.0399P:0.47, R:0.84
normal: 0.1208 0.3139  anomaly: 0.2176 0.6178	P:0.61, R:0.33
Pixel Auroc:0.771, Sample Auroc0.985, Pixel Aupro0.0
test_fnorm_loss: 0.0096 test_afnorm_loss: 0.0242
 76%|███████▌  | 76/100 [12:49<04:08, 10.36s/it]epoch [76/100], focal_loss:0.0165	, anomaly_loss:0.4161	fnorm_loss:0.0085, a_fnorm_loss:0.0435P:0.52, R:0.89
 77%|███████▋  | 77/100 [12:56<03:32,  9.25s/it]epoch [77/100], focal_loss:0.0177	, anomaly_loss:0.4292	fnorm_loss:0.0087, a_fnorm_loss:0.0408P:0.49, R:0.86
 78%|███████▊  | 78/100 [13:02<03:05,  8.42s/it]epoch [78/100], focal_loss:0.0162	, anomaly_loss:0.4200	fnorm_loss:0.0084, a_fnorm_loss:0.0431P:0.59, R:0.87
 79%|███████▉  | 79/100 [13:09<02:46,  7.95s/it]epoch [79/100], focal_loss:0.0150	, anomaly_loss:0.4115	fnorm_loss:0.0083, a_fnorm_loss:0.0439P:0.53, R:0.89
 80%|████████  | 80/100 [13:29<03:51, 11.60s/it]epoch [80/100], focal_loss:0.0199	, anomaly_loss:0.4359	fnorm_loss:0.0086, a_fnorm_loss:0.0435P:0.53, R:0.82
normal: 0.0563 0.1669  anomaly: 0.1120 0.5913	P:0.52, R:0.26
Pixel Auroc:0.762, Sample Auroc0.991, Pixel Aupro0.0
test_fnorm_loss: 0.0080 test_afnorm_loss: 0.0222
 81%|████████  | 81/100 [13:36<03:11, 10.10s/it]epoch [81/100], focal_loss:0.0187	, anomaly_loss:0.4329	fnorm_loss:0.0083, a_fnorm_loss:0.0409P:0.47, R:0.84
 82%|████████▏ | 82/100 [13:43<02:44,  9.14s/it]epoch [82/100], focal_loss:0.0167	, anomaly_loss:0.4160	fnorm_loss:0.0085, a_fnorm_loss:0.0429P:0.51, R:0.91
 83%|████████▎ | 83/100 [13:49<02:21,  8.32s/it]epoch [83/100], focal_loss:0.0136	, anomaly_loss:0.4121	fnorm_loss:0.0080, a_fnorm_loss:0.0441P:0.48, R:0.91
 84%|████████▍ | 84/100 [13:56<02:04,  7.79s/it]epoch [84/100], focal_loss:0.0171	, anomaly_loss:0.4236	fnorm_loss:0.0082, a_fnorm_loss:0.0437P:0.53, R:0.90
 85%|████████▌ | 85/100 [14:17<02:57, 11.81s/it]epoch [85/100], focal_loss:0.0163	, anomaly_loss:0.4074	fnorm_loss:0.0083, a_fnorm_loss:0.0444P:0.51, R:0.90
normal: 0.1259 0.3869  anomaly: 0.2530 0.6598	P:0.61, R:0.38
Pixel Auroc:0.767, Sample Auroc0.987, Pixel Aupro0.0
test_fnorm_loss: 0.0089 test_afnorm_loss: 0.0285
 86%|████████▌ | 86/100 [14:23<02:23, 10.26s/it]epoch [86/100], focal_loss:0.0189	, anomaly_loss:0.4277	fnorm_loss:0.0083, a_fnorm_loss:0.0422P:0.52, R:0.87
 87%|████████▋ | 87/100 [14:30<01:58,  9.13s/it]epoch [87/100], focal_loss:0.0148	, anomaly_loss:0.4193	fnorm_loss:0.0082, a_fnorm_loss:0.0440P:0.51, R:0.89
 88%|████████▊ | 88/100 [14:37<01:40,  8.39s/it]epoch [88/100], focal_loss:0.0142	, anomaly_loss:0.4188	fnorm_loss:0.0080, a_fnorm_loss:0.0441P:0.51, R:0.88
 89%|████████▉ | 89/100 [14:43<01:26,  7.88s/it]epoch [89/100], focal_loss:0.0165	, anomaly_loss:0.4212	fnorm_loss:0.0081, a_fnorm_loss:0.0428P:0.52, R:0.87
 90%|█████████ | 90/100 [15:09<02:11, 13.11s/it]epoch [90/100], focal_loss:0.0165	, anomaly_loss:0.4182	fnorm_loss:0.0085, a_fnorm_loss:0.0443P:0.53, R:0.90
normal: 0.1404 0.3516  anomaly: 0.2274 0.6628	P:0.63, R:0.36
Pixel Auroc:0.765, Sample Auroc0.991, Pixel Aupro0.0
test_fnorm_loss: 0.0087 test_afnorm_loss: 0.0266
 91%|█████████ | 91/100 [15:16<01:41, 11.28s/it]epoch [91/100], focal_loss:0.0142	, anomaly_loss:0.4117	fnorm_loss:0.0081, a_fnorm_loss:0.0451P:0.51, R:0.91
 92%|█████████▏| 92/100 [15:22<01:19,  9.94s/it]epoch [92/100], focal_loss:0.0143	, anomaly_loss:0.4140	fnorm_loss:0.0080, a_fnorm_loss:0.0432P:0.54, R:0.89
 93%|█████████▎| 93/100 [15:30<01:03,  9.10s/it]epoch [93/100], focal_loss:0.0155	, anomaly_loss:0.4193	fnorm_loss:0.0081, a_fnorm_loss:0.0436P:0.53, R:0.89
 94%|█████████▍| 94/100 [15:36<00:50,  8.42s/it]epoch [94/100], focal_loss:0.0131	, anomaly_loss:0.4071	fnorm_loss:0.0080, a_fnorm_loss:0.0458P:0.54, R:0.92
 95%|█████████▌| 95/100 [15:57<01:00, 12.16s/it]epoch [95/100], focal_loss:0.0142	, anomaly_loss:0.4157	fnorm_loss:0.0079, a_fnorm_loss:0.0459P:0.57, R:0.91
normal: 0.1146 0.3577  anomaly: 0.2314 0.6715	P:0.62, R:0.36
Pixel Auroc:0.768, Sample Auroc0.991, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0281
 96%|█████████▌| 96/100 [16:04<00:42, 10.63s/it]epoch [96/100], focal_loss:0.0212	, anomaly_loss:0.4235	fnorm_loss:0.0082, a_fnorm_loss:0.0432P:0.54, R:0.87
 97%|█████████▋| 97/100 [16:11<00:28,  9.53s/it]epoch [97/100], focal_loss:0.0147	, anomaly_loss:0.4087	fnorm_loss:0.0083, a_fnorm_loss:0.0452P:0.50, R:0.92
 98%|█████████▊| 98/100 [16:18<00:17,  8.75s/it]epoch [98/100], focal_loss:0.0135	, anomaly_loss:0.4119	fnorm_loss:0.0079, a_fnorm_loss:0.0451P:0.56, R:0.89
 99%|█████████▉| 99/100 [16:25<00:08,  8.27s/it]epoch [99/100], focal_loss:0.0162	, anomaly_loss:0.4146	fnorm_loss:0.0081, a_fnorm_loss:0.0451P:0.57, R:0.90
100%|██████████| 100/100 [16:47<00:00, 12.33s/it]100%|██████████| 100/100 [16:47<00:00, 10.08s/it]
epoch [100/100], focal_loss:0.0160	, anomaly_loss:0.4128	fnorm_loss:0.0082, a_fnorm_loss:0.0445P:0.54, R:0.89
normal: 0.1244 0.3678  anomaly: 0.2381 0.6694	P:0.61, R:0.37
Pixel Auroc:0.767, Sample Auroc0.990, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0280
training Stubborn Student...
metal_nut
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:04<09:29,  4.78s/it]epoch [1/120], kd_loss:4.9308
  2%|▏         | 2/120 [00:09<09:21,  4.76s/it]epoch [2/120], kd_loss:4.0921
  2%|▎         | 3/120 [00:14<09:21,  4.80s/it]epoch [3/120], kd_loss:3.8221
  3%|▎         | 4/120 [00:19<09:20,  4.83s/it]epoch [4/120], kd_loss:3.7291
  4%|▍         | 5/120 [00:24<09:15,  4.83s/it]epoch [5/120], kd_loss:3.4033
  5%|▌         | 6/120 [00:28<09:12,  4.85s/it]epoch [6/120], kd_loss:3.1408
  6%|▌         | 7/120 [00:33<09:08,  4.86s/it]epoch [7/120], kd_loss:2.7183
  7%|▋         | 8/120 [00:38<09:04,  4.86s/it]epoch [8/120], kd_loss:2.5395
  8%|▊         | 9/120 [00:43<08:59,  4.86s/it]epoch [9/120], kd_loss:2.3970
  8%|▊         | 9/120 [01:01<12:34,  6.79s/it]
epoch [10/120], kd_loss:2.3189
normal: 1.4442 1.7254  anomaly: 1.7828 2.4810
thresh: 1.7827960246392829
fpr: 0.0 fnr 0.0
Pixel Auroc:0.921, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
pill
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:30<50:56, 30.88s/it]epoch [1/100], focal_loss:0.0823	, anomaly_loss:0.6078	fnorm_loss:0.0660, a_fnorm_loss:0.0158P:0.00, R:0.06
normal: 0.2466 0.2555  anomaly: 0.2364 0.2547	P:0.00, R:0.00
Pixel Auroc:0.419, Sample Auroc0.321, Pixel Aupro0.0
test_fnorm_loss: 0.0692 test_afnorm_loss: 0.0174
  2%|▏         | 2/100 [00:39<29:11, 17.88s/it]epoch [2/100], focal_loss:0.0708	, anomaly_loss:0.6055	fnorm_loss:0.0616, a_fnorm_loss:0.0151P:0.00, R:0.00
  3%|▎         | 3/100 [00:48<22:08, 13.70s/it]epoch [3/100], focal_loss:0.0643	, anomaly_loss:0.6254	fnorm_loss:0.0552, a_fnorm_loss:0.0135P:0.00, R:0.00
  4%|▍         | 4/100 [00:56<18:28, 11.55s/it]epoch [4/100], focal_loss:0.0563	, anomaly_loss:0.6377	fnorm_loss:0.0496, a_fnorm_loss:0.0122P:0.00, R:0.00
  5%|▌         | 5/100 [01:28<29:51, 18.86s/it]epoch [5/100], focal_loss:0.0608	, anomaly_loss:0.6482	fnorm_loss:0.0467, a_fnorm_loss:0.0116P:0.00, R:0.00
normal: 0.1747 0.1795  anomaly: 0.1689 0.1794	P:0.00, R:0.00
Pixel Auroc:0.429, Sample Auroc0.321, Pixel Aupro0.0
test_fnorm_loss: 0.0486 test_afnorm_loss: 0.0125
  6%|▌         | 6/100 [01:36<23:56, 15.29s/it]epoch [6/100], focal_loss:0.0553	, anomaly_loss:0.6474	fnorm_loss:0.0453, a_fnorm_loss:0.0118P:0.01, R:0.00
  7%|▋         | 7/100 [01:45<20:23, 13.16s/it]epoch [7/100], focal_loss:0.0616	, anomaly_loss:0.6590	fnorm_loss:0.0436, a_fnorm_loss:0.0108P:0.00, R:0.00
  8%|▊         | 8/100 [01:54<17:51, 11.65s/it]epoch [8/100], focal_loss:0.0540	, anomaly_loss:0.6517	fnorm_loss:0.0436, a_fnorm_loss:0.0114P:0.00, R:0.00
  9%|▉         | 9/100 [02:02<16:05, 10.61s/it]epoch [9/100], focal_loss:0.0547	, anomaly_loss:0.6036	fnorm_loss:0.0420, a_fnorm_loss:0.0198P:0.05, R:0.12
 10%|█         | 10/100 [02:34<25:54, 17.27s/it]epoch [10/100], focal_loss:0.0483	, anomaly_loss:0.5428	fnorm_loss:0.0371, a_fnorm_loss:0.0326P:0.09, R:0.31
normal: 0.1371 0.2249  anomaly: 0.1375 0.2953	P:0.13, R:0.08
Pixel Auroc:0.701, Sample Auroc0.881, Pixel Aupro0.0
test_fnorm_loss: 0.0359 test_afnorm_loss: 0.0180
 11%|█         | 11/100 [02:43<21:49, 14.71s/it]epoch [11/100], focal_loss:0.0464	, anomaly_loss:0.5378	fnorm_loss:0.0341, a_fnorm_loss:0.0342P:0.10, R:0.30
 12%|█▏        | 12/100 [02:52<18:53, 12.88s/it]epoch [12/100], focal_loss:0.0449	, anomaly_loss:0.5386	fnorm_loss:0.0315, a_fnorm_loss:0.0352P:0.11, R:0.31
 13%|█▎        | 13/100 [03:00<16:33, 11.42s/it]epoch [13/100], focal_loss:0.0441	, anomaly_loss:0.5316	fnorm_loss:0.0297, a_fnorm_loss:0.0368P:0.14, R:0.34
 14%|█▍        | 14/100 [03:08<15:14, 10.63s/it]epoch [14/100], focal_loss:0.0459	, anomaly_loss:0.5335	fnorm_loss:0.0289, a_fnorm_loss:0.0372P:0.13, R:0.31
 15%|█▌        | 15/100 [03:46<26:28, 18.69s/it]epoch [15/100], focal_loss:0.0423	, anomaly_loss:0.5094	fnorm_loss:0.0286, a_fnorm_loss:0.0395P:0.28, R:0.43
normal: 0.1955 0.2876  anomaly: 0.1942 0.4195	P:0.25, R:0.21
Pixel Auroc:0.852, Sample Auroc0.832, Pixel Aupro0.0
test_fnorm_loss: 0.0278 test_afnorm_loss: 0.0161
 16%|█▌        | 16/100 [03:55<22:14, 15.89s/it]epoch [16/100], focal_loss:0.0360	, anomaly_loss:0.4886	fnorm_loss:0.0263, a_fnorm_loss:0.0383P:0.33, R:0.67
 17%|█▋        | 17/100 [04:03<18:44, 13.55s/it]epoch [17/100], focal_loss:0.0256	, anomaly_loss:0.4635	fnorm_loss:0.0233, a_fnorm_loss:0.0435P:0.40, R:0.82
 18%|█▊        | 18/100 [04:12<16:23, 11.99s/it]epoch [18/100], focal_loss:0.0265	, anomaly_loss:0.4458	fnorm_loss:0.0214, a_fnorm_loss:0.0446P:0.41, R:0.87
 19%|█▉        | 19/100 [04:20<14:47, 10.96s/it]epoch [19/100], focal_loss:0.0201	, anomaly_loss:0.4314	fnorm_loss:0.0195, a_fnorm_loss:0.0457P:0.48, R:0.93
 20%|██        | 20/100 [04:56<24:41, 18.52s/it]epoch [20/100], focal_loss:0.0188	, anomaly_loss:0.4281	fnorm_loss:0.0183, a_fnorm_loss:0.0464P:0.48, R:0.92
normal: 0.0822 0.3056  anomaly: 0.1147 0.5838	P:0.42, R:0.29
Pixel Auroc:0.926, Sample Auroc0.934, Pixel Aupro0.0
test_fnorm_loss: 0.0179 test_afnorm_loss: 0.0300
 21%|██        | 21/100 [05:05<20:21, 15.47s/it]epoch [21/100], focal_loss:0.0218	, anomaly_loss:0.4403	fnorm_loss:0.0178, a_fnorm_loss:0.0451P:0.47, R:0.90
 22%|██▏       | 22/100 [05:13<17:20, 13.35s/it]epoch [22/100], focal_loss:0.0199	, anomaly_loss:0.4364	fnorm_loss:0.0167, a_fnorm_loss:0.0464P:0.49, R:0.89
 23%|██▎       | 23/100 [05:22<15:14, 11.88s/it]epoch [23/100], focal_loss:0.0189	, anomaly_loss:0.4281	fnorm_loss:0.0159, a_fnorm_loss:0.0477P:0.51, R:0.92
 24%|██▍       | 24/100 [05:30<13:44, 10.85s/it]epoch [24/100], focal_loss:0.0179	, anomaly_loss:0.4352	fnorm_loss:0.0153, a_fnorm_loss:0.0451P:0.50, R:0.89
 25%|██▌       | 25/100 [06:05<22:39, 18.13s/it]epoch [25/100], focal_loss:0.0170	, anomaly_loss:0.4229	fnorm_loss:0.0147, a_fnorm_loss:0.0478P:0.52, R:0.93
normal: 0.1062 0.2918  anomaly: 0.1362 0.6446	P:0.49, R:0.41
Pixel Auroc:0.948, Sample Auroc0.954, Pixel Aupro0.0
test_fnorm_loss: 0.0142 test_afnorm_loss: 0.0286
 26%|██▌       | 26/100 [06:14<18:52, 15.30s/it]epoch [26/100], focal_loss:0.0184	, anomaly_loss:0.4294	fnorm_loss:0.0143, a_fnorm_loss:0.0476P:0.55, R:0.89
 27%|██▋       | 27/100 [06:23<16:12, 13.33s/it]epoch [27/100], focal_loss:0.0176	, anomaly_loss:0.4323	fnorm_loss:0.0139, a_fnorm_loss:0.0463P:0.50, R:0.87
 28%|██▊       | 28/100 [06:31<14:08, 11.78s/it]epoch [28/100], focal_loss:0.0151	, anomaly_loss:0.4221	fnorm_loss:0.0133, a_fnorm_loss:0.0485P:0.56, R:0.93
 29%|██▉       | 29/100 [06:39<12:48, 10.83s/it]epoch [29/100], focal_loss:0.0164	, anomaly_loss:0.4219	fnorm_loss:0.0133, a_fnorm_loss:0.0474P:0.53, R:0.92
 30%|███       | 30/100 [07:10<19:31, 16.73s/it]epoch [30/100], focal_loss:0.0131	, anomaly_loss:0.4151	fnorm_loss:0.0124, a_fnorm_loss:0.0516P:0.55, R:0.93
normal: 0.0608 0.2636  anomaly: 0.0986 0.6247	P:0.46, R:0.37
Pixel Auroc:0.951, Sample Auroc0.952, Pixel Aupro0.0
test_fnorm_loss: 0.0120 test_afnorm_loss: 0.0291
 31%|███       | 31/100 [07:18<16:23, 14.25s/it]epoch [31/100], focal_loss:0.0133	, anomaly_loss:0.4117	fnorm_loss:0.0120, a_fnorm_loss:0.0495P:0.57, R:0.94
 32%|███▏      | 32/100 [07:27<14:08, 12.49s/it]epoch [32/100], focal_loss:0.0150	, anomaly_loss:0.4201	fnorm_loss:0.0119, a_fnorm_loss:0.0486P:0.52, R:0.90
 33%|███▎      | 33/100 [07:35<12:35, 11.27s/it]epoch [33/100], focal_loss:0.0144	, anomaly_loss:0.4135	fnorm_loss:0.0117, a_fnorm_loss:0.0494P:0.54, R:0.93
 34%|███▍      | 34/100 [07:43<11:24, 10.38s/it]epoch [34/100], focal_loss:0.0126	, anomaly_loss:0.4109	fnorm_loss:0.0114, a_fnorm_loss:0.0496P:0.54, R:0.94
 35%|███▌      | 35/100 [08:15<18:15, 16.85s/it]epoch [35/100], focal_loss:0.0122	, anomaly_loss:0.4105	fnorm_loss:0.0109, a_fnorm_loss:0.0523P:0.59, R:0.94
normal: 0.0469 0.1801  anomaly: 0.0649 0.6084	P:0.47, R:0.29
Pixel Auroc:0.946, Sample Auroc0.951, Pixel Aupro0.0
test_fnorm_loss: 0.0104 test_afnorm_loss: 0.0216
 36%|███▌      | 36/100 [08:24<15:14, 14.29s/it]epoch [36/100], focal_loss:0.0121	, anomaly_loss:0.4102	fnorm_loss:0.0107, a_fnorm_loss:0.0510P:0.59, R:0.93
 37%|███▋      | 37/100 [08:32<13:04, 12.45s/it]epoch [37/100], focal_loss:0.0159	, anomaly_loss:0.4210	fnorm_loss:0.0109, a_fnorm_loss:0.0484P:0.55, R:0.90
 38%|███▊      | 38/100 [08:40<11:35, 11.22s/it]epoch [38/100], focal_loss:0.0142	, anomaly_loss:0.4111	fnorm_loss:0.0108, a_fnorm_loss:0.0505P:0.54, R:0.92
 39%|███▉      | 39/100 [08:49<10:31, 10.35s/it]epoch [39/100], focal_loss:0.0166	, anomaly_loss:0.4159	fnorm_loss:0.0106, a_fnorm_loss:0.0503P:0.57, R:0.91
 40%|████      | 40/100 [09:20<16:37, 16.63s/it]epoch [40/100], focal_loss:0.0127	, anomaly_loss:0.4150	fnorm_loss:0.0103, a_fnorm_loss:0.0500P:0.55, R:0.93
normal: 0.0477 0.1550  anomaly: 0.0709 0.5881	P:0.48, R:0.26
Pixel Auroc:0.949, Sample Auroc0.955, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0177
 41%|████      | 41/100 [09:28<13:54, 14.15s/it]epoch [41/100], focal_loss:0.0129	, anomaly_loss:0.4088	fnorm_loss:0.0102, a_fnorm_loss:0.0508P:0.56, R:0.93
 42%|████▏     | 42/100 [09:37<12:00, 12.42s/it]epoch [42/100], focal_loss:0.0151	, anomaly_loss:0.4162	fnorm_loss:0.0101, a_fnorm_loss:0.0501P:0.58, R:0.90
 43%|████▎     | 43/100 [09:45<10:41, 11.26s/it]epoch [43/100], focal_loss:0.0109	, anomaly_loss:0.4058	fnorm_loss:0.0096, a_fnorm_loss:0.0533P:0.54, R:0.94
 44%|████▍     | 44/100 [09:54<09:44, 10.45s/it]epoch [44/100], focal_loss:0.0110	, anomaly_loss:0.4047	fnorm_loss:0.0095, a_fnorm_loss:0.0518P:0.58, R:0.94
 45%|████▌     | 45/100 [10:29<16:26, 17.94s/it]epoch [45/100], focal_loss:0.0135	, anomaly_loss:0.4152	fnorm_loss:0.0096, a_fnorm_loss:0.0506P:0.57, R:0.92
normal: 0.0547 0.1937  anomaly: 0.0622 0.7141	P:0.50, R:0.36
Pixel Auroc:0.959, Sample Auroc0.956, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0253
 46%|████▌     | 46/100 [10:38<13:39, 15.18s/it]epoch [46/100], focal_loss:0.0116	, anomaly_loss:0.4108	fnorm_loss:0.0094, a_fnorm_loss:0.0500P:0.61, R:0.93
 47%|████▋     | 47/100 [10:46<11:36, 13.13s/it]epoch [47/100], focal_loss:0.0109	, anomaly_loss:0.4024	fnorm_loss:0.0092, a_fnorm_loss:0.0526P:0.58, R:0.95
 48%|████▊     | 48/100 [10:55<10:10, 11.73s/it]epoch [48/100], focal_loss:0.0109	, anomaly_loss:0.4098	fnorm_loss:0.0090, a_fnorm_loss:0.0531P:0.58, R:0.93
 49%|████▉     | 49/100 [11:03<09:06, 10.72s/it]epoch [49/100], focal_loss:0.0123	, anomaly_loss:0.4132	fnorm_loss:0.0090, a_fnorm_loss:0.0514P:0.60, R:0.94
 50%|█████     | 50/100 [11:33<13:52, 16.65s/it]epoch [50/100], focal_loss:0.0122	, anomaly_loss:0.4068	fnorm_loss:0.0089, a_fnorm_loss:0.0533P:0.55, R:0.93
normal: 0.0444 0.1476  anomaly: 0.0461 0.6688	P:0.47, R:0.25
Pixel Auroc:0.955, Sample Auroc0.954, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0192
 51%|█████     | 51/100 [11:42<11:38, 14.25s/it]epoch [51/100], focal_loss:0.0112	, anomaly_loss:0.4098	fnorm_loss:0.0087, a_fnorm_loss:0.0520P:0.60, R:0.93
 52%|█████▏    | 52/100 [11:51<10:00, 12.50s/it]epoch [52/100], focal_loss:0.0130	, anomaly_loss:0.4076	fnorm_loss:0.0092, a_fnorm_loss:0.0516P:0.61, R:0.93
 53%|█████▎    | 53/100 [11:59<08:52, 11.33s/it]epoch [53/100], focal_loss:0.0327	, anomaly_loss:0.4959	fnorm_loss:0.0112, a_fnorm_loss:0.0435P:0.36, R:0.52
 54%|█████▍    | 54/100 [12:08<08:05, 10.56s/it]epoch [54/100], focal_loss:0.0170	, anomaly_loss:0.4393	fnorm_loss:0.0095, a_fnorm_loss:0.0505P:0.56, R:0.86
 55%|█████▌    | 55/100 [12:39<12:30, 16.68s/it]epoch [55/100], focal_loss:0.0132	, anomaly_loss:0.4209	fnorm_loss:0.0087, a_fnorm_loss:0.0506P:0.53, R:0.93
normal: 0.0329 0.1408  anomaly: 0.0410 0.5096	P:0.33, R:0.18
Pixel Auroc:0.949, Sample Auroc0.925, Pixel Aupro0.0
test_fnorm_loss: 0.0081 test_afnorm_loss: 0.0237
 56%|█████▌    | 56/100 [12:47<10:22, 14.16s/it]epoch [56/100], focal_loss:0.0219	, anomaly_loss:0.4440	fnorm_loss:0.0089, a_fnorm_loss:0.0491P:0.57, R:0.86
 57%|█████▋    | 57/100 [12:55<08:48, 12.28s/it]epoch [57/100], focal_loss:0.0115	, anomaly_loss:0.4153	fnorm_loss:0.0085, a_fnorm_loss:0.0528P:0.58, R:0.93
 58%|█████▊    | 58/100 [13:04<07:49, 11.19s/it]epoch [58/100], focal_loss:0.0103	, anomaly_loss:0.4071	fnorm_loss:0.0083, a_fnorm_loss:0.0531P:0.57, R:0.94
 59%|█████▉    | 59/100 [13:12<07:04, 10.34s/it]epoch [59/100], focal_loss:0.0130	, anomaly_loss:0.4083	fnorm_loss:0.0085, a_fnorm_loss:0.0522P:0.59, R:0.93
 60%|██████    | 60/100 [13:43<10:54, 16.37s/it]epoch [60/100], focal_loss:0.0123	, anomaly_loss:0.4137	fnorm_loss:0.0084, a_fnorm_loss:0.0527P:0.58, R:0.93
normal: 0.0698 0.2944  anomaly: 0.0831 0.7086	P:0.49, R:0.44
Pixel Auroc:0.966, Sample Auroc0.945, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0313
 61%|██████    | 61/100 [13:51<09:04, 13.95s/it]epoch [61/100], focal_loss:0.0142	, anomaly_loss:0.4176	fnorm_loss:0.0085, a_fnorm_loss:0.0515P:0.57, R:0.92
 62%|██████▏   | 62/100 [13:59<07:48, 12.34s/it]epoch [62/100], focal_loss:0.0115	, anomaly_loss:0.4040	fnorm_loss:0.0081, a_fnorm_loss:0.0524P:0.57, R:0.93
 63%|██████▎   | 63/100 [14:08<06:54, 11.20s/it]epoch [63/100], focal_loss:0.0112	, anomaly_loss:0.4018	fnorm_loss:0.0081, a_fnorm_loss:0.0532P:0.58, R:0.94
 64%|██████▍   | 64/100 [14:17<06:15, 10.43s/it]epoch [64/100], focal_loss:0.0147	, anomaly_loss:0.4083	fnorm_loss:0.0081, a_fnorm_loss:0.0536P:0.60, R:0.92
 65%|██████▌   | 65/100 [14:47<09:38, 16.52s/it]epoch [65/100], focal_loss:0.0111	, anomaly_loss:0.4078	fnorm_loss:0.0081, a_fnorm_loss:0.0527P:0.57, R:0.94
normal: 0.0321 0.1216  anomaly: 0.0360 0.6574	P:0.44, R:0.24
Pixel Auroc:0.959, Sample Auroc0.958, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0220
 66%|██████▌   | 66/100 [14:56<07:57, 14.04s/it]epoch [66/100], focal_loss:0.0128	, anomaly_loss:0.4117	fnorm_loss:0.0082, a_fnorm_loss:0.0519P:0.56, R:0.92
 67%|██████▋   | 67/100 [15:04<06:47, 12.34s/it]epoch [67/100], focal_loss:0.0167	, anomaly_loss:0.4244	fnorm_loss:0.0087, a_fnorm_loss:0.0511P:0.59, R:0.91
 68%|██████▊   | 68/100 [15:12<05:55, 11.12s/it]epoch [68/100], focal_loss:0.0151	, anomaly_loss:0.4142	fnorm_loss:0.0082, a_fnorm_loss:0.0523P:0.58, R:0.92
 69%|██████▉   | 69/100 [15:20<05:18, 10.26s/it]epoch [69/100], focal_loss:0.0116	, anomaly_loss:0.4044	fnorm_loss:0.0078, a_fnorm_loss:0.0535P:0.64, R:0.94
 70%|███████   | 70/100 [15:51<08:14, 16.48s/it]epoch [70/100], focal_loss:0.0108	, anomaly_loss:0.4036	fnorm_loss:0.0077, a_fnorm_loss:0.0532P:0.60, R:0.94
normal: 0.0352 0.2088  anomaly: 0.0383 0.7000	P:0.48, R:0.31
Pixel Auroc:0.963, Sample Auroc0.948, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0261
 71%|███████   | 71/100 [16:00<06:50, 14.16s/it]epoch [71/100], focal_loss:0.0094	, anomaly_loss:0.3931	fnorm_loss:0.0075, a_fnorm_loss:0.0550P:0.61, R:0.95
 72%|███████▏  | 72/100 [16:09<05:48, 12.43s/it]epoch [72/100], focal_loss:0.0116	, anomaly_loss:0.4017	fnorm_loss:0.0077, a_fnorm_loss:0.0543P:0.60, R:0.94
 73%|███████▎  | 73/100 [16:17<05:04, 11.27s/it]epoch [73/100], focal_loss:0.0117	, anomaly_loss:0.4062	fnorm_loss:0.0076, a_fnorm_loss:0.0530P:0.61, R:0.93
 74%|███████▍  | 74/100 [16:26<04:30, 10.40s/it]epoch [74/100], focal_loss:0.0106	, anomaly_loss:0.4042	fnorm_loss:0.0075, a_fnorm_loss:0.0540P:0.58, R:0.94
 75%|███████▌  | 75/100 [16:56<06:54, 16.57s/it]epoch [75/100], focal_loss:0.0125	, anomaly_loss:0.4081	fnorm_loss:0.0077, a_fnorm_loss:0.0523P:0.59, R:0.92
normal: 0.0413 0.1830  anomaly: 0.0571 0.6828	P:0.49, R:0.33
Pixel Auroc:0.968, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0268
 76%|███████▌  | 76/100 [17:05<05:38, 14.10s/it]epoch [76/100], focal_loss:0.0116	, anomaly_loss:0.4072	fnorm_loss:0.0075, a_fnorm_loss:0.0531P:0.57, R:0.93
 77%|███████▋  | 77/100 [17:13<04:45, 12.41s/it]epoch [77/100], focal_loss:0.0104	, anomaly_loss:0.3974	fnorm_loss:0.0076, a_fnorm_loss:0.0524P:0.59, R:0.94
 78%|███████▊  | 78/100 [17:22<04:06, 11.19s/it]epoch [78/100], focal_loss:0.0097	, anomaly_loss:0.4016	fnorm_loss:0.0073, a_fnorm_loss:0.0543P:0.61, R:0.94
 79%|███████▉  | 79/100 [17:30<03:38, 10.39s/it]epoch [79/100], focal_loss:0.0107	, anomaly_loss:0.4012	fnorm_loss:0.0074, a_fnorm_loss:0.0546P:0.58, R:0.95
 80%|████████  | 80/100 [18:06<05:59, 17.99s/it]epoch [80/100], focal_loss:0.0105	, anomaly_loss:0.4022	fnorm_loss:0.0074, a_fnorm_loss:0.0539P:0.61, R:0.94
normal: 0.0361 0.1536  anomaly: 0.0443 0.7118	P:0.51, R:0.31
Pixel Auroc:0.964, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0233
 81%|████████  | 81/100 [18:14<04:46, 15.08s/it]epoch [81/100], focal_loss:0.0096	, anomaly_loss:0.4022	fnorm_loss:0.0072, a_fnorm_loss:0.0549P:0.65, R:0.95
 82%|████████▏ | 82/100 [18:23<03:57, 13.22s/it]epoch [82/100], focal_loss:0.0114	, anomaly_loss:0.4035	fnorm_loss:0.0074, a_fnorm_loss:0.0539P:0.56, R:0.94
 83%|████████▎ | 83/100 [18:31<03:18, 11.70s/it]epoch [83/100], focal_loss:0.0101	, anomaly_loss:0.4060	fnorm_loss:0.0073, a_fnorm_loss:0.0545P:0.59, R:0.95
 84%|████████▍ | 84/100 [18:40<02:51, 10.71s/it]epoch [84/100], focal_loss:0.0095	, anomaly_loss:0.4009	fnorm_loss:0.0072, a_fnorm_loss:0.0547P:0.64, R:0.95
 85%|████████▌ | 85/100 [19:15<04:32, 18.17s/it]epoch [85/100], focal_loss:0.0092	, anomaly_loss:0.3929	fnorm_loss:0.0072, a_fnorm_loss:0.0556P:0.63, R:0.96
normal: 0.0346 0.1766  anomaly: 0.0401 0.7180	P:0.52, R:0.37
Pixel Auroc:0.968, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0298
 86%|████████▌ | 86/100 [19:24<03:33, 15.25s/it]epoch [86/100], focal_loss:0.0087	, anomaly_loss:0.3944	fnorm_loss:0.0071, a_fnorm_loss:0.0551P:0.60, R:0.95
 87%|████████▋ | 87/100 [19:32<02:52, 13.31s/it]epoch [87/100], focal_loss:0.0102	, anomaly_loss:0.3983	fnorm_loss:0.0072, a_fnorm_loss:0.0538P:0.60, R:0.94
 88%|████████▊ | 88/100 [19:41<02:23, 11.96s/it]epoch [88/100], focal_loss:0.0103	, anomaly_loss:0.3959	fnorm_loss:0.0072, a_fnorm_loss:0.0549P:0.65, R:0.95
 89%|████████▉ | 89/100 [19:49<01:58, 10.75s/it]epoch [89/100], focal_loss:0.0095	, anomaly_loss:0.3997	fnorm_loss:0.0071, a_fnorm_loss:0.0549P:0.62, R:0.95
 90%|█████████ | 90/100 [20:21<02:51, 17.20s/it]epoch [90/100], focal_loss:0.0106	, anomaly_loss:0.4006	fnorm_loss:0.0073, a_fnorm_loss:0.0533P:0.55, R:0.95
normal: 0.0394 0.1867  anomaly: 0.0425 0.7156	P:0.52, R:0.37
Pixel Auroc:0.970, Sample Auroc0.964, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0271
 91%|█████████ | 91/100 [20:30<02:10, 14.51s/it]epoch [91/100], focal_loss:0.0090	, anomaly_loss:0.3965	fnorm_loss:0.0072, a_fnorm_loss:0.0523P:0.58, R:0.95
 92%|█████████▏| 92/100 [20:38<01:41, 12.74s/it]epoch [92/100], focal_loss:0.0089	, anomaly_loss:0.4005	fnorm_loss:0.0072, a_fnorm_loss:0.0536P:0.57, R:0.94
 93%|█████████▎| 93/100 [20:47<01:19, 11.41s/it]epoch [93/100], focal_loss:0.0093	, anomaly_loss:0.3909	fnorm_loss:0.0072, a_fnorm_loss:0.0542P:0.59, R:0.95
 94%|█████████▍| 94/100 [20:55<01:02, 10.48s/it]epoch [94/100], focal_loss:0.0091	, anomaly_loss:0.3974	fnorm_loss:0.0071, a_fnorm_loss:0.0547P:0.63, R:0.95
 95%|█████████▌| 95/100 [21:24<01:20, 16.20s/it]epoch [95/100], focal_loss:0.0097	, anomaly_loss:0.3971	fnorm_loss:0.0072, a_fnorm_loss:0.0539P:0.62, R:0.95
normal: 0.0368 0.1841  anomaly: 0.0397 0.7192	P:0.52, R:0.37
Pixel Auroc:0.969, Sample Auroc0.963, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0279
 96%|█████████▌| 96/100 [21:33<00:55, 13.85s/it]epoch [96/100], focal_loss:0.0093	, anomaly_loss:0.3979	fnorm_loss:0.0071, a_fnorm_loss:0.0548P:0.61, R:0.95
 97%|█████████▋| 97/100 [21:41<00:36, 12.20s/it]epoch [97/100], focal_loss:0.0103	, anomaly_loss:0.3974	fnorm_loss:0.0072, a_fnorm_loss:0.0547P:0.64, R:0.95
 98%|█████████▊| 98/100 [21:49<00:22, 11.04s/it]epoch [98/100], focal_loss:0.0097	, anomaly_loss:0.4034	fnorm_loss:0.0072, a_fnorm_loss:0.0534P:0.57, R:0.94
 99%|█████████▉| 99/100 [21:58<00:10, 10.27s/it]epoch [99/100], focal_loss:0.0090	, anomaly_loss:0.3949	fnorm_loss:0.0071, a_fnorm_loss:0.0551P:0.65, R:0.96
100%|██████████| 100/100 [22:29<00:00, 16.63s/it]100%|██████████| 100/100 [22:29<00:00, 13.50s/it]
epoch [100/100], focal_loss:0.0099	, anomaly_loss:0.3936	fnorm_loss:0.0072, a_fnorm_loss:0.0551P:0.63, R:0.95
normal: 0.0377 0.1861  anomaly: 0.0396 0.7161	P:0.52, R:0.37
Pixel Auroc:0.970, Sample Auroc0.962, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0286
training Stubborn Student...
pill
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<11:15,  5.68s/it]epoch [1/120], kd_loss:4.7550
  2%|▏         | 2/120 [00:11<11:16,  5.73s/it]epoch [2/120], kd_loss:3.9060
  2%|▎         | 3/120 [00:17<11:11,  5.74s/it]epoch [3/120], kd_loss:3.7736
  3%|▎         | 4/120 [00:22<11:06,  5.75s/it]epoch [4/120], kd_loss:3.5704
  4%|▍         | 5/120 [00:28<11:05,  5.79s/it]epoch [5/120], kd_loss:3.0142
  5%|▌         | 6/120 [00:34<11:01,  5.80s/it]epoch [6/120], kd_loss:2.3797
  6%|▌         | 7/120 [00:40<10:55,  5.80s/it]epoch [7/120], kd_loss:2.3612
  7%|▋         | 8/120 [00:46<10:50,  5.81s/it]epoch [8/120], kd_loss:2.7160
  8%|▊         | 9/120 [00:52<10:43,  5.80s/it]epoch [9/120], kd_loss:2.1644
  8%|▊         | 10/120 [01:20<23:14, 12.68s/it]epoch [10/120], kd_loss:1.8181
normal: 1.0986 1.6083  anomaly: 1.1519 2.3007
thresh: 1.2549028266908977
fpr: 0.19230769230769232 fnr 0.0070921985815602835
Pixel Auroc:0.979, Sample Auroc0.972, Pixel Aupro0.0
  9%|▉         | 11/120 [01:25<19:07, 10.53s/it]epoch [11/120], kd_loss:1.7394
 10%|█         | 12/120 [01:31<16:19,  9.07s/it]epoch [12/120], kd_loss:2.1228
 11%|█         | 13/120 [01:37<14:22,  8.06s/it]epoch [13/120], kd_loss:1.7884
 12%|█▏        | 14/120 [01:43<13:01,  7.38s/it]epoch [14/120], kd_loss:1.6456
 12%|█▎        | 15/120 [01:48<12:02,  6.88s/it]epoch [15/120], kd_loss:1.6444
 13%|█▎        | 16/120 [01:54<11:22,  6.56s/it]epoch [16/120], kd_loss:1.5029
 14%|█▍        | 17/120 [02:00<10:51,  6.32s/it]epoch [17/120], kd_loss:1.4668
 15%|█▌        | 18/120 [02:06<10:30,  6.18s/it]epoch [18/120], kd_loss:2.7915
 16%|█▌        | 19/120 [02:12<10:13,  6.08s/it]epoch [19/120], kd_loss:1.9239
 17%|█▋        | 20/120 [02:39<20:52, 12.52s/it]epoch [20/120], kd_loss:1.7493
normal: 0.9940 1.5759  anomaly: 1.0939 2.2534
thresh: 1.2276461705770338
fpr: 0.11538461538461539 fnr 0.0070921985815602835
Pixel Auroc:0.980, Sample Auroc0.974, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:45<17:16, 10.47s/it]epoch [21/120], kd_loss:1.5598
 18%|█▊        | 22/120 [02:50<14:45,  9.03s/it]epoch [22/120], kd_loss:1.5011
 19%|█▉        | 23/120 [02:56<13:01,  8.06s/it]epoch [23/120], kd_loss:1.5578
 20%|██        | 24/120 [03:02<11:47,  7.37s/it]epoch [24/120], kd_loss:2.0253
 21%|██        | 25/120 [03:08<10:54,  6.89s/it]epoch [25/120], kd_loss:1.5759
 22%|██▏       | 26/120 [03:14<10:16,  6.56s/it]epoch [26/120], kd_loss:1.6662
 22%|██▎       | 27/120 [03:19<09:50,  6.35s/it]epoch [27/120], kd_loss:1.5706
 23%|██▎       | 28/120 [03:25<09:27,  6.17s/it]epoch [28/120], kd_loss:1.4593
 24%|██▍       | 29/120 [03:31<09:12,  6.07s/it]epoch [29/120], kd_loss:1.4350
 25%|██▌       | 30/120 [03:58<18:30, 12.34s/it]epoch [30/120], kd_loss:1.4097
normal: 0.8758 1.3784  anomaly: 0.9054 2.2053
thresh: 1.0734851131740557
fpr: 0.15384615384615385 fnr 0.014184397163120567
Pixel Auroc:0.983, Sample Auroc0.972, Pixel Aupro0.0
 26%|██▌       | 31/120 [04:04<15:21, 10.35s/it]epoch [31/120], kd_loss:1.4774
 27%|██▋       | 32/120 [04:09<13:10,  8.98s/it]epoch [32/120], kd_loss:1.4517
 28%|██▊       | 33/120 [04:15<11:37,  8.02s/it]epoch [33/120], kd_loss:1.3921
 28%|██▊       | 34/120 [04:21<10:32,  7.36s/it]epoch [34/120], kd_loss:1.4116
 29%|██▉       | 35/120 [04:27<09:46,  6.90s/it]epoch [35/120], kd_loss:1.4255
 30%|███       | 36/120 [04:33<09:13,  6.58s/it]epoch [36/120], kd_loss:1.3645
 31%|███       | 37/120 [04:39<08:46,  6.34s/it]epoch [37/120], kd_loss:1.3502
 32%|███▏      | 38/120 [04:44<08:27,  6.18s/it]epoch [38/120], kd_loss:1.3699
 32%|███▎      | 39/120 [04:50<08:11,  6.07s/it]epoch [39/120], kd_loss:1.6290
 33%|███▎      | 40/120 [05:19<17:01, 12.77s/it]epoch [40/120], kd_loss:1.9671
normal: 0.8956 1.4367  anomaly: 1.0021 2.2262
thresh: 1.1232962710140393
fpr: 0.19230769230769232 fnr 0.0070921985815602835
Pixel Auroc:0.983, Sample Auroc0.975, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:24<14:01, 10.65s/it]epoch [41/120], kd_loss:1.5390
 35%|███▌      | 42/120 [05:30<11:57,  9.20s/it]epoch [42/120], kd_loss:1.4105
 36%|███▌      | 43/120 [05:36<10:28,  8.16s/it]epoch [43/120], kd_loss:1.3860
 37%|███▋      | 44/120 [05:42<09:25,  7.44s/it]epoch [44/120], kd_loss:1.3835
 38%|███▊      | 45/120 [05:47<08:40,  6.95s/it]epoch [45/120], kd_loss:1.4449
 38%|███▊      | 46/120 [05:53<08:10,  6.62s/it]epoch [46/120], kd_loss:1.3508
 39%|███▉      | 47/120 [05:59<07:46,  6.39s/it]epoch [47/120], kd_loss:1.3681
 40%|████      | 48/120 [06:05<07:28,  6.22s/it]epoch [48/120], kd_loss:1.3688
 41%|████      | 49/120 [06:11<07:13,  6.10s/it]epoch [49/120], kd_loss:1.3224
 42%|████▏     | 50/120 [06:39<14:47, 12.68s/it]epoch [50/120], kd_loss:1.3113
normal: 0.7425 1.4148  anomaly: 0.8472 2.2249
thresh: 1.0152440003080432
fpr: 0.11538461538461539 fnr 0.014184397163120567
Pixel Auroc:0.984, Sample Auroc0.969, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:45<12:13, 10.64s/it]epoch [51/120], kd_loss:1.3034
 43%|████▎     | 52/120 [06:50<10:24,  9.18s/it]epoch [52/120], kd_loss:1.3501
 44%|████▍     | 53/120 [06:56<09:06,  8.16s/it]epoch [53/120], kd_loss:1.3181
 45%|████▌     | 54/120 [07:02<08:12,  7.46s/it]epoch [54/120], kd_loss:1.4052
 46%|████▌     | 55/120 [07:08<07:34,  6.99s/it]epoch [55/120], kd_loss:1.3582
 47%|████▋     | 56/120 [07:14<07:03,  6.62s/it]epoch [56/120], kd_loss:1.3148
 48%|████▊     | 57/120 [07:19<06:42,  6.38s/it]epoch [57/120], kd_loss:1.6673
 48%|████▊     | 58/120 [07:25<06:26,  6.23s/it]epoch [58/120], kd_loss:1.3358
 49%|████▉     | 59/120 [07:31<06:12,  6.11s/it]epoch [59/120], kd_loss:1.4047
 50%|█████     | 60/120 [07:58<12:21, 12.36s/it]epoch [60/120], kd_loss:1.3320
normal: 0.7804 1.3810  anomaly: 0.8568 2.1667
thresh: 1.00658311686282
fpr: 0.15384615384615385 fnr 0.0070921985815602835
Pixel Auroc:0.984, Sample Auroc0.972, Pixel Aupro0.0
 51%|█████     | 61/120 [08:04<10:13, 10.39s/it]epoch [61/120], kd_loss:1.3099
 52%|█████▏    | 62/120 [08:10<08:41,  8.99s/it]epoch [62/120], kd_loss:1.3027
 52%|█████▎    | 63/120 [08:15<07:37,  8.03s/it]epoch [63/120], kd_loss:1.2930
 53%|█████▎    | 64/120 [08:21<06:51,  7.36s/it]epoch [64/120], kd_loss:1.3211
 54%|█████▍    | 65/120 [08:27<06:19,  6.89s/it]epoch [65/120], kd_loss:1.2892
 55%|█████▌    | 66/120 [08:33<05:54,  6.56s/it]epoch [66/120], kd_loss:1.2802
 56%|█████▌    | 67/120 [08:39<05:35,  6.34s/it]epoch [67/120], kd_loss:1.2804
 57%|█████▋    | 68/120 [08:44<05:21,  6.19s/it]epoch [68/120], kd_loss:1.2688
 57%|█████▊    | 69/120 [08:50<05:11,  6.11s/it]epoch [69/120], kd_loss:1.2681
 58%|█████▊    | 70/120 [09:19<10:36, 12.73s/it]epoch [70/120], kd_loss:1.3047
normal: 0.7357 1.3888  anomaly: 0.9265 2.1812
thresh: 0.9996861514487758
fpr: 0.15384615384615385 fnr 0.0070921985815602835
Pixel Auroc:0.984, Sample Auroc0.975, Pixel Aupro0.0
 59%|█████▉    | 71/120 [09:24<08:40, 10.63s/it]epoch [71/120], kd_loss:1.2761
 60%|██████    | 72/120 [09:30<07:18,  9.14s/it]epoch [72/120], kd_loss:1.2668
 61%|██████    | 73/120 [09:36<06:22,  8.13s/it]epoch [73/120], kd_loss:1.2763
 62%|██████▏   | 74/120 [09:42<05:42,  7.44s/it]epoch [74/120], kd_loss:1.5142
 62%|██████▎   | 75/120 [09:47<05:12,  6.95s/it]epoch [75/120], kd_loss:1.3342
 63%|██████▎   | 76/120 [09:53<04:50,  6.61s/it]epoch [76/120], kd_loss:1.2727
 64%|██████▍   | 77/120 [09:59<04:34,  6.39s/it]epoch [77/120], kd_loss:1.2561
 65%|██████▌   | 78/120 [10:05<04:20,  6.20s/it]epoch [78/120], kd_loss:1.2483
 66%|██████▌   | 79/120 [10:11<04:09,  6.09s/it]epoch [79/120], kd_loss:1.2419
 67%|██████▋   | 80/120 [10:38<08:20, 12.52s/it]epoch [80/120], kd_loss:1.2813
normal: 0.7457 1.3905  anomaly: 0.8573 2.1887
thresh: 1.0234485330648972
fpr: 0.15384615384615385 fnr 0.0070921985815602835
Pixel Auroc:0.983, Sample Auroc0.971, Pixel Aupro0.0
 68%|██████▊   | 81/120 [10:44<06:48, 10.48s/it]epoch [81/120], kd_loss:1.2558
 68%|██████▊   | 82/120 [10:50<05:43,  9.04s/it]epoch [82/120], kd_loss:1.2631
 69%|██████▉   | 83/120 [10:55<04:57,  8.05s/it]epoch [83/120], kd_loss:1.2548
 70%|███████   | 84/120 [11:01<04:26,  7.41s/it]epoch [84/120], kd_loss:1.2594
 71%|███████   | 85/120 [11:07<04:02,  6.92s/it]epoch [85/120], kd_loss:1.3761
 72%|███████▏  | 86/120 [11:13<03:43,  6.58s/it]epoch [86/120], kd_loss:1.3433
 72%|███████▎  | 87/120 [11:19<03:29,  6.36s/it]epoch [87/120], kd_loss:1.2666
 73%|███████▎  | 88/120 [11:24<03:18,  6.20s/it]epoch [88/120], kd_loss:1.5504
 74%|███████▍  | 89/120 [11:30<03:08,  6.09s/it]epoch [89/120], kd_loss:1.2957
 75%|███████▌  | 90/120 [11:57<06:07, 12.24s/it]epoch [90/120], kd_loss:1.2609
normal: 0.7664 1.3911  anomaly: 0.8163 2.1738
thresh: 0.9996166761134446
fpr: 0.15384615384615385 fnr 0.02127659574468085
Pixel Auroc:0.985, Sample Auroc0.972, Pixel Aupro0.0
 76%|███████▌  | 91/120 [12:03<04:58, 10.28s/it]epoch [91/120], kd_loss:1.4389
 77%|███████▋  | 92/120 [12:08<04:10,  8.93s/it]epoch [92/120], kd_loss:1.3901
 78%|███████▊  | 93/120 [12:14<03:36,  8.02s/it]epoch [93/120], kd_loss:1.2968
 78%|███████▊  | 94/120 [12:20<03:11,  7.35s/it]epoch [94/120], kd_loss:1.2707
 79%|███████▉  | 95/120 [12:26<02:52,  6.90s/it]epoch [95/120], kd_loss:1.2654
 80%|████████  | 96/120 [12:32<02:38,  6.59s/it]epoch [96/120], kd_loss:1.2953
 81%|████████  | 97/120 [12:38<02:26,  6.36s/it]epoch [97/120], kd_loss:1.2502
 82%|████████▏ | 98/120 [12:44<02:17,  6.24s/it]epoch [98/120], kd_loss:1.2393
 82%|████████▎ | 99/120 [12:50<02:09,  6.15s/it]epoch [99/120], kd_loss:1.2322
 83%|████████▎ | 100/120 [13:15<04:01, 12.09s/it]epoch [100/120], kd_loss:1.2286
normal: 0.7473 1.3588  anomaly: 0.8295 2.1779
thresh: 0.9699498074329927
fpr: 0.11538461538461539 fnr 0.014184397163120567
Pixel Auroc:0.984, Sample Auroc0.974, Pixel Aupro0.0
 84%|████████▍ | 101/120 [13:21<03:13, 10.19s/it]epoch [101/120], kd_loss:1.2255
 85%|████████▌ | 102/120 [13:27<02:39,  8.87s/it]epoch [102/120], kd_loss:1.2230
 86%|████████▌ | 103/120 [13:33<02:14,  7.94s/it]epoch [103/120], kd_loss:1.2204
 87%|████████▋ | 104/120 [13:39<01:56,  7.29s/it]epoch [104/120], kd_loss:1.2162
 88%|████████▊ | 105/120 [13:44<01:42,  6.85s/it]epoch [105/120], kd_loss:1.2131
 88%|████████▊ | 106/120 [13:50<01:31,  6.54s/it]epoch [106/120], kd_loss:1.2120
 89%|████████▉ | 107/120 [13:56<01:22,  6.34s/it]epoch [107/120], kd_loss:1.2064
 90%|█████████ | 108/120 [14:02<01:14,  6.18s/it]epoch [108/120], kd_loss:1.2038
 91%|█████████ | 109/120 [14:08<01:06,  6.09s/it]epoch [109/120], kd_loss:1.2016
 92%|█████████▏| 110/120 [14:36<02:06, 12.64s/it]epoch [110/120], kd_loss:1.2007
normal: 0.7452 1.3715  anomaly: 0.8047 2.1950
thresh: 0.9835897630113115
fpr: 0.11538461538461539 fnr 0.014184397163120567
Pixel Auroc:0.985, Sample Auroc0.972, Pixel Aupro0.0
 92%|█████████▎| 111/120 [14:41<01:35, 10.56s/it]epoch [111/120], kd_loss:1.1995
 93%|█████████▎| 112/120 [14:47<01:12,  9.11s/it]epoch [112/120], kd_loss:1.1986
 94%|█████████▍| 113/120 [14:53<00:56,  8.10s/it]epoch [113/120], kd_loss:1.1978
 95%|█████████▌| 114/120 [14:59<00:44,  7.41s/it]epoch [114/120], kd_loss:1.1970
 96%|█████████▌| 115/120 [15:04<00:34,  6.91s/it]epoch [115/120], kd_loss:1.1972
 97%|█████████▋| 116/120 [15:10<00:26,  6.58s/it]epoch [116/120], kd_loss:1.1966
 98%|█████████▊| 117/120 [15:16<00:19,  6.34s/it]epoch [117/120], kd_loss:1.1953
 98%|█████████▊| 118/120 [15:22<00:12,  6.19s/it]epoch [118/120], kd_loss:1.1949
 99%|█████████▉| 119/120 [15:28<00:06,  6.10s/it]epoch [119/120], kd_loss:1.1947
100%|██████████| 120/120 [15:54<00:00, 12.24s/it]100%|██████████| 120/120 [15:54<00:00,  7.96s/it]
epoch [120/120], kd_loss:1.1942
normal: 0.7416 1.3789  anomaly: 0.8049 2.1845
thresh: 0.9760403633152438
fpr: 0.11538461538461539 fnr 0.014184397163120567
Pixel Auroc:0.985, Sample Auroc0.973, Pixel Aupro0.0
training Advanced Teacher...
screw
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:29<49:13, 29.83s/it]epoch [1/100], focal_loss:0.0727	, anomaly_loss:0.5589	fnorm_loss:0.0697, a_fnorm_loss:0.0153P:0.00, R:0.03
normal: 0.2344 0.2466  anomaly: 0.2348 0.2482	P:0.00, R:0.00
Pixel Auroc:0.860, Sample Auroc0.696, Pixel Aupro0.0
test_fnorm_loss: 0.0688 test_afnorm_loss: 0.0159
  2%|▏         | 2/100 [00:39<29:06, 17.82s/it]epoch [2/100], focal_loss:0.0561	, anomaly_loss:0.5621	fnorm_loss:0.0622, a_fnorm_loss:0.0138P:0.00, R:0.00
  3%|▎         | 3/100 [00:49<23:03, 14.26s/it]epoch [3/100], focal_loss:0.0476	, anomaly_loss:0.5890	fnorm_loss:0.0538, a_fnorm_loss:0.0120P:0.00, R:0.00
  4%|▍         | 4/100 [00:59<20:00, 12.51s/it]epoch [4/100], focal_loss:0.0428	, anomaly_loss:0.6086	fnorm_loss:0.0479, a_fnorm_loss:0.0106P:0.00, R:0.00
  5%|▌         | 5/100 [01:28<29:36, 18.70s/it]epoch [5/100], focal_loss:0.0375	, anomaly_loss:0.6232	fnorm_loss:0.0435, a_fnorm_loss:0.0098P:0.00, R:0.00
normal: 0.1481 0.1541  anomaly: 0.1474 0.1547	P:0.00, R:0.00
Pixel Auroc:0.891, Sample Auroc0.639, Pixel Aupro0.0
test_fnorm_loss: 0.0426 test_afnorm_loss: 0.0100
  6%|▌         | 6/100 [01:39<25:03, 15.99s/it]epoch [6/100], focal_loss:0.0353	, anomaly_loss:0.6328	fnorm_loss:0.0405, a_fnorm_loss:0.0091P:0.00, R:0.00
  7%|▋         | 7/100 [01:49<21:44, 14.03s/it]epoch [7/100], focal_loss:0.0351	, anomaly_loss:0.5599	fnorm_loss:0.0399, a_fnorm_loss:0.0219P:0.07, R:0.19
  8%|▊         | 8/100 [01:59<19:25, 12.67s/it]epoch [8/100], focal_loss:0.0324	, anomaly_loss:0.5132	fnorm_loss:0.0338, a_fnorm_loss:0.0328P:0.09, R:0.29
  9%|▉         | 9/100 [02:09<17:52, 11.79s/it]epoch [9/100], focal_loss:0.0293	, anomaly_loss:0.5031	fnorm_loss:0.0308, a_fnorm_loss:0.0356P:0.09, R:0.31
 10%|█         | 10/100 [02:39<26:12, 17.47s/it]epoch [10/100], focal_loss:0.0303	, anomaly_loss:0.5093	fnorm_loss:0.0302, a_fnorm_loss:0.0353P:0.09, R:0.31
normal: 0.1660 0.3351  anomaly: 0.1687 0.3464	P:0.03, R:0.10
Pixel Auroc:0.957, Sample Auroc0.648, Pixel Aupro0.0
test_fnorm_loss: 0.0349 test_afnorm_loss: 0.0246
 11%|█         | 11/100 [02:49<22:36, 15.24s/it]epoch [11/100], focal_loss:0.0264	, anomaly_loss:0.4973	fnorm_loss:0.0270, a_fnorm_loss:0.0361P:0.08, R:0.31
 12%|█▏        | 12/100 [03:00<20:22, 13.90s/it]epoch [12/100], focal_loss:0.0295	, anomaly_loss:0.5041	fnorm_loss:0.0252, a_fnorm_loss:0.0370P:0.10, R:0.32
 13%|█▎        | 13/100 [03:10<18:32, 12.78s/it]epoch [13/100], focal_loss:0.0264	, anomaly_loss:0.4951	fnorm_loss:0.0242, a_fnorm_loss:0.0380P:0.10, R:0.31
 14%|█▍        | 14/100 [03:20<16:57, 11.83s/it]epoch [14/100], focal_loss:0.0245	, anomaly_loss:0.4805	fnorm_loss:0.0234, a_fnorm_loss:0.0394P:0.13, R:0.40
 15%|█▌        | 15/100 [03:55<26:38, 18.81s/it]epoch [15/100], focal_loss:0.0221	, anomaly_loss:0.4177	fnorm_loss:0.0215, a_fnorm_loss:0.0412P:0.23, R:0.66
normal: 0.0920 0.2972  anomaly: 0.0960 0.4338	P:0.13, R:0.16
Pixel Auroc:0.967, Sample Auroc0.746, Pixel Aupro0.0
test_fnorm_loss: 0.0201 test_afnorm_loss: 0.0165
 16%|█▌        | 16/100 [04:04<22:30, 16.08s/it]epoch [16/100], focal_loss:0.0199	, anomaly_loss:0.3767	fnorm_loss:0.0199, a_fnorm_loss:0.0430P:0.32, R:0.86
 17%|█▋        | 17/100 [04:14<19:37, 14.18s/it]epoch [17/100], focal_loss:0.0158	, anomaly_loss:0.3425	fnorm_loss:0.0183, a_fnorm_loss:0.0467P:0.33, R:0.92
 18%|█▊        | 18/100 [04:24<17:43, 12.97s/it]epoch [18/100], focal_loss:0.0154	, anomaly_loss:0.3381	fnorm_loss:0.0173, a_fnorm_loss:0.0471P:0.34, R:0.92
 19%|█▉        | 19/100 [04:35<16:32, 12.26s/it]epoch [19/100], focal_loss:0.0155	, anomaly_loss:0.3513	fnorm_loss:0.0165, a_fnorm_loss:0.0442P:0.34, R:0.89
 20%|██        | 20/100 [05:10<25:25, 19.07s/it]epoch [20/100], focal_loss:0.0136	, anomaly_loss:0.3343	fnorm_loss:0.0155, a_fnorm_loss:0.0468P:0.38, R:0.94
normal: 0.1186 0.3382  anomaly: 0.1036 0.5572	P:0.18, R:0.31
Pixel Auroc:0.977, Sample Auroc0.786, Pixel Aupro0.0
test_fnorm_loss: 0.0152 test_afnorm_loss: 0.0268
 21%|██        | 21/100 [05:20<21:27, 16.29s/it]epoch [21/100], focal_loss:0.0134	, anomaly_loss:0.3394	fnorm_loss:0.0150, a_fnorm_loss:0.0466P:0.35, R:0.90
 22%|██▏       | 22/100 [05:30<18:41, 14.38s/it]epoch [22/100], focal_loss:0.0123	, anomaly_loss:0.3353	fnorm_loss:0.0142, a_fnorm_loss:0.0478P:0.37, R:0.92
 23%|██▎       | 23/100 [05:39<16:31, 12.87s/it]epoch [23/100], focal_loss:0.0124	, anomaly_loss:0.3383	fnorm_loss:0.0137, a_fnorm_loss:0.0486P:0.39, R:0.92
 24%|██▍       | 24/100 [05:48<14:58, 11.83s/it]epoch [24/100], focal_loss:0.0112	, anomaly_loss:0.3260	fnorm_loss:0.0132, a_fnorm_loss:0.0489P:0.38, R:0.93
 25%|██▌       | 25/100 [06:24<23:49, 19.05s/it]epoch [25/100], focal_loss:0.0125	, anomaly_loss:0.3360	fnorm_loss:0.0129, a_fnorm_loss:0.0467P:0.37, R:0.91
normal: 0.0573 0.2668  anomaly: 0.0586 0.5327	P:0.21, R:0.20
Pixel Auroc:0.975, Sample Auroc0.790, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0200
 26%|██▌       | 26/100 [06:35<20:23, 16.53s/it]epoch [26/100], focal_loss:0.0100	, anomaly_loss:0.3277	fnorm_loss:0.0122, a_fnorm_loss:0.0499P:0.42, R:0.93
 27%|██▋       | 27/100 [06:45<17:49, 14.66s/it]epoch [27/100], focal_loss:0.0126	, anomaly_loss:0.3420	fnorm_loss:0.0123, a_fnorm_loss:0.0472P:0.39, R:0.89
 28%|██▊       | 28/100 [06:55<15:50, 13.21s/it]epoch [28/100], focal_loss:0.0109	, anomaly_loss:0.3321	fnorm_loss:0.0117, a_fnorm_loss:0.0494P:0.37, R:0.93
 29%|██▉       | 29/100 [07:05<14:29, 12.25s/it]epoch [29/100], focal_loss:0.0098	, anomaly_loss:0.3202	fnorm_loss:0.0113, a_fnorm_loss:0.0504P:0.44, R:0.94
 30%|███       | 30/100 [07:41<22:27, 19.25s/it]epoch [30/100], focal_loss:0.0107	, anomaly_loss:0.3286	fnorm_loss:0.0112, a_fnorm_loss:0.0488P:0.42, R:0.91
normal: 0.0743 0.2850  anomaly: 0.0756 0.5511	P:0.21, R:0.24
Pixel Auroc:0.978, Sample Auroc0.835, Pixel Aupro0.0
test_fnorm_loss: 0.0105 test_afnorm_loss: 0.0201
 31%|███       | 31/100 [07:50<18:47, 16.35s/it]epoch [31/100], focal_loss:0.0088	, anomaly_loss:0.3110	fnorm_loss:0.0107, a_fnorm_loss:0.0518P:0.43, R:0.94
 32%|███▏      | 32/100 [08:00<16:27, 14.52s/it]epoch [32/100], focal_loss:0.0105	, anomaly_loss:0.3180	fnorm_loss:0.0106, a_fnorm_loss:0.0499P:0.43, R:0.93
 33%|███▎      | 33/100 [08:10<14:42, 13.17s/it]epoch [33/100], focal_loss:0.0105	, anomaly_loss:0.3204	fnorm_loss:0.0106, a_fnorm_loss:0.0490P:0.42, R:0.91
 34%|███▍      | 34/100 [08:20<13:14, 12.04s/it]epoch [34/100], focal_loss:0.0090	, anomaly_loss:0.3154	fnorm_loss:0.0102, a_fnorm_loss:0.0504P:0.39, R:0.93
 35%|███▌      | 35/100 [08:55<20:36, 19.02s/it]epoch [35/100], focal_loss:0.0091	, anomaly_loss:0.3209	fnorm_loss:0.0100, a_fnorm_loss:0.0504P:0.44, R:0.92
normal: 0.0553 0.2243  anomaly: 0.0487 0.5502	P:0.23, R:0.23
Pixel Auroc:0.980, Sample Auroc0.826, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0224
 36%|███▌      | 36/100 [09:05<17:27, 16.37s/it]epoch [36/100], focal_loss:0.0092	, anomaly_loss:0.3166	fnorm_loss:0.0098, a_fnorm_loss:0.0503P:0.43, R:0.92
 37%|███▋      | 37/100 [09:16<15:19, 14.60s/it]epoch [37/100], focal_loss:0.0091	, anomaly_loss:0.3076	fnorm_loss:0.0095, a_fnorm_loss:0.0524P:0.48, R:0.92
 38%|███▊      | 38/100 [09:25<13:33, 13.13s/it]epoch [38/100], focal_loss:0.0105	, anomaly_loss:0.3130	fnorm_loss:0.0096, a_fnorm_loss:0.0508P:0.41, R:0.94
 39%|███▉      | 39/100 [09:35<12:23, 12.18s/it]epoch [39/100], focal_loss:0.0078	, anomaly_loss:0.3125	fnorm_loss:0.0092, a_fnorm_loss:0.0510P:0.43, R:0.93
 40%|████      | 40/100 [10:05<17:17, 17.29s/it]epoch [40/100], focal_loss:0.0085	, anomaly_loss:0.3140	fnorm_loss:0.0092, a_fnorm_loss:0.0518P:0.47, R:0.95
normal: 0.0593 0.2512  anomaly: 0.0480 0.5772	P:0.22, R:0.25
Pixel Auroc:0.978, Sample Auroc0.797, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0263
 41%|████      | 41/100 [10:14<14:45, 15.01s/it]epoch [41/100], focal_loss:0.0080	, anomaly_loss:0.3048	fnorm_loss:0.0089, a_fnorm_loss:0.0522P:0.48, R:0.94
 42%|████▏     | 42/100 [10:24<12:58, 13.43s/it]epoch [42/100], focal_loss:0.0084	, anomaly_loss:0.3108	fnorm_loss:0.0089, a_fnorm_loss:0.0518P:0.40, R:0.93
 43%|████▎     | 43/100 [10:35<11:55, 12.56s/it]epoch [43/100], focal_loss:0.0090	, anomaly_loss:0.3118	fnorm_loss:0.0089, a_fnorm_loss:0.0513P:0.43, R:0.93
 44%|████▍     | 44/100 [10:45<10:59, 11.78s/it]epoch [44/100], focal_loss:0.0088	, anomaly_loss:0.3104	fnorm_loss:0.0087, a_fnorm_loss:0.0518P:0.47, R:0.94
 45%|████▌     | 45/100 [11:15<15:53, 17.34s/it]epoch [45/100], focal_loss:0.0084	, anomaly_loss:0.3104	fnorm_loss:0.0086, a_fnorm_loss:0.0536P:0.45, R:0.94
normal: 0.0479 0.2126  anomaly: 0.0509 0.5431	P:0.22, R:0.23
Pixel Auroc:0.982, Sample Auroc0.815, Pixel Aupro0.0
test_fnorm_loss: 0.0080 test_afnorm_loss: 0.0205
 46%|████▌     | 46/100 [11:25<13:36, 15.13s/it]epoch [46/100], focal_loss:0.0081	, anomaly_loss:0.3112	fnorm_loss:0.0085, a_fnorm_loss:0.0522P:0.48, R:0.93
 47%|████▋     | 47/100 [11:35<12:04, 13.66s/it]epoch [47/100], focal_loss:0.0078	, anomaly_loss:0.3113	fnorm_loss:0.0083, a_fnorm_loss:0.0527P:0.47, R:0.93
 48%|████▊     | 48/100 [11:45<10:44, 12.40s/it]epoch [48/100], focal_loss:0.0090	, anomaly_loss:0.3130	fnorm_loss:0.0084, a_fnorm_loss:0.0515P:0.43, R:0.92
 49%|████▉     | 49/100 [11:55<10:01, 11.79s/it]epoch [49/100], focal_loss:0.0080	, anomaly_loss:0.3078	fnorm_loss:0.0082, a_fnorm_loss:0.0530P:0.46, R:0.95
 50%|█████     | 50/100 [12:25<14:23, 17.26s/it]epoch [50/100], focal_loss:0.0091	, anomaly_loss:0.3138	fnorm_loss:0.0084, a_fnorm_loss:0.0510P:0.45, R:0.92
normal: 0.0467 0.1710  anomaly: 0.0487 0.5626	P:0.23, R:0.22
Pixel Auroc:0.979, Sample Auroc0.845, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0210
 51%|█████     | 51/100 [12:35<12:22, 15.15s/it]epoch [51/100], focal_loss:0.0075	, anomaly_loss:0.3038	fnorm_loss:0.0080, a_fnorm_loss:0.0538P:0.50, R:0.95
 52%|█████▏    | 52/100 [12:45<10:52, 13.60s/it]epoch [52/100], focal_loss:0.0079	, anomaly_loss:0.3084	fnorm_loss:0.0080, a_fnorm_loss:0.0521P:0.45, R:0.94
 53%|█████▎    | 53/100 [12:56<09:53, 12.63s/it]epoch [53/100], focal_loss:0.0074	, anomaly_loss:0.3034	fnorm_loss:0.0078, a_fnorm_loss:0.0537P:0.47, R:0.95
 54%|█████▍    | 54/100 [13:05<08:59, 11.73s/it]epoch [54/100], focal_loss:0.0072	, anomaly_loss:0.2995	fnorm_loss:0.0077, a_fnorm_loss:0.0540P:0.43, R:0.95
 55%|█████▌    | 55/100 [13:34<12:42, 16.94s/it]epoch [55/100], focal_loss:0.0075	, anomaly_loss:0.2994	fnorm_loss:0.0077, a_fnorm_loss:0.0544P:0.49, R:0.95
normal: 0.0314 0.1470  anomaly: 0.0345 0.5557	P:0.20, R:0.18
Pixel Auroc:0.980, Sample Auroc0.879, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0185
 56%|█████▌    | 56/100 [13:44<10:52, 14.83s/it]epoch [56/100], focal_loss:0.0081	, anomaly_loss:0.3039	fnorm_loss:0.0078, a_fnorm_loss:0.0529P:0.43, R:0.93
 57%|█████▋    | 57/100 [13:54<09:38, 13.45s/it]epoch [57/100], focal_loss:0.0071	, anomaly_loss:0.3033	fnorm_loss:0.0076, a_fnorm_loss:0.0537P:0.49, R:0.95
 58%|█████▊    | 58/100 [14:04<08:36, 12.30s/it]epoch [58/100], focal_loss:0.0071	, anomaly_loss:0.3047	fnorm_loss:0.0074, a_fnorm_loss:0.0544P:0.48, R:0.95
 59%|█████▉    | 59/100 [14:14<07:55, 11.59s/it]epoch [59/100], focal_loss:0.0074	, anomaly_loss:0.2933	fnorm_loss:0.0075, a_fnorm_loss:0.0529P:0.48, R:0.94
 60%|██████    | 60/100 [14:49<12:26, 18.66s/it]epoch [60/100], focal_loss:0.0066	, anomaly_loss:0.2973	fnorm_loss:0.0074, a_fnorm_loss:0.0547P:0.48, R:0.95
normal: 0.0399 0.1919  anomaly: 0.0555 0.6082	P:0.25, R:0.27
Pixel Auroc:0.983, Sample Auroc0.859, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0246
 61%|██████    | 61/100 [14:59<10:30, 16.17s/it]epoch [61/100], focal_loss:0.0085	, anomaly_loss:0.3215	fnorm_loss:0.0077, a_fnorm_loss:0.0490P:0.51, R:0.93
 62%|██████▏   | 62/100 [15:10<09:12, 14.55s/it]epoch [62/100], focal_loss:0.0076	, anomaly_loss:0.3157	fnorm_loss:0.0074, a_fnorm_loss:0.0516P:0.47, R:0.94
 63%|██████▎   | 63/100 [15:20<08:06, 13.14s/it]epoch [63/100], focal_loss:0.0083	, anomaly_loss:0.3062	fnorm_loss:0.0074, a_fnorm_loss:0.0537P:0.45, R:0.93
 64%|██████▍   | 64/100 [15:30<07:22, 12.30s/it]epoch [64/100], focal_loss:0.0074	, anomaly_loss:0.3102	fnorm_loss:0.0073, a_fnorm_loss:0.0526P:0.48, R:0.93
 65%|██████▌   | 65/100 [16:00<10:14, 17.55s/it]epoch [65/100], focal_loss:0.0092	, anomaly_loss:0.3192	fnorm_loss:0.0074, a_fnorm_loss:0.0509P:0.51, R:0.92
normal: 0.1148 0.3115  anomaly: 0.1258 0.6711	P:0.22, R:0.36
Pixel Auroc:0.981, Sample Auroc0.841, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0338
 66%|██████▌   | 66/100 [16:10<08:37, 15.21s/it]epoch [66/100], focal_loss:0.0080	, anomaly_loss:0.3079	fnorm_loss:0.0074, a_fnorm_loss:0.0534P:0.46, R:0.94
 67%|██████▋   | 67/100 [16:20<07:34, 13.76s/it]epoch [67/100], focal_loss:0.0068	, anomaly_loss:0.2960	fnorm_loss:0.0071, a_fnorm_loss:0.0540P:0.49, R:0.96
 68%|██████▊   | 68/100 [16:30<06:43, 12.60s/it]epoch [68/100], focal_loss:0.0071	, anomaly_loss:0.3052	fnorm_loss:0.0071, a_fnorm_loss:0.0545P:0.48, R:0.94
 69%|██████▉   | 69/100 [16:40<06:08, 11.89s/it]epoch [69/100], focal_loss:0.0079	, anomaly_loss:0.3122	fnorm_loss:0.0072, a_fnorm_loss:0.0519P:0.45, R:0.93
 70%|███████   | 70/100 [17:10<08:36, 17.22s/it]epoch [70/100], focal_loss:0.0067	, anomaly_loss:0.2996	fnorm_loss:0.0070, a_fnorm_loss:0.0546P:0.50, R:0.95
normal: 0.1097 0.3255  anomaly: 0.1082 0.6717	P:0.21, R:0.32
Pixel Auroc:0.977, Sample Auroc0.777, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0314
 71%|███████   | 71/100 [17:20<07:18, 15.12s/it]epoch [71/100], focal_loss:0.0075	, anomaly_loss:0.3097	fnorm_loss:0.0071, a_fnorm_loss:0.0533P:0.51, R:0.94
 72%|███████▏  | 72/100 [17:30<06:20, 13.59s/it]epoch [72/100], focal_loss:0.0074	, anomaly_loss:0.3145	fnorm_loss:0.0070, a_fnorm_loss:0.0541P:0.51, R:0.93
 73%|███████▎  | 73/100 [17:41<05:39, 12.59s/it]epoch [73/100], focal_loss:0.0068	, anomaly_loss:0.2988	fnorm_loss:0.0070, a_fnorm_loss:0.0546P:0.52, R:0.95
 74%|███████▍  | 74/100 [17:50<05:04, 11.70s/it]epoch [74/100], focal_loss:0.0066	, anomaly_loss:0.3020	fnorm_loss:0.0069, a_fnorm_loss:0.0530P:0.47, R:0.95
 75%|███████▌  | 75/100 [18:21<07:13, 17.33s/it]epoch [75/100], focal_loss:0.0064	, anomaly_loss:0.2984	fnorm_loss:0.0068, a_fnorm_loss:0.0565P:0.49, R:0.95
normal: 0.0296 0.3376  anomaly: 0.0429 0.6261	P:0.24, R:0.28
Pixel Auroc:0.983, Sample Auroc0.826, Pixel Aupro0.0
test_fnorm_loss: 0.0065 test_afnorm_loss: 0.0276
 76%|███████▌  | 76/100 [18:30<06:00, 15.01s/it]epoch [76/100], focal_loss:0.0070	, anomaly_loss:0.3029	fnorm_loss:0.0069, a_fnorm_loss:0.0545P:0.44, R:0.94
 77%|███████▋  | 77/100 [18:40<05:11, 13.52s/it]epoch [77/100], focal_loss:0.0085	, anomaly_loss:0.3082	fnorm_loss:0.0070, a_fnorm_loss:0.0515P:0.51, R:0.93
 78%|███████▊  | 78/100 [18:51<04:39, 12.69s/it]epoch [78/100], focal_loss:0.0065	, anomaly_loss:0.3030	fnorm_loss:0.0067, a_fnorm_loss:0.0550P:0.54, R:0.96
 79%|███████▉  | 79/100 [19:02<04:12, 12.02s/it]epoch [79/100], focal_loss:0.0072	, anomaly_loss:0.3069	fnorm_loss:0.0068, a_fnorm_loss:0.0541P:0.47, R:0.94
 80%|████████  | 80/100 [19:31<05:45, 17.28s/it]epoch [80/100], focal_loss:0.0063	, anomaly_loss:0.2965	fnorm_loss:0.0067, a_fnorm_loss:0.0548P:0.50, R:0.96
normal: 0.0275 0.1561  anomaly: 0.0322 0.5715	P:0.23, R:0.21
Pixel Auroc:0.982, Sample Auroc0.850, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0223
 81%|████████  | 81/100 [19:41<04:48, 15.18s/it]epoch [81/100], focal_loss:0.0065	, anomaly_loss:0.2975	fnorm_loss:0.0067, a_fnorm_loss:0.0546P:0.51, R:0.95
 82%|████████▏ | 82/100 [19:52<04:08, 13.79s/it]epoch [82/100], focal_loss:0.0064	, anomaly_loss:0.2948	fnorm_loss:0.0067, a_fnorm_loss:0.0554P:0.52, R:0.95
 83%|████████▎ | 83/100 [20:02<03:36, 12.74s/it]epoch [83/100], focal_loss:0.0067	, anomaly_loss:0.2983	fnorm_loss:0.0067, a_fnorm_loss:0.0529P:0.46, R:0.94
 84%|████████▍ | 84/100 [20:12<03:11, 11.96s/it]epoch [84/100], focal_loss:0.0058	, anomaly_loss:0.2996	fnorm_loss:0.0067, a_fnorm_loss:0.0553P:0.46, R:0.96
 85%|████████▌ | 85/100 [20:44<04:26, 17.79s/it]epoch [85/100], focal_loss:0.0066	, anomaly_loss:0.2949	fnorm_loss:0.0067, a_fnorm_loss:0.0551P:0.51, R:0.95
normal: 0.0558 0.2366  anomaly: 0.0739 0.6727	P:0.24, R:0.31
Pixel Auroc:0.982, Sample Auroc0.837, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0296
 86%|████████▌ | 86/100 [20:54<03:36, 15.45s/it]epoch [86/100], focal_loss:0.0060	, anomaly_loss:0.3023	fnorm_loss:0.0066, a_fnorm_loss:0.0555P:0.51, R:0.95
 87%|████████▋ | 87/100 [21:04<03:00, 13.86s/it]epoch [87/100], focal_loss:0.0066	, anomaly_loss:0.2937	fnorm_loss:0.0067, a_fnorm_loss:0.0562P:0.51, R:0.96
 88%|████████▊ | 88/100 [21:14<02:33, 12.77s/it]epoch [88/100], focal_loss:0.0064	, anomaly_loss:0.3025	fnorm_loss:0.0066, a_fnorm_loss:0.0545P:0.55, R:0.95
 89%|████████▉ | 89/100 [21:24<02:11, 11.97s/it]epoch [89/100], focal_loss:0.0063	, anomaly_loss:0.2891	fnorm_loss:0.0066, a_fnorm_loss:0.0552P:0.53, R:0.97
 90%|█████████ | 90/100 [22:00<03:11, 19.14s/it]epoch [90/100], focal_loss:0.0058	, anomaly_loss:0.3023	fnorm_loss:0.0066, a_fnorm_loss:0.0562P:0.51, R:0.96
normal: 0.0382 0.2117  anomaly: 0.0516 0.6427	P:0.25, R:0.28
Pixel Auroc:0.982, Sample Auroc0.837, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0276
 91%|█████████ | 91/100 [22:10<02:27, 16.34s/it]epoch [91/100], focal_loss:0.0059	, anomaly_loss:0.2979	fnorm_loss:0.0066, a_fnorm_loss:0.0564P:0.57, R:0.96
 92%|█████████▏| 92/100 [22:20<01:54, 14.37s/it]epoch [92/100], focal_loss:0.0057	, anomaly_loss:0.2989	fnorm_loss:0.0066, a_fnorm_loss:0.0552P:0.53, R:0.96
 93%|█████████▎| 93/100 [22:30<01:31, 13.05s/it]epoch [93/100], focal_loss:0.0056	, anomaly_loss:0.2899	fnorm_loss:0.0065, a_fnorm_loss:0.0553P:0.50, R:0.97
 94%|█████████▍| 94/100 [22:39<01:12, 12.06s/it]epoch [94/100], focal_loss:0.0067	, anomaly_loss:0.2998	fnorm_loss:0.0066, a_fnorm_loss:0.0556P:0.48, R:0.95
 95%|█████████▌| 95/100 [23:09<01:26, 17.27s/it]epoch [95/100], focal_loss:0.0067	, anomaly_loss:0.3053	fnorm_loss:0.0066, a_fnorm_loss:0.0549P:0.49, R:0.94
normal: 0.0602 0.2744  anomaly: 0.0704 0.6719	P:0.25, R:0.33
Pixel Auroc:0.983, Sample Auroc0.844, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0314
 96%|█████████▌| 96/100 [23:19<01:00, 15.08s/it]epoch [96/100], focal_loss:0.0065	, anomaly_loss:0.2929	fnorm_loss:0.0067, a_fnorm_loss:0.0553P:0.49, R:0.95
 97%|█████████▋| 97/100 [23:29<00:40, 13.53s/it]epoch [97/100], focal_loss:0.0066	, anomaly_loss:0.3015	fnorm_loss:0.0066, a_fnorm_loss:0.0563P:0.54, R:0.96
 98%|█████████▊| 98/100 [23:39<00:24, 12.45s/it]epoch [98/100], focal_loss:0.0070	, anomaly_loss:0.2940	fnorm_loss:0.0067, a_fnorm_loss:0.0542P:0.44, R:0.96
 99%|█████████▉| 99/100 [23:49<00:11, 11.72s/it]epoch [99/100], focal_loss:0.0065	, anomaly_loss:0.2987	fnorm_loss:0.0066, a_fnorm_loss:0.0553P:0.53, R:0.96
100%|██████████| 100/100 [24:23<00:00, 18.60s/it]100%|██████████| 100/100 [24:23<00:00, 14.64s/it]
epoch [100/100], focal_loss:0.0061	, anomaly_loss:0.3003	fnorm_loss:0.0066, a_fnorm_loss:0.0550P:0.58, R:0.95
normal: 0.0537 0.2417  anomaly: 0.0666 0.6615	P:0.25, R:0.31
Pixel Auroc:0.983, Sample Auroc0.844, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0296
training Stubborn Student...
screw
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<12:48,  6.46s/it]epoch [1/120], kd_loss:4.3392
  2%|▏         | 2/120 [00:12<12:47,  6.50s/it]epoch [2/120], kd_loss:3.3111
  2%|▎         | 3/120 [00:19<12:46,  6.55s/it]epoch [3/120], kd_loss:2.7205
  3%|▎         | 4/120 [00:26<12:40,  6.56s/it]epoch [4/120], kd_loss:2.2603
  4%|▍         | 5/120 [00:32<12:36,  6.58s/it]epoch [5/120], kd_loss:2.1248
  5%|▌         | 6/120 [00:39<12:30,  6.59s/it]epoch [6/120], kd_loss:1.9840
  6%|▌         | 7/120 [00:46<12:26,  6.61s/it]epoch [7/120], kd_loss:1.7834
  7%|▋         | 8/120 [00:52<12:20,  6.61s/it]epoch [8/120], kd_loss:2.0181
  8%|▊         | 9/120 [00:59<12:15,  6.63s/it]epoch [9/120], kd_loss:1.7554
  8%|▊         | 10/120 [01:26<24:01, 13.10s/it]epoch [10/120], kd_loss:1.9574
normal: 1.1524 1.4917  anomaly: 1.2009 2.0797
thresh: 1.2432101471935497
fpr: 0.7073170731707317 fnr 0.03361344537815126
Pixel Auroc:0.971, Sample Auroc0.843, Pixel Aupro0.0
  9%|▉         | 11/120 [01:33<20:07, 11.08s/it]epoch [11/120], kd_loss:1.7233
 10%|█         | 12/120 [01:40<17:29,  9.71s/it]epoch [12/120], kd_loss:1.6774
 11%|█         | 13/120 [01:46<15:38,  8.77s/it]epoch [13/120], kd_loss:1.6296
 12%|█▏        | 14/120 [01:53<14:19,  8.11s/it]epoch [14/120], kd_loss:1.6043
 12%|█▎        | 15/120 [01:59<13:25,  7.67s/it]epoch [15/120], kd_loss:2.1045
 13%|█▎        | 16/120 [02:06<12:44,  7.36s/it]epoch [16/120], kd_loss:1.6792
 14%|█▍        | 17/120 [02:13<12:14,  7.13s/it]epoch [17/120], kd_loss:1.6095
 15%|█▌        | 18/120 [02:19<11:53,  6.99s/it]epoch [18/120], kd_loss:1.9958
 16%|█▌        | 19/120 [02:26<11:36,  6.90s/it]epoch [19/120], kd_loss:1.7060
 17%|█▋        | 20/120 [02:50<20:16, 12.17s/it]epoch [20/120], kd_loss:1.5834
normal: 1.0090 1.4265  anomaly: 1.0201 2.0020
thresh: 1.1175573201945674
fpr: 0.5609756097560976 fnr 0.06722689075630252
Pixel Auroc:0.976, Sample Auroc0.835, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:57<17:20, 10.51s/it]epoch [21/120], kd_loss:1.5438
 18%|█▊        | 22/120 [03:04<15:15,  9.34s/it]epoch [22/120], kd_loss:1.6062
 19%|█▉        | 23/120 [03:10<13:45,  8.51s/it]epoch [23/120], kd_loss:1.5877
 20%|██        | 24/120 [03:17<12:42,  7.95s/it]epoch [24/120], kd_loss:1.5290
 21%|██        | 25/120 [03:24<11:58,  7.57s/it]epoch [25/120], kd_loss:1.5047
 22%|██▏       | 26/120 [03:30<11:25,  7.29s/it]epoch [26/120], kd_loss:1.5795
 22%|██▎       | 27/120 [03:37<11:00,  7.10s/it]epoch [27/120], kd_loss:1.5113
 23%|██▎       | 28/120 [03:44<10:43,  6.99s/it]epoch [28/120], kd_loss:2.0225
 24%|██▍       | 29/120 [03:50<10:27,  6.90s/it]epoch [29/120], kd_loss:1.8610
 25%|██▌       | 30/120 [04:17<19:03, 12.71s/it]epoch [30/120], kd_loss:1.6750
normal: 1.0871 1.5731  anomaly: 1.1350 2.0069
thresh: 1.156388703035824
fpr: 0.7804878048780488 fnr 0.025210084033613446
Pixel Auroc:0.974, Sample Auroc0.833, Pixel Aupro0.0
 26%|██▌       | 31/120 [04:23<16:08, 10.88s/it]epoch [31/120], kd_loss:1.6458
 27%|██▋       | 32/120 [04:30<14:04,  9.59s/it]epoch [32/120], kd_loss:1.5717
 28%|██▊       | 33/120 [04:36<12:35,  8.69s/it]epoch [33/120], kd_loss:1.7164
 28%|██▊       | 34/120 [04:43<11:35,  8.08s/it]epoch [34/120], kd_loss:1.9740
 29%|██▉       | 35/120 [04:50<10:50,  7.65s/it]epoch [35/120], kd_loss:1.6288
 30%|███       | 36/120 [04:56<10:19,  7.37s/it]epoch [36/120], kd_loss:1.5296
 31%|███       | 37/120 [05:03<09:55,  7.18s/it]epoch [37/120], kd_loss:1.5856
 32%|███▏      | 38/120 [05:10<09:38,  7.06s/it]epoch [38/120], kd_loss:1.4905
 32%|███▎      | 39/120 [05:16<09:22,  6.94s/it]epoch [39/120], kd_loss:1.6361
 33%|███▎      | 40/120 [05:42<16:34, 12.43s/it]epoch [40/120], kd_loss:1.4570
normal: 0.9782 1.3968  anomaly: 0.9703 1.8665
thresh: 1.043004763315988
fpr: 0.6341463414634146 fnr 0.058823529411764705
Pixel Auroc:0.981, Sample Auroc0.836, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:48<14:02, 10.66s/it]epoch [41/120], kd_loss:1.4541
 35%|███▌      | 42/120 [05:55<12:14,  9.42s/it]epoch [42/120], kd_loss:1.4172
 36%|███▌      | 43/120 [06:01<10:59,  8.56s/it]epoch [43/120], kd_loss:1.4129
 37%|███▋      | 44/120 [06:08<10:07,  7.99s/it]epoch [44/120], kd_loss:1.6004
 38%|███▊      | 45/120 [06:15<09:27,  7.56s/it]epoch [45/120], kd_loss:1.4618
 38%|███▊      | 46/120 [06:21<08:58,  7.28s/it]epoch [46/120], kd_loss:1.4487
 39%|███▉      | 47/120 [06:28<08:39,  7.12s/it]epoch [47/120], kd_loss:1.4447
 40%|████      | 48/120 [06:35<08:21,  6.97s/it]epoch [48/120], kd_loss:1.6303
 41%|████      | 49/120 [06:41<08:08,  6.87s/it]epoch [49/120], kd_loss:1.4358
 42%|████▏     | 50/120 [07:08<15:03, 12.90s/it]epoch [50/120], kd_loss:1.4517
normal: 0.9190 1.4383  anomaly: 0.9280 1.8288
thresh: 0.9820432924919895
fpr: 0.6097560975609756 fnr 0.04201680672268908
Pixel Auroc:0.981, Sample Auroc0.850, Pixel Aupro0.0
 42%|████▎     | 51/120 [07:15<12:38, 10.99s/it]epoch [51/120], kd_loss:1.4686
 43%|████▎     | 52/120 [07:21<10:57,  9.66s/it]epoch [52/120], kd_loss:1.3881
 44%|████▍     | 53/120 [07:28<09:45,  8.73s/it]epoch [53/120], kd_loss:1.3710
 45%|████▌     | 54/120 [07:34<08:53,  8.08s/it]epoch [54/120], kd_loss:1.4028
 46%|████▌     | 55/120 [07:41<08:16,  7.64s/it]epoch [55/120], kd_loss:1.3752
 47%|████▋     | 56/120 [07:48<07:49,  7.33s/it]epoch [56/120], kd_loss:1.4292
 48%|████▊     | 57/120 [07:54<07:29,  7.13s/it]epoch [57/120], kd_loss:1.3618
 48%|████▊     | 58/120 [08:01<07:13,  6.99s/it]epoch [58/120], kd_loss:1.5477
 49%|████▉     | 59/120 [08:08<07:00,  6.89s/it]epoch [59/120], kd_loss:1.4654
 50%|█████     | 60/120 [08:34<12:42, 12.71s/it]epoch [60/120], kd_loss:1.3763
normal: 0.8720 1.3943  anomaly: 0.9165 1.7996
thresh: 1.0068837339489007
fpr: 0.34146341463414637 fnr 0.1092436974789916
Pixel Auroc:0.982, Sample Auroc0.860, Pixel Aupro0.0
 51%|█████     | 61/120 [08:40<10:40, 10.86s/it]epoch [61/120], kd_loss:1.3601
 52%|█████▏    | 62/120 [08:47<09:15,  9.58s/it]epoch [62/120], kd_loss:1.3634
 52%|█████▎    | 63/120 [08:54<08:14,  8.67s/it]epoch [63/120], kd_loss:1.3380
 53%|█████▎    | 64/120 [09:00<07:30,  8.05s/it]epoch [64/120], kd_loss:1.3311
 54%|█████▍    | 65/120 [09:07<06:59,  7.63s/it]epoch [65/120], kd_loss:1.3323
 55%|█████▌    | 66/120 [09:13<06:36,  7.34s/it]epoch [66/120], kd_loss:1.4226
 56%|█████▌    | 67/120 [09:20<06:18,  7.14s/it]epoch [67/120], kd_loss:1.4111
 57%|█████▋    | 68/120 [09:27<06:03,  7.00s/it]epoch [68/120], kd_loss:1.5318
 57%|█████▊    | 69/120 [09:34<05:52,  6.91s/it]epoch [69/120], kd_loss:1.3732
 58%|█████▊    | 70/120 [09:59<10:30, 12.60s/it]epoch [70/120], kd_loss:1.4144
normal: 1.0934 1.5376  anomaly: 1.0881 1.8769
thresh: 1.0880595036905911
fpr: 1.0 fnr 0.0
Pixel Auroc:0.974, Sample Auroc0.753, Pixel Aupro0.0
 59%|█████▉    | 71/120 [10:06<08:48, 10.79s/it]epoch [71/120], kd_loss:1.4530
 60%|██████    | 72/120 [10:13<07:37,  9.53s/it]epoch [72/120], kd_loss:1.3712
 61%|██████    | 73/120 [10:19<06:46,  8.65s/it]epoch [73/120], kd_loss:1.3654
 62%|██████▏   | 74/120 [10:26<06:10,  8.06s/it]epoch [74/120], kd_loss:1.3522
 62%|██████▎   | 75/120 [10:32<05:43,  7.63s/it]epoch [75/120], kd_loss:1.3872
 63%|██████▎   | 76/120 [10:39<05:22,  7.33s/it]epoch [76/120], kd_loss:1.3570
 64%|██████▍   | 77/120 [10:46<05:05,  7.11s/it]epoch [77/120], kd_loss:1.4025
 65%|██████▌   | 78/120 [10:52<04:54,  7.00s/it]epoch [78/120], kd_loss:1.5175
 66%|██████▌   | 79/120 [10:59<04:42,  6.89s/it]epoch [79/120], kd_loss:1.4046
 67%|██████▋   | 80/120 [11:26<08:38, 12.96s/it]epoch [80/120], kd_loss:1.3430
normal: 0.8713 1.4094  anomaly: 0.8770 1.7958
thresh: 0.9665190989499068
fpr: 0.4878048780487805 fnr 0.06722689075630252
Pixel Auroc:0.982, Sample Auroc0.863, Pixel Aupro0.0
 68%|██████▊   | 81/120 [11:33<07:10, 11.05s/it]epoch [81/120], kd_loss:1.3520
 68%|██████▊   | 82/120 [11:39<06:08,  9.71s/it]epoch [82/120], kd_loss:1.3176
 69%|██████▉   | 83/120 [11:46<05:24,  8.76s/it]epoch [83/120], kd_loss:1.3112
 70%|███████   | 84/120 [11:53<04:52,  8.11s/it]epoch [84/120], kd_loss:1.3125
 71%|███████   | 85/120 [11:59<04:27,  7.65s/it]epoch [85/120], kd_loss:1.3028
 72%|███████▏  | 86/120 [12:06<04:09,  7.33s/it]epoch [86/120], kd_loss:1.4066
 72%|███████▎  | 87/120 [12:12<03:55,  7.13s/it]epoch [87/120], kd_loss:1.3849
 73%|███████▎  | 88/120 [12:19<03:43,  6.98s/it]epoch [88/120], kd_loss:1.3229
 74%|███████▍  | 89/120 [12:26<03:33,  6.87s/it]epoch [89/120], kd_loss:1.2962
 75%|███████▌  | 90/120 [12:51<06:12, 12.42s/it]epoch [90/120], kd_loss:1.2935
normal: 0.7914 1.2742  anomaly: 0.8562 1.7843
thresh: 0.951676168223362
fpr: 0.4634146341463415 fnr 0.09243697478991597
Pixel Auroc:0.984, Sample Auroc0.845, Pixel Aupro0.0
 76%|███████▌  | 91/120 [12:57<05:08, 10.64s/it]epoch [91/120], kd_loss:1.4131
 77%|███████▋  | 92/120 [13:04<04:23,  9.42s/it]epoch [92/120], kd_loss:1.3972
 78%|███████▊  | 93/120 [13:11<03:50,  8.55s/it]epoch [93/120], kd_loss:1.4713
 78%|███████▊  | 94/120 [13:17<03:27,  7.98s/it]epoch [94/120], kd_loss:1.7297
 79%|███████▉  | 95/120 [13:24<03:09,  7.56s/it]epoch [95/120], kd_loss:1.4507
 80%|████████  | 96/120 [13:30<02:54,  7.28s/it]epoch [96/120], kd_loss:1.4703
 81%|████████  | 97/120 [13:37<02:43,  7.10s/it]epoch [97/120], kd_loss:1.3882
 82%|████████▏ | 98/120 [13:44<02:33,  6.97s/it]epoch [98/120], kd_loss:1.3681
 82%|████████▎ | 99/120 [13:50<02:24,  6.88s/it]epoch [99/120], kd_loss:1.3602
 83%|████████▎ | 100/120 [14:16<04:10, 12.54s/it]epoch [100/120], kd_loss:1.3689
normal: 0.8525 1.4168  anomaly: 0.8801 1.7440
thresh: 0.9568985387676747
fpr: 0.6829268292682927 fnr 0.04201680672268908
Pixel Auroc:0.983, Sample Auroc0.827, Pixel Aupro0.0
 84%|████████▍ | 101/120 [14:23<03:23, 10.73s/it]epoch [101/120], kd_loss:1.3587
 85%|████████▌ | 102/120 [14:29<02:50,  9.49s/it]epoch [102/120], kd_loss:1.3514
 86%|████████▌ | 103/120 [14:36<02:26,  8.64s/it]epoch [103/120], kd_loss:1.3405
 87%|████████▋ | 104/120 [14:42<02:08,  8.02s/it]epoch [104/120], kd_loss:1.3364
 88%|████████▊ | 105/120 [14:49<01:54,  7.63s/it]epoch [105/120], kd_loss:1.3459
 88%|████████▊ | 106/120 [14:56<01:42,  7.33s/it]epoch [106/120], kd_loss:1.3347
 89%|████████▉ | 107/120 [15:03<01:32,  7.15s/it]epoch [107/120], kd_loss:1.3288
 90%|█████████ | 108/120 [15:09<01:23,  6.98s/it]epoch [108/120], kd_loss:1.3308
 91%|█████████ | 109/120 [15:16<01:15,  6.90s/it]epoch [109/120], kd_loss:1.3259
 92%|█████████▏| 110/120 [15:42<02:05, 12.54s/it]epoch [110/120], kd_loss:1.3225
normal: 0.8210 1.4442  anomaly: 0.8733 1.7206
thresh: 0.9487325012846046
fpr: 0.5853658536585366 fnr 0.06722689075630252
Pixel Auroc:0.983, Sample Auroc0.826, Pixel Aupro0.0
 92%|█████████▎| 111/120 [15:48<01:36, 10.74s/it]epoch [111/120], kd_loss:1.3198
 93%|█████████▎| 112/120 [15:55<01:15,  9.49s/it]epoch [112/120], kd_loss:1.3194
 94%|█████████▍| 113/120 [16:01<01:00,  8.62s/it]epoch [113/120], kd_loss:1.3158
 95%|█████████▌| 114/120 [16:08<00:48,  8.01s/it]epoch [114/120], kd_loss:1.3127
 96%|█████████▌| 115/120 [16:14<00:37,  7.59s/it]epoch [115/120], kd_loss:1.3122
 97%|█████████▋| 116/120 [16:21<00:29,  7.31s/it]epoch [116/120], kd_loss:1.3101
 98%|█████████▊| 117/120 [16:28<00:21,  7.10s/it]epoch [117/120], kd_loss:1.3087
 98%|█████████▊| 118/120 [16:34<00:13,  6.99s/it]epoch [118/120], kd_loss:1.3069
 99%|█████████▉| 119/120 [16:41<00:06,  6.93s/it]epoch [119/120], kd_loss:1.3051
100%|██████████| 120/120 [17:06<00:00, 12.30s/it]100%|██████████| 120/120 [17:06<00:00,  8.56s/it]
epoch [120/120], kd_loss:1.3041
normal: 0.8232 1.4291  anomaly: 0.8692 1.7240
thresh: 0.9334547445425854
fpr: 0.5365853658536586 fnr 0.06722689075630252
Pixel Auroc:0.984, Sample Auroc0.836, Pixel Aupro0.0
training Advanced Teacher...
toothbrush
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:09<15:16,  9.25s/it]epoch [1/100], focal_loss:0.0895	, anomaly_loss:0.6357	fnorm_loss:0.0620, a_fnorm_loss:0.0127P:0.01, R:0.18
normal: 0.2676 0.2775  anomaly: 0.2633 0.2788	P:0.00, R:0.00
Pixel Auroc:0.475, Sample Auroc0.394, Pixel Aupro0.0
test_fnorm_loss: 0.0782 test_afnorm_loss: 0.0178
  2%|▏         | 2/100 [00:13<09:51,  6.04s/it]epoch [2/100], focal_loss:0.0794	, anomaly_loss:0.5552	fnorm_loss:0.0763, a_fnorm_loss:0.0162P:0.00, R:0.00
  3%|▎         | 3/100 [00:16<07:58,  4.93s/it]epoch [3/100], focal_loss:0.0742	, anomaly_loss:0.5518	fnorm_loss:0.0737, a_fnorm_loss:0.0162P:0.00, R:0.00
  4%|▍         | 4/100 [00:20<07:11,  4.49s/it]epoch [4/100], focal_loss:0.0734	, anomaly_loss:0.5649	fnorm_loss:0.0715, a_fnorm_loss:0.0156P:0.00, R:0.00
  5%|▌         | 5/100 [00:29<09:55,  6.27s/it]epoch [5/100], focal_loss:0.0696	, anomaly_loss:0.5710	fnorm_loss:0.0694, a_fnorm_loss:0.0148P:0.00, R:0.00
normal: 0.2369 0.2457  anomaly: 0.2340 0.2466	P:0.00, R:0.00
Pixel Auroc:0.487, Sample Auroc0.403, Pixel Aupro0.0
test_fnorm_loss: 0.0687 test_afnorm_loss: 0.0156
  6%|▌         | 6/100 [00:33<08:19,  5.32s/it]epoch [6/100], focal_loss:0.0673	, anomaly_loss:0.5752	fnorm_loss:0.0668, a_fnorm_loss:0.0149P:0.00, R:0.00
  7%|▋         | 7/100 [00:37<07:28,  4.83s/it]epoch [7/100], focal_loss:0.0661	, anomaly_loss:0.5786	fnorm_loss:0.0653, a_fnorm_loss:0.0140P:0.00, R:0.00
  8%|▊         | 8/100 [00:41<06:55,  4.51s/it]epoch [8/100], focal_loss:0.0634	, anomaly_loss:0.5887	fnorm_loss:0.0630, a_fnorm_loss:0.0141P:0.00, R:0.00
  9%|▉         | 9/100 [00:44<06:27,  4.26s/it]epoch [9/100], focal_loss:0.0595	, anomaly_loss:0.5910	fnorm_loss:0.0612, a_fnorm_loss:0.0137P:0.00, R:0.00
 10%|█         | 10/100 [00:55<09:24,  6.27s/it]epoch [10/100], focal_loss:0.0624	, anomaly_loss:0.5907	fnorm_loss:0.0600, a_fnorm_loss:0.0132P:0.00, R:0.00
normal: 0.2067 0.2137  anomaly: 0.2043 0.2134	P:0.00, R:0.00
Pixel Auroc:0.508, Sample Auroc0.375, Pixel Aupro0.0
test_fnorm_loss: 0.0594 test_afnorm_loss: 0.0136
 11%|█         | 11/100 [00:59<08:08,  5.49s/it]epoch [11/100], focal_loss:0.0576	, anomaly_loss:0.6042	fnorm_loss:0.0580, a_fnorm_loss:0.0127P:0.00, R:0.00
 12%|█▏        | 12/100 [01:02<07:14,  4.94s/it]epoch [12/100], focal_loss:0.0609	, anomaly_loss:0.6073	fnorm_loss:0.0568, a_fnorm_loss:0.0125P:0.00, R:0.00
 13%|█▎        | 13/100 [01:06<06:34,  4.54s/it]epoch [13/100], focal_loss:0.0538	, anomaly_loss:0.6070	fnorm_loss:0.0553, a_fnorm_loss:0.0120P:0.00, R:0.00
 14%|█▍        | 14/100 [01:10<06:08,  4.28s/it]epoch [14/100], focal_loss:0.0512	, anomaly_loss:0.6127	fnorm_loss:0.0535, a_fnorm_loss:0.0116P:0.00, R:0.00
 15%|█▌        | 15/100 [01:19<08:13,  5.80s/it]epoch [15/100], focal_loss:0.0539	, anomaly_loss:0.6115	fnorm_loss:0.0527, a_fnorm_loss:0.0113P:0.00, R:0.00
normal: 0.1837 0.1896  anomaly: 0.1818 0.1890	P:0.00, R:0.00
Pixel Auroc:0.520, Sample Auroc0.353, Pixel Aupro0.0
test_fnorm_loss: 0.0526 test_afnorm_loss: 0.0121
 16%|█▌        | 16/100 [01:23<07:14,  5.17s/it]epoch [16/100], focal_loss:0.0515	, anomaly_loss:0.6127	fnorm_loss:0.0520, a_fnorm_loss:0.0110P:0.00, R:0.00
 17%|█▋        | 17/100 [01:26<06:33,  4.74s/it]epoch [17/100], focal_loss:0.0537	, anomaly_loss:0.6274	fnorm_loss:0.0505, a_fnorm_loss:0.0111P:0.00, R:0.00
 18%|█▊        | 18/100 [01:30<06:03,  4.43s/it]epoch [18/100], focal_loss:0.0487	, anomaly_loss:0.6223	fnorm_loss:0.0494, a_fnorm_loss:0.0107P:0.00, R:0.00
 19%|█▉        | 19/100 [01:34<05:39,  4.19s/it]epoch [19/100], focal_loss:0.0529	, anomaly_loss:0.6312	fnorm_loss:0.0491, a_fnorm_loss:0.0107P:0.00, R:0.00
 20%|██        | 20/100 [01:43<07:35,  5.69s/it]epoch [20/100], focal_loss:0.0485	, anomaly_loss:0.6251	fnorm_loss:0.0483, a_fnorm_loss:0.0105P:0.00, R:0.00
normal: 0.1683 0.1733  anomaly: 0.1666 0.1728	P:0.00, R:0.00
Pixel Auroc:0.530, Sample Auroc0.344, Pixel Aupro0.0
test_fnorm_loss: 0.0481 test_afnorm_loss: 0.0111
 21%|██        | 21/100 [01:47<06:42,  5.09s/it]epoch [21/100], focal_loss:0.0471	, anomaly_loss:0.6299	fnorm_loss:0.0472, a_fnorm_loss:0.0107P:0.00, R:0.00
 22%|██▏       | 22/100 [01:50<06:05,  4.68s/it]epoch [22/100], focal_loss:0.0555	, anomaly_loss:0.6346	fnorm_loss:0.0469, a_fnorm_loss:0.0107P:0.00, R:0.00
 23%|██▎       | 23/100 [01:54<05:36,  4.37s/it]epoch [23/100], focal_loss:0.0643	, anomaly_loss:0.6054	fnorm_loss:0.0524, a_fnorm_loss:0.0143P:0.00, R:0.08
 24%|██▍       | 24/100 [01:58<05:20,  4.21s/it]epoch [24/100], focal_loss:0.0527	, anomaly_loss:0.6135	fnorm_loss:0.0480, a_fnorm_loss:0.0131P:0.00, R:0.00
 25%|██▌       | 25/100 [02:12<09:01,  7.22s/it]epoch [25/100], focal_loss:0.0429	, anomaly_loss:0.5764	fnorm_loss:0.0475, a_fnorm_loss:0.0166P:0.00, R:0.08
normal: 0.2257 0.2332  anomaly: 0.2205 0.2348	P:0.02, R:0.10
Pixel Auroc:0.826, Sample Auroc0.403, Pixel Aupro0.0
test_fnorm_loss: 0.0470 test_afnorm_loss: 0.0182
 26%|██▌       | 26/100 [02:16<07:39,  6.20s/it]epoch [26/100], focal_loss:0.0462	, anomaly_loss:0.5657	fnorm_loss:0.0459, a_fnorm_loss:0.0193P:0.04, R:0.23
 27%|██▋       | 27/100 [02:20<06:38,  5.46s/it]epoch [27/100], focal_loss:0.0488	, anomaly_loss:0.6186	fnorm_loss:0.0438, a_fnorm_loss:0.0136P:0.01, R:0.08
 28%|██▊       | 28/100 [02:24<05:57,  4.97s/it]epoch [28/100], focal_loss:0.0454	, anomaly_loss:0.6412	fnorm_loss:0.0427, a_fnorm_loss:0.0092P:0.00, R:0.00
 29%|██▉       | 29/100 [02:27<05:26,  4.60s/it]epoch [29/100], focal_loss:0.0448	, anomaly_loss:0.6440	fnorm_loss:0.0420, a_fnorm_loss:0.0094P:0.00, R:0.00
 30%|███       | 30/100 [02:37<07:01,  6.01s/it]epoch [30/100], focal_loss:0.0385	, anomaly_loss:0.6440	fnorm_loss:0.0421, a_fnorm_loss:0.0094P:0.00, R:0.00
normal: 0.1510 0.1544  anomaly: 0.1486 0.1545	P:0.00, R:0.00
Pixel Auroc:0.614, Sample Auroc0.328, Pixel Aupro0.0
test_fnorm_loss: 0.0423 test_afnorm_loss: 0.0103
 31%|███       | 31/100 [02:40<06:05,  5.30s/it]epoch [31/100], focal_loss:0.0460	, anomaly_loss:0.6229	fnorm_loss:0.0430, a_fnorm_loss:0.0118P:0.00, R:0.00
 32%|███▏      | 32/100 [02:44<05:26,  4.80s/it]epoch [32/100], focal_loss:0.0487	, anomaly_loss:0.5837	fnorm_loss:0.0428, a_fnorm_loss:0.0168P:0.08, R:0.17
 33%|███▎      | 33/100 [02:47<04:58,  4.45s/it]epoch [33/100], focal_loss:0.0554	, anomaly_loss:0.5360	fnorm_loss:0.0433, a_fnorm_loss:0.0230P:0.07, R:0.35
 34%|███▍      | 34/100 [02:51<04:37,  4.21s/it]epoch [34/100], focal_loss:0.0398	, anomaly_loss:0.5309	fnorm_loss:0.0398, a_fnorm_loss:0.0265P:0.11, R:0.29
 35%|███▌      | 35/100 [03:05<07:45,  7.17s/it]epoch [35/100], focal_loss:0.0435	, anomaly_loss:0.5477	fnorm_loss:0.0383, a_fnorm_loss:0.0253P:0.15, R:0.23
normal: 0.2622 0.2904  anomaly: 0.2665 0.3052	P:0.04, R:0.15
Pixel Auroc:0.922, Sample Auroc0.764, Pixel Aupro0.0
test_fnorm_loss: 0.0403 test_afnorm_loss: 0.0283
 36%|███▌      | 36/100 [03:09<06:34,  6.16s/it]epoch [36/100], focal_loss:0.0448	, anomaly_loss:0.5359	fnorm_loss:0.0379, a_fnorm_loss:0.0281P:0.12, R:0.27
 37%|███▋      | 37/100 [03:13<05:40,  5.40s/it]epoch [37/100], focal_loss:0.0585	, anomaly_loss:0.5254	fnorm_loss:0.0386, a_fnorm_loss:0.0289P:0.12, R:0.32
 38%|███▊      | 38/100 [03:16<05:01,  4.86s/it]epoch [38/100], focal_loss:0.0468	, anomaly_loss:0.5335	fnorm_loss:0.0371, a_fnorm_loss:0.0280P:0.09, R:0.26
 39%|███▉      | 39/100 [03:20<04:34,  4.49s/it]epoch [39/100], focal_loss:0.0374	, anomaly_loss:0.5240	fnorm_loss:0.0359, a_fnorm_loss:0.0308P:0.09, R:0.28
 40%|████      | 40/100 [03:33<07:10,  7.18s/it]epoch [40/100], focal_loss:0.0468	, anomaly_loss:0.5222	fnorm_loss:0.0354, a_fnorm_loss:0.0310P:0.15, R:0.28
normal: 0.2556 0.2989  anomaly: 0.2610 0.3138	P:0.04, R:0.15
Pixel Auroc:0.928, Sample Auroc0.719, Pixel Aupro0.0
test_fnorm_loss: 0.0367 test_afnorm_loss: 0.0295
 41%|████      | 41/100 [03:37<06:01,  6.12s/it]epoch [41/100], focal_loss:0.0506	, anomaly_loss:0.5243	fnorm_loss:0.0365, a_fnorm_loss:0.0306P:0.11, R:0.28
 42%|████▏     | 42/100 [03:41<05:19,  5.52s/it]epoch [42/100], focal_loss:0.0335	, anomaly_loss:0.5090	fnorm_loss:0.0345, a_fnorm_loss:0.0320P:0.10, R:0.30
 43%|████▎     | 43/100 [03:45<04:44,  5.00s/it]epoch [43/100], focal_loss:0.0367	, anomaly_loss:0.5115	fnorm_loss:0.0339, a_fnorm_loss:0.0327P:0.10, R:0.30
 44%|████▍     | 44/100 [03:49<04:18,  4.62s/it]epoch [44/100], focal_loss:0.0405	, anomaly_loss:0.5294	fnorm_loss:0.0332, a_fnorm_loss:0.0296P:0.12, R:0.26
 45%|████▌     | 45/100 [04:02<06:42,  7.31s/it]epoch [45/100], focal_loss:0.0429	, anomaly_loss:0.4957	fnorm_loss:0.0357, a_fnorm_loss:0.0343P:0.11, R:0.29
normal: 0.1577 0.2497  anomaly: 0.1579 0.3238	P:0.07, R:0.07
Pixel Auroc:0.886, Sample Auroc0.872, Pixel Aupro0.0
test_fnorm_loss: 0.0329 test_afnorm_loss: 0.0185
 46%|████▌     | 46/100 [04:06<05:35,  6.22s/it]epoch [46/100], focal_loss:0.0358	, anomaly_loss:0.4999	fnorm_loss:0.0329, a_fnorm_loss:0.0331P:0.09, R:0.28
 47%|████▋     | 47/100 [04:09<04:47,  5.43s/it]epoch [47/100], focal_loss:0.0422	, anomaly_loss:0.5003	fnorm_loss:0.0320, a_fnorm_loss:0.0329P:0.12, R:0.27
 48%|████▊     | 48/100 [04:13<04:15,  4.91s/it]epoch [48/100], focal_loss:0.0383	, anomaly_loss:0.4756	fnorm_loss:0.0318, a_fnorm_loss:0.0344P:0.12, R:0.29
 49%|████▉     | 49/100 [04:17<03:50,  4.53s/it]epoch [49/100], focal_loss:0.0306	, anomaly_loss:0.4699	fnorm_loss:0.0302, a_fnorm_loss:0.0339P:0.24, R:0.34
 50%|█████     | 50/100 [04:31<06:04,  7.29s/it]epoch [50/100], focal_loss:0.0391	, anomaly_loss:0.4922	fnorm_loss:0.0312, a_fnorm_loss:0.0324P:0.17, R:0.39
normal: 0.1428 0.1832  anomaly: 0.1467 0.2708	P:0.08, R:0.06
Pixel Auroc:0.892, Sample Auroc0.900, Pixel Aupro0.0
test_fnorm_loss: 0.0305 test_afnorm_loss: 0.0156
 51%|█████     | 51/100 [04:34<05:03,  6.20s/it]epoch [51/100], focal_loss:0.0320	, anomaly_loss:0.4975	fnorm_loss:0.0309, a_fnorm_loss:0.0306P:0.21, R:0.28
 52%|█████▏    | 52/100 [04:38<04:21,  5.44s/it]epoch [52/100], focal_loss:0.0301	, anomaly_loss:0.4662	fnorm_loss:0.0293, a_fnorm_loss:0.0366P:0.47, R:0.45
 53%|█████▎    | 53/100 [04:42<03:54,  4.99s/it]epoch [53/100], focal_loss:0.0329	, anomaly_loss:0.4559	fnorm_loss:0.0287, a_fnorm_loss:0.0369P:0.33, R:0.60
 54%|█████▍    | 54/100 [04:46<03:32,  4.61s/it]epoch [54/100], focal_loss:0.0317	, anomaly_loss:0.4497	fnorm_loss:0.0280, a_fnorm_loss:0.0359P:0.41, R:0.71
 55%|█████▌    | 55/100 [05:00<05:34,  7.44s/it]epoch [55/100], focal_loss:0.0314	, anomaly_loss:0.4603	fnorm_loss:0.0278, a_fnorm_loss:0.0361P:0.42, R:0.60
normal: 0.1441 0.2700  anomaly: 0.1831 0.3930	P:0.13, R:0.10
Pixel Auroc:0.951, Sample Auroc0.853, Pixel Aupro0.0
test_fnorm_loss: 0.0275 test_afnorm_loss: 0.0188
 56%|█████▌    | 56/100 [05:03<04:39,  6.35s/it]epoch [56/100], focal_loss:0.0314	, anomaly_loss:0.4529	fnorm_loss:0.0274, a_fnorm_loss:0.0348P:0.26, R:0.66
 57%|█████▋    | 57/100 [05:07<03:58,  5.53s/it]epoch [57/100], focal_loss:0.0313	, anomaly_loss:0.4984	fnorm_loss:0.0264, a_fnorm_loss:0.0330P:0.21, R:0.48
 58%|█████▊    | 58/100 [05:11<03:29,  4.98s/it]epoch [58/100], focal_loss:0.0304	, anomaly_loss:0.4817	fnorm_loss:0.0258, a_fnorm_loss:0.0369P:0.32, R:0.50
 59%|█████▉    | 59/100 [05:14<03:09,  4.63s/it]epoch [59/100], focal_loss:0.0371	, anomaly_loss:0.4755	fnorm_loss:0.0261, a_fnorm_loss:0.0348P:0.23, R:0.55
 60%|██████    | 60/100 [05:28<04:52,  7.32s/it]epoch [60/100], focal_loss:0.0309	, anomaly_loss:0.4507	fnorm_loss:0.0251, a_fnorm_loss:0.0378P:0.27, R:0.60
normal: 0.1383 0.2544  anomaly: 0.1635 0.4132	P:0.19, R:0.16
Pixel Auroc:0.960, Sample Auroc0.953, Pixel Aupro0.0
test_fnorm_loss: 0.0244 test_afnorm_loss: 0.0214
 61%|██████    | 61/100 [05:32<04:04,  6.27s/it]epoch [61/100], focal_loss:0.0348	, anomaly_loss:0.4589	fnorm_loss:0.0251, a_fnorm_loss:0.0356P:0.38, R:0.56
 62%|██████▏   | 62/100 [05:36<03:28,  5.49s/it]epoch [62/100], focal_loss:0.0363	, anomaly_loss:0.4556	fnorm_loss:0.0260, a_fnorm_loss:0.0326P:0.42, R:0.65
 63%|██████▎   | 63/100 [05:39<03:05,  5.02s/it]epoch [63/100], focal_loss:0.0271	, anomaly_loss:0.4257	fnorm_loss:0.0242, a_fnorm_loss:0.0369P:0.42, R:0.72
 64%|██████▍   | 64/100 [05:43<02:46,  4.62s/it]epoch [64/100], focal_loss:0.0313	, anomaly_loss:0.4373	fnorm_loss:0.0240, a_fnorm_loss:0.0358P:0.35, R:0.71
 65%|██████▌   | 65/100 [05:57<04:22,  7.51s/it]epoch [65/100], focal_loss:0.0263	, anomaly_loss:0.4324	fnorm_loss:0.0234, a_fnorm_loss:0.0388P:0.46, R:0.79
normal: 0.1274 0.2705  anomaly: 0.1916 0.4238	P:0.22, R:0.21
Pixel Auroc:0.976, Sample Auroc0.958, Pixel Aupro0.0
test_fnorm_loss: 0.0227 test_afnorm_loss: 0.0222
 66%|██████▌   | 66/100 [06:02<03:41,  6.51s/it]epoch [66/100], focal_loss:0.0266	, anomaly_loss:0.4374	fnorm_loss:0.0234, a_fnorm_loss:0.0365P:0.32, R:0.73
 67%|██████▋   | 67/100 [06:05<03:06,  5.66s/it]epoch [67/100], focal_loss:0.0204	, anomaly_loss:0.3937	fnorm_loss:0.0224, a_fnorm_loss:0.0426P:0.35, R:0.92
 68%|██████▊   | 68/100 [06:09<02:42,  5.07s/it]epoch [68/100], focal_loss:0.0238	, anomaly_loss:0.3940	fnorm_loss:0.0222, a_fnorm_loss:0.0411P:0.36, R:0.89
 69%|██████▉   | 69/100 [06:13<02:23,  4.64s/it]epoch [69/100], focal_loss:0.0261	, anomaly_loss:0.4137	fnorm_loss:0.0223, a_fnorm_loss:0.0401P:0.33, R:0.80
 70%|███████   | 70/100 [06:21<02:57,  5.91s/it]epoch [70/100], focal_loss:0.0250	, anomaly_loss:0.4181	fnorm_loss:0.0214, a_fnorm_loss:0.0395P:0.53, R:0.82
normal: 0.1574 0.2913  anomaly: 0.2774 0.4432	P:0.17, R:0.28
Pixel Auroc:0.981, Sample Auroc0.994, Pixel Aupro0.0
test_fnorm_loss: 0.0215 test_afnorm_loss: 0.0305
 71%|███████   | 71/100 [06:25<02:31,  5.22s/it]epoch [71/100], focal_loss:0.0313	, anomaly_loss:0.4210	fnorm_loss:0.0220, a_fnorm_loss:0.0397P:0.43, R:0.77
 72%|███████▏  | 72/100 [06:29<02:14,  4.80s/it]epoch [72/100], focal_loss:0.0202	, anomaly_loss:0.4125	fnorm_loss:0.0209, a_fnorm_loss:0.0397P:0.46, R:0.84
 73%|███████▎  | 73/100 [06:33<02:00,  4.46s/it]epoch [73/100], focal_loss:0.0235	, anomaly_loss:0.4020	fnorm_loss:0.0211, a_fnorm_loss:0.0420P:0.39, R:0.85
 74%|███████▍  | 74/100 [06:37<01:52,  4.31s/it]epoch [74/100], focal_loss:0.0218	, anomaly_loss:0.4022	fnorm_loss:0.0206, a_fnorm_loss:0.0390P:0.44, R:0.88
 75%|███████▌  | 75/100 [06:50<02:58,  7.13s/it]epoch [75/100], focal_loss:0.0217	, anomaly_loss:0.3887	fnorm_loss:0.0204, a_fnorm_loss:0.0415P:0.38, R:0.89
normal: 0.1444 0.3228  anomaly: 0.2487 0.5207	P:0.26, R:0.31
Pixel Auroc:0.978, Sample Auroc0.975, Pixel Aupro0.0
test_fnorm_loss: 0.0197 test_afnorm_loss: 0.0272
 76%|███████▌  | 76/100 [06:54<02:26,  6.10s/it]epoch [76/100], focal_loss:0.0230	, anomaly_loss:0.4035	fnorm_loss:0.0203, a_fnorm_loss:0.0412P:0.41, R:0.87
 77%|███████▋  | 77/100 [06:58<02:04,  5.40s/it]epoch [77/100], focal_loss:0.0230	, anomaly_loss:0.3982	fnorm_loss:0.0200, a_fnorm_loss:0.0411P:0.42, R:0.80
 78%|███████▊  | 78/100 [07:02<01:48,  4.93s/it]epoch [78/100], focal_loss:0.0196	, anomaly_loss:0.4071	fnorm_loss:0.0194, a_fnorm_loss:0.0394P:0.44, R:0.83
 79%|███████▉  | 79/100 [07:05<01:35,  4.53s/it]epoch [79/100], focal_loss:0.0202	, anomaly_loss:0.3795	fnorm_loss:0.0194, a_fnorm_loss:0.0389P:0.36, R:0.88
 80%|████████  | 80/100 [07:14<01:59,  5.95s/it]epoch [80/100], focal_loss:0.0225	, anomaly_loss:0.4021	fnorm_loss:0.0196, a_fnorm_loss:0.0405P:0.39, R:0.89
normal: 0.1665 0.3447  anomaly: 0.2492 0.5724	P:0.25, R:0.40
Pixel Auroc:0.982, Sample Auroc0.978, Pixel Aupro0.0
test_fnorm_loss: 0.0189 test_afnorm_loss: 0.0305
 81%|████████  | 81/100 [07:18<01:39,  5.22s/it]epoch [81/100], focal_loss:0.0244	, anomaly_loss:0.3914	fnorm_loss:0.0194, a_fnorm_loss:0.0422P:0.28, R:0.88
 82%|████████▏ | 82/100 [07:22<01:25,  4.76s/it]epoch [82/100], focal_loss:0.0202	, anomaly_loss:0.3828	fnorm_loss:0.0191, a_fnorm_loss:0.0404P:0.40, R:0.86
 83%|████████▎ | 83/100 [07:25<01:14,  4.40s/it]epoch [83/100], focal_loss:0.0208	, anomaly_loss:0.3846	fnorm_loss:0.0191, a_fnorm_loss:0.0445P:0.37, R:0.91
 84%|████████▍ | 84/100 [07:29<01:07,  4.19s/it]epoch [84/100], focal_loss:0.0176	, anomaly_loss:0.3784	fnorm_loss:0.0187, a_fnorm_loss:0.0436P:0.46, R:0.93
 85%|████████▌ | 85/100 [07:43<01:46,  7.08s/it]epoch [85/100], focal_loss:0.0184	, anomaly_loss:0.3756	fnorm_loss:0.0188, a_fnorm_loss:0.0419P:0.40, R:0.90
normal: 0.1222 0.2687  anomaly: 0.2406 0.4974	P:0.32, R:0.29
Pixel Auroc:0.984, Sample Auroc0.994, Pixel Aupro0.0
test_fnorm_loss: 0.0184 test_afnorm_loss: 0.0262
 86%|████████▌ | 86/100 [07:47<01:25,  6.10s/it]epoch [86/100], focal_loss:0.0200	, anomaly_loss:0.3757	fnorm_loss:0.0188, a_fnorm_loss:0.0430P:0.40, R:0.90
 87%|████████▋ | 87/100 [07:50<01:09,  5.38s/it]epoch [87/100], focal_loss:0.0172	, anomaly_loss:0.3656	fnorm_loss:0.0186, a_fnorm_loss:0.0443P:0.39, R:0.93
 88%|████████▊ | 88/100 [07:54<00:58,  4.86s/it]epoch [88/100], focal_loss:0.0180	, anomaly_loss:0.3878	fnorm_loss:0.0185, a_fnorm_loss:0.0431P:0.52, R:0.92
 89%|████████▉ | 89/100 [07:58<00:49,  4.53s/it]epoch [89/100], focal_loss:0.0169	, anomaly_loss:0.3885	fnorm_loss:0.0184, a_fnorm_loss:0.0422P:0.50, R:0.89
 90%|█████████ | 90/100 [08:07<01:00,  6.03s/it]epoch [90/100], focal_loss:0.0200	, anomaly_loss:0.3683	fnorm_loss:0.0188, a_fnorm_loss:0.0443P:0.45, R:0.91
normal: 0.1372 0.2825  anomaly: 0.2397 0.5308	P:0.30, R:0.31
Pixel Auroc:0.984, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0183 test_afnorm_loss: 0.0279
 91%|█████████ | 91/100 [08:11<00:48,  5.34s/it]epoch [91/100], focal_loss:0.0175	, anomaly_loss:0.3954	fnorm_loss:0.0184, a_fnorm_loss:0.0429P:0.50, R:0.87
 92%|█████████▏| 92/100 [08:15<00:38,  4.84s/it]epoch [92/100], focal_loss:0.0179	, anomaly_loss:0.3658	fnorm_loss:0.0186, a_fnorm_loss:0.0443P:0.33, R:0.93
 93%|█████████▎| 93/100 [08:18<00:31,  4.53s/it]epoch [93/100], focal_loss:0.0187	, anomaly_loss:0.3535	fnorm_loss:0.0186, a_fnorm_loss:0.0458P:0.35, R:0.96
 94%|█████████▍| 94/100 [08:22<00:25,  4.26s/it]epoch [94/100], focal_loss:0.0208	, anomaly_loss:0.3970	fnorm_loss:0.0185, a_fnorm_loss:0.0411P:0.39, R:0.85
 95%|█████████▌| 95/100 [08:31<00:28,  5.72s/it]epoch [95/100], focal_loss:0.0202	, anomaly_loss:0.3885	fnorm_loss:0.0184, a_fnorm_loss:0.0411P:0.46, R:0.86
normal: 0.1377 0.2762  anomaly: 0.2368 0.5251	P:0.32, R:0.32
Pixel Auroc:0.984, Sample Auroc0.992, Pixel Aupro0.0
test_fnorm_loss: 0.0183 test_afnorm_loss: 0.0279
 96%|█████████▌| 96/100 [08:35<00:20,  5.12s/it]epoch [96/100], focal_loss:0.0208	, anomaly_loss:0.4188	fnorm_loss:0.0186, a_fnorm_loss:0.0410P:0.34, R:0.82
 97%|█████████▋| 97/100 [08:39<00:14,  4.70s/it]epoch [97/100], focal_loss:0.0170	, anomaly_loss:0.3672	fnorm_loss:0.0184, a_fnorm_loss:0.0446P:0.52, R:0.94
 98%|█████████▊| 98/100 [08:42<00:08,  4.40s/it]epoch [98/100], focal_loss:0.0199	, anomaly_loss:0.3847	fnorm_loss:0.0186, a_fnorm_loss:0.0420P:0.45, R:0.91
 99%|█████████▉| 99/100 [08:46<00:04,  4.21s/it]epoch [99/100], focal_loss:0.0191	, anomaly_loss:0.3896	fnorm_loss:0.0185, a_fnorm_loss:0.0419P:0.43, R:0.86
100%|██████████| 100/100 [08:56<00:00,  5.80s/it]100%|██████████| 100/100 [08:56<00:00,  5.36s/it]
epoch [100/100], focal_loss:0.0192	, anomaly_loss:0.3616	fnorm_loss:0.0186, a_fnorm_loss:0.0446P:0.36, R:0.94
normal: 0.1270 0.2674  anomaly: 0.2245 0.5171	P:0.32, R:0.30
Pixel Auroc:0.984, Sample Auroc0.989, Pixel Aupro0.0
test_fnorm_loss: 0.0181 test_afnorm_loss: 0.0268
training Stubborn Student...
toothbrush
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:02<04:55,  2.48s/it]epoch [1/120], kd_loss:5.8290
  2%|▏         | 2/120 [00:04<04:47,  2.43s/it]epoch [2/120], kd_loss:5.0612
  2%|▎         | 3/120 [00:07<04:46,  2.45s/it]epoch [3/120], kd_loss:4.6667
  3%|▎         | 4/120 [00:09<04:44,  2.45s/it]epoch [4/120], kd_loss:4.2365
  4%|▍         | 5/120 [00:12<04:43,  2.46s/it]epoch [5/120], kd_loss:4.0705
  5%|▌         | 6/120 [00:14<04:40,  2.46s/it]epoch [6/120], kd_loss:4.0519
  6%|▌         | 7/120 [00:17<04:37,  2.45s/it]epoch [7/120], kd_loss:3.9986
  7%|▋         | 8/120 [00:19<04:35,  2.46s/it]epoch [8/120], kd_loss:3.9575
  8%|▊         | 9/120 [00:22<04:33,  2.46s/it]epoch [9/120], kd_loss:3.9615
  8%|▊         | 9/120 [00:29<06:09,  3.33s/it]
epoch [10/120], kd_loss:3.6285
normal: 2.0896 2.1813  anomaly: 2.1814 2.5046
thresh: 2.1814391341378023
fpr: 0.0 fnr 0.0
Pixel Auroc:0.975, Sample Auroc1.000, Pixel Aupro0.0
training Advanced Teacher...
transistor
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:24<40:34, 24.59s/it]epoch [1/100], focal_loss:0.0936	, anomaly_loss:0.6499	fnorm_loss:0.0532, a_fnorm_loss:0.0157P:0.00, R:0.03
normal: 0.2534 0.2610  anomaly: 0.2526 0.2616	P:0.00, R:0.00
Pixel Auroc:0.450, Sample Auroc0.418, Pixel Aupro0.0
test_fnorm_loss: 0.0555 test_afnorm_loss: 0.0283
  2%|▏         | 2/100 [00:32<24:32, 15.03s/it]epoch [2/100], focal_loss:0.0839	, anomaly_loss:0.6425	fnorm_loss:0.0517, a_fnorm_loss:0.0156P:0.00, R:0.00
  3%|▎         | 3/100 [00:41<19:30, 12.07s/it]epoch [3/100], focal_loss:0.0782	, anomaly_loss:0.6559	fnorm_loss:0.0468, a_fnorm_loss:0.0144P:0.00, R:0.00
  4%|▍         | 4/100 [00:49<16:59, 10.62s/it]epoch [4/100], focal_loss:0.0756	, anomaly_loss:0.6632	fnorm_loss:0.0445, a_fnorm_loss:0.0136P:0.00, R:0.00
  5%|▌         | 5/100 [01:12<23:34, 14.88s/it]epoch [5/100], focal_loss:0.0758	, anomaly_loss:0.6674	fnorm_loss:0.0424, a_fnorm_loss:0.0130P:0.00, R:0.00
normal: 0.1956 0.2003  anomaly: 0.1951 0.2007	P:0.00, R:0.00
Pixel Auroc:0.452, Sample Auroc0.399, Pixel Aupro0.0
test_fnorm_loss: 0.0428 test_afnorm_loss: 0.0220
  6%|▌         | 6/100 [01:21<20:04, 12.81s/it]epoch [6/100], focal_loss:0.0783	, anomaly_loss:0.6717	fnorm_loss:0.0417, a_fnorm_loss:0.0136P:0.00, R:0.00
  7%|▋         | 7/100 [01:29<17:44, 11.45s/it]epoch [7/100], focal_loss:0.0808	, anomaly_loss:0.6636	fnorm_loss:0.0435, a_fnorm_loss:0.0137P:0.01, R:0.00
  8%|▊         | 8/100 [01:38<16:04, 10.49s/it]epoch [8/100], focal_loss:0.0790	, anomaly_loss:0.6704	fnorm_loss:0.0410, a_fnorm_loss:0.0129P:0.00, R:0.00
  9%|▉         | 9/100 [01:46<14:54,  9.83s/it]epoch [9/100], focal_loss:0.0767	, anomaly_loss:0.6437	fnorm_loss:0.0420, a_fnorm_loss:0.0183P:0.05, R:0.08
 10%|█         | 10/100 [02:10<21:18, 14.21s/it]epoch [10/100], focal_loss:0.0676	, anomaly_loss:0.5839	fnorm_loss:0.0372, a_fnorm_loss:0.0297P:0.10, R:0.29
normal: 0.1671 0.2389  anomaly: 0.1673 0.2430	P:0.02, R:0.00
Pixel Auroc:0.483, Sample Auroc0.441, Pixel Aupro0.0
test_fnorm_loss: 0.0341 test_afnorm_loss: 0.0178
 11%|█         | 11/100 [02:19<18:33, 12.52s/it]epoch [11/100], focal_loss:0.0719	, anomaly_loss:0.5808	fnorm_loss:0.0349, a_fnorm_loss:0.0306P:0.11, R:0.29
 12%|█▏        | 12/100 [02:27<16:33, 11.29s/it]epoch [12/100], focal_loss:0.0663	, anomaly_loss:0.5697	fnorm_loss:0.0324, a_fnorm_loss:0.0336P:0.13, R:0.31
 13%|█▎        | 13/100 [02:36<15:06, 10.42s/it]epoch [13/100], focal_loss:0.0658	, anomaly_loss:0.5691	fnorm_loss:0.0300, a_fnorm_loss:0.0329P:0.16, R:0.38
 14%|█▍        | 14/100 [02:44<14:08,  9.87s/it]epoch [14/100], focal_loss:0.0664	, anomaly_loss:0.5754	fnorm_loss:0.0289, a_fnorm_loss:0.0332P:0.15, R:0.31
 15%|█▌        | 15/100 [03:11<21:17, 15.03s/it]epoch [15/100], focal_loss:0.0598	, anomaly_loss:0.5526	fnorm_loss:0.0268, a_fnorm_loss:0.0351P:0.25, R:0.53
normal: 0.1633 0.3102  anomaly: 0.1803 0.3587	P:0.07, R:0.03
Pixel Auroc:0.656, Sample Auroc0.758, Pixel Aupro0.0
test_fnorm_loss: 0.0244 test_afnorm_loss: 0.0188
 16%|█▌        | 16/100 [03:20<18:25, 13.16s/it]epoch [16/100], focal_loss:0.0558	, anomaly_loss:0.5432	fnorm_loss:0.0243, a_fnorm_loss:0.0373P:0.26, R:0.58
 17%|█▋        | 17/100 [03:28<16:10, 11.70s/it]epoch [17/100], focal_loss:0.0549	, anomaly_loss:0.5426	fnorm_loss:0.0224, a_fnorm_loss:0.0378P:0.31, R:0.59
 18%|█▊        | 18/100 [03:37<14:42, 10.76s/it]epoch [18/100], focal_loss:0.0472	, anomaly_loss:0.5416	fnorm_loss:0.0207, a_fnorm_loss:0.0384P:0.30, R:0.56
 19%|█▉        | 19/100 [03:45<13:30, 10.01s/it]epoch [19/100], focal_loss:0.0498	, anomaly_loss:0.5320	fnorm_loss:0.0198, a_fnorm_loss:0.0399P:0.32, R:0.63
 20%|██        | 20/100 [04:12<20:05, 15.07s/it]epoch [20/100], focal_loss:0.0413	, anomaly_loss:0.5398	fnorm_loss:0.0190, a_fnorm_loss:0.0376P:0.40, R:0.68
normal: 0.1621 0.3036  anomaly: 0.1117 0.4214	P:0.12, R:0.07
Pixel Auroc:0.685, Sample Auroc0.771, Pixel Aupro0.0
test_fnorm_loss: 0.0171 test_afnorm_loss: 0.0168
 21%|██        | 21/100 [04:21<17:14, 13.09s/it]epoch [21/100], focal_loss:0.0422	, anomaly_loss:0.5309	fnorm_loss:0.0180, a_fnorm_loss:0.0391P:0.46, R:0.73
 22%|██▏       | 22/100 [04:29<15:15, 11.74s/it]epoch [22/100], focal_loss:0.0317	, anomaly_loss:0.5199	fnorm_loss:0.0169, a_fnorm_loss:0.0402P:0.45, R:0.86
 23%|██▎       | 23/100 [04:38<13:55, 10.85s/it]epoch [23/100], focal_loss:0.0307	, anomaly_loss:0.5139	fnorm_loss:0.0162, a_fnorm_loss:0.0416P:0.50, R:0.87
 24%|██▍       | 24/100 [04:46<12:49, 10.13s/it]epoch [24/100], focal_loss:0.0307	, anomaly_loss:0.5137	fnorm_loss:0.0157, a_fnorm_loss:0.0426P:0.51, R:0.87
 25%|██▌       | 25/100 [05:14<19:08, 15.31s/it]epoch [25/100], focal_loss:0.0269	, anomaly_loss:0.5169	fnorm_loss:0.0149, a_fnorm_loss:0.0427P:0.49, R:0.86
normal: 0.1234 0.3420  anomaly: 0.1215 0.4058	P:0.13, R:0.06
Pixel Auroc:0.680, Sample Auroc0.826, Pixel Aupro0.0
test_fnorm_loss: 0.0133 test_afnorm_loss: 0.0094
 26%|██▌       | 26/100 [05:22<16:20, 13.25s/it]epoch [26/100], focal_loss:0.0279	, anomaly_loss:0.5104	fnorm_loss:0.0145, a_fnorm_loss:0.0427P:0.55, R:0.88
 27%|██▋       | 27/100 [05:31<14:20, 11.78s/it]epoch [27/100], focal_loss:0.0295	, anomaly_loss:0.5054	fnorm_loss:0.0143, a_fnorm_loss:0.0432P:0.49, R:0.87
 28%|██▊       | 28/100 [05:40<13:08, 10.95s/it]epoch [28/100], focal_loss:0.0254	, anomaly_loss:0.5086	fnorm_loss:0.0136, a_fnorm_loss:0.0429P:0.54, R:0.88
 29%|██▉       | 29/100 [05:48<11:56, 10.09s/it]epoch [29/100], focal_loss:0.0252	, anomaly_loss:0.5129	fnorm_loss:0.0134, a_fnorm_loss:0.0421P:0.53, R:0.86
 30%|███       | 30/100 [06:15<17:38, 15.13s/it]epoch [30/100], focal_loss:0.0335	, anomaly_loss:0.5229	fnorm_loss:0.0140, a_fnorm_loss:0.0393P:0.54, R:0.83
normal: 0.1313 0.2902  anomaly: 0.1267 0.4010	P:0.14, R:0.05
Pixel Auroc:0.755, Sample Auroc0.893, Pixel Aupro0.0
test_fnorm_loss: 0.0130 test_afnorm_loss: 0.0117
 31%|███       | 31/100 [06:23<15:13, 13.24s/it]epoch [31/100], focal_loss:0.0275	, anomaly_loss:0.5108	fnorm_loss:0.0137, a_fnorm_loss:0.0414P:0.51, R:0.86
 32%|███▏      | 32/100 [06:32<13:24, 11.82s/it]epoch [32/100], focal_loss:0.0253	, anomaly_loss:0.5017	fnorm_loss:0.0129, a_fnorm_loss:0.0442P:0.58, R:0.88
 33%|███▎      | 33/100 [06:40<12:03, 10.80s/it]epoch [33/100], focal_loss:0.0262	, anomaly_loss:0.5061	fnorm_loss:0.0127, a_fnorm_loss:0.0441P:0.55, R:0.88
 34%|███▍      | 34/100 [06:49<11:06, 10.11s/it]epoch [34/100], focal_loss:0.0224	, anomaly_loss:0.5042	fnorm_loss:0.0122, a_fnorm_loss:0.0434P:0.55, R:0.88
 35%|███▌      | 35/100 [07:16<16:27, 15.19s/it]epoch [35/100], focal_loss:0.0248	, anomaly_loss:0.5060	fnorm_loss:0.0122, a_fnorm_loss:0.0450P:0.61, R:0.89
normal: 0.1036 0.4065  anomaly: 0.1074 0.5127	P:0.17, R:0.08
Pixel Auroc:0.742, Sample Auroc0.837, Pixel Aupro0.0
test_fnorm_loss: 0.0104 test_afnorm_loss: 0.0124
 36%|███▌      | 36/100 [07:24<14:03, 13.18s/it]epoch [36/100], focal_loss:0.0219	, anomaly_loss:0.5010	fnorm_loss:0.0116, a_fnorm_loss:0.0449P:0.58, R:0.89
 37%|███▋      | 37/100 [07:33<12:21, 11.76s/it]epoch [37/100], focal_loss:0.0230	, anomaly_loss:0.4995	fnorm_loss:0.0116, a_fnorm_loss:0.0459P:0.61, R:0.91
 38%|███▊      | 38/100 [07:41<11:11, 10.84s/it]epoch [38/100], focal_loss:0.0216	, anomaly_loss:0.4991	fnorm_loss:0.0114, a_fnorm_loss:0.0454P:0.60, R:0.90
 39%|███▉      | 39/100 [07:50<10:14, 10.08s/it]epoch [39/100], focal_loss:0.0221	, anomaly_loss:0.5030	fnorm_loss:0.0111, a_fnorm_loss:0.0460P:0.61, R:0.88
 40%|████      | 40/100 [08:12<13:47, 13.79s/it]epoch [40/100], focal_loss:0.0232	, anomaly_loss:0.5063	fnorm_loss:0.0112, a_fnorm_loss:0.0451P:0.63, R:0.89
normal: 0.1242 0.4238  anomaly: 0.1444 0.5788	P:0.16, R:0.09
Pixel Auroc:0.702, Sample Auroc0.855, Pixel Aupro0.0
test_fnorm_loss: 0.0094 test_afnorm_loss: 0.0133
 41%|████      | 41/100 [08:21<12:02, 12.25s/it]epoch [41/100], focal_loss:0.0260	, anomaly_loss:0.5024	fnorm_loss:0.0113, a_fnorm_loss:0.0457P:0.62, R:0.89
 42%|████▏     | 42/100 [08:30<10:50, 11.22s/it]epoch [42/100], focal_loss:0.0214	, anomaly_loss:0.5058	fnorm_loss:0.0109, a_fnorm_loss:0.0438P:0.54, R:0.88
 43%|████▎     | 43/100 [08:38<09:56, 10.47s/it]epoch [43/100], focal_loss:0.0221	, anomaly_loss:0.5022	fnorm_loss:0.0107, a_fnorm_loss:0.0460P:0.63, R:0.89
 44%|████▍     | 44/100 [08:47<09:15,  9.93s/it]epoch [44/100], focal_loss:0.0243	, anomaly_loss:0.5068	fnorm_loss:0.0107, a_fnorm_loss:0.0446P:0.59, R:0.87
 45%|████▌     | 45/100 [09:09<12:31, 13.67s/it]epoch [45/100], focal_loss:0.0203	, anomaly_loss:0.5016	fnorm_loss:0.0105, a_fnorm_loss:0.0463P:0.59, R:0.90
normal: 0.0650 0.3650  anomaly: 0.0767 0.4975	P:0.17, R:0.06
Pixel Auroc:0.740, Sample Auroc0.870, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0106
 46%|████▌     | 46/100 [09:18<10:53, 12.09s/it]epoch [46/100], focal_loss:0.0171	, anomaly_loss:0.4953	fnorm_loss:0.0098, a_fnorm_loss:0.0467P:0.60, R:0.90
 47%|████▋     | 47/100 [09:26<09:42, 10.99s/it]epoch [47/100], focal_loss:0.0191	, anomaly_loss:0.4902	fnorm_loss:0.0102, a_fnorm_loss:0.0467P:0.60, R:0.92
 48%|████▊     | 48/100 [09:35<08:53, 10.25s/it]epoch [48/100], focal_loss:0.0200	, anomaly_loss:0.4928	fnorm_loss:0.0099, a_fnorm_loss:0.0456P:0.62, R:0.90
 49%|████▉     | 49/100 [09:43<08:13,  9.68s/it]epoch [49/100], focal_loss:0.0198	, anomaly_loss:0.4927	fnorm_loss:0.0098, a_fnorm_loss:0.0471P:0.56, R:0.90
 50%|█████     | 50/100 [10:10<12:26, 14.94s/it]epoch [50/100], focal_loss:0.0230	, anomaly_loss:0.4989	fnorm_loss:0.0101, a_fnorm_loss:0.0453P:0.60, R:0.87
normal: 0.0701 0.3328  anomaly: 0.0746 0.4960	P:0.17, R:0.05
Pixel Auroc:0.712, Sample Auroc0.850, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0104
 51%|█████     | 51/100 [10:19<10:35, 12.96s/it]epoch [51/100], focal_loss:0.0219	, anomaly_loss:0.4994	fnorm_loss:0.0099, a_fnorm_loss:0.0447P:0.59, R:0.89
 52%|█████▏    | 52/100 [10:27<09:16, 11.58s/it]epoch [52/100], focal_loss:0.0225	, anomaly_loss:0.4985	fnorm_loss:0.0097, a_fnorm_loss:0.0458P:0.60, R:0.89
 53%|█████▎    | 53/100 [10:36<08:23, 10.71s/it]epoch [53/100], focal_loss:0.0225	, anomaly_loss:0.4973	fnorm_loss:0.0099, a_fnorm_loss:0.0455P:0.60, R:0.89
 54%|█████▍    | 54/100 [10:44<07:40, 10.02s/it]epoch [54/100], focal_loss:0.0186	, anomaly_loss:0.4916	fnorm_loss:0.0094, a_fnorm_loss:0.0464P:0.63, R:0.90
 55%|█████▌    | 55/100 [11:11<11:11, 14.91s/it]epoch [55/100], focal_loss:0.0185	, anomaly_loss:0.4925	fnorm_loss:0.0091, a_fnorm_loss:0.0469P:0.59, R:0.90
normal: 0.0770 0.3166  anomaly: 0.0864 0.5918	P:0.18, R:0.07
Pixel Auroc:0.741, Sample Auroc0.885, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0131
 56%|█████▌    | 56/100 [11:19<09:30, 12.97s/it]epoch [56/100], focal_loss:0.0187	, anomaly_loss:0.4946	fnorm_loss:0.0092, a_fnorm_loss:0.0462P:0.59, R:0.89
 57%|█████▋    | 57/100 [11:28<08:21, 11.66s/it]epoch [57/100], focal_loss:0.0207	, anomaly_loss:0.4938	fnorm_loss:0.0093, a_fnorm_loss:0.0466P:0.62, R:0.90
 58%|█████▊    | 58/100 [11:36<07:29, 10.69s/it]epoch [58/100], focal_loss:0.0187	, anomaly_loss:0.4933	fnorm_loss:0.0090, a_fnorm_loss:0.0476P:0.62, R:0.91
 59%|█████▉    | 59/100 [11:45<06:55, 10.13s/it]epoch [59/100], focal_loss:0.0186	, anomaly_loss:0.4915	fnorm_loss:0.0089, a_fnorm_loss:0.0470P:0.60, R:0.89
 60%|██████    | 60/100 [12:07<09:15, 13.88s/it]epoch [60/100], focal_loss:0.0394	, anomaly_loss:0.5234	fnorm_loss:0.0096, a_fnorm_loss:0.0449P:0.44, R:0.68
normal: 0.1089 0.3487  anomaly: 0.1042 0.3986	P:0.11, R:0.04
Pixel Auroc:0.754, Sample Auroc0.860, Pixel Aupro0.0
test_fnorm_loss: 0.0081 test_afnorm_loss: 0.0123
 61%|██████    | 61/100 [12:16<07:55, 12.19s/it]epoch [61/100], focal_loss:0.0290	, anomaly_loss:0.5200	fnorm_loss:0.0089, a_fnorm_loss:0.0443P:0.48, R:0.68
 62%|██████▏   | 62/100 [12:24<07:01, 11.10s/it]epoch [62/100], focal_loss:0.0228	, anomaly_loss:0.5076	fnorm_loss:0.0088, a_fnorm_loss:0.0448P:0.58, R:0.80
 63%|██████▎   | 63/100 [12:33<06:21, 10.30s/it]epoch [63/100], focal_loss:0.0230	, anomaly_loss:0.5091	fnorm_loss:0.0091, a_fnorm_loss:0.0443P:0.57, R:0.87
 64%|██████▍   | 64/100 [12:41<05:51,  9.75s/it]epoch [64/100], focal_loss:0.0188	, anomaly_loss:0.4935	fnorm_loss:0.0089, a_fnorm_loss:0.0466P:0.57, R:0.91
 65%|██████▌   | 65/100 [13:04<07:53, 13.53s/it]epoch [65/100], focal_loss:0.0245	, anomaly_loss:0.5035	fnorm_loss:0.0090, a_fnorm_loss:0.0453P:0.61, R:0.88
normal: 0.0668 0.4020  anomaly: 0.0714 0.5571	P:0.18, R:0.07
Pixel Auroc:0.759, Sample Auroc0.866, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0126
 66%|██████▌   | 66/100 [13:12<06:51, 12.10s/it]epoch [66/100], focal_loss:0.0227	, anomaly_loss:0.5001	fnorm_loss:0.0088, a_fnorm_loss:0.0473P:0.57, R:0.90
 67%|██████▋   | 67/100 [13:20<06:00, 10.93s/it]epoch [67/100], focal_loss:0.0182	, anomaly_loss:0.4921	fnorm_loss:0.0083, a_fnorm_loss:0.0474P:0.60, R:0.91
 68%|██████▊   | 68/100 [13:29<05:25, 10.16s/it]epoch [68/100], focal_loss:0.0173	, anomaly_loss:0.4913	fnorm_loss:0.0084, a_fnorm_loss:0.0478P:0.62, R:0.92
 69%|██████▉   | 69/100 [13:37<04:56,  9.55s/it]epoch [69/100], focal_loss:0.0185	, anomaly_loss:0.4950	fnorm_loss:0.0084, a_fnorm_loss:0.0470P:0.59, R:0.92
 70%|███████   | 70/100 [14:04<07:22, 14.76s/it]epoch [70/100], focal_loss:0.0171	, anomaly_loss:0.4924	fnorm_loss:0.0082, a_fnorm_loss:0.0465P:0.62, R:0.92
normal: 0.0532 0.3711  anomaly: 0.0798 0.5451	P:0.19, R:0.07
Pixel Auroc:0.763, Sample Auroc0.871, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0127
 71%|███████   | 71/100 [14:12<06:11, 12.82s/it]epoch [71/100], focal_loss:0.0179	, anomaly_loss:0.4958	fnorm_loss:0.0083, a_fnorm_loss:0.0471P:0.62, R:0.91
 72%|███████▏  | 72/100 [14:20<05:20, 11.46s/it]epoch [72/100], focal_loss:0.0204	, anomaly_loss:0.4909	fnorm_loss:0.0085, a_fnorm_loss:0.0467P:0.56, R:0.91
 73%|███████▎  | 73/100 [14:29<04:44, 10.53s/it]epoch [73/100], focal_loss:0.0211	, anomaly_loss:0.5013	fnorm_loss:0.0084, a_fnorm_loss:0.0450P:0.58, R:0.88
 74%|███████▍  | 74/100 [14:37<04:18,  9.93s/it]epoch [74/100], focal_loss:0.0190	, anomaly_loss:0.4961	fnorm_loss:0.0082, a_fnorm_loss:0.0472P:0.61, R:0.90
 75%|███████▌  | 75/100 [15:00<05:42, 13.69s/it]epoch [75/100], focal_loss:0.0199	, anomaly_loss:0.4951	fnorm_loss:0.0084, a_fnorm_loss:0.0465P:0.59, R:0.90
normal: 0.0536 0.3296  anomaly: 0.0788 0.4878	P:0.14, R:0.04
Pixel Auroc:0.714, Sample Auroc0.872, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0073
 76%|███████▌  | 76/100 [15:08<04:49, 12.08s/it]epoch [76/100], focal_loss:0.0251	, anomaly_loss:0.5089	fnorm_loss:0.0082, a_fnorm_loss:0.0456P:0.61, R:0.82
 77%|███████▋  | 77/100 [15:17<04:13, 11.02s/it]epoch [77/100], focal_loss:0.0194	, anomaly_loss:0.4978	fnorm_loss:0.0080, a_fnorm_loss:0.0458P:0.62, R:0.91
 78%|███████▊  | 78/100 [15:25<03:45, 10.23s/it]epoch [78/100], focal_loss:0.0169	, anomaly_loss:0.4886	fnorm_loss:0.0079, a_fnorm_loss:0.0479P:0.57, R:0.92
 79%|███████▉  | 79/100 [15:34<03:24,  9.72s/it]epoch [79/100], focal_loss:0.0190	, anomaly_loss:0.4969	fnorm_loss:0.0079, a_fnorm_loss:0.0470P:0.61, R:0.91
 80%|████████  | 80/100 [15:56<04:32, 13.65s/it]epoch [80/100], focal_loss:0.0180	, anomaly_loss:0.4943	fnorm_loss:0.0082, a_fnorm_loss:0.0463P:0.60, R:0.91
normal: 0.0550 0.3738  anomaly: 0.0747 0.5447	P:0.18, R:0.06
Pixel Auroc:0.729, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0139
 81%|████████  | 81/100 [16:05<03:50, 12.12s/it]epoch [81/100], focal_loss:0.0176	, anomaly_loss:0.4958	fnorm_loss:0.0078, a_fnorm_loss:0.0470P:0.59, R:0.90
 82%|████████▏ | 82/100 [16:13<03:18, 11.01s/it]epoch [82/100], focal_loss:0.0175	, anomaly_loss:0.4924	fnorm_loss:0.0078, a_fnorm_loss:0.0474P:0.63, R:0.92
 83%|████████▎ | 83/100 [16:22<02:55, 10.30s/it]epoch [83/100], focal_loss:0.0174	, anomaly_loss:0.4860	fnorm_loss:0.0078, a_fnorm_loss:0.0486P:0.64, R:0.92
 84%|████████▍ | 84/100 [16:30<02:35,  9.72s/it]epoch [84/100], focal_loss:0.0171	, anomaly_loss:0.4910	fnorm_loss:0.0078, a_fnorm_loss:0.0475P:0.64, R:0.92
 85%|████████▌ | 85/100 [16:58<03:44, 14.96s/it]epoch [85/100], focal_loss:0.0171	, anomaly_loss:0.4885	fnorm_loss:0.0078, a_fnorm_loss:0.0480P:0.58, R:0.92
normal: 0.0716 0.4054  anomaly: 0.0999 0.5925	P:0.20, R:0.09
Pixel Auroc:0.754, Sample Auroc0.893, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0137
 86%|████████▌ | 86/100 [17:06<03:02, 13.00s/it]epoch [86/100], focal_loss:0.0179	, anomaly_loss:0.4938	fnorm_loss:0.0078, a_fnorm_loss:0.0470P:0.59, R:0.90
 87%|████████▋ | 87/100 [17:15<02:33, 11.77s/it]epoch [87/100], focal_loss:0.0170	, anomaly_loss:0.4895	fnorm_loss:0.0076, a_fnorm_loss:0.0491P:0.62, R:0.92
 88%|████████▊ | 88/100 [17:23<02:09, 10.76s/it]epoch [88/100], focal_loss:0.0172	, anomaly_loss:0.4905	fnorm_loss:0.0078, a_fnorm_loss:0.0482P:0.60, R:0.92
 89%|████████▉ | 89/100 [17:32<01:50, 10.04s/it]epoch [89/100], focal_loss:0.0200	, anomaly_loss:0.4910	fnorm_loss:0.0079, a_fnorm_loss:0.0476P:0.61, R:0.90
 90%|█████████ | 90/100 [18:02<02:40, 16.08s/it]epoch [90/100], focal_loss:0.0176	, anomaly_loss:0.4888	fnorm_loss:0.0078, a_fnorm_loss:0.0479P:0.63, R:0.91
normal: 0.0783 0.4125  anomaly: 0.1244 0.6072	P:0.20, R:0.09
Pixel Auroc:0.774, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0159
 91%|█████████ | 91/100 [18:10<02:04, 13.82s/it]epoch [91/100], focal_loss:0.0173	, anomaly_loss:0.4974	fnorm_loss:0.0080, a_fnorm_loss:0.0478P:0.60, R:0.92
 92%|█████████▏| 92/100 [18:19<01:37, 12.20s/it]epoch [92/100], focal_loss:0.0196	, anomaly_loss:0.4937	fnorm_loss:0.0081, a_fnorm_loss:0.0474P:0.61, R:0.90
 93%|█████████▎| 93/100 [18:27<01:17, 11.07s/it]epoch [93/100], focal_loss:0.0162	, anomaly_loss:0.4943	fnorm_loss:0.0077, a_fnorm_loss:0.0479P:0.61, R:0.91
 94%|█████████▍| 94/100 [18:36<01:01, 10.31s/it]epoch [94/100], focal_loss:0.0158	, anomaly_loss:0.4915	fnorm_loss:0.0078, a_fnorm_loss:0.0488P:0.62, R:0.93
 95%|█████████▌| 95/100 [18:58<01:09, 13.90s/it]epoch [95/100], focal_loss:0.0168	, anomaly_loss:0.4889	fnorm_loss:0.0077, a_fnorm_loss:0.0485P:0.66, R:0.92
normal: 0.0684 0.4050  anomaly: 0.0956 0.6007	P:0.20, R:0.09
Pixel Auroc:0.770, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0148
 96%|█████████▌| 96/100 [19:06<00:48, 12.22s/it]epoch [96/100], focal_loss:0.0169	, anomaly_loss:0.4878	fnorm_loss:0.0078, a_fnorm_loss:0.0478P:0.59, R:0.91
 97%|█████████▋| 97/100 [19:15<00:33, 11.05s/it]epoch [97/100], focal_loss:0.0166	, anomaly_loss:0.4892	fnorm_loss:0.0076, a_fnorm_loss:0.0482P:0.67, R:0.91
 98%|█████████▊| 98/100 [19:23<00:20, 10.20s/it]epoch [98/100], focal_loss:0.0200	, anomaly_loss:0.4875	fnorm_loss:0.0079, a_fnorm_loss:0.0493P:0.63, R:0.92
 99%|█████████▉| 99/100 [19:31<00:09,  9.70s/it]epoch [99/100], focal_loss:0.0161	, anomaly_loss:0.4874	fnorm_loss:0.0077, a_fnorm_loss:0.0489P:0.60, R:0.93
100%|██████████| 100/100 [19:54<00:00, 13.61s/it]100%|██████████| 100/100 [19:54<00:00, 11.95s/it]
epoch [100/100], focal_loss:0.0159	, anomaly_loss:0.4856	fnorm_loss:0.0077, a_fnorm_loss:0.0495P:0.63, R:0.92
normal: 0.0718 0.4079  anomaly: 0.0897 0.6074	P:0.20, R:0.09
Pixel Auroc:0.768, Sample Auroc0.888, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0147
training Stubborn Student...
transistor
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:02,  5.07s/it]epoch [1/120], kd_loss:5.1208
  2%|▏         | 2/120 [00:10<10:02,  5.11s/it]epoch [2/120], kd_loss:4.1098
  2%|▎         | 3/120 [00:15<09:57,  5.11s/it]epoch [3/120], kd_loss:4.0060
  3%|▎         | 4/120 [00:20<09:55,  5.13s/it]epoch [4/120], kd_loss:3.9677
  4%|▍         | 5/120 [00:25<09:51,  5.14s/it]epoch [5/120], kd_loss:3.5484
  5%|▌         | 6/120 [00:30<09:48,  5.16s/it]epoch [6/120], kd_loss:3.3959
  6%|▌         | 7/120 [00:36<09:44,  5.17s/it]epoch [7/120], kd_loss:2.8608
  7%|▋         | 8/120 [00:41<09:39,  5.17s/it]epoch [8/120], kd_loss:2.7629
  8%|▊         | 9/120 [00:46<09:33,  5.17s/it]epoch [9/120], kd_loss:2.9937
  8%|▊         | 10/120 [01:04<17:05,  9.32s/it]epoch [10/120], kd_loss:2.6426
normal: 1.5335 1.9304  anomaly: 1.5421 2.3125
thresh: 1.7718958550366597
fpr: 0.06666666666666667 fnr 0.3
Pixel Auroc:0.794, Sample Auroc0.844, Pixel Aupro0.0
  9%|▉         | 11/120 [01:10<14:39,  8.07s/it]epoch [11/120], kd_loss:2.4742
 10%|█         | 12/120 [01:15<12:56,  7.19s/it]epoch [12/120], kd_loss:2.4448
 11%|█         | 13/120 [01:20<11:42,  6.57s/it]epoch [13/120], kd_loss:2.8359
 12%|█▏        | 14/120 [01:25<10:51,  6.15s/it]epoch [14/120], kd_loss:2.5095
 12%|█▎        | 15/120 [01:30<10:15,  5.86s/it]epoch [15/120], kd_loss:2.3554
 13%|█▎        | 16/120 [01:36<09:48,  5.66s/it]epoch [16/120], kd_loss:2.2580
 14%|█▍        | 17/120 [01:41<09:31,  5.55s/it]epoch [17/120], kd_loss:2.2215
 15%|█▌        | 18/120 [01:46<09:17,  5.46s/it]epoch [18/120], kd_loss:2.1222
 16%|█▌        | 19/120 [01:51<09:06,  5.41s/it]epoch [19/120], kd_loss:2.1305
 17%|█▋        | 20/120 [02:11<15:58,  9.59s/it]epoch [20/120], kd_loss:2.0575
normal: 1.1958 1.7695  anomaly: 1.2358 2.1583
thresh: 1.4296418248890954
fpr: 0.21666666666666667 fnr 0.2
Pixel Auroc:0.832, Sample Auroc0.849, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:16<13:40,  8.29s/it]epoch [21/120], kd_loss:1.9964
 18%|█▊        | 22/120 [02:21<12:00,  7.36s/it]epoch [22/120], kd_loss:2.6297
 19%|█▉        | 23/120 [02:26<10:50,  6.70s/it]epoch [23/120], kd_loss:2.2071
 20%|██        | 24/120 [02:32<10:00,  6.25s/it]epoch [24/120], kd_loss:2.0405
 21%|██        | 25/120 [02:37<09:22,  5.92s/it]epoch [25/120], kd_loss:1.9434
 22%|██▏       | 26/120 [02:42<08:56,  5.70s/it]epoch [26/120], kd_loss:1.8769
 22%|██▎       | 27/120 [02:47<08:39,  5.58s/it]epoch [27/120], kd_loss:1.9041
 23%|██▎       | 28/120 [02:52<08:22,  5.46s/it]epoch [28/120], kd_loss:1.8331
 24%|██▍       | 29/120 [02:58<08:10,  5.39s/it]epoch [29/120], kd_loss:2.0146
 25%|██▌       | 30/120 [03:15<13:40,  9.12s/it]epoch [30/120], kd_loss:2.5201
normal: 1.6716 1.9865  anomaly: 1.6884 2.4428
thresh: 1.8435555828902095
fpr: 0.23333333333333334 fnr 0.225
Pixel Auroc:0.778, Sample Auroc0.823, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:21<11:45,  7.93s/it]epoch [31/120], kd_loss:2.4746
 27%|██▋       | 32/120 [03:26<10:24,  7.10s/it]epoch [32/120], kd_loss:2.1374
 28%|██▊       | 33/120 [03:31<09:26,  6.52s/it]epoch [33/120], kd_loss:2.0013
 28%|██▊       | 34/120 [03:36<08:45,  6.11s/it]epoch [34/120], kd_loss:1.9946
 29%|██▉       | 35/120 [03:41<08:15,  5.83s/it]epoch [35/120], kd_loss:1.8901
 30%|███       | 36/120 [03:46<07:54,  5.65s/it]epoch [36/120], kd_loss:1.8076
 31%|███       | 37/120 [03:52<07:40,  5.54s/it]epoch [37/120], kd_loss:1.7755
 32%|███▏      | 38/120 [03:57<07:26,  5.45s/it]epoch [38/120], kd_loss:1.7595
 32%|███▎      | 39/120 [04:02<07:17,  5.40s/it]epoch [39/120], kd_loss:1.7267
 33%|███▎      | 40/120 [04:21<12:22,  9.28s/it]epoch [40/120], kd_loss:1.7465
normal: 1.0460 1.6424  anomaly: 1.0786 2.0443
thresh: 1.2741460811948089
fpr: 0.13333333333333333 fnr 0.3
Pixel Auroc:0.861, Sample Auroc0.841, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:26<10:36,  8.06s/it]epoch [41/120], kd_loss:1.7316
 35%|███▌      | 42/120 [04:31<09:21,  7.20s/it]epoch [42/120], kd_loss:2.0065
 36%|███▌      | 43/120 [04:36<08:28,  6.60s/it]epoch [43/120], kd_loss:1.9372
 37%|███▋      | 44/120 [04:41<07:49,  6.18s/it]epoch [44/120], kd_loss:2.0308
 38%|███▊      | 45/120 [04:47<07:21,  5.89s/it]epoch [45/120], kd_loss:1.8184
 38%|███▊      | 46/120 [04:52<06:59,  5.67s/it]epoch [46/120], kd_loss:2.0014
 39%|███▉      | 47/120 [04:57<06:43,  5.53s/it]epoch [47/120], kd_loss:1.8335
 40%|████      | 48/120 [05:02<06:32,  5.45s/it]epoch [48/120], kd_loss:1.7447
 41%|████      | 49/120 [05:07<06:22,  5.39s/it]epoch [49/120], kd_loss:1.7235
 42%|████▏     | 50/120 [05:27<11:10,  9.58s/it]epoch [50/120], kd_loss:1.7585
normal: 1.0273 1.5348  anomaly: 1.0995 2.0714
thresh: 1.2514462365406536
fpr: 0.18333333333333332 fnr 0.25
Pixel Auroc:0.864, Sample Auroc0.859, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:32<09:30,  8.27s/it]epoch [51/120], kd_loss:1.6777
 43%|████▎     | 52/120 [05:37<08:19,  7.34s/it]epoch [52/120], kd_loss:1.6896
 44%|████▍     | 53/120 [05:42<07:26,  6.66s/it]epoch [53/120], kd_loss:1.6572
 45%|████▌     | 54/120 [05:47<06:50,  6.21s/it]epoch [54/120], kd_loss:1.6598
 46%|████▌     | 55/120 [05:53<06:23,  5.91s/it]epoch [55/120], kd_loss:1.6255
 47%|████▋     | 56/120 [05:58<06:05,  5.70s/it]epoch [56/120], kd_loss:2.3336
 48%|████▊     | 57/120 [06:03<05:50,  5.56s/it]epoch [57/120], kd_loss:1.8149
 48%|████▊     | 58/120 [06:08<05:38,  5.46s/it]epoch [58/120], kd_loss:1.7189
 49%|████▉     | 59/120 [06:14<05:28,  5.38s/it]epoch [59/120], kd_loss:1.7186
 50%|█████     | 60/120 [06:33<09:30,  9.50s/it]epoch [60/120], kd_loss:1.7834
normal: 1.0590 1.5540  anomaly: 1.1365 2.2185
thresh: 1.2187430505622592
fpr: 0.25 fnr 0.125
Pixel Auroc:0.875, Sample Auroc0.878, Pixel Aupro0.0
 51%|█████     | 61/120 [06:38<08:04,  8.21s/it]epoch [61/120], kd_loss:1.7798
 52%|█████▏    | 62/120 [06:43<07:03,  7.31s/it]epoch [62/120], kd_loss:1.6606
 52%|█████▎    | 63/120 [06:48<06:20,  6.68s/it]epoch [63/120], kd_loss:2.5177
 53%|█████▎    | 64/120 [06:53<05:49,  6.24s/it]epoch [64/120], kd_loss:2.6937
 54%|█████▍    | 65/120 [06:59<05:26,  5.93s/it]epoch [65/120], kd_loss:2.0248
 55%|█████▌    | 66/120 [07:04<05:08,  5.72s/it]epoch [66/120], kd_loss:1.8598
 56%|█████▌    | 67/120 [07:09<04:53,  5.53s/it]epoch [67/120], kd_loss:1.8281
 57%|█████▋    | 68/120 [07:14<04:44,  5.47s/it]epoch [68/120], kd_loss:1.8074
 57%|█████▊    | 69/120 [07:20<04:35,  5.40s/it]epoch [69/120], kd_loss:1.7659
 58%|█████▊    | 70/120 [07:38<07:41,  9.24s/it]epoch [70/120], kd_loss:1.8410
normal: 1.0586 1.5619  anomaly: 1.1450 2.0570
thresh: 1.4509930242865638
fpr: 0.06666666666666667 fnr 0.35
Pixel Auroc:0.857, Sample Auroc0.854, Pixel Aupro0.0
 59%|█████▉    | 71/120 [07:43<06:33,  8.03s/it]epoch [71/120], kd_loss:1.7865
 60%|██████    | 72/120 [07:48<05:44,  7.19s/it]epoch [72/120], kd_loss:1.7377
 61%|██████    | 73/120 [07:53<05:09,  6.59s/it]epoch [73/120], kd_loss:1.6971
 62%|██████▏   | 74/120 [07:59<04:43,  6.17s/it]epoch [74/120], kd_loss:1.7000
 62%|██████▎   | 75/120 [08:04<04:24,  5.88s/it]epoch [75/120], kd_loss:1.6472
 63%|██████▎   | 76/120 [08:09<04:10,  5.69s/it]epoch [76/120], kd_loss:1.6777
 64%|██████▍   | 77/120 [08:14<03:58,  5.56s/it]epoch [77/120], kd_loss:1.7772
 65%|██████▌   | 78/120 [08:20<03:49,  5.47s/it]epoch [78/120], kd_loss:1.6604
 66%|██████▌   | 79/120 [08:25<03:41,  5.40s/it]epoch [79/120], kd_loss:1.6174
 67%|██████▋   | 80/120 [08:43<06:11,  9.29s/it]epoch [80/120], kd_loss:1.6063
normal: 0.9289 1.4137  anomaly: 1.0089 2.0267
thresh: 1.3884412663993584
fpr: 0.03333333333333333 fnr 0.35
Pixel Auroc:0.881, Sample Auroc0.860, Pixel Aupro0.0
 68%|██████▊   | 81/120 [08:48<05:13,  8.05s/it]epoch [81/120], kd_loss:1.5971
 68%|██████▊   | 82/120 [08:53<04:33,  7.19s/it]epoch [82/120], kd_loss:1.6659
 69%|██████▉   | 83/120 [08:59<04:03,  6.59s/it]epoch [83/120], kd_loss:1.6245
 70%|███████   | 84/120 [09:04<03:42,  6.17s/it]epoch [84/120], kd_loss:1.5819
 71%|███████   | 85/120 [09:09<03:25,  5.88s/it]epoch [85/120], kd_loss:1.5737
 72%|███████▏  | 86/120 [09:14<03:13,  5.70s/it]epoch [86/120], kd_loss:1.5642
 72%|███████▎  | 87/120 [09:20<03:03,  5.56s/it]epoch [87/120], kd_loss:1.5534
 73%|███████▎  | 88/120 [09:25<02:54,  5.44s/it]epoch [88/120], kd_loss:1.5436
 74%|███████▍  | 89/120 [09:30<02:46,  5.36s/it]epoch [89/120], kd_loss:1.5298
 75%|███████▌  | 90/120 [09:48<04:34,  9.16s/it]epoch [90/120], kd_loss:1.6799
normal: 0.9142 1.4711  anomaly: 0.9696 2.0803
thresh: 1.1760211312341264
fpr: 0.13333333333333333 fnr 0.2
Pixel Auroc:0.883, Sample Auroc0.877, Pixel Aupro0.0
 76%|███████▌  | 91/120 [09:53<03:51,  7.99s/it]epoch [91/120], kd_loss:1.6395
 77%|███████▋  | 92/120 [09:58<03:19,  7.14s/it]epoch [92/120], kd_loss:1.5768
 78%|███████▊  | 93/120 [10:04<02:57,  6.56s/it]epoch [93/120], kd_loss:1.5814
 78%|███████▊  | 94/120 [10:09<02:40,  6.16s/it]epoch [94/120], kd_loss:1.5809
 79%|███████▉  | 95/120 [10:14<02:26,  5.87s/it]epoch [95/120], kd_loss:1.5566
 80%|████████  | 96/120 [10:19<02:15,  5.67s/it]epoch [96/120], kd_loss:1.5364
 81%|████████  | 97/120 [10:24<02:07,  5.53s/it]epoch [97/120], kd_loss:1.5156
 82%|████████▏ | 98/120 [10:30<01:59,  5.44s/it]epoch [98/120], kd_loss:1.5040
 82%|████████▎ | 99/120 [10:35<01:52,  5.37s/it]epoch [99/120], kd_loss:1.4950
 83%|████████▎ | 100/120 [10:53<03:02,  9.13s/it]epoch [100/120], kd_loss:1.4962
normal: 0.8814 1.4583  anomaly: 0.9196 2.0887
thresh: 1.1261796189747908
fpr: 0.13333333333333333 fnr 0.2
Pixel Auroc:0.881, Sample Auroc0.867, Pixel Aupro0.0
 84%|████████▍ | 101/120 [10:58<02:30,  7.93s/it]epoch [101/120], kd_loss:1.4901
 85%|████████▌ | 102/120 [11:03<02:07,  7.10s/it]epoch [102/120], kd_loss:1.4902
 86%|████████▌ | 103/120 [11:08<01:51,  6.54s/it]epoch [103/120], kd_loss:1.4874
 87%|████████▋ | 104/120 [11:13<01:37,  6.12s/it]epoch [104/120], kd_loss:1.4792
 88%|████████▊ | 105/120 [11:19<01:27,  5.84s/it]epoch [105/120], kd_loss:1.4766
 88%|████████▊ | 106/120 [11:24<01:19,  5.64s/it]epoch [106/120], kd_loss:1.4746
 89%|████████▉ | 107/120 [11:29<01:11,  5.50s/it]epoch [107/120], kd_loss:1.4729
 90%|█████████ | 108/120 [11:34<01:05,  5.43s/it]epoch [108/120], kd_loss:1.4714
 91%|█████████ | 109/120 [11:39<00:59,  5.38s/it]epoch [109/120], kd_loss:1.4666
 92%|█████████▏| 110/120 [11:58<01:34,  9.42s/it]epoch [110/120], kd_loss:1.4644
normal: 0.8720 1.4769  anomaly: 0.9560 2.1185
thresh: 1.0940223583450834
fpr: 0.15 fnr 0.175
Pixel Auroc:0.883, Sample Auroc0.885, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:04<01:13,  8.14s/it]epoch [111/120], kd_loss:1.4631
 93%|█████████▎| 112/120 [12:09<00:58,  7.26s/it]epoch [112/120], kd_loss:1.4641
 94%|█████████▍| 113/120 [12:14<00:46,  6.61s/it]epoch [113/120], kd_loss:1.4617
 95%|█████████▌| 114/120 [12:19<00:37,  6.20s/it]epoch [114/120], kd_loss:1.4655
 96%|█████████▌| 115/120 [12:24<00:29,  5.90s/it]epoch [115/120], kd_loss:1.4606
 97%|█████████▋| 116/120 [12:29<00:22,  5.69s/it]epoch [116/120], kd_loss:1.4632
 98%|█████████▊| 117/120 [12:35<00:16,  5.55s/it]epoch [117/120], kd_loss:1.4615
 98%|█████████▊| 118/120 [12:40<00:10,  5.43s/it]epoch [118/120], kd_loss:1.4618
 99%|█████████▉| 119/120 [12:45<00:05,  5.38s/it]epoch [119/120], kd_loss:1.4624
100%|██████████| 120/120 [13:03<00:00,  9.24s/it]100%|██████████| 120/120 [13:03<00:00,  6.53s/it]
epoch [120/120], kd_loss:1.4597
normal: 0.8730 1.4668  anomaly: 0.9154 2.1223
thresh: 1.0969437897160432
fpr: 0.13333333333333333 fnr 0.175
Pixel Auroc:0.884, Sample Auroc0.883, Pixel Aupro0.0
training Advanced Teacher...
zipper
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:25<42:08, 25.54s/it]epoch [1/100], focal_loss:0.0899	, anomaly_loss:0.6202	fnorm_loss:0.0612, a_fnorm_loss:0.0156P:0.02, R:0.03
normal: 0.2546 0.2640  anomaly: 0.2517 0.2651	P:0.00, R:0.00
Pixel Auroc:0.508, Sample Auroc0.404, Pixel Aupro0.0
test_fnorm_loss: 0.0665 test_afnorm_loss: 0.0156
  2%|▏         | 2/100 [00:32<23:45, 14.54s/it]epoch [2/100], focal_loss:0.0839	, anomaly_loss:0.6147	fnorm_loss:0.0602, a_fnorm_loss:0.0150P:0.00, R:0.00
  3%|▎         | 3/100 [00:39<17:57, 11.11s/it]epoch [3/100], focal_loss:0.0778	, anomaly_loss:0.6271	fnorm_loss:0.0545, a_fnorm_loss:0.0134P:0.00, R:0.00
  4%|▍         | 4/100 [00:46<15:10,  9.49s/it]epoch [4/100], focal_loss:0.0746	, anomaly_loss:0.6333	fnorm_loss:0.0514, a_fnorm_loss:0.0126P:0.00, R:0.00
  5%|▌         | 5/100 [01:10<23:14, 14.68s/it]epoch [5/100], focal_loss:0.0725	, anomaly_loss:0.6397	fnorm_loss:0.0488, a_fnorm_loss:0.0120P:0.00, R:0.00
normal: 0.1944 0.2000  anomaly: 0.1930 0.2007	P:0.00, R:0.00
Pixel Auroc:0.531, Sample Auroc0.405, Pixel Aupro0.0
test_fnorm_loss: 0.0506 test_afnorm_loss: 0.0121
  6%|▌         | 6/100 [01:17<18:52, 12.05s/it]epoch [6/100], focal_loss:0.0710	, anomaly_loss:0.6433	fnorm_loss:0.0469, a_fnorm_loss:0.0118P:0.00, R:0.00
  7%|▋         | 7/100 [01:24<16:11, 10.45s/it]epoch [7/100], focal_loss:0.0682	, anomaly_loss:0.6504	fnorm_loss:0.0450, a_fnorm_loss:0.0114P:0.00, R:0.00
  8%|▊         | 8/100 [01:31<14:20,  9.35s/it]epoch [8/100], focal_loss:0.0716	, anomaly_loss:0.6440	fnorm_loss:0.0461, a_fnorm_loss:0.0128P:0.00, R:0.00
  9%|▉         | 9/100 [01:38<13:01,  8.59s/it]epoch [9/100], focal_loss:0.0799	, anomaly_loss:0.6415	fnorm_loss:0.0480, a_fnorm_loss:0.0124P:0.01, R:0.00
 10%|█         | 10/100 [02:03<20:26, 13.63s/it]epoch [10/100], focal_loss:0.0705	, anomaly_loss:0.5812	fnorm_loss:0.0442, a_fnorm_loss:0.0227P:0.11, R:0.24
normal: 0.2584 0.3248  anomaly: 0.2328 0.3349	P:0.07, R:0.15
Pixel Auroc:0.899, Sample Auroc0.686, Pixel Aupro0.0
test_fnorm_loss: 0.0419 test_afnorm_loss: 0.0224
 11%|█         | 11/100 [02:10<17:20, 11.69s/it]epoch [11/100], focal_loss:0.0558	, anomaly_loss:0.5277	fnorm_loss:0.0375, a_fnorm_loss:0.0316P:0.21, R:0.44
 12%|█▏        | 12/100 [02:17<15:12, 10.36s/it]epoch [12/100], focal_loss:0.0633	, anomaly_loss:0.5238	fnorm_loss:0.0343, a_fnorm_loss:0.0303P:0.25, R:0.58
 13%|█▎        | 13/100 [02:24<13:32,  9.34s/it]epoch [13/100], focal_loss:0.0493	, anomaly_loss:0.4914	fnorm_loss:0.0295, a_fnorm_loss:0.0351P:0.29, R:0.64
 14%|█▍        | 14/100 [02:31<12:24,  8.65s/it]epoch [14/100], focal_loss:0.0399	, anomaly_loss:0.4803	fnorm_loss:0.0266, a_fnorm_loss:0.0367P:0.42, R:0.80
 15%|█▌        | 15/100 [03:00<20:59, 14.82s/it]epoch [15/100], focal_loss:0.0455	, anomaly_loss:0.5061	fnorm_loss:0.0260, a_fnorm_loss:0.0344P:0.36, R:0.66
normal: 0.1140 0.2214  anomaly: 0.1154 0.3617	P:0.24, R:0.08
Pixel Auroc:0.963, Sample Auroc0.931, Pixel Aupro0.0
test_fnorm_loss: 0.0251 test_afnorm_loss: 0.0136
 16%|█▌        | 16/100 [03:08<17:31, 12.52s/it]epoch [16/100], focal_loss:0.0371	, anomaly_loss:0.4830	fnorm_loss:0.0238, a_fnorm_loss:0.0363P:0.41, R:0.82
 17%|█▋        | 17/100 [03:15<15:00, 10.86s/it]epoch [17/100], focal_loss:0.0302	, anomaly_loss:0.4622	fnorm_loss:0.0217, a_fnorm_loss:0.0387P:0.42, R:0.90
 18%|█▊        | 18/100 [03:22<13:19,  9.75s/it]epoch [18/100], focal_loss:0.0285	, anomaly_loss:0.4595	fnorm_loss:0.0206, a_fnorm_loss:0.0403P:0.51, R:0.92
 19%|█▉        | 19/100 [03:29<12:02,  8.92s/it]epoch [19/100], focal_loss:0.0275	, anomaly_loss:0.4585	fnorm_loss:0.0193, a_fnorm_loss:0.0398P:0.45, R:0.90
 20%|██        | 20/100 [03:58<19:51, 14.89s/it]epoch [20/100], focal_loss:0.0251	, anomaly_loss:0.4500	fnorm_loss:0.0182, a_fnorm_loss:0.0414P:0.51, R:0.90
normal: 0.0920 0.2475  anomaly: 0.1652 0.5703	P:0.62, R:0.36
Pixel Auroc:0.986, Sample Auroc0.991, Pixel Aupro0.0
test_fnorm_loss: 0.0177 test_afnorm_loss: 0.0226
 21%|██        | 21/100 [04:05<16:38, 12.64s/it]epoch [21/100], focal_loss:0.0289	, anomaly_loss:0.4592	fnorm_loss:0.0178, a_fnorm_loss:0.0407P:0.51, R:0.87
 22%|██▏       | 22/100 [04:12<14:15, 10.96s/it]epoch [22/100], focal_loss:0.0226	, anomaly_loss:0.4481	fnorm_loss:0.0168, a_fnorm_loss:0.0423P:0.49, R:0.91
 23%|██▎       | 23/100 [04:19<12:39,  9.86s/it]epoch [23/100], focal_loss:0.0236	, anomaly_loss:0.4452	fnorm_loss:0.0163, a_fnorm_loss:0.0412P:0.50, R:0.91
 24%|██▍       | 24/100 [04:26<11:26,  9.04s/it]epoch [24/100], focal_loss:0.0261	, anomaly_loss:0.4531	fnorm_loss:0.0159, a_fnorm_loss:0.0420P:0.53, R:0.88
 25%|██▌       | 25/100 [04:51<16:59, 13.60s/it]epoch [25/100], focal_loss:0.0236	, anomaly_loss:0.4469	fnorm_loss:0.0163, a_fnorm_loss:0.0419P:0.53, R:0.89
normal: 0.0610 0.1334  anomaly: 0.0850 0.5591	P:0.54, R:0.23
Pixel Auroc:0.983, Sample Auroc0.990, Pixel Aupro0.0
test_fnorm_loss: 0.0146 test_afnorm_loss: 0.0214
 26%|██▌       | 26/100 [04:58<14:26, 11.71s/it]epoch [26/100], focal_loss:0.0237	, anomaly_loss:0.4447	fnorm_loss:0.0151, a_fnorm_loss:0.0427P:0.53, R:0.90
 27%|██▋       | 27/100 [05:05<12:37, 10.38s/it]epoch [27/100], focal_loss:0.0205	, anomaly_loss:0.4412	fnorm_loss:0.0146, a_fnorm_loss:0.0423P:0.52, R:0.92
 28%|██▊       | 28/100 [05:13<11:22,  9.47s/it]epoch [28/100], focal_loss:0.0185	, anomaly_loss:0.4414	fnorm_loss:0.0138, a_fnorm_loss:0.0438P:0.55, R:0.91
 29%|██▉       | 29/100 [05:20<10:25,  8.81s/it]epoch [29/100], focal_loss:0.0184	, anomaly_loss:0.4391	fnorm_loss:0.0135, a_fnorm_loss:0.0444P:0.59, R:0.92
 30%|███       | 30/100 [05:44<15:30, 13.29s/it]epoch [30/100], focal_loss:0.0188	, anomaly_loss:0.4386	fnorm_loss:0.0133, a_fnorm_loss:0.0446P:0.59, R:0.92
normal: 0.1121 0.2535  anomaly: 0.1866 0.6571	P:0.54, R:0.48
Pixel Auroc:0.988, Sample Auroc0.997, Pixel Aupro0.0
test_fnorm_loss: 0.0131 test_afnorm_loss: 0.0290
 31%|███       | 31/100 [05:51<13:13, 11.50s/it]epoch [31/100], focal_loss:0.0181	, anomaly_loss:0.4312	fnorm_loss:0.0128, a_fnorm_loss:0.0450P:0.57, R:0.93
 32%|███▏      | 32/100 [05:58<11:36, 10.24s/it]epoch [32/100], focal_loss:0.0231	, anomaly_loss:0.4460	fnorm_loss:0.0130, a_fnorm_loss:0.0417P:0.56, R:0.88
 33%|███▎      | 33/100 [06:05<10:18,  9.23s/it]epoch [33/100], focal_loss:0.0188	, anomaly_loss:0.4570	fnorm_loss:0.0127, a_fnorm_loss:0.0401P:0.61, R:0.89
 34%|███▍      | 34/100 [06:12<09:27,  8.60s/it]epoch [34/100], focal_loss:0.0180	, anomaly_loss:0.4354	fnorm_loss:0.0123, a_fnorm_loss:0.0446P:0.57, R:0.93
 35%|███▌      | 35/100 [06:41<15:50, 14.63s/it]epoch [35/100], focal_loss:0.0176	, anomaly_loss:0.4333	fnorm_loss:0.0119, a_fnorm_loss:0.0448P:0.57, R:0.92
normal: 0.0834 0.1821  anomaly: 0.1598 0.6073	P:0.63, R:0.37
Pixel Auroc:0.987, Sample Auroc0.999, Pixel Aupro0.0
test_fnorm_loss: 0.0117 test_afnorm_loss: 0.0248
 36%|███▌      | 36/100 [06:48<13:14, 12.42s/it]epoch [36/100], focal_loss:0.0171	, anomaly_loss:0.4318	fnorm_loss:0.0117, a_fnorm_loss:0.0455P:0.61, R:0.93
 37%|███▋      | 37/100 [06:55<11:24, 10.87s/it]epoch [37/100], focal_loss:0.0248	, anomaly_loss:0.4457	fnorm_loss:0.0119, a_fnorm_loss:0.0433P:0.58, R:0.88
 38%|███▊      | 38/100 [07:03<10:06,  9.79s/it]epoch [38/100], focal_loss:0.0230	, anomaly_loss:0.4624	fnorm_loss:0.0117, a_fnorm_loss:0.0420P:0.53, R:0.81
 39%|███▉      | 39/100 [07:10<09:07,  8.98s/it]epoch [39/100], focal_loss:0.0180	, anomaly_loss:0.4455	fnorm_loss:0.0112, a_fnorm_loss:0.0440P:0.59, R:0.92
 40%|████      | 40/100 [07:34<13:32, 13.55s/it]epoch [40/100], focal_loss:0.0167	, anomaly_loss:0.4309	fnorm_loss:0.0110, a_fnorm_loss:0.0455P:0.62, R:0.94
normal: 0.0498 0.1824  anomaly: 0.1276 0.6333	P:0.61, R:0.36
Pixel Auroc:0.986, Sample Auroc0.996, Pixel Aupro0.0
test_fnorm_loss: 0.0103 test_afnorm_loss: 0.0267
 41%|████      | 41/100 [07:41<11:23, 11.59s/it]epoch [41/100], focal_loss:0.0196	, anomaly_loss:0.4405	fnorm_loss:0.0112, a_fnorm_loss:0.0437P:0.57, R:0.91
 42%|████▏     | 42/100 [07:48<09:58, 10.32s/it]epoch [42/100], focal_loss:0.0164	, anomaly_loss:0.4332	fnorm_loss:0.0108, a_fnorm_loss:0.0455P:0.58, R:0.93
 43%|████▎     | 43/100 [07:56<08:58,  9.45s/it]epoch [43/100], focal_loss:0.0205	, anomaly_loss:0.4448	fnorm_loss:0.0107, a_fnorm_loss:0.0438P:0.57, R:0.91
 44%|████▍     | 44/100 [08:03<08:10,  8.76s/it]epoch [44/100], focal_loss:0.0148	, anomaly_loss:0.4265	fnorm_loss:0.0103, a_fnorm_loss:0.0457P:0.60, R:0.93
 45%|████▌     | 45/100 [08:27<12:21, 13.48s/it]epoch [45/100], focal_loss:0.0177	, anomaly_loss:0.4334	fnorm_loss:0.0102, a_fnorm_loss:0.0457P:0.57, R:0.91
normal: 0.0834 0.2387  anomaly: 0.2050 0.6380	P:0.60, R:0.44
Pixel Auroc:0.988, Sample Auroc0.999, Pixel Aupro0.0
test_fnorm_loss: 0.0099 test_afnorm_loss: 0.0276
 46%|████▌     | 46/100 [08:35<10:31, 11.69s/it]epoch [46/100], focal_loss:0.0132	, anomaly_loss:0.4219	fnorm_loss:0.0099, a_fnorm_loss:0.0467P:0.62, R:0.95
 47%|████▋     | 47/100 [08:42<09:07, 10.33s/it]epoch [47/100], focal_loss:0.0162	, anomaly_loss:0.4293	fnorm_loss:0.0099, a_fnorm_loss:0.0455P:0.58, R:0.92
 48%|████▊     | 48/100 [08:49<08:08,  9.39s/it]epoch [48/100], focal_loss:0.0146	, anomaly_loss:0.4234	fnorm_loss:0.0098, a_fnorm_loss:0.0465P:0.59, R:0.94
 49%|████▉     | 49/100 [08:57<07:27,  8.78s/it]epoch [49/100], focal_loss:0.0156	, anomaly_loss:0.4291	fnorm_loss:0.0098, a_fnorm_loss:0.0454P:0.61, R:0.94
 49%|████▉     | 49/100 [09:20<09:43, 11.45s/it]
epoch [50/100], focal_loss:0.0171	, anomaly_loss:0.4323	fnorm_loss:0.0097, a_fnorm_loss:0.0457P:0.61, R:0.93
normal: 0.0630 0.2008  anomaly: 0.1793 0.6554	P:0.62, R:0.42
Pixel Auroc:0.991, Sample Auroc1.000, Pixel Aupro0.0
test_fnorm_loss: 0.0089 test_afnorm_loss: 0.0253
training Stubborn Student...
zipper
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:13,  5.16s/it]epoch [1/120], kd_loss:4.5362
  2%|▏         | 2/120 [00:10<10:12,  5.19s/it]epoch [2/120], kd_loss:3.5398
  2%|▎         | 3/120 [00:15<10:03,  5.16s/it]epoch [3/120], kd_loss:3.0360
  3%|▎         | 4/120 [00:20<09:57,  5.15s/it]epoch [4/120], kd_loss:2.5782
  4%|▍         | 5/120 [00:25<09:54,  5.17s/it]epoch [5/120], kd_loss:2.6417
  5%|▌         | 6/120 [00:31<09:51,  5.18s/it]epoch [6/120], kd_loss:2.2991
  6%|▌         | 7/120 [00:36<09:48,  5.21s/it]epoch [7/120], kd_loss:2.2260
  7%|▋         | 8/120 [00:41<09:42,  5.20s/it]epoch [8/120], kd_loss:2.0650
  8%|▊         | 9/120 [00:46<09:36,  5.20s/it]epoch [9/120], kd_loss:2.0020
  8%|▊         | 10/120 [01:08<18:46, 10.24s/it]epoch [10/120], kd_loss:2.0295
normal: 1.0641 1.5675  anomaly: 1.2449 2.6572
thresh: 1.4221163586864065
fpr: 0.125 fnr 0.04201680672268908
Pixel Auroc:0.971, Sample Auroc0.977, Pixel Aupro0.0
  9%|▉         | 11/120 [01:13<15:46,  8.68s/it]epoch [11/120], kd_loss:2.3186
 10%|█         | 12/120 [01:18<13:40,  7.59s/it]epoch [12/120], kd_loss:2.0406
 11%|█         | 13/120 [01:23<12:15,  6.87s/it]epoch [13/120], kd_loss:1.9081
 12%|█▏        | 14/120 [01:28<11:16,  6.38s/it]epoch [14/120], kd_loss:1.8668
 12%|█▎        | 15/120 [01:34<10:32,  6.03s/it]epoch [15/120], kd_loss:1.9820
 13%|█▎        | 16/120 [01:39<10:01,  5.78s/it]epoch [16/120], kd_loss:2.0245
 14%|█▍        | 17/120 [01:44<09:37,  5.60s/it]epoch [17/120], kd_loss:1.9123
 15%|█▌        | 18/120 [01:49<09:21,  5.51s/it]epoch [18/120], kd_loss:2.1985
 16%|█▌        | 19/120 [01:55<09:08,  5.43s/it]epoch [19/120], kd_loss:3.4667
 17%|█▋        | 20/120 [02:16<17:01, 10.22s/it]epoch [20/120], kd_loss:3.2414
normal: 2.2847 2.5734  anomaly: 2.3259 2.9616
thresh: 2.404812046260078
fpr: 0.4375 fnr 0.03361344537815126
Pixel Auroc:0.954, Sample Auroc0.928, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:21<14:22,  8.71s/it]epoch [21/120], kd_loss:3.7799
 18%|█▊        | 22/120 [02:26<12:30,  7.66s/it]epoch [22/120], kd_loss:3.4828
 19%|█▉        | 23/120 [02:31<11:10,  6.91s/it]epoch [23/120], kd_loss:3.3822
 20%|██        | 24/120 [02:37<10:13,  6.39s/it]epoch [24/120], kd_loss:2.6332
 21%|██        | 25/120 [02:42<09:33,  6.03s/it]epoch [25/120], kd_loss:2.2219
 22%|██▏       | 26/120 [02:47<09:02,  5.77s/it]epoch [26/120], kd_loss:2.0616
 22%|██▎       | 27/120 [02:52<08:40,  5.60s/it]epoch [27/120], kd_loss:2.0558
 23%|██▎       | 28/120 [02:57<08:24,  5.49s/it]epoch [28/120], kd_loss:2.0502
 24%|██▍       | 29/120 [03:03<08:11,  5.40s/it]epoch [29/120], kd_loss:1.9675
 25%|██▌       | 30/120 [03:25<15:40, 10.45s/it]epoch [30/120], kd_loss:2.5913
normal: 1.4469 1.9056  anomaly: 1.6912 2.5946
thresh: 1.6911991206057877
fpr: 0.3125 fnr 0.0
Pixel Auroc:0.986, Sample Auroc0.979, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:30<13:08,  8.86s/it]epoch [31/120], kd_loss:3.3979
 27%|██▋       | 32/120 [03:35<11:21,  7.74s/it]epoch [32/120], kd_loss:2.2797
 28%|██▊       | 33/120 [03:40<10:06,  6.97s/it]epoch [33/120], kd_loss:2.0802
 28%|██▊       | 34/120 [03:45<09:11,  6.41s/it]epoch [34/120], kd_loss:2.2081
 29%|██▉       | 35/120 [03:51<08:33,  6.04s/it]epoch [35/120], kd_loss:1.9490
 30%|███       | 36/120 [03:56<08:07,  5.80s/it]epoch [36/120], kd_loss:2.7054
 31%|███       | 37/120 [04:01<07:46,  5.63s/it]epoch [37/120], kd_loss:2.7117
 32%|███▏      | 38/120 [04:06<07:32,  5.51s/it]epoch [38/120], kd_loss:1.9820
 32%|███▎      | 39/120 [04:12<07:19,  5.42s/it]epoch [39/120], kd_loss:1.8207
 33%|███▎      | 40/120 [04:32<13:20, 10.01s/it]epoch [40/120], kd_loss:1.8032
normal: 1.2122 1.6522  anomaly: 1.2976 2.3448
thresh: 1.4109468402539513
fpr: 0.34375 fnr 0.03361344537815126
Pixel Auroc:0.959, Sample Auroc0.943, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:37<11:15,  8.54s/it]epoch [41/120], kd_loss:1.8339
 35%|███▌      | 42/120 [04:42<09:45,  7.51s/it]epoch [42/120], kd_loss:1.7116
 36%|███▌      | 43/120 [04:48<08:44,  6.81s/it]epoch [43/120], kd_loss:1.6914
 37%|███▋      | 44/120 [04:53<08:00,  6.33s/it]epoch [44/120], kd_loss:1.7071
 38%|███▊      | 45/120 [04:58<07:28,  5.99s/it]epoch [45/120], kd_loss:1.6820
 38%|███▊      | 46/120 [05:03<07:05,  5.75s/it]epoch [46/120], kd_loss:1.6493
 39%|███▉      | 47/120 [05:08<06:47,  5.58s/it]epoch [47/120], kd_loss:1.7028
 40%|████      | 48/120 [05:14<06:34,  5.48s/it]epoch [48/120], kd_loss:1.6241
 41%|████      | 49/120 [05:19<06:22,  5.39s/it]epoch [49/120], kd_loss:1.9567
 42%|████▏     | 50/120 [05:41<12:02, 10.32s/it]epoch [50/120], kd_loss:2.7765
normal: 1.1090 1.6961  anomaly: 1.3152 2.3608
thresh: 1.4067597234441207
fpr: 0.125 fnr 0.025210084033613446
Pixel Auroc:0.983, Sample Auroc0.972, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:46<10:04,  8.76s/it]epoch [51/120], kd_loss:2.5696
 43%|████▎     | 52/120 [05:51<08:41,  7.67s/it]epoch [52/120], kd_loss:1.8953
 44%|████▍     | 53/120 [05:56<07:43,  6.92s/it]epoch [53/120], kd_loss:1.7267
 45%|████▌     | 54/120 [06:01<06:59,  6.36s/it]epoch [54/120], kd_loss:1.7517
 46%|████▌     | 55/120 [06:06<06:30,  6.00s/it]epoch [55/120], kd_loss:1.7702
 47%|████▋     | 56/120 [06:12<06:08,  5.76s/it]epoch [56/120], kd_loss:1.6535
 48%|████▊     | 57/120 [06:17<05:52,  5.59s/it]epoch [57/120], kd_loss:1.6342
 48%|████▊     | 58/120 [06:22<05:39,  5.48s/it]epoch [58/120], kd_loss:1.5894
 49%|████▉     | 59/120 [06:27<05:29,  5.41s/it]epoch [59/120], kd_loss:1.5571
 50%|█████     | 60/120 [06:48<10:05, 10.08s/it]epoch [60/120], kd_loss:1.5774
normal: 0.9744 1.3791  anomaly: 1.0554 2.3063
thresh: 1.1956346563145324
fpr: 0.25 fnr 0.03361344537815126
Pixel Auroc:0.935, Sample Auroc0.965, Pixel Aupro0.0
 51%|█████     | 61/120 [06:53<08:27,  8.60s/it]epoch [61/120], kd_loss:1.5464
 52%|█████▏    | 62/120 [06:58<07:17,  7.54s/it]epoch [62/120], kd_loss:1.5067
 52%|█████▎    | 63/120 [07:04<06:29,  6.83s/it]epoch [63/120], kd_loss:1.4914
 53%|█████▎    | 64/120 [07:09<05:55,  6.34s/it]epoch [64/120], kd_loss:1.4785
 54%|█████▍    | 65/120 [07:14<05:29,  5.99s/it]epoch [65/120], kd_loss:2.5241
 55%|█████▌    | 66/120 [07:19<05:11,  5.77s/it]epoch [66/120], kd_loss:1.6568
 56%|█████▌    | 67/120 [07:24<04:57,  5.61s/it]epoch [67/120], kd_loss:1.5635
 57%|█████▋    | 68/120 [07:30<04:45,  5.49s/it]epoch [68/120], kd_loss:1.4904
 57%|█████▊    | 69/120 [07:35<04:35,  5.41s/it]epoch [69/120], kd_loss:1.4788
 58%|█████▊    | 70/120 [07:57<08:36, 10.33s/it]epoch [70/120], kd_loss:1.4717
normal: 0.8952 1.6090  anomaly: 1.0059 2.3841
thresh: 1.189093888925419
fpr: 0.21875 fnr 0.04201680672268908
Pixel Auroc:0.940, Sample Auroc0.960, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:02<07:09,  8.77s/it]epoch [71/120], kd_loss:1.4271
 60%|██████    | 72/120 [08:07<06:08,  7.67s/it]epoch [72/120], kd_loss:1.4270
 61%|██████    | 73/120 [08:12<05:25,  6.92s/it]epoch [73/120], kd_loss:1.4061
 62%|██████▏   | 74/120 [08:17<04:54,  6.41s/it]epoch [74/120], kd_loss:1.4145
 62%|██████▎   | 75/120 [08:22<04:32,  6.05s/it]epoch [75/120], kd_loss:1.3890
 63%|██████▎   | 76/120 [08:28<04:14,  5.79s/it]epoch [76/120], kd_loss:1.3640
 64%|██████▍   | 77/120 [08:33<04:01,  5.61s/it]epoch [77/120], kd_loss:1.3469
 65%|██████▌   | 78/120 [08:38<03:50,  5.49s/it]epoch [78/120], kd_loss:1.3448
 66%|██████▌   | 79/120 [08:43<03:42,  5.42s/it]epoch [79/120], kd_loss:1.3251
 67%|██████▋   | 80/120 [09:05<06:47, 10.19s/it]epoch [80/120], kd_loss:1.3090
normal: 0.8297 1.2154  anomaly: 0.9355 2.2382
thresh: 1.0960231879395654
fpr: 0.03125 fnr 0.04201680672268908
Pixel Auroc:0.939, Sample Auroc0.986, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:10<05:39,  8.70s/it]epoch [81/120], kd_loss:1.3118
 68%|██████▊   | 82/120 [09:15<04:50,  7.64s/it]epoch [82/120], kd_loss:1.3128
 69%|██████▉   | 83/120 [09:20<04:14,  6.89s/it]epoch [83/120], kd_loss:1.2887
 70%|███████   | 84/120 [09:25<03:49,  6.37s/it]epoch [84/120], kd_loss:1.2785
 71%|███████   | 85/120 [09:31<03:30,  6.02s/it]epoch [85/120], kd_loss:1.2863
 72%|███████▏  | 86/120 [09:36<03:16,  5.77s/it]epoch [86/120], kd_loss:1.2825
 72%|███████▎  | 87/120 [09:41<03:04,  5.60s/it]epoch [87/120], kd_loss:1.2723
 73%|███████▎  | 88/120 [09:46<02:55,  5.48s/it]epoch [88/120], kd_loss:1.2908
 74%|███████▍  | 89/120 [09:51<02:46,  5.38s/it]epoch [89/120], kd_loss:1.2606
 75%|███████▌  | 90/120 [10:14<05:15, 10.51s/it]epoch [90/120], kd_loss:1.2651
normal: 0.8080 1.1003  anomaly: 0.8970 2.3185
thresh: 1.0835783691822765
fpr: 0.03125 fnr 0.03361344537815126
Pixel Auroc:0.941, Sample Auroc0.988, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:19<04:18,  8.90s/it]epoch [91/120], kd_loss:1.2723
 77%|███████▋  | 92/120 [10:24<03:37,  7.77s/it]epoch [92/120], kd_loss:1.2476
 78%|███████▊  | 93/120 [10:29<03:08,  7.00s/it]epoch [93/120], kd_loss:1.2680
 78%|███████▊  | 94/120 [10:34<02:47,  6.45s/it]epoch [94/120], kd_loss:1.2352
 79%|███████▉  | 95/120 [10:40<02:31,  6.07s/it]epoch [95/120], kd_loss:1.2366
 80%|████████  | 96/120 [10:45<02:19,  5.79s/it]epoch [96/120], kd_loss:1.2356
 81%|████████  | 97/120 [10:50<02:09,  5.61s/it]epoch [97/120], kd_loss:1.2155
 82%|████████▏ | 98/120 [10:55<02:00,  5.48s/it]epoch [98/120], kd_loss:1.2075
 82%|████████▎ | 99/120 [11:00<01:53,  5.39s/it]epoch [99/120], kd_loss:1.2268
 83%|████████▎ | 100/120 [11:23<03:29, 10.46s/it]epoch [100/120], kd_loss:1.2147
normal: 0.7663 1.0290  anomaly: 0.8782 2.2399
thresh: 1.0256009051233437
fpr: 0.03125 fnr 0.04201680672268908
Pixel Auroc:0.946, Sample Auroc0.991, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:28<02:48,  8.86s/it]epoch [101/120], kd_loss:1.2077
 85%|████████▌ | 102/120 [11:33<02:19,  7.73s/it]epoch [102/120], kd_loss:1.2133
 86%|████████▌ | 103/120 [11:38<01:58,  6.96s/it]epoch [103/120], kd_loss:1.2176
 87%|████████▋ | 104/120 [11:43<01:42,  6.42s/it]epoch [104/120], kd_loss:1.2084
 88%|████████▊ | 105/120 [11:48<01:30,  6.05s/it]epoch [105/120], kd_loss:1.2041
 88%|████████▊ | 106/120 [11:53<01:21,  5.79s/it]epoch [106/120], kd_loss:1.2009
 89%|████████▉ | 107/120 [11:59<01:12,  5.59s/it]epoch [107/120], kd_loss:1.1991
 90%|█████████ | 108/120 [12:04<01:05,  5.48s/it]epoch [108/120], kd_loss:1.1927
 91%|█████████ | 109/120 [12:09<00:59,  5.40s/it]epoch [109/120], kd_loss:1.1906
 92%|█████████▏| 110/120 [12:31<01:42, 10.24s/it]epoch [110/120], kd_loss:1.1899
normal: 0.7528 1.0272  anomaly: 0.8795 2.2357
thresh: 1.0181475070323451
fpr: 0.03125 fnr 0.03361344537815126
Pixel Auroc:0.946, Sample Auroc0.991, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:36<01:18,  8.69s/it]epoch [111/120], kd_loss:1.1890
 93%|█████████▎| 112/120 [12:41<01:01,  7.63s/it]epoch [112/120], kd_loss:1.1886
 94%|█████████▍| 113/120 [12:46<00:48,  6.90s/it]epoch [113/120], kd_loss:1.1879
 95%|█████████▌| 114/120 [12:51<00:38,  6.38s/it]epoch [114/120], kd_loss:1.1875
 96%|█████████▌| 115/120 [12:56<00:30,  6.03s/it]epoch [115/120], kd_loss:1.1871
 97%|█████████▋| 116/120 [13:02<00:23,  5.78s/it]epoch [116/120], kd_loss:1.1860
 98%|█████████▊| 117/120 [13:07<00:16,  5.60s/it]epoch [117/120], kd_loss:1.1858
 98%|█████████▊| 118/120 [13:12<00:10,  5.50s/it]epoch [118/120], kd_loss:1.1853
 99%|█████████▉| 119/120 [13:17<00:05,  5.42s/it]epoch [119/120], kd_loss:1.1851
100%|██████████| 120/120 [13:39<00:00, 10.47s/it]100%|██████████| 120/120 [13:39<00:00,  6.83s/it]
epoch [120/120], kd_loss:1.1843
normal: 0.7436 1.0425  anomaly: 0.8788 2.2310
thresh: 1.0144568482713
fpr: 0.03125 fnr 0.03361344537815126
Pixel Auroc:0.946, Sample Auroc0.992, Pixel Aupro0.0
