training Advanced Teacher...
bagel
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:21<36:02, 21.85s/it]epoch [1/100], focal_loss:0.0811	, anomaly_loss:0.5660	fnorm_loss:0.0677, a_fnorm_loss:0.0154P:0.01, R:0.01
normal: 0.2551 0.2606  anomaly: 0.2537 0.2615	P:0.00, R:0.00
Pixel Auroc:0.513, Sample Auroc0.347, Pixel Aupro0.0
test_fnorm_loss: 0.0681 test_afnorm_loss: 0.0192
  2%|▏         | 2/100 [00:28<21:26, 13.13s/it]epoch [2/100], focal_loss:0.0682	, anomaly_loss:0.5633	fnorm_loss:0.0636, a_fnorm_loss:0.0143P:0.00, R:0.00
  3%|▎         | 3/100 [00:36<17:06, 10.58s/it]epoch [3/100], focal_loss:0.0617	, anomaly_loss:0.5896	fnorm_loss:0.0566, a_fnorm_loss:0.0131P:0.00, R:0.00
  4%|▍         | 4/100 [00:43<14:40,  9.17s/it]epoch [4/100], focal_loss:0.0571	, anomaly_loss:0.6001	fnorm_loss:0.0519, a_fnorm_loss:0.0120P:0.00, R:0.00
  5%|▌         | 5/100 [01:02<20:26, 12.91s/it]epoch [5/100], focal_loss:0.0552	, anomaly_loss:0.6127	fnorm_loss:0.0483, a_fnorm_loss:0.0111P:0.00, R:0.00
normal: 0.1790 0.1819  anomaly: 0.1780 0.1822	P:0.00, R:0.00
Pixel Auroc:0.524, Sample Auroc0.342, Pixel Aupro0.0
test_fnorm_loss: 0.0474 test_afnorm_loss: 0.0136
  6%|▌         | 6/100 [01:10<17:11, 10.97s/it]epoch [6/100], focal_loss:0.0516	, anomaly_loss:0.6125	fnorm_loss:0.0472, a_fnorm_loss:0.0112P:0.00, R:0.02
  7%|▋         | 7/100 [01:17<15:09,  9.78s/it]epoch [7/100], focal_loss:0.0531	, anomaly_loss:0.6207	fnorm_loss:0.0442, a_fnorm_loss:0.0108P:0.00, R:0.00
  8%|▊         | 8/100 [01:25<13:56,  9.09s/it]epoch [8/100], focal_loss:0.0493	, anomaly_loss:0.5499	fnorm_loss:0.0433, a_fnorm_loss:0.0214P:0.07, R:0.20
  9%|▉         | 9/100 [01:32<13:04,  8.62s/it]epoch [9/100], focal_loss:0.0454	, anomaly_loss:0.5093	fnorm_loss:0.0382, a_fnorm_loss:0.0300P:0.11, R:0.30
 10%|█         | 10/100 [02:00<21:49, 14.55s/it]epoch [10/100], focal_loss:0.0407	, anomaly_loss:0.5054	fnorm_loss:0.0345, a_fnorm_loss:0.0325P:0.10, R:0.30
normal: 0.1375 0.2534  anomaly: 0.1593 0.2825	P:0.12, R:0.17
Pixel Auroc:0.980, Sample Auroc0.743, Pixel Aupro0.0
test_fnorm_loss: 0.0327 test_afnorm_loss: 0.0325
 11%|█         | 11/100 [02:08<18:21, 12.38s/it]epoch [11/100], focal_loss:0.0410	, anomaly_loss:0.5013	fnorm_loss:0.0323, a_fnorm_loss:0.0321P:0.11, R:0.30
 12%|█▏        | 12/100 [02:15<15:58, 10.89s/it]epoch [12/100], focal_loss:0.0398	, anomaly_loss:0.4900	fnorm_loss:0.0309, a_fnorm_loss:0.0328P:0.13, R:0.35
 13%|█▎        | 13/100 [02:22<14:12,  9.80s/it]epoch [13/100], focal_loss:0.0377	, anomaly_loss:0.4895	fnorm_loss:0.0309, a_fnorm_loss:0.0324P:0.17, R:0.36
 14%|█▍        | 14/100 [02:30<13:00,  9.07s/it]epoch [14/100], focal_loss:0.0350	, anomaly_loss:0.4751	fnorm_loss:0.0282, a_fnorm_loss:0.0335P:0.20, R:0.47
 15%|█▌        | 15/100 [02:55<19:42, 13.91s/it]epoch [15/100], focal_loss:0.0300	, anomaly_loss:0.4269	fnorm_loss:0.0257, a_fnorm_loss:0.0378P:0.42, R:0.79
normal: 0.3192 0.5297  anomaly: 0.3528 0.5511	P:0.12, R:0.64
Pixel Auroc:0.981, Sample Auroc0.682, Pixel Aupro0.0
test_fnorm_loss: 0.0248 test_afnorm_loss: 0.0454
 16%|█▌        | 16/100 [03:02<16:43, 11.95s/it]epoch [16/100], focal_loss:0.0267	, anomaly_loss:0.3969	fnorm_loss:0.0237, a_fnorm_loss:0.0396P:0.35, R:0.88
 17%|█▋        | 17/100 [03:10<14:37, 10.58s/it]epoch [17/100], focal_loss:0.0243	, anomaly_loss:0.3856	fnorm_loss:0.0220, a_fnorm_loss:0.0397P:0.39, R:0.91
 18%|█▊        | 18/100 [03:18<13:24,  9.81s/it]epoch [18/100], focal_loss:0.0212	, anomaly_loss:0.3784	fnorm_loss:0.0205, a_fnorm_loss:0.0409P:0.40, R:0.90
 19%|█▉        | 19/100 [03:26<12:29,  9.25s/it]epoch [19/100], focal_loss:0.0223	, anomaly_loss:0.3929	fnorm_loss:0.0196, a_fnorm_loss:0.0401P:0.38, R:0.88
 20%|██        | 20/100 [03:50<18:33, 13.92s/it]epoch [20/100], focal_loss:0.0251	, anomaly_loss:0.4043	fnorm_loss:0.0197, a_fnorm_loss:0.0369P:0.46, R:0.83
normal: 0.1907 0.4275  anomaly: 0.2183 0.5764	P:0.27, R:0.51
Pixel Auroc:0.984, Sample Auroc0.763, Pixel Aupro0.0
test_fnorm_loss: 0.0182 test_afnorm_loss: 0.0376
 21%|██        | 21/100 [03:58<15:48, 12.00s/it]epoch [21/100], focal_loss:0.0212	, anomaly_loss:0.3835	fnorm_loss:0.0183, a_fnorm_loss:0.0419P:0.39, R:0.89
 22%|██▏       | 22/100 [04:06<13:56, 10.72s/it]epoch [22/100], focal_loss:0.0168	, anomaly_loss:0.3721	fnorm_loss:0.0169, a_fnorm_loss:0.0431P:0.48, R:0.91
 23%|██▎       | 23/100 [04:13<12:27,  9.71s/it]epoch [23/100], focal_loss:0.0164	, anomaly_loss:0.3648	fnorm_loss:0.0162, a_fnorm_loss:0.0432P:0.47, R:0.92
 24%|██▍       | 24/100 [04:20<11:19,  8.94s/it]epoch [24/100], focal_loss:0.0168	, anomaly_loss:0.3680	fnorm_loss:0.0156, a_fnorm_loss:0.0439P:0.47, R:0.89
 25%|██▌       | 25/100 [04:40<15:17, 12.23s/it]epoch [25/100], focal_loss:0.0189	, anomaly_loss:0.3799	fnorm_loss:0.0155, a_fnorm_loss:0.0406P:0.44, R:0.87
normal: 0.1588 0.4043  anomaly: 0.2014 0.6077	P:0.25, R:0.50
Pixel Auroc:0.982, Sample Auroc0.782, Pixel Aupro0.0
test_fnorm_loss: 0.0147 test_afnorm_loss: 0.0358
 26%|██▌       | 26/100 [04:48<13:25, 10.89s/it]epoch [26/100], focal_loss:0.0146	, anomaly_loss:0.3622	fnorm_loss:0.0145, a_fnorm_loss:0.0460P:0.49, R:0.94
 27%|██▋       | 27/100 [04:55<12:04,  9.92s/it]epoch [27/100], focal_loss:0.0209	, anomaly_loss:0.3832	fnorm_loss:0.0145, a_fnorm_loss:0.0416P:0.46, R:0.83
 28%|██▊       | 28/100 [05:03<11:02,  9.20s/it]epoch [28/100], focal_loss:0.0160	, anomaly_loss:0.3985	fnorm_loss:0.0152, a_fnorm_loss:0.0434P:0.45, R:0.82
 29%|██▉       | 29/100 [05:11<10:23,  8.78s/it]epoch [29/100], focal_loss:0.0154	, anomaly_loss:0.3682	fnorm_loss:0.0137, a_fnorm_loss:0.0457P:0.47, R:0.93
 30%|███       | 30/100 [05:31<14:11, 12.17s/it]epoch [30/100], focal_loss:0.0124	, anomaly_loss:0.3587	fnorm_loss:0.0130, a_fnorm_loss:0.0457P:0.50, R:0.93
normal: 0.1050 0.3554  anomaly: 0.1042 0.5775	P:0.24, R:0.24
Pixel Auroc:0.979, Sample Auroc0.713, Pixel Aupro0.0
test_fnorm_loss: 0.0124 test_afnorm_loss: 0.0251
 31%|███       | 31/100 [05:38<12:22, 10.76s/it]epoch [31/100], focal_loss:0.0132	, anomaly_loss:0.3723	fnorm_loss:0.0127, a_fnorm_loss:0.0451P:0.52, R:0.91
 32%|███▏      | 32/100 [05:46<11:02,  9.75s/it]epoch [32/100], focal_loss:0.0161	, anomaly_loss:0.3715	fnorm_loss:0.0128, a_fnorm_loss:0.0437P:0.53, R:0.89
 33%|███▎      | 33/100 [05:53<10:05,  9.04s/it]epoch [33/100], focal_loss:0.0220	, anomaly_loss:0.4033	fnorm_loss:0.0142, a_fnorm_loss:0.0444P:0.49, R:0.76
 34%|███▍      | 34/100 [06:01<09:27,  8.60s/it]epoch [34/100], focal_loss:0.0146	, anomaly_loss:0.3670	fnorm_loss:0.0124, a_fnorm_loss:0.0457P:0.46, R:0.92
 35%|███▌      | 35/100 [06:20<12:54, 11.92s/it]epoch [35/100], focal_loss:0.0130	, anomaly_loss:0.3669	fnorm_loss:0.0121, a_fnorm_loss:0.0463P:0.55, R:0.93
normal: 0.0484 0.1796  anomaly: 0.0505 0.5396	P:0.13, R:0.08
Pixel Auroc:0.978, Sample Auroc0.762, Pixel Aupro0.0
test_fnorm_loss: 0.0110 test_afnorm_loss: 0.0151
 36%|███▌      | 36/100 [06:28<11:24, 10.69s/it]epoch [36/100], focal_loss:0.0111	, anomaly_loss:0.3505	fnorm_loss:0.0115, a_fnorm_loss:0.0474P:0.52, R:0.93
 37%|███▋      | 37/100 [06:35<10:10,  9.68s/it]epoch [37/100], focal_loss:0.0109	, anomaly_loss:0.3480	fnorm_loss:0.0112, a_fnorm_loss:0.0488P:0.56, R:0.94
 38%|███▊      | 38/100 [06:43<09:16,  8.97s/it]epoch [38/100], focal_loss:0.0122	, anomaly_loss:0.3554	fnorm_loss:0.0111, a_fnorm_loss:0.0479P:0.54, R:0.92
 39%|███▉      | 39/100 [06:51<08:48,  8.67s/it]epoch [39/100], focal_loss:0.0123	, anomaly_loss:0.3504	fnorm_loss:0.0110, a_fnorm_loss:0.0475P:0.55, R:0.93
 40%|████      | 40/100 [07:12<12:26, 12.44s/it]epoch [40/100], focal_loss:0.0126	, anomaly_loss:0.3619	fnorm_loss:0.0109, a_fnorm_loss:0.0467P:0.54, R:0.92
normal: 0.0706 0.2576  anomaly: 0.0724 0.5675	P:0.19, R:0.13
Pixel Auroc:0.977, Sample Auroc0.737, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0196
 41%|████      | 41/100 [07:20<10:55, 11.11s/it]epoch [41/100], focal_loss:0.0136	, anomaly_loss:0.3557	fnorm_loss:0.0108, a_fnorm_loss:0.0469P:0.59, R:0.93
 42%|████▏     | 42/100 [07:28<09:46, 10.12s/it]epoch [42/100], focal_loss:0.0115	, anomaly_loss:0.3595	fnorm_loss:0.0104, a_fnorm_loss:0.0463P:0.52, R:0.91
 43%|████▎     | 43/100 [07:35<08:53,  9.36s/it]epoch [43/100], focal_loss:0.0107	, anomaly_loss:0.3548	fnorm_loss:0.0103, a_fnorm_loss:0.0492P:0.56, R:0.93
 44%|████▍     | 44/100 [07:43<08:11,  8.78s/it]epoch [44/100], focal_loss:0.0173	, anomaly_loss:0.3818	fnorm_loss:0.0110, a_fnorm_loss:0.0396P:0.51, R:0.85
 45%|████▌     | 45/100 [08:04<11:25, 12.47s/it]epoch [45/100], focal_loss:0.0110	, anomaly_loss:0.3566	fnorm_loss:0.0101, a_fnorm_loss:0.0449P:0.55, R:0.93
normal: 0.0461 0.1574  anomaly: 0.0467 0.5465	P:0.15, R:0.07
Pixel Auroc:0.976, Sample Auroc0.748, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0120
 46%|████▌     | 46/100 [08:11<09:54, 11.00s/it]epoch [46/100], focal_loss:0.0122	, anomaly_loss:0.3569	fnorm_loss:0.0101, a_fnorm_loss:0.0465P:0.52, R:0.90
 47%|████▋     | 47/100 [08:18<08:38,  9.79s/it]epoch [47/100], focal_loss:0.0111	, anomaly_loss:0.3527	fnorm_loss:0.0098, a_fnorm_loss:0.0480P:0.59, R:0.93
 48%|████▊     | 48/100 [08:26<07:56,  9.17s/it]epoch [48/100], focal_loss:0.0098	, anomaly_loss:0.3419	fnorm_loss:0.0096, a_fnorm_loss:0.0499P:0.54, R:0.94
 49%|████▉     | 49/100 [08:33<07:16,  8.55s/it]epoch [49/100], focal_loss:0.0106	, anomaly_loss:0.3427	fnorm_loss:0.0095, a_fnorm_loss:0.0497P:0.58, R:0.93
 50%|█████     | 50/100 [08:54<10:04, 12.09s/it]epoch [50/100], focal_loss:0.0128	, anomaly_loss:0.3582	fnorm_loss:0.0096, a_fnorm_loss:0.0473P:0.54, R:0.90
normal: 0.1347 0.3805  anomaly: 0.1349 0.6378	P:0.24, R:0.37
Pixel Auroc:0.975, Sample Auroc0.731, Pixel Aupro0.0
test_fnorm_loss: 0.0090 test_afnorm_loss: 0.0319
 51%|█████     | 51/100 [09:01<08:45, 10.72s/it]epoch [51/100], focal_loss:0.0115	, anomaly_loss:0.3526	fnorm_loss:0.0095, a_fnorm_loss:0.0475P:0.52, R:0.93
 52%|█████▏    | 52/100 [09:09<07:52,  9.85s/it]epoch [52/100], focal_loss:0.0118	, anomaly_loss:0.3488	fnorm_loss:0.0094, a_fnorm_loss:0.0470P:0.56, R:0.93
 53%|█████▎    | 53/100 [09:16<07:09,  9.13s/it]epoch [53/100], focal_loss:0.0145	, anomaly_loss:0.3641	fnorm_loss:0.0097, a_fnorm_loss:0.0471P:0.53, R:0.87
 54%|█████▍    | 54/100 [09:24<06:36,  8.63s/it]epoch [54/100], focal_loss:0.0127	, anomaly_loss:0.3847	fnorm_loss:0.0097, a_fnorm_loss:0.0428P:0.54, R:0.86
 55%|█████▌    | 55/100 [09:45<09:15, 12.35s/it]epoch [55/100], focal_loss:0.0105	, anomaly_loss:0.3589	fnorm_loss:0.0091, a_fnorm_loss:0.0486P:0.50, R:0.93
normal: 0.0414 0.2351  anomaly: 0.0690 0.6190	P:0.23, R:0.21
Pixel Auroc:0.975, Sample Auroc0.767, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0291
 56%|█████▌    | 56/100 [09:53<08:02, 10.96s/it]epoch [56/100], focal_loss:0.0120	, anomaly_loss:0.3553	fnorm_loss:0.0090, a_fnorm_loss:0.0483P:0.54, R:0.92
 57%|█████▋    | 57/100 [10:01<07:12, 10.06s/it]epoch [57/100], focal_loss:0.0156	, anomaly_loss:0.3688	fnorm_loss:0.0096, a_fnorm_loss:0.0460P:0.55, R:0.89
 58%|█████▊    | 58/100 [10:09<06:37,  9.47s/it]epoch [58/100], focal_loss:0.0112	, anomaly_loss:0.3419	fnorm_loss:0.0089, a_fnorm_loss:0.0496P:0.57, R:0.94
 59%|█████▉    | 59/100 [10:16<06:03,  8.85s/it]epoch [59/100], focal_loss:0.0094	, anomaly_loss:0.3494	fnorm_loss:0.0085, a_fnorm_loss:0.0505P:0.61, R:0.94
 60%|██████    | 60/100 [10:36<08:07, 12.19s/it]epoch [60/100], focal_loss:0.0101	, anomaly_loss:0.3422	fnorm_loss:0.0087, a_fnorm_loss:0.0493P:0.56, R:0.93
normal: 0.0623 0.3294  anomaly: 0.0586 0.6198	P:0.25, R:0.22
Pixel Auroc:0.976, Sample Auroc0.765, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0266
 61%|██████    | 61/100 [10:43<06:59, 10.76s/it]epoch [61/100], focal_loss:0.0108	, anomaly_loss:0.3386	fnorm_loss:0.0085, a_fnorm_loss:0.0494P:0.58, R:0.94
 62%|██████▏   | 62/100 [10:51<06:14,  9.85s/it]epoch [62/100], focal_loss:0.0094	, anomaly_loss:0.3439	fnorm_loss:0.0083, a_fnorm_loss:0.0480P:0.55, R:0.91
 63%|██████▎   | 63/100 [10:59<05:38,  9.16s/it]epoch [63/100], focal_loss:0.0112	, anomaly_loss:0.3480	fnorm_loss:0.0085, a_fnorm_loss:0.0501P:0.55, R:0.93
 64%|██████▍   | 64/100 [11:06<05:11,  8.66s/it]epoch [64/100], focal_loss:0.0095	, anomaly_loss:0.3453	fnorm_loss:0.0082, a_fnorm_loss:0.0487P:0.54, R:0.93
 65%|██████▌   | 65/100 [11:26<07:03, 12.10s/it]epoch [65/100], focal_loss:0.0092	, anomaly_loss:0.3422	fnorm_loss:0.0081, a_fnorm_loss:0.0508P:0.59, R:0.94
normal: 0.0524 0.2575  anomaly: 0.0437 0.5819	P:0.20, R:0.13
Pixel Auroc:0.973, Sample Auroc0.727, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0183
 66%|██████▌   | 66/100 [11:34<06:04, 10.73s/it]epoch [66/100], focal_loss:0.0109	, anomaly_loss:0.3512	fnorm_loss:0.0083, a_fnorm_loss:0.0488P:0.55, R:0.93
 67%|██████▋   | 67/100 [11:41<05:21,  9.75s/it]epoch [67/100], focal_loss:0.0107	, anomaly_loss:0.3451	fnorm_loss:0.0083, a_fnorm_loss:0.0485P:0.62, R:0.93
 68%|██████▊   | 68/100 [11:49<04:49,  9.05s/it]epoch [68/100], focal_loss:0.0105	, anomaly_loss:0.3420	fnorm_loss:0.0083, a_fnorm_loss:0.0487P:0.50, R:0.92
 69%|██████▉   | 69/100 [11:57<04:29,  8.70s/it]epoch [69/100], focal_loss:0.0102	, anomaly_loss:0.3492	fnorm_loss:0.0081, a_fnorm_loss:0.0490P:0.57, R:0.91
 70%|███████   | 70/100 [12:17<06:08, 12.27s/it]epoch [70/100], focal_loss:0.0094	, anomaly_loss:0.3406	fnorm_loss:0.0079, a_fnorm_loss:0.0500P:0.55, R:0.93
normal: 0.0653 0.3174  anomaly: 0.0903 0.6442	P:0.21, R:0.26
Pixel Auroc:0.973, Sample Auroc0.681, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0292
 71%|███████   | 71/100 [12:25<05:14, 10.85s/it]epoch [71/100], focal_loss:0.0120	, anomaly_loss:0.3452	fnorm_loss:0.0081, a_fnorm_loss:0.0500P:0.61, R:0.93
 72%|███████▏  | 72/100 [12:33<04:40, 10.03s/it]epoch [72/100], focal_loss:0.0107	, anomaly_loss:0.3482	fnorm_loss:0.0079, a_fnorm_loss:0.0495P:0.57, R:0.93
 73%|███████▎  | 73/100 [12:40<04:09,  9.25s/it]epoch [73/100], focal_loss:0.0086	, anomaly_loss:0.3423	fnorm_loss:0.0076, a_fnorm_loss:0.0501P:0.60, R:0.93
 74%|███████▍  | 74/100 [12:48<03:49,  8.84s/it]epoch [74/100], focal_loss:0.0115	, anomaly_loss:0.3414	fnorm_loss:0.0080, a_fnorm_loss:0.0508P:0.57, R:0.94
 75%|███████▌  | 75/100 [13:08<05:03, 12.15s/it]epoch [75/100], focal_loss:0.0101	, anomaly_loss:0.3526	fnorm_loss:0.0079, a_fnorm_loss:0.0483P:0.55, R:0.92
normal: 0.0836 0.3739  anomaly: 0.0856 0.6402	P:0.23, R:0.29
Pixel Auroc:0.976, Sample Auroc0.742, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0324
 76%|███████▌  | 76/100 [13:16<04:20, 10.84s/it]epoch [76/100], focal_loss:0.0110	, anomaly_loss:0.3405	fnorm_loss:0.0079, a_fnorm_loss:0.0502P:0.59, R:0.95
 77%|███████▋  | 77/100 [13:23<03:46,  9.83s/it]epoch [77/100], focal_loss:0.0093	, anomaly_loss:0.3383	fnorm_loss:0.0076, a_fnorm_loss:0.0488P:0.57, R:0.94
 78%|███████▊  | 78/100 [13:31<03:20,  9.13s/it]epoch [78/100], focal_loss:0.0108	, anomaly_loss:0.3446	fnorm_loss:0.0078, a_fnorm_loss:0.0489P:0.53, R:0.95
 79%|███████▉  | 79/100 [13:38<03:00,  8.58s/it]epoch [79/100], focal_loss:0.0100	, anomaly_loss:0.3476	fnorm_loss:0.0077, a_fnorm_loss:0.0503P:0.53, R:0.93
 80%|████████  | 80/100 [13:59<04:05, 12.29s/it]epoch [80/100], focal_loss:0.0086	, anomaly_loss:0.3403	fnorm_loss:0.0074, a_fnorm_loss:0.0501P:0.59, R:0.95
normal: 0.0868 0.3559  anomaly: 0.1109 0.6759	P:0.21, R:0.31
Pixel Auroc:0.971, Sample Auroc0.684, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0352
 81%|████████  | 81/100 [14:07<03:29, 11.02s/it]epoch [81/100], focal_loss:0.0088	, anomaly_loss:0.3302	fnorm_loss:0.0074, a_fnorm_loss:0.0512P:0.56, R:0.95
 82%|████████▏ | 82/100 [14:15<03:00, 10.01s/it]epoch [82/100], focal_loss:0.0102	, anomaly_loss:0.3432	fnorm_loss:0.0076, a_fnorm_loss:0.0502P:0.49, R:0.93
 83%|████████▎ | 83/100 [14:23<02:39,  9.37s/it]epoch [83/100], focal_loss:0.0088	, anomaly_loss:0.3397	fnorm_loss:0.0074, a_fnorm_loss:0.0509P:0.57, R:0.95
 84%|████████▍ | 84/100 [14:31<02:23,  8.95s/it]epoch [84/100], focal_loss:0.0093	, anomaly_loss:0.3442	fnorm_loss:0.0075, a_fnorm_loss:0.0494P:0.54, R:0.94
 85%|████████▌ | 85/100 [14:52<03:07, 12.52s/it]epoch [85/100], focal_loss:0.0123	, anomaly_loss:0.3585	fnorm_loss:0.0078, a_fnorm_loss:0.0495P:0.56, R:0.90
normal: 0.1130 0.3675  anomaly: 0.1516 0.6500	P:0.20, R:0.29
Pixel Auroc:0.967, Sample Auroc0.711, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0322
 86%|████████▌ | 86/100 [14:59<02:34, 11.05s/it]epoch [86/100], focal_loss:0.0088	, anomaly_loss:0.3388	fnorm_loss:0.0076, a_fnorm_loss:0.0513P:0.59, R:0.95
 87%|████████▋ | 87/100 [15:07<02:09,  9.96s/it]epoch [87/100], focal_loss:0.0088	, anomaly_loss:0.3317	fnorm_loss:0.0074, a_fnorm_loss:0.0520P:0.58, R:0.95
 88%|████████▊ | 88/100 [15:14<01:51,  9.28s/it]epoch [88/100], focal_loss:0.0109	, anomaly_loss:0.3456	fnorm_loss:0.0075, a_fnorm_loss:0.0496P:0.58, R:0.93
 89%|████████▉ | 89/100 [15:22<01:36,  8.80s/it]epoch [89/100], focal_loss:0.0094	, anomaly_loss:0.3416	fnorm_loss:0.0075, a_fnorm_loss:0.0510P:0.63, R:0.95
 90%|█████████ | 90/100 [15:43<02:03, 12.34s/it]epoch [90/100], focal_loss:0.0078	, anomaly_loss:0.3366	fnorm_loss:0.0073, a_fnorm_loss:0.0528P:0.60, R:0.96
normal: 0.0558 0.2934  anomaly: 0.0604 0.6404	P:0.23, R:0.22
Pixel Auroc:0.973, Sample Auroc0.749, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0276
 91%|█████████ | 91/100 [15:51<01:39, 11.07s/it]epoch [91/100], focal_loss:0.0088	, anomaly_loss:0.3436	fnorm_loss:0.0072, a_fnorm_loss:0.0519P:0.58, R:0.94
 92%|█████████▏| 92/100 [15:58<01:20, 10.09s/it]epoch [92/100], focal_loss:0.0092	, anomaly_loss:0.3429	fnorm_loss:0.0073, a_fnorm_loss:0.0523P:0.61, R:0.94
 93%|█████████▎| 93/100 [16:06<01:05,  9.41s/it]epoch [93/100], focal_loss:0.0080	, anomaly_loss:0.3458	fnorm_loss:0.0073, a_fnorm_loss:0.0509P:0.55, R:0.94
 94%|█████████▍| 94/100 [16:14<00:53,  8.96s/it]epoch [94/100], focal_loss:0.0086	, anomaly_loss:0.3407	fnorm_loss:0.0073, a_fnorm_loss:0.0513P:0.58, R:0.94
 95%|█████████▌| 95/100 [16:36<01:03, 12.69s/it]epoch [95/100], focal_loss:0.0089	, anomaly_loss:0.3318	fnorm_loss:0.0074, a_fnorm_loss:0.0522P:0.62, R:0.96
normal: 0.0674 0.3051  anomaly: 0.0822 0.6472	P:0.23, R:0.24
Pixel Auroc:0.972, Sample Auroc0.739, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0300
 96%|█████████▌| 96/100 [16:43<00:44, 11.18s/it]epoch [96/100], focal_loss:0.0096	, anomaly_loss:0.3342	fnorm_loss:0.0074, a_fnorm_loss:0.0498P:0.59, R:0.94
 97%|█████████▋| 97/100 [16:51<00:30, 10.19s/it]epoch [97/100], focal_loss:0.0080	, anomaly_loss:0.3370	fnorm_loss:0.0073, a_fnorm_loss:0.0530P:0.55, R:0.96
 98%|█████████▊| 98/100 [16:59<00:18,  9.47s/it]epoch [98/100], focal_loss:0.0082	, anomaly_loss:0.3322	fnorm_loss:0.0073, a_fnorm_loss:0.0521P:0.60, R:0.95
 99%|█████████▉| 99/100 [17:07<00:09,  9.03s/it]epoch [99/100], focal_loss:0.0087	, anomaly_loss:0.3404	fnorm_loss:0.0073, a_fnorm_loss:0.0518P:0.63, R:0.94
100%|██████████| 100/100 [17:28<00:00, 12.58s/it]100%|██████████| 100/100 [17:28<00:00, 10.48s/it]
epoch [100/100], focal_loss:0.0090	, anomaly_loss:0.3278	fnorm_loss:0.0074, a_fnorm_loss:0.0507P:0.57, R:0.95
normal: 0.0673 0.3074  anomaly: 0.0800 0.6486	P:0.23, R:0.25
Pixel Auroc:0.972, Sample Auroc0.740, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0300
training Stubborn Student...
bagel
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:15,  5.17s/it]epoch [1/120], kd_loss:4.8199
  2%|▏         | 2/120 [00:10<10:10,  5.17s/it]epoch [2/120], kd_loss:3.9200
  2%|▎         | 3/120 [00:15<10:07,  5.19s/it]epoch [3/120], kd_loss:3.6516
  3%|▎         | 4/120 [00:20<10:06,  5.23s/it]epoch [4/120], kd_loss:3.2354
  4%|▍         | 5/120 [00:26<10:09,  5.30s/it]epoch [5/120], kd_loss:2.8467
  5%|▌         | 6/120 [00:31<10:02,  5.29s/it]epoch [6/120], kd_loss:2.6607
  6%|▌         | 7/120 [00:36<09:57,  5.29s/it]epoch [7/120], kd_loss:2.2894
  7%|▋         | 8/120 [00:42<09:54,  5.31s/it]epoch [8/120], kd_loss:2.2222
  8%|▊         | 9/120 [00:47<09:49,  5.31s/it]epoch [9/120], kd_loss:2.1716
  8%|▊         | 10/120 [01:06<17:14,  9.41s/it]epoch [10/120], kd_loss:2.1525
normal: 1.3809 1.9162  anomaly: 1.3630 2.1242
thresh: 1.499534511808267
fpr: 0.5 fnr 0.022727272727272728
Pixel Auroc:0.987, Sample Auroc0.883, Pixel Aupro0.0
  9%|▉         | 11/120 [01:11<14:48,  8.16s/it]epoch [11/120], kd_loss:2.0113
 10%|█         | 12/120 [01:16<13:06,  7.28s/it]epoch [12/120], kd_loss:2.4948
 11%|█         | 13/120 [01:22<11:56,  6.70s/it]epoch [13/120], kd_loss:2.1039
 12%|█▏        | 14/120 [01:27<11:06,  6.29s/it]epoch [14/120], kd_loss:2.0004
 12%|█▎        | 15/120 [01:32<10:32,  6.02s/it]epoch [15/120], kd_loss:1.9983
 13%|█▎        | 16/120 [01:38<10:07,  5.84s/it]epoch [16/120], kd_loss:2.4655
 14%|█▍        | 17/120 [01:43<09:45,  5.69s/it]epoch [17/120], kd_loss:2.3425
 15%|█▌        | 18/120 [01:48<09:32,  5.62s/it]epoch [18/120], kd_loss:2.0429
 16%|█▌        | 19/120 [01:54<09:23,  5.58s/it]epoch [19/120], kd_loss:1.9506
 17%|█▋        | 20/120 [02:13<15:52,  9.52s/it]epoch [20/120], kd_loss:2.1406
normal: 1.3766 1.8694  anomaly: 1.3022 2.2010
thresh: 1.5175845108226274
fpr: 0.4090909090909091 fnr 0.03409090909090909
Pixel Auroc:0.989, Sample Auroc0.905, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:18<13:35,  8.24s/it]epoch [21/120], kd_loss:1.9893
 18%|█▊        | 22/120 [02:23<11:57,  7.32s/it]epoch [22/120], kd_loss:1.8608
 19%|█▉        | 23/120 [02:28<10:49,  6.70s/it]epoch [23/120], kd_loss:2.0241
 20%|██        | 24/120 [02:34<10:03,  6.28s/it]epoch [24/120], kd_loss:1.9341
 21%|██        | 25/120 [02:39<09:28,  5.99s/it]epoch [25/120], kd_loss:1.8719
 22%|██▏       | 26/120 [02:44<09:09,  5.84s/it]epoch [26/120], kd_loss:1.8149
 22%|██▎       | 27/120 [02:50<08:52,  5.72s/it]epoch [27/120], kd_loss:1.9050
 23%|██▎       | 28/120 [02:55<08:37,  5.63s/it]epoch [28/120], kd_loss:1.8566
 24%|██▍       | 29/120 [03:01<08:27,  5.58s/it]epoch [29/120], kd_loss:1.8457
 25%|██▌       | 30/120 [03:20<14:27,  9.64s/it]epoch [30/120], kd_loss:1.7621
normal: 1.1712 1.6587  anomaly: 1.2660 1.9974
thresh: 1.3864542364942367
fpr: 0.22727272727272727 fnr 0.06818181818181818
Pixel Auroc:0.989, Sample Auroc0.928, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:25<12:20,  8.33s/it]epoch [31/120], kd_loss:1.7438
 27%|██▋       | 32/120 [03:31<10:54,  7.43s/it]epoch [32/120], kd_loss:1.7829
 28%|██▊       | 33/120 [03:36<09:55,  6.85s/it]epoch [33/120], kd_loss:1.7220
 28%|██▊       | 34/120 [03:41<09:13,  6.44s/it]epoch [34/120], kd_loss:2.4558
 29%|██▉       | 35/120 [03:47<08:38,  6.10s/it]epoch [35/120], kd_loss:1.9518
 30%|███       | 36/120 [03:52<08:15,  5.89s/it]epoch [36/120], kd_loss:1.8893
 31%|███       | 37/120 [03:58<07:57,  5.75s/it]epoch [37/120], kd_loss:1.8873
 32%|███▏      | 38/120 [04:03<07:45,  5.67s/it]epoch [38/120], kd_loss:1.7702
 32%|███▎      | 39/120 [04:09<07:35,  5.63s/it]epoch [39/120], kd_loss:1.8103
 33%|███▎      | 40/120 [04:28<13:04,  9.80s/it]epoch [40/120], kd_loss:1.7620
normal: 1.2307 1.6628  anomaly: 1.2211 2.0442
thresh: 1.4731636208406553
fpr: 0.22727272727272727 fnr 0.06818181818181818
Pixel Auroc:0.988, Sample Auroc0.933, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:33<11:07,  8.45s/it]epoch [41/120], kd_loss:1.7555
 35%|███▌      | 42/120 [04:39<09:47,  7.54s/it]epoch [42/120], kd_loss:1.9101
 36%|███▌      | 43/120 [04:44<08:50,  6.89s/it]epoch [43/120], kd_loss:2.0726
 37%|███▋      | 44/120 [04:50<08:10,  6.46s/it]epoch [44/120], kd_loss:1.7436
 38%|███▊      | 45/120 [04:55<07:39,  6.13s/it]epoch [45/120], kd_loss:1.7241
 38%|███▊      | 46/120 [05:00<07:17,  5.91s/it]epoch [46/120], kd_loss:1.7172
 39%|███▉      | 47/120 [05:06<07:02,  5.78s/it]epoch [47/120], kd_loss:1.7424
 40%|████      | 48/120 [05:11<06:49,  5.69s/it]epoch [48/120], kd_loss:1.7125
 41%|████      | 49/120 [05:17<06:38,  5.61s/it]epoch [49/120], kd_loss:1.6881
 42%|████▏     | 50/120 [05:36<11:16,  9.66s/it]epoch [50/120], kd_loss:1.6929
normal: 1.0845 1.5398  anomaly: 1.1745 2.0727
thresh: 1.4059147927642839
fpr: 0.09090909090909091 fnr 0.10227272727272728
Pixel Auroc:0.987, Sample Auroc0.935, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:41<09:37,  8.38s/it]epoch [51/120], kd_loss:1.6692
 43%|████▎     | 52/120 [05:47<08:27,  7.46s/it]epoch [52/120], kd_loss:1.6622
 44%|████▍     | 53/120 [05:52<07:39,  6.86s/it]epoch [53/120], kd_loss:1.6740
 45%|████▌     | 54/120 [05:58<07:04,  6.42s/it]epoch [54/120], kd_loss:2.2470
 46%|████▌     | 55/120 [06:03<06:37,  6.11s/it]epoch [55/120], kd_loss:1.8239
 47%|████▋     | 56/120 [06:08<06:18,  5.91s/it]epoch [56/120], kd_loss:1.7792
 48%|████▊     | 57/120 [06:14<06:03,  5.77s/it]epoch [57/120], kd_loss:1.6956
 48%|████▊     | 58/120 [06:19<05:51,  5.68s/it]epoch [58/120], kd_loss:1.6820
 49%|████▉     | 59/120 [06:25<05:42,  5.62s/it]epoch [59/120], kd_loss:1.7122
 50%|█████     | 60/120 [06:43<09:16,  9.27s/it]epoch [60/120], kd_loss:1.6759
normal: 1.0758 1.4887  anomaly: 1.1740 2.1670
thresh: 1.2363652200123953
fpr: 0.5454545454545454 fnr 0.011363636363636364
Pixel Auroc:0.987, Sample Auroc0.913, Pixel Aupro0.0
 51%|█████     | 61/120 [06:48<07:57,  8.09s/it]epoch [61/120], kd_loss:1.6735
 52%|█████▏    | 62/120 [06:53<07:01,  7.26s/it]epoch [62/120], kd_loss:1.6939
 52%|█████▎    | 63/120 [06:59<06:23,  6.72s/it]epoch [63/120], kd_loss:1.6668
 53%|█████▎    | 64/120 [07:04<05:54,  6.33s/it]epoch [64/120], kd_loss:1.6532
 54%|█████▍    | 65/120 [07:09<05:32,  6.04s/it]epoch [65/120], kd_loss:1.6447
 55%|█████▌    | 66/120 [07:15<05:16,  5.86s/it]epoch [66/120], kd_loss:1.8812
 56%|█████▌    | 67/120 [07:20<05:03,  5.74s/it]epoch [67/120], kd_loss:1.6648
 57%|█████▋    | 68/120 [07:26<04:52,  5.63s/it]epoch [68/120], kd_loss:2.0201
 57%|█████▊    | 69/120 [07:31<04:44,  5.58s/it]epoch [69/120], kd_loss:2.1732
 58%|█████▊    | 70/120 [07:51<08:05,  9.71s/it]epoch [70/120], kd_loss:1.7755
normal: 1.1193 1.6071  anomaly: 1.2408 2.0160
thresh: 1.3389106790313399
fpr: 0.4090909090909091 fnr 0.011363636363636364
Pixel Auroc:0.988, Sample Auroc0.942, Pixel Aupro0.0
 59%|█████▉    | 71/120 [07:56<06:51,  8.41s/it]epoch [71/120], kd_loss:1.7279
 60%|██████    | 72/120 [08:01<05:59,  7.49s/it]epoch [72/120], kd_loss:1.7058
 61%|██████    | 73/120 [08:07<05:22,  6.87s/it]epoch [73/120], kd_loss:1.7233
 62%|██████▏   | 74/120 [08:12<04:55,  6.43s/it]epoch [74/120], kd_loss:1.6810
 62%|██████▎   | 75/120 [08:17<04:35,  6.12s/it]epoch [75/120], kd_loss:1.6730
 63%|██████▎   | 76/120 [08:23<04:19,  5.90s/it]epoch [76/120], kd_loss:1.6591
 64%|██████▍   | 77/120 [08:28<04:07,  5.75s/it]epoch [77/120], kd_loss:1.8589
 65%|██████▌   | 78/120 [08:34<03:58,  5.67s/it]epoch [78/120], kd_loss:1.7076
 66%|██████▌   | 79/120 [08:39<03:49,  5.59s/it]epoch [79/120], kd_loss:1.6629
 67%|██████▋   | 80/120 [08:59<06:29,  9.74s/it]epoch [80/120], kd_loss:1.6423
normal: 1.0730 1.4910  anomaly: 1.0984 2.1160
thresh: 1.2763975200268771
fpr: 0.2727272727272727 fnr 0.045454545454545456
Pixel Auroc:0.986, Sample Auroc0.945, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:04<05:28,  8.41s/it]epoch [81/120], kd_loss:1.6381
 68%|██████▊   | 82/120 [09:09<04:45,  7.51s/it]epoch [82/120], kd_loss:1.6300
 69%|██████▉   | 83/120 [09:15<04:13,  6.84s/it]epoch [83/120], kd_loss:1.6303
 70%|███████   | 84/120 [09:20<03:50,  6.42s/it]epoch [84/120], kd_loss:1.6534
 71%|███████   | 85/120 [09:25<03:33,  6.11s/it]epoch [85/120], kd_loss:1.7346
 72%|███████▏  | 86/120 [09:31<03:20,  5.89s/it]epoch [86/120], kd_loss:1.7039
 72%|███████▎  | 87/120 [09:36<03:09,  5.75s/it]epoch [87/120], kd_loss:1.6353
 73%|███████▎  | 88/120 [09:42<03:00,  5.64s/it]epoch [88/120], kd_loss:1.5975
 74%|███████▍  | 89/120 [09:47<02:53,  5.59s/it]epoch [89/120], kd_loss:1.5797
 75%|███████▌  | 90/120 [10:04<04:34,  9.15s/it]epoch [90/120], kd_loss:1.5764
normal: 0.9925 1.3371  anomaly: 1.0491 1.7484
thresh: 1.1200077828771926
fpr: 0.5454545454545454 fnr 0.011363636363636364
Pixel Auroc:0.987, Sample Auroc0.917, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:10<03:51,  7.99s/it]epoch [91/120], kd_loss:1.5783
 77%|███████▋  | 92/120 [10:15<03:21,  7.19s/it]epoch [92/120], kd_loss:1.5683
 78%|███████▊  | 93/120 [10:21<03:00,  6.68s/it]epoch [93/120], kd_loss:1.5607
 78%|███████▊  | 94/120 [10:26<02:43,  6.29s/it]epoch [94/120], kd_loss:1.5544
 79%|███████▉  | 95/120 [10:31<02:30,  6.01s/it]epoch [95/120], kd_loss:1.8804
 80%|████████  | 96/120 [10:37<02:19,  5.83s/it]epoch [96/120], kd_loss:1.6519
 81%|████████  | 97/120 [10:42<02:11,  5.71s/it]epoch [97/120], kd_loss:1.6082
 82%|████████▏ | 98/120 [10:48<02:03,  5.62s/it]epoch [98/120], kd_loss:1.5888
 82%|████████▎ | 99/120 [10:53<01:57,  5.57s/it]epoch [99/120], kd_loss:1.5844
 83%|████████▎ | 100/120 [11:11<03:04,  9.22s/it]epoch [100/120], kd_loss:1.5813
normal: 0.9981 1.3535  anomaly: 1.0207 1.8311
thresh: 1.1277875674121323
fpr: 0.5454545454545454 fnr 0.022727272727272728
Pixel Auroc:0.988, Sample Auroc0.909, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:16<02:32,  8.04s/it]epoch [101/120], kd_loss:1.5734
 85%|████████▌ | 102/120 [11:21<02:10,  7.23s/it]epoch [102/120], kd_loss:1.5688
 86%|████████▌ | 103/120 [11:27<01:53,  6.68s/it]epoch [103/120], kd_loss:1.5606
 87%|████████▋ | 104/120 [11:32<01:40,  6.28s/it]epoch [104/120], kd_loss:1.5583
 88%|████████▊ | 105/120 [11:38<01:30,  6.04s/it]epoch [105/120], kd_loss:1.5535
 88%|████████▊ | 106/120 [11:43<01:22,  5.87s/it]epoch [106/120], kd_loss:1.5529
 89%|████████▉ | 107/120 [11:49<01:14,  5.75s/it]epoch [107/120], kd_loss:1.5493
 90%|█████████ | 108/120 [11:54<01:08,  5.68s/it]epoch [108/120], kd_loss:1.5462
 91%|█████████ | 109/120 [12:00<01:01,  5.62s/it]epoch [109/120], kd_loss:1.5447
 92%|█████████▏| 110/120 [12:17<01:32,  9.24s/it]epoch [110/120], kd_loss:1.5409
normal: 0.9829 1.3528  anomaly: 1.0071 1.8398
thresh: 1.1375264379827077
fpr: 0.5 fnr 0.03409090909090909
Pixel Auroc:0.988, Sample Auroc0.896, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:23<01:12,  8.06s/it]epoch [111/120], kd_loss:1.5382
 93%|█████████▎| 112/120 [12:28<00:58,  7.28s/it]epoch [112/120], kd_loss:1.5411
 94%|█████████▍| 113/120 [12:33<00:47,  6.72s/it]epoch [113/120], kd_loss:1.5377
 95%|█████████▌| 114/120 [12:39<00:38,  6.34s/it]epoch [114/120], kd_loss:1.5392
 96%|█████████▌| 115/120 [12:44<00:30,  6.05s/it]epoch [115/120], kd_loss:1.5375
 97%|█████████▋| 116/120 [12:50<00:23,  5.85s/it]epoch [116/120], kd_loss:1.5354
 98%|█████████▊| 117/120 [12:55<00:17,  5.71s/it]epoch [117/120], kd_loss:1.5359
 98%|█████████▊| 118/120 [13:00<00:11,  5.62s/it]epoch [118/120], kd_loss:1.5354
 99%|█████████▉| 119/120 [13:06<00:05,  5.60s/it]epoch [119/120], kd_loss:1.5356
100%|██████████| 120/120 [13:23<00:00,  9.14s/it]100%|██████████| 120/120 [13:23<00:00,  6.70s/it]
epoch [120/120], kd_loss:1.5326
normal: 0.9871 1.3581  anomaly: 1.0159 1.8325
thresh: 1.1301007828150633
fpr: 0.5 fnr 0.03409090909090909
Pixel Auroc:0.988, Sample Auroc0.900, Pixel Aupro0.0
training Advanced Teacher...
cable_gland
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:18<30:13, 18.32s/it]epoch [1/100], focal_loss:0.0753	, anomaly_loss:0.5581	fnorm_loss:0.0664, a_fnorm_loss:0.0149P:0.00, R:0.04
normal: 0.2568 0.2635  anomaly: 0.2541 0.2654	P:0.00, R:0.00
Pixel Auroc:0.709, Sample Auroc0.388, Pixel Aupro0.0
test_fnorm_loss: 0.0658 test_afnorm_loss: 0.0156
  2%|▏         | 2/100 [00:25<18:47, 11.51s/it]epoch [2/100], focal_loss:0.0641	, anomaly_loss:0.5462	fnorm_loss:0.0636, a_fnorm_loss:0.0146P:0.00, R:0.00
  3%|▎         | 3/100 [00:31<14:53,  9.21s/it]epoch [3/100], focal_loss:0.0564	, anomaly_loss:0.5647	fnorm_loss:0.0572, a_fnorm_loss:0.0130P:0.00, R:0.00
  4%|▍         | 4/100 [00:38<13:04,  8.17s/it]epoch [4/100], focal_loss:0.0492	, anomaly_loss:0.5791	fnorm_loss:0.0520, a_fnorm_loss:0.0116P:0.00, R:0.00
  5%|▌         | 5/100 [00:55<17:56, 11.33s/it]epoch [5/100], focal_loss:0.0454	, anomaly_loss:0.5960	fnorm_loss:0.0475, a_fnorm_loss:0.0110P:0.00, R:0.00
normal: 0.1777 0.1820  anomaly: 0.1769 0.1830	P:0.00, R:0.00
Pixel Auroc:0.753, Sample Auroc0.396, Pixel Aupro0.0
test_fnorm_loss: 0.0450 test_afnorm_loss: 0.0108
  6%|▌         | 6/100 [01:01<15:13,  9.72s/it]epoch [6/100], focal_loss:0.0427	, anomaly_loss:0.6054	fnorm_loss:0.0443, a_fnorm_loss:0.0101P:0.00, R:0.00
  7%|▋         | 7/100 [01:08<13:28,  8.69s/it]epoch [7/100], focal_loss:0.0404	, anomaly_loss:0.6156	fnorm_loss:0.0418, a_fnorm_loss:0.0099P:0.00, R:0.00
  8%|▊         | 8/100 [01:14<12:05,  7.89s/it]epoch [8/100], focal_loss:0.0392	, anomaly_loss:0.6198	fnorm_loss:0.0404, a_fnorm_loss:0.0097P:0.00, R:0.00
  9%|▉         | 9/100 [01:20<11:15,  7.42s/it]epoch [9/100], focal_loss:0.0415	, anomaly_loss:0.6076	fnorm_loss:0.0396, a_fnorm_loss:0.0114P:0.02, R:0.02
 10%|█         | 10/100 [01:39<16:16, 10.85s/it]epoch [10/100], focal_loss:0.0375	, anomaly_loss:0.5235	fnorm_loss:0.0365, a_fnorm_loss:0.0263P:0.08, R:0.25
normal: 0.2042 0.2781  anomaly: 0.1945 0.2868	P:0.04, R:0.14
Pixel Auroc:0.971, Sample Auroc0.706, Pixel Aupro0.0
test_fnorm_loss: 0.0340 test_afnorm_loss: 0.0263
 11%|█         | 11/100 [01:45<14:06,  9.51s/it]epoch [11/100], focal_loss:0.0323	, anomaly_loss:0.5017	fnorm_loss:0.0329, a_fnorm_loss:0.0317P:0.11, R:0.30
 12%|█▏        | 12/100 [01:52<12:41,  8.66s/it]epoch [12/100], focal_loss:0.0343	, anomaly_loss:0.4985	fnorm_loss:0.0313, a_fnorm_loss:0.0339P:0.11, R:0.30
 13%|█▎        | 13/100 [01:58<11:28,  7.91s/it]epoch [13/100], focal_loss:0.0318	, anomaly_loss:0.5091	fnorm_loss:0.0291, a_fnorm_loss:0.0323P:0.10, R:0.29
 14%|█▍        | 14/100 [02:04<10:38,  7.43s/it]epoch [14/100], focal_loss:0.0296	, anomaly_loss:0.5078	fnorm_loss:0.0278, a_fnorm_loss:0.0330P:0.10, R:0.29
 15%|█▌        | 15/100 [02:21<14:21, 10.14s/it]epoch [15/100], focal_loss:0.0296	, anomaly_loss:0.5112	fnorm_loss:0.0268, a_fnorm_loss:0.0322P:0.09, R:0.28
normal: 0.1987 0.3065  anomaly: 0.1872 0.3060	P:0.03, R:0.15
Pixel Auroc:0.975, Sample Auroc0.595, Pixel Aupro0.0
test_fnorm_loss: 0.0258 test_afnorm_loss: 0.0300
 16%|█▌        | 16/100 [02:27<12:33,  8.98s/it]epoch [16/100], focal_loss:0.0275	, anomaly_loss:0.4996	fnorm_loss:0.0256, a_fnorm_loss:0.0343P:0.09, R:0.31
 17%|█▋        | 17/100 [02:34<11:24,  8.25s/it]epoch [17/100], focal_loss:0.0296	, anomaly_loss:0.4981	fnorm_loss:0.0247, a_fnorm_loss:0.0365P:0.11, R:0.31
 18%|█▊        | 18/100 [02:40<10:30,  7.68s/it]epoch [18/100], focal_loss:0.0286	, anomaly_loss:0.4932	fnorm_loss:0.0241, a_fnorm_loss:0.0351P:0.11, R:0.33
 19%|█▉        | 19/100 [02:47<10:03,  7.45s/it]epoch [19/100], focal_loss:0.0283	, anomaly_loss:0.4807	fnorm_loss:0.0239, a_fnorm_loss:0.0363P:0.13, R:0.37
 20%|██        | 20/100 [03:04<13:46, 10.33s/it]epoch [20/100], focal_loss:0.0265	, anomaly_loss:0.4672	fnorm_loss:0.0223, a_fnorm_loss:0.0356P:0.18, R:0.47
normal: 0.3885 0.4917  anomaly: 0.3579 0.4954	P:0.02, R:0.36
Pixel Auroc:0.960, Sample Auroc0.499, Pixel Aupro0.0
test_fnorm_loss: 0.0236 test_afnorm_loss: 0.0363
 21%|██        | 21/100 [03:10<12:02,  9.15s/it]epoch [21/100], focal_loss:0.0224	, anomaly_loss:0.4038	fnorm_loss:0.0208, a_fnorm_loss:0.0396P:0.25, R:0.67
 22%|██▏       | 22/100 [03:17<10:45,  8.28s/it]epoch [22/100], focal_loss:0.0224	, anomaly_loss:0.3783	fnorm_loss:0.0196, a_fnorm_loss:0.0422P:0.30, R:0.81
 23%|██▎       | 23/100 [03:23<09:48,  7.64s/it]epoch [23/100], focal_loss:0.0201	, anomaly_loss:0.3689	fnorm_loss:0.0186, a_fnorm_loss:0.0418P:0.31, R:0.86
 24%|██▍       | 24/100 [03:29<09:17,  7.33s/it]epoch [24/100], focal_loss:0.0170	, anomaly_loss:0.3466	fnorm_loss:0.0176, a_fnorm_loss:0.0433P:0.31, R:0.89
 25%|██▌       | 25/100 [03:52<15:02, 12.04s/it]epoch [25/100], focal_loss:0.0170	, anomaly_loss:0.3545	fnorm_loss:0.0168, a_fnorm_loss:0.0424P:0.32, R:0.89
normal: 0.0875 0.4271  anomaly: 0.0827 0.4892	P:0.19, R:0.22
Pixel Auroc:0.979, Sample Auroc0.679, Pixel Aupro0.0
test_fnorm_loss: 0.0154 test_afnorm_loss: 0.0177
 26%|██▌       | 26/100 [03:59<12:50, 10.41s/it]epoch [26/100], focal_loss:0.0180	, anomaly_loss:0.3577	fnorm_loss:0.0163, a_fnorm_loss:0.0430P:0.36, R:0.88
 27%|██▋       | 27/100 [04:06<11:15,  9.25s/it]epoch [27/100], focal_loss:0.0153	, anomaly_loss:0.3338	fnorm_loss:0.0155, a_fnorm_loss:0.0452P:0.32, R:0.92
 28%|██▊       | 28/100 [04:12<09:58,  8.32s/it]epoch [28/100], focal_loss:0.0143	, anomaly_loss:0.3428	fnorm_loss:0.0150, a_fnorm_loss:0.0435P:0.36, R:0.91
 29%|██▉       | 29/100 [04:18<09:12,  7.78s/it]epoch [29/100], focal_loss:0.0143	, anomaly_loss:0.3336	fnorm_loss:0.0145, a_fnorm_loss:0.0455P:0.35, R:0.89
 30%|███       | 30/100 [04:35<12:13, 10.48s/it]epoch [30/100], focal_loss:0.0170	, anomaly_loss:0.3406	fnorm_loss:0.0146, a_fnorm_loss:0.0423P:0.37, R:0.87
normal: 0.1359 0.4081  anomaly: 0.1198 0.4894	P:0.19, R:0.24
Pixel Auroc:0.979, Sample Auroc0.738, Pixel Aupro0.0
test_fnorm_loss: 0.0133 test_afnorm_loss: 0.0211
 31%|███       | 31/100 [04:41<10:35,  9.21s/it]epoch [31/100], focal_loss:0.0137	, anomaly_loss:0.3313	fnorm_loss:0.0138, a_fnorm_loss:0.0451P:0.37, R:0.91
 32%|███▏      | 32/100 [04:48<09:33,  8.43s/it]epoch [32/100], focal_loss:0.0139	, anomaly_loss:0.3330	fnorm_loss:0.0135, a_fnorm_loss:0.0449P:0.37, R:0.88
 33%|███▎      | 33/100 [04:55<08:50,  7.91s/it]epoch [33/100], focal_loss:0.0135	, anomaly_loss:0.3332	fnorm_loss:0.0132, a_fnorm_loss:0.0429P:0.37, R:0.90
 34%|███▍      | 34/100 [05:01<08:15,  7.51s/it]epoch [34/100], focal_loss:0.0132	, anomaly_loss:0.3384	fnorm_loss:0.0128, a_fnorm_loss:0.0452P:0.35, R:0.87
 35%|███▌      | 35/100 [05:19<11:21, 10.48s/it]epoch [35/100], focal_loss:0.0119	, anomaly_loss:0.3196	fnorm_loss:0.0124, a_fnorm_loss:0.0466P:0.40, R:0.93
normal: 0.1204 0.5189  anomaly: 0.0958 0.5925	P:0.19, R:0.30
Pixel Auroc:0.980, Sample Auroc0.742, Pixel Aupro0.0
test_fnorm_loss: 0.0114 test_afnorm_loss: 0.0224
 36%|███▌      | 36/100 [05:25<09:53,  9.27s/it]epoch [36/100], focal_loss:0.0141	, anomaly_loss:0.3314	fnorm_loss:0.0124, a_fnorm_loss:0.0459P:0.36, R:0.90
 37%|███▋      | 37/100 [05:32<08:55,  8.49s/it]epoch [37/100], focal_loss:0.0130	, anomaly_loss:0.3191	fnorm_loss:0.0120, a_fnorm_loss:0.0452P:0.41, R:0.91
 38%|███▊      | 38/100 [05:38<08:11,  7.93s/it]epoch [38/100], focal_loss:0.0131	, anomaly_loss:0.3185	fnorm_loss:0.0119, a_fnorm_loss:0.0474P:0.36, R:0.92
 39%|███▉      | 39/100 [05:45<07:43,  7.60s/it]epoch [39/100], focal_loss:0.0170	, anomaly_loss:0.3613	fnorm_loss:0.0121, a_fnorm_loss:0.0392P:0.43, R:0.85
 40%|████      | 40/100 [06:03<10:39, 10.66s/it]epoch [40/100], focal_loss:0.0139	, anomaly_loss:0.3314	fnorm_loss:0.0116, a_fnorm_loss:0.0456P:0.43, R:0.91
normal: 0.1237 0.5659  anomaly: 0.1156 0.6327	P:0.18, R:0.34
Pixel Auroc:0.977, Sample Auroc0.744, Pixel Aupro0.0
test_fnorm_loss: 0.0106 test_afnorm_loss: 0.0254
 41%|████      | 41/100 [06:09<09:10,  9.33s/it]epoch [41/100], focal_loss:0.0113	, anomaly_loss:0.3083	fnorm_loss:0.0112, a_fnorm_loss:0.0463P:0.38, R:0.94
 42%|████▏     | 42/100 [06:16<08:16,  8.56s/it]epoch [42/100], focal_loss:0.0124	, anomaly_loss:0.3278	fnorm_loss:0.0110, a_fnorm_loss:0.0466P:0.39, R:0.91
 43%|████▎     | 43/100 [06:23<07:35,  7.99s/it]epoch [43/100], focal_loss:0.0094	, anomaly_loss:0.3042	fnorm_loss:0.0106, a_fnorm_loss:0.0495P:0.39, R:0.95
 44%|████▍     | 44/100 [06:29<07:03,  7.56s/it]epoch [44/100], focal_loss:0.0127	, anomaly_loss:0.3306	fnorm_loss:0.0109, a_fnorm_loss:0.0447P:0.42, R:0.90
 45%|████▌     | 45/100 [06:46<09:25, 10.27s/it]epoch [45/100], focal_loss:0.0126	, anomaly_loss:0.3248	fnorm_loss:0.0106, a_fnorm_loss:0.0445P:0.38, R:0.90
normal: 0.2848 0.5787  anomaly: 0.2603 0.6317	P:0.09, R:0.41
Pixel Auroc:0.975, Sample Auroc0.649, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0288
 46%|████▌     | 46/100 [06:52<08:15,  9.18s/it]epoch [46/100], focal_loss:0.0118	, anomaly_loss:0.3181	fnorm_loss:0.0105, a_fnorm_loss:0.0461P:0.42, R:0.91
 47%|████▋     | 47/100 [06:59<07:21,  8.33s/it]epoch [47/100], focal_loss:0.0118	, anomaly_loss:0.3152	fnorm_loss:0.0102, a_fnorm_loss:0.0469P:0.41, R:0.92
 48%|████▊     | 48/100 [07:05<06:38,  7.66s/it]epoch [48/100], focal_loss:0.0133	, anomaly_loss:0.3382	fnorm_loss:0.0104, a_fnorm_loss:0.0421P:0.35, R:0.85
 49%|████▉     | 49/100 [07:11<06:14,  7.34s/it]epoch [49/100], focal_loss:0.0114	, anomaly_loss:0.3069	fnorm_loss:0.0101, a_fnorm_loss:0.0472P:0.43, R:0.93
 50%|█████     | 50/100 [07:28<08:25, 10.11s/it]epoch [50/100], focal_loss:0.0091	, anomaly_loss:0.2981	fnorm_loss:0.0096, a_fnorm_loss:0.0501P:0.47, R:0.96
normal: 0.0707 0.5269  anomaly: 0.0636 0.6201	P:0.18, R:0.24
Pixel Auroc:0.975, Sample Auroc0.687, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0191
 51%|█████     | 51/100 [07:35<07:24,  9.07s/it]epoch [51/100], focal_loss:0.0094	, anomaly_loss:0.3080	fnorm_loss:0.0095, a_fnorm_loss:0.0493P:0.40, R:0.93
 52%|█████▏    | 52/100 [07:41<06:35,  8.24s/it]epoch [52/100], focal_loss:0.0128	, anomaly_loss:0.3338	fnorm_loss:0.0097, a_fnorm_loss:0.0448P:0.38, R:0.87
 53%|█████▎    | 53/100 [07:48<06:03,  7.74s/it]epoch [53/100], focal_loss:0.0089	, anomaly_loss:0.3048	fnorm_loss:0.0094, a_fnorm_loss:0.0487P:0.46, R:0.94
 54%|█████▍    | 54/100 [07:54<05:38,  7.36s/it]epoch [54/100], focal_loss:0.0093	, anomaly_loss:0.2963	fnorm_loss:0.0092, a_fnorm_loss:0.0515P:0.42, R:0.95
 55%|█████▌    | 55/100 [08:11<07:43, 10.29s/it]epoch [55/100], focal_loss:0.0143	, anomaly_loss:0.3595	fnorm_loss:0.0107, a_fnorm_loss:0.0432P:0.43, R:0.80
normal: 0.0536 0.3463  anomaly: 0.0435 0.4728	P:0.13, R:0.13
Pixel Auroc:0.979, Sample Auroc0.726, Pixel Aupro0.0
test_fnorm_loss: 0.0088 test_afnorm_loss: 0.0156
 56%|█████▌    | 56/100 [08:18<06:46,  9.24s/it]epoch [56/100], focal_loss:0.0087	, anomaly_loss:0.3090	fnorm_loss:0.0090, a_fnorm_loss:0.0502P:0.47, R:0.96
 57%|█████▋    | 57/100 [08:24<06:00,  8.38s/it]epoch [57/100], focal_loss:0.0108	, anomaly_loss:0.3220	fnorm_loss:0.0092, a_fnorm_loss:0.0469P:0.39, R:0.90
 58%|█████▊    | 58/100 [08:31<05:35,  7.99s/it]epoch [58/100], focal_loss:0.0107	, anomaly_loss:0.3230	fnorm_loss:0.0091, a_fnorm_loss:0.0459P:0.39, R:0.89
 59%|█████▉    | 59/100 [08:38<05:09,  7.54s/it]epoch [59/100], focal_loss:0.0104	, anomaly_loss:0.3153	fnorm_loss:0.0089, a_fnorm_loss:0.0470P:0.42, R:0.92
 60%|██████    | 60/100 [08:56<07:04, 10.60s/it]epoch [60/100], focal_loss:0.0087	, anomaly_loss:0.3180	fnorm_loss:0.0087, a_fnorm_loss:0.0493P:0.45, R:0.94
normal: 0.0586 0.4725  anomaly: 0.0552 0.5507	P:0.18, R:0.21
Pixel Auroc:0.981, Sample Auroc0.747, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0232
 61%|██████    | 61/100 [09:02<06:00,  9.24s/it]epoch [61/100], focal_loss:0.0109	, anomaly_loss:0.3132	fnorm_loss:0.0089, a_fnorm_loss:0.0475P:0.42, R:0.92
 62%|██████▏   | 62/100 [09:08<05:20,  8.43s/it]epoch [62/100], focal_loss:0.0103	, anomaly_loss:0.3168	fnorm_loss:0.0088, a_fnorm_loss:0.0466P:0.47, R:0.91
 63%|██████▎   | 63/100 [09:15<04:52,  7.91s/it]epoch [63/100], focal_loss:0.0096	, anomaly_loss:0.2980	fnorm_loss:0.0086, a_fnorm_loss:0.0493P:0.49, R:0.94
 64%|██████▍   | 64/100 [09:22<04:31,  7.54s/it]epoch [64/100], focal_loss:0.0093	, anomaly_loss:0.3139	fnorm_loss:0.0085, a_fnorm_loss:0.0498P:0.45, R:0.92
 65%|██████▌   | 65/100 [09:39<06:09, 10.57s/it]epoch [65/100], focal_loss:0.0101	, anomaly_loss:0.3039	fnorm_loss:0.0085, a_fnorm_loss:0.0493P:0.43, R:0.92
normal: 0.0835 0.4476  anomaly: 0.0631 0.5523	P:0.17, R:0.21
Pixel Auroc:0.981, Sample Auroc0.716, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0231
 66%|██████▌   | 66/100 [09:46<05:19,  9.39s/it]epoch [66/100], focal_loss:0.0088	, anomaly_loss:0.3046	fnorm_loss:0.0083, a_fnorm_loss:0.0480P:0.47, R:0.93
 67%|██████▋   | 67/100 [09:53<04:43,  8.58s/it]epoch [67/100], focal_loss:0.0093	, anomaly_loss:0.2985	fnorm_loss:0.0082, a_fnorm_loss:0.0499P:0.49, R:0.93
 68%|██████▊   | 68/100 [09:59<04:15,  7.98s/it]epoch [68/100], focal_loss:0.0082	, anomaly_loss:0.2888	fnorm_loss:0.0081, a_fnorm_loss:0.0511P:0.45, R:0.97
 69%|██████▉   | 69/100 [10:06<04:01,  7.78s/it]epoch [69/100], focal_loss:0.0081	, anomaly_loss:0.2937	fnorm_loss:0.0079, a_fnorm_loss:0.0493P:0.47, R:0.96
 70%|███████   | 70/100 [10:24<05:18, 10.61s/it]epoch [70/100], focal_loss:0.0076	, anomaly_loss:0.3005	fnorm_loss:0.0079, a_fnorm_loss:0.0517P:0.47, R:0.94
normal: 0.0661 0.5114  anomaly: 0.0486 0.5922	P:0.17, R:0.20
Pixel Auroc:0.976, Sample Auroc0.732, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0170
 71%|███████   | 71/100 [10:30<04:34,  9.46s/it]epoch [71/100], focal_loss:0.0094	, anomaly_loss:0.3096	fnorm_loss:0.0080, a_fnorm_loss:0.0494P:0.46, R:0.92
 72%|███████▏  | 72/100 [10:37<04:00,  8.58s/it]epoch [72/100], focal_loss:0.0095	, anomaly_loss:0.3111	fnorm_loss:0.0080, a_fnorm_loss:0.0483P:0.45, R:0.93
 73%|███████▎  | 73/100 [10:43<03:34,  7.95s/it]epoch [73/100], focal_loss:0.0078	, anomaly_loss:0.2981	fnorm_loss:0.0077, a_fnorm_loss:0.0485P:0.43, R:0.94
 74%|███████▍  | 74/100 [10:51<03:20,  7.69s/it]epoch [74/100], focal_loss:0.0085	, anomaly_loss:0.2970	fnorm_loss:0.0077, a_fnorm_loss:0.0493P:0.43, R:0.94
 75%|███████▌  | 75/100 [11:08<04:21, 10.47s/it]epoch [75/100], focal_loss:0.0081	, anomaly_loss:0.2992	fnorm_loss:0.0076, a_fnorm_loss:0.0502P:0.50, R:0.94
normal: 0.0471 0.4432  anomaly: 0.0328 0.5792	P:0.17, R:0.18
Pixel Auroc:0.978, Sample Auroc0.745, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0191
 76%|███████▌  | 76/100 [11:14<03:43,  9.33s/it]epoch [76/100], focal_loss:0.0078	, anomaly_loss:0.2990	fnorm_loss:0.0076, a_fnorm_loss:0.0496P:0.44, R:0.93
 77%|███████▋  | 77/100 [11:21<03:14,  8.47s/it]epoch [77/100], focal_loss:0.0101	, anomaly_loss:0.3083	fnorm_loss:0.0079, a_fnorm_loss:0.0484P:0.43, R:0.92
 78%|███████▊  | 78/100 [11:27<02:52,  7.86s/it]epoch [78/100], focal_loss:0.0079	, anomaly_loss:0.3097	fnorm_loss:0.0075, a_fnorm_loss:0.0500P:0.49, R:0.94
 79%|███████▉  | 79/100 [11:34<02:38,  7.53s/it]epoch [79/100], focal_loss:0.0100	, anomaly_loss:0.3170	fnorm_loss:0.0077, a_fnorm_loss:0.0486P:0.50, R:0.92
 80%|████████  | 80/100 [11:51<03:26, 10.32s/it]epoch [80/100], focal_loss:0.0088	, anomaly_loss:0.3041	fnorm_loss:0.0075, a_fnorm_loss:0.0499P:0.45, R:0.95
normal: 0.0481 0.3822  anomaly: 0.0488 0.4910	P:0.11, R:0.13
Pixel Auroc:0.982, Sample Auroc0.728, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0208
 81%|████████  | 81/100 [11:57<02:54,  9.16s/it]epoch [81/100], focal_loss:0.0069	, anomaly_loss:0.2977	fnorm_loss:0.0073, a_fnorm_loss:0.0499P:0.50, R:0.94
 82%|████████▏ | 82/100 [12:03<02:29,  8.31s/it]epoch [82/100], focal_loss:0.0097	, anomaly_loss:0.3108	fnorm_loss:0.0075, a_fnorm_loss:0.0487P:0.41, R:0.92
 83%|████████▎ | 83/100 [12:10<02:12,  7.78s/it]epoch [83/100], focal_loss:0.0077	, anomaly_loss:0.2947	fnorm_loss:0.0075, a_fnorm_loss:0.0506P:0.47, R:0.95
 84%|████████▍ | 84/100 [12:16<01:57,  7.31s/it]epoch [84/100], focal_loss:0.0072	, anomaly_loss:0.2938	fnorm_loss:0.0073, a_fnorm_loss:0.0504P:0.48, R:0.94
 85%|████████▌ | 85/100 [12:40<03:02, 12.19s/it]epoch [85/100], focal_loss:0.0079	, anomaly_loss:0.2987	fnorm_loss:0.0074, a_fnorm_loss:0.0496P:0.47, R:0.95
normal: 0.0770 0.5166  anomaly: 0.0563 0.6108	P:0.20, R:0.25
Pixel Auroc:0.981, Sample Auroc0.726, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0231
 86%|████████▌ | 86/100 [12:46<02:27, 10.52s/it]epoch [86/100], focal_loss:0.0074	, anomaly_loss:0.2947	fnorm_loss:0.0073, a_fnorm_loss:0.0502P:0.48, R:0.94
 87%|████████▋ | 87/100 [12:54<02:04,  9.56s/it]epoch [87/100], focal_loss:0.0081	, anomaly_loss:0.3005	fnorm_loss:0.0073, a_fnorm_loss:0.0503P:0.49, R:0.94
 88%|████████▊ | 88/100 [13:01<01:46,  8.89s/it]epoch [88/100], focal_loss:0.0079	, anomaly_loss:0.2953	fnorm_loss:0.0074, a_fnorm_loss:0.0518P:0.44, R:0.95
 89%|████████▉ | 89/100 [13:08<01:30,  8.22s/it]epoch [89/100], focal_loss:0.0090	, anomaly_loss:0.3107	fnorm_loss:0.0075, a_fnorm_loss:0.0481P:0.47, R:0.91
 90%|█████████ | 90/100 [13:25<01:48, 10.89s/it]epoch [90/100], focal_loss:0.0074	, anomaly_loss:0.2870	fnorm_loss:0.0074, a_fnorm_loss:0.0510P:0.47, R:0.96
normal: 0.0822 0.4914  anomaly: 0.0625 0.6054	P:0.19, R:0.24
Pixel Auroc:0.980, Sample Auroc0.721, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0216
 91%|█████████ | 91/100 [13:31<01:25,  9.46s/it]epoch [91/100], focal_loss:0.0074	, anomaly_loss:0.2918	fnorm_loss:0.0073, a_fnorm_loss:0.0497P:0.54, R:0.94
 92%|█████████▏| 92/100 [13:37<01:07,  8.43s/it]epoch [92/100], focal_loss:0.0068	, anomaly_loss:0.2742	fnorm_loss:0.0073, a_fnorm_loss:0.0543P:0.47, R:0.98
 93%|█████████▎| 93/100 [13:43<00:53,  7.67s/it]epoch [93/100], focal_loss:0.0074	, anomaly_loss:0.3039	fnorm_loss:0.0073, a_fnorm_loss:0.0506P:0.50, R:0.94
 94%|█████████▍| 94/100 [13:49<00:43,  7.30s/it]epoch [94/100], focal_loss:0.0079	, anomaly_loss:0.2957	fnorm_loss:0.0073, a_fnorm_loss:0.0513P:0.49, R:0.94
 95%|█████████▌| 95/100 [14:07<00:51, 10.27s/it]epoch [95/100], focal_loss:0.0073	, anomaly_loss:0.2879	fnorm_loss:0.0073, a_fnorm_loss:0.0508P:0.43, R:0.96
normal: 0.0799 0.5096  anomaly: 0.0564 0.6121	P:0.19, R:0.24
Pixel Auroc:0.979, Sample Auroc0.721, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0222
 96%|█████████▌| 96/100 [14:13<00:36,  9.22s/it]epoch [96/100], focal_loss:0.0079	, anomaly_loss:0.2889	fnorm_loss:0.0073, a_fnorm_loss:0.0517P:0.50, R:0.94
 97%|█████████▋| 97/100 [14:20<00:25,  8.52s/it]epoch [97/100], focal_loss:0.0073	, anomaly_loss:0.2897	fnorm_loss:0.0073, a_fnorm_loss:0.0513P:0.47, R:0.96
 98%|█████████▊| 98/100 [14:27<00:16,  8.02s/it]epoch [98/100], focal_loss:0.0079	, anomaly_loss:0.2913	fnorm_loss:0.0074, a_fnorm_loss:0.0517P:0.49, R:0.96
 99%|█████████▉| 99/100 [14:34<00:07,  7.73s/it]epoch [99/100], focal_loss:0.0126	, anomaly_loss:0.3421	fnorm_loss:0.0074, a_fnorm_loss:0.0461P:0.50, R:0.86
100%|██████████| 100/100 [14:52<00:00, 10.77s/it]100%|██████████| 100/100 [14:52<00:00,  8.92s/it]
epoch [100/100], focal_loss:0.0083	, anomaly_loss:0.2892	fnorm_loss:0.0075, a_fnorm_loss:0.0499P:0.44, R:0.96
normal: 0.0909 0.4982  anomaly: 0.0770 0.6077	P:0.18, R:0.25
Pixel Auroc:0.978, Sample Auroc0.710, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0229
training Stubborn Student...
cable_gland
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:04<08:59,  4.54s/it]epoch [1/120], kd_loss:4.4449
  2%|▏         | 2/120 [00:09<08:54,  4.53s/it]epoch [2/120], kd_loss:3.4279
  2%|▎         | 3/120 [00:13<08:51,  4.54s/it]epoch [3/120], kd_loss:3.1313
  3%|▎         | 4/120 [00:18<08:48,  4.56s/it]epoch [4/120], kd_loss:2.2595
  4%|▍         | 5/120 [00:22<08:45,  4.57s/it]epoch [5/120], kd_loss:2.5545
  5%|▌         | 6/120 [00:27<08:43,  4.60s/it]epoch [6/120], kd_loss:2.4587
  6%|▌         | 7/120 [00:32<08:42,  4.62s/it]epoch [7/120], kd_loss:1.9441
  7%|▋         | 8/120 [00:36<08:37,  4.62s/it]epoch [8/120], kd_loss:1.8541
  8%|▊         | 9/120 [00:41<08:31,  4.61s/it]epoch [9/120], kd_loss:1.8213
  8%|▊         | 10/120 [00:56<14:10,  7.73s/it]epoch [10/120], kd_loss:1.7284
normal: 1.2804 1.7066  anomaly: 1.2962 1.9753
thresh: 1.3273036080032916
fpr: 0.6190476190476191 fnr 0.011494252873563218
Pixel Auroc:0.983, Sample Auroc0.813, Pixel Aupro0.0
  9%|▉         | 11/120 [01:00<12:15,  6.74s/it]epoch [11/120], kd_loss:1.7267
 10%|█         | 12/120 [01:05<10:56,  6.08s/it]epoch [12/120], kd_loss:1.8306
 11%|█         | 13/120 [01:09<10:01,  5.62s/it]epoch [13/120], kd_loss:1.6859
 12%|█▏        | 14/120 [01:14<09:25,  5.34s/it]epoch [14/120], kd_loss:1.6513
 12%|█▎        | 15/120 [01:19<08:59,  5.14s/it]epoch [15/120], kd_loss:1.7269
 13%|█▎        | 16/120 [01:23<08:39,  4.99s/it]epoch [16/120], kd_loss:1.6736
 14%|█▍        | 17/120 [01:28<08:22,  4.87s/it]epoch [17/120], kd_loss:2.6345
 15%|█▌        | 18/120 [01:32<08:10,  4.81s/it]epoch [18/120], kd_loss:2.1416
 16%|█▌        | 19/120 [01:37<08:01,  4.77s/it]epoch [19/120], kd_loss:1.9091
 17%|█▋        | 20/120 [01:51<12:37,  7.57s/it]epoch [20/120], kd_loss:1.7895
normal: 1.1895 1.9297  anomaly: 1.2348 2.0499
thresh: 1.3253086812937032
fpr: 0.7142857142857143 fnr 0.011494252873563218
Pixel Auroc:0.979, Sample Auroc0.768, Pixel Aupro0.0
 18%|█▊        | 21/120 [01:56<10:59,  6.66s/it]epoch [21/120], kd_loss:1.8722
 18%|█▊        | 22/120 [02:00<09:50,  6.03s/it]epoch [22/120], kd_loss:1.7495
 19%|█▉        | 23/120 [02:05<09:02,  5.60s/it]epoch [23/120], kd_loss:1.6644
 20%|██        | 24/120 [02:10<08:29,  5.31s/it]epoch [24/120], kd_loss:1.7426
 21%|██        | 25/120 [02:14<08:04,  5.10s/it]epoch [25/120], kd_loss:1.8296
 22%|██▏       | 26/120 [02:19<07:46,  4.96s/it]epoch [26/120], kd_loss:1.6570
 22%|██▎       | 27/120 [02:24<07:35,  4.90s/it]epoch [27/120], kd_loss:1.6521
 23%|██▎       | 28/120 [02:28<07:26,  4.85s/it]epoch [28/120], kd_loss:1.6196
 24%|██▍       | 29/120 [02:33<07:16,  4.79s/it]epoch [29/120], kd_loss:1.6002
 25%|██▌       | 30/120 [02:46<11:05,  7.40s/it]epoch [30/120], kd_loss:1.8717
normal: 1.1525 1.7386  anomaly: 1.2219 1.9784
thresh: 1.2781599419887493
fpr: 0.7142857142857143 fnr 0.011494252873563218
Pixel Auroc:0.976, Sample Auroc0.780, Pixel Aupro0.0
 26%|██▌       | 31/120 [02:51<09:44,  6.56s/it]epoch [31/120], kd_loss:1.6490
 27%|██▋       | 32/120 [02:56<08:44,  5.96s/it]epoch [32/120], kd_loss:1.6114
 28%|██▊       | 33/120 [03:00<08:03,  5.56s/it]epoch [33/120], kd_loss:1.5773
 28%|██▊       | 34/120 [03:05<07:34,  5.29s/it]epoch [34/120], kd_loss:1.5651
 29%|██▉       | 35/120 [03:10<07:14,  5.11s/it]epoch [35/120], kd_loss:1.5503
 30%|███       | 36/120 [03:14<06:59,  5.00s/it]epoch [36/120], kd_loss:1.5654
 31%|███       | 37/120 [03:19<06:47,  4.90s/it]epoch [37/120], kd_loss:1.5807
 32%|███▏      | 38/120 [03:24<06:37,  4.85s/it]epoch [38/120], kd_loss:1.5638
 32%|███▎      | 39/120 [03:28<06:29,  4.81s/it]epoch [39/120], kd_loss:1.5198
 33%|███▎      | 40/120 [03:43<10:27,  7.85s/it]epoch [40/120], kd_loss:1.5342
normal: 1.0341 1.6997  anomaly: 1.2231 2.0345
thresh: 1.2431466196703596
fpr: 0.5714285714285714 fnr 0.011494252873563218
Pixel Auroc:0.982, Sample Auroc0.828, Pixel Aupro0.0
 34%|███▍      | 41/120 [03:48<09:01,  6.85s/it]epoch [41/120], kd_loss:2.2946
 35%|███▌      | 42/120 [03:52<08:01,  6.17s/it]epoch [42/120], kd_loss:2.1738
 36%|███▌      | 43/120 [03:57<07:19,  5.71s/it]epoch [43/120], kd_loss:1.9903
 37%|███▋      | 44/120 [04:02<06:49,  5.39s/it]epoch [44/120], kd_loss:1.7717
 38%|███▊      | 45/120 [04:06<06:28,  5.18s/it]epoch [45/120], kd_loss:1.7404
 38%|███▊      | 46/120 [04:11<06:12,  5.03s/it]epoch [46/120], kd_loss:1.6511
 39%|███▉      | 47/120 [04:16<05:59,  4.93s/it]epoch [47/120], kd_loss:1.6060
 40%|████      | 48/120 [04:21<05:50,  4.86s/it]epoch [48/120], kd_loss:1.6629
 41%|████      | 49/120 [04:25<05:41,  4.81s/it]epoch [49/120], kd_loss:1.6149
 42%|████▏     | 50/120 [04:40<08:56,  7.66s/it]epoch [50/120], kd_loss:1.5678
normal: 1.0865 1.7146  anomaly: 1.2109 1.9705
thresh: 1.210887453428751
fpr: 0.6190476190476191 fnr 0.0
Pixel Auroc:0.981, Sample Auroc0.826, Pixel Aupro0.0
 42%|████▎     | 51/120 [04:44<07:45,  6.75s/it]epoch [51/120], kd_loss:1.5686
 43%|████▎     | 52/120 [04:49<06:55,  6.11s/it]epoch [52/120], kd_loss:1.5710
 44%|████▍     | 53/120 [04:53<06:20,  5.68s/it]epoch [53/120], kd_loss:1.5609
 45%|████▌     | 54/120 [04:58<05:53,  5.36s/it]epoch [54/120], kd_loss:1.5512
 46%|████▌     | 55/120 [05:03<05:34,  5.14s/it]epoch [55/120], kd_loss:1.5308
 47%|████▋     | 56/120 [05:07<05:20,  5.01s/it]epoch [56/120], kd_loss:1.5150
 48%|████▊     | 57/120 [05:12<05:08,  4.89s/it]epoch [57/120], kd_loss:1.5470
 48%|████▊     | 58/120 [05:17<05:00,  4.84s/it]epoch [58/120], kd_loss:1.5249
 49%|████▉     | 59/120 [05:21<04:52,  4.79s/it]epoch [59/120], kd_loss:1.5323
 50%|█████     | 60/120 [05:36<07:43,  7.73s/it]epoch [60/120], kd_loss:1.5190
normal: 1.0504 2.2817  anomaly: 1.1768 2.2106
thresh: 1.2432477195728469
fpr: 0.5714285714285714 fnr 0.04597701149425287
Pixel Auroc:0.981, Sample Auroc0.743, Pixel Aupro0.0
 51%|█████     | 61/120 [05:41<06:42,  6.82s/it]epoch [61/120], kd_loss:1.5145
 52%|█████▏    | 62/120 [05:45<05:56,  6.15s/it]epoch [62/120], kd_loss:1.6685
 52%|█████▎    | 63/120 [05:50<05:23,  5.68s/it]epoch [63/120], kd_loss:1.5708
 53%|█████▎    | 64/120 [05:55<05:00,  5.37s/it]epoch [64/120], kd_loss:1.5494
 54%|█████▍    | 65/120 [05:59<04:44,  5.17s/it]epoch [65/120], kd_loss:1.6444
 55%|█████▌    | 66/120 [06:04<04:31,  5.03s/it]epoch [66/120], kd_loss:1.5680
 56%|█████▌    | 67/120 [06:09<04:20,  4.91s/it]epoch [67/120], kd_loss:1.5334
 57%|█████▋    | 68/120 [06:13<04:11,  4.84s/it]epoch [68/120], kd_loss:2.6785
 57%|█████▊    | 69/120 [06:18<04:04,  4.79s/it]epoch [69/120], kd_loss:2.0129
 58%|█████▊    | 70/120 [06:33<06:30,  7.80s/it]epoch [70/120], kd_loss:1.7718
normal: 1.2349 1.6779  anomaly: 1.2378 2.0615
thresh: 1.2944180535573553
fpr: 0.8095238095238095 fnr 0.011494252873563218
Pixel Auroc:0.977, Sample Auroc0.795, Pixel Aupro0.0
 59%|█████▉    | 71/120 [06:37<05:36,  6.86s/it]epoch [71/120], kd_loss:1.7229
 60%|██████    | 72/120 [06:42<04:57,  6.21s/it]epoch [72/120], kd_loss:1.6650
 61%|██████    | 73/120 [06:47<04:30,  5.75s/it]epoch [73/120], kd_loss:1.6344
 62%|██████▏   | 74/120 [06:51<04:08,  5.40s/it]epoch [74/120], kd_loss:1.6027
 62%|██████▎   | 75/120 [06:56<03:52,  5.18s/it]epoch [75/120], kd_loss:1.5888
 63%|██████▎   | 76/120 [07:01<03:40,  5.01s/it]epoch [76/120], kd_loss:1.6385
 64%|██████▍   | 77/120 [07:05<03:30,  4.89s/it]epoch [77/120], kd_loss:1.5810
 65%|██████▌   | 78/120 [07:10<03:23,  4.84s/it]epoch [78/120], kd_loss:1.6631
 66%|██████▌   | 79/120 [07:15<03:16,  4.79s/it]epoch [79/120], kd_loss:1.6615
 67%|██████▋   | 80/120 [07:29<05:01,  7.54s/it]epoch [80/120], kd_loss:1.5885
normal: 1.1590 1.7064  anomaly: 1.2242 1.9540
thresh: 1.2241714635990983
fpr: 0.7142857142857143 fnr 0.0
Pixel Auroc:0.980, Sample Auroc0.806, Pixel Aupro0.0
 68%|██████▊   | 81/120 [07:33<04:19,  6.65s/it]epoch [81/120], kd_loss:1.5733
 68%|██████▊   | 82/120 [07:38<03:48,  6.02s/it]epoch [82/120], kd_loss:1.5617
 69%|██████▉   | 83/120 [07:42<03:26,  5.58s/it]epoch [83/120], kd_loss:2.0165
 70%|███████   | 84/120 [07:47<03:10,  5.30s/it]epoch [84/120], kd_loss:1.7902
 71%|███████   | 85/120 [07:52<02:59,  5.12s/it]epoch [85/120], kd_loss:1.6685
 72%|███████▏  | 86/120 [07:56<02:49,  4.97s/it]epoch [86/120], kd_loss:1.6894
 72%|███████▎  | 87/120 [08:01<02:41,  4.89s/it]epoch [87/120], kd_loss:1.7027
 73%|███████▎  | 88/120 [08:06<02:34,  4.82s/it]epoch [88/120], kd_loss:1.7337
 74%|███████▍  | 89/120 [08:10<02:28,  4.78s/it]epoch [89/120], kd_loss:1.6569
 75%|███████▌  | 90/120 [08:26<03:58,  7.93s/it]epoch [90/120], kd_loss:1.6503
normal: 1.1172 1.6013  anomaly: 1.2063 1.9177
thresh: 1.206316940055306
fpr: 0.6666666666666666 fnr 0.0
Pixel Auroc:0.981, Sample Auroc0.831, Pixel Aupro0.0
 76%|███████▌  | 91/120 [08:30<03:20,  6.92s/it]epoch [91/120], kd_loss:1.6009
 77%|███████▋  | 92/120 [08:35<02:54,  6.23s/it]epoch [92/120], kd_loss:1.5924
 78%|███████▊  | 93/120 [08:39<02:35,  5.76s/it]epoch [93/120], kd_loss:1.6258
 78%|███████▊  | 94/120 [08:44<02:21,  5.45s/it]epoch [94/120], kd_loss:1.6281
 79%|███████▉  | 95/120 [08:49<02:10,  5.23s/it]epoch [95/120], kd_loss:1.6348
 80%|████████  | 96/120 [08:53<02:00,  5.04s/it]epoch [96/120], kd_loss:1.5909
 81%|████████  | 97/120 [08:58<01:52,  4.91s/it]epoch [97/120], kd_loss:1.5737
 82%|████████▏ | 98/120 [09:03<01:46,  4.83s/it]epoch [98/120], kd_loss:1.5632
 82%|████████▎ | 99/120 [09:07<01:40,  4.79s/it]epoch [99/120], kd_loss:1.6719
 83%|████████▎ | 100/120 [09:23<02:42,  8.15s/it]epoch [100/120], kd_loss:1.5624
normal: 1.0553 1.5517  anomaly: 1.1767 1.9683
thresh: 1.238656859994826
fpr: 0.5714285714285714 fnr 0.011494252873563218
Pixel Auroc:0.979, Sample Auroc0.848, Pixel Aupro0.0
 84%|████████▍ | 101/120 [09:28<02:14,  7.08s/it]epoch [101/120], kd_loss:1.5542
 85%|████████▌ | 102/120 [09:33<01:54,  6.34s/it]epoch [102/120], kd_loss:1.5468
 86%|████████▌ | 103/120 [09:37<01:39,  5.83s/it]epoch [103/120], kd_loss:1.5474
 87%|████████▋ | 104/120 [09:42<01:27,  5.49s/it]epoch [104/120], kd_loss:1.5478
 88%|████████▊ | 105/120 [09:47<01:18,  5.25s/it]epoch [105/120], kd_loss:1.5409
 88%|████████▊ | 106/120 [09:51<01:11,  5.08s/it]epoch [106/120], kd_loss:1.5368
 89%|████████▉ | 107/120 [09:56<01:04,  4.97s/it]epoch [107/120], kd_loss:1.5306
 90%|█████████ | 108/120 [10:01<00:58,  4.88s/it]epoch [108/120], kd_loss:1.5284
 91%|█████████ | 109/120 [10:05<00:53,  4.83s/it]epoch [109/120], kd_loss:1.5252
 92%|█████████▏| 110/120 [10:20<01:16,  7.64s/it]epoch [110/120], kd_loss:1.5244
normal: 1.0772 1.5636  anomaly: 1.1601 1.9292
thresh: 1.208755214307552
fpr: 0.5714285714285714 fnr 0.034482758620689655
Pixel Auroc:0.980, Sample Auroc0.848, Pixel Aupro0.0
 92%|█████████▎| 111/120 [10:24<01:00,  6.72s/it]epoch [111/120], kd_loss:1.5241
 93%|█████████▎| 112/120 [10:29<00:48,  6.08s/it]epoch [112/120], kd_loss:1.5221
 94%|█████████▍| 113/120 [10:33<00:39,  5.64s/it]epoch [113/120], kd_loss:1.5231
 95%|█████████▌| 114/120 [10:38<00:32,  5.33s/it]epoch [114/120], kd_loss:1.5215
 96%|█████████▌| 115/120 [10:43<00:25,  5.12s/it]epoch [115/120], kd_loss:1.5214
 97%|█████████▋| 116/120 [10:47<00:19,  4.98s/it]epoch [116/120], kd_loss:1.5198
 98%|█████████▊| 117/120 [10:52<00:14,  4.88s/it]epoch [117/120], kd_loss:1.5201
 98%|█████████▊| 118/120 [10:57<00:09,  4.81s/it]epoch [118/120], kd_loss:1.5181
 99%|█████████▉| 119/120 [11:01<00:04,  4.79s/it]epoch [119/120], kd_loss:1.5172
100%|██████████| 120/120 [11:17<00:00,  7.99s/it]100%|██████████| 120/120 [11:17<00:00,  5.64s/it]
epoch [120/120], kd_loss:1.5214
normal: 1.0596 1.5621  anomaly: 1.1448 1.9283
thresh: 1.192016438532679
fpr: 0.6190476190476191 fnr 0.011494252873563218
Pixel Auroc:0.981, Sample Auroc0.852, Pixel Aupro0.0
training Advanced Teacher...
carrot
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:30<50:43, 30.75s/it]epoch [1/100], focal_loss:0.0706	, anomaly_loss:0.4570	fnorm_loss:0.0739, a_fnorm_loss:0.0152P:0.00, R:0.03
normal: 0.2668 0.2738  anomaly: 0.2655 0.2742	P:0.00, R:0.00
Pixel Auroc:0.963, Sample Auroc0.457, Pixel Aupro0.0
test_fnorm_loss: 0.0741 test_afnorm_loss: 0.0171
  2%|▏         | 2/100 [00:41<30:34, 18.72s/it]epoch [2/100], focal_loss:0.0563	, anomaly_loss:0.4523	fnorm_loss:0.0677, a_fnorm_loss:0.0139P:0.00, R:0.00
  3%|▎         | 3/100 [00:51<24:13, 14.98s/it]epoch [3/100], focal_loss:0.0452	, anomaly_loss:0.4847	fnorm_loss:0.0590, a_fnorm_loss:0.0120P:0.00, R:0.00
  4%|▍         | 4/100 [01:01<20:33, 12.85s/it]epoch [4/100], focal_loss:0.0388	, anomaly_loss:0.5134	fnorm_loss:0.0524, a_fnorm_loss:0.0109P:0.00, R:0.00
  5%|▌         | 5/100 [01:28<28:50, 18.22s/it]epoch [5/100], focal_loss:0.0345	, anomaly_loss:0.5078	fnorm_loss:0.0472, a_fnorm_loss:0.0098P:0.00, R:0.00
normal: 0.1660 0.1692  anomaly: 0.1655 0.1691	P:0.00, R:0.00
Pixel Auroc:0.967, Sample Auroc0.521, Pixel Aupro0.0
test_fnorm_loss: 0.0461 test_afnorm_loss: 0.0108
  6%|▌         | 6/100 [01:39<24:25, 15.59s/it]epoch [6/100], focal_loss:0.0326	, anomaly_loss:0.5419	fnorm_loss:0.0452, a_fnorm_loss:0.0101P:0.00, R:0.02
  7%|▋         | 7/100 [01:49<21:20, 13.76s/it]epoch [7/100], focal_loss:0.0316	, anomaly_loss:0.5547	fnorm_loss:0.0424, a_fnorm_loss:0.0089P:0.00, R:0.04
  8%|▊         | 8/100 [01:59<19:27, 12.69s/it]epoch [8/100], focal_loss:0.0282	, anomaly_loss:0.4634	fnorm_loss:0.0394, a_fnorm_loss:0.0227P:0.05, R:0.23
  9%|▉         | 9/100 [02:09<17:54, 11.81s/it]epoch [9/100], focal_loss:0.0269	, anomaly_loss:0.3419	fnorm_loss:0.0349, a_fnorm_loss:0.0335P:0.09, R:0.48
 10%|█         | 10/100 [02:38<25:48, 17.21s/it]epoch [10/100], focal_loss:0.0261	, anomaly_loss:0.2748	fnorm_loss:0.0325, a_fnorm_loss:0.0364P:0.10, R:0.67
normal: 0.2033 0.3734  anomaly: 0.2115 0.4590	P:0.05, R:0.09
Pixel Auroc:0.979, Sample Auroc0.591, Pixel Aupro0.0
test_fnorm_loss: 0.0314 test_afnorm_loss: 0.0235
 11%|█         | 11/100 [02:49<22:16, 15.02s/it]epoch [11/100], focal_loss:0.0217	, anomaly_loss:0.2019	fnorm_loss:0.0293, a_fnorm_loss:0.0395P:0.21, R:0.90
 12%|█▏        | 12/100 [02:58<19:33, 13.33s/it]epoch [12/100], focal_loss:0.0190	, anomaly_loss:0.1535	fnorm_loss:0.0264, a_fnorm_loss:0.0427P:0.21, R:0.95
 13%|█▎        | 13/100 [03:08<18:04, 12.47s/it]epoch [13/100], focal_loss:0.0162	, anomaly_loss:0.1538	fnorm_loss:0.0241, a_fnorm_loss:0.0419P:0.31, R:0.92
 14%|█▍        | 14/100 [03:19<16:53, 11.78s/it]epoch [14/100], focal_loss:0.0150	, anomaly_loss:0.1500	fnorm_loss:0.0223, a_fnorm_loss:0.0420P:0.23, R:0.92
 15%|█▌        | 15/100 [03:51<25:39, 18.11s/it]epoch [15/100], focal_loss:0.0151	, anomaly_loss:0.1458	fnorm_loss:0.0208, a_fnorm_loss:0.0438P:0.24, R:0.93
normal: 0.1384 0.4944  anomaly: 0.1702 0.6720	P:0.11, R:0.24
Pixel Auroc:0.990, Sample Auroc0.719, Pixel Aupro0.0
test_fnorm_loss: 0.0205 test_afnorm_loss: 0.0293
 16%|█▌        | 16/100 [04:02<22:11, 15.86s/it]epoch [16/100], focal_loss:0.0132	, anomaly_loss:0.1341	fnorm_loss:0.0196, a_fnorm_loss:0.0435P:0.23, R:0.93
 17%|█▋        | 17/100 [04:12<19:21, 13.99s/it]epoch [17/100], focal_loss:0.0123	, anomaly_loss:0.1334	fnorm_loss:0.0185, a_fnorm_loss:0.0440P:0.25, R:0.95
 18%|█▊        | 18/100 [04:22<17:44, 12.98s/it]epoch [18/100], focal_loss:0.0119	, anomaly_loss:0.1229	fnorm_loss:0.0176, a_fnorm_loss:0.0463P:0.30, R:0.96
 19%|█▉        | 19/100 [04:33<16:33, 12.27s/it]epoch [19/100], focal_loss:0.0113	, anomaly_loss:0.1357	fnorm_loss:0.0168, a_fnorm_loss:0.0452P:0.25, R:0.93
 20%|██        | 20/100 [05:06<24:41, 18.52s/it]epoch [20/100], focal_loss:0.0115	, anomaly_loss:0.1171	fnorm_loss:0.0162, a_fnorm_loss:0.0452P:0.28, R:0.95
normal: 0.0660 0.3059  anomaly: 0.0722 0.5818	P:0.12, R:0.16
Pixel Auroc:0.986, Sample Auroc0.743, Pixel Aupro0.0
test_fnorm_loss: 0.0157 test_afnorm_loss: 0.0220
 21%|██        | 21/100 [05:17<21:17, 16.16s/it]epoch [21/100], focal_loss:0.0111	, anomaly_loss:0.1172	fnorm_loss:0.0155, a_fnorm_loss:0.0456P:0.26, R:0.94
 22%|██▏       | 22/100 [05:27<18:39, 14.35s/it]epoch [22/100], focal_loss:0.0112	, anomaly_loss:0.1327	fnorm_loss:0.0150, a_fnorm_loss:0.0463P:0.21, R:0.95
 23%|██▎       | 23/100 [05:38<17:10, 13.39s/it]epoch [23/100], focal_loss:0.0108	, anomaly_loss:0.1148	fnorm_loss:0.0144, a_fnorm_loss:0.0457P:0.27, R:0.95
 24%|██▍       | 24/100 [05:49<15:53, 12.55s/it]epoch [24/100], focal_loss:0.0107	, anomaly_loss:0.1169	fnorm_loss:0.0140, a_fnorm_loss:0.0460P:0.27, R:0.95
 25%|██▌       | 25/100 [06:17<21:44, 17.40s/it]epoch [25/100], focal_loss:0.0098	, anomaly_loss:0.1067	fnorm_loss:0.0135, a_fnorm_loss:0.0462P:0.29, R:0.95
normal: 0.1463 0.6477  anomaly: 0.2082 0.8320	P:0.06, R:0.28
Pixel Auroc:0.987, Sample Auroc0.689, Pixel Aupro0.0
test_fnorm_loss: 0.0137 test_afnorm_loss: 0.0369
 26%|██▌       | 26/100 [06:27<18:45, 15.21s/it]epoch [26/100], focal_loss:0.0091	, anomaly_loss:0.1113	fnorm_loss:0.0130, a_fnorm_loss:0.0490P:0.33, R:0.96
 27%|██▋       | 27/100 [06:38<16:50, 13.85s/it]epoch [27/100], focal_loss:0.0091	, anomaly_loss:0.1022	fnorm_loss:0.0128, a_fnorm_loss:0.0493P:0.27, R:0.97
 28%|██▊       | 28/100 [06:49<15:35, 12.99s/it]epoch [28/100], focal_loss:0.0085	, anomaly_loss:0.1053	fnorm_loss:0.0123, a_fnorm_loss:0.0501P:0.30, R:0.97
 29%|██▉       | 29/100 [07:00<14:32, 12.29s/it]epoch [29/100], focal_loss:0.0081	, anomaly_loss:0.1199	fnorm_loss:0.0120, a_fnorm_loss:0.0490P:0.27, R:0.94
 30%|███       | 30/100 [07:27<19:29, 16.71s/it]epoch [30/100], focal_loss:0.0090	, anomaly_loss:0.0964	fnorm_loss:0.0118, a_fnorm_loss:0.0477P:0.31, R:0.96
normal: 0.1107 0.4918  anomaly: 0.0989 0.7752	P:0.10, R:0.23
Pixel Auroc:0.987, Sample Auroc0.714, Pixel Aupro0.0
test_fnorm_loss: 0.0118 test_afnorm_loss: 0.0317
 31%|███       | 31/100 [07:37<17:04, 14.84s/it]epoch [31/100], focal_loss:0.0089	, anomaly_loss:0.0970	fnorm_loss:0.0116, a_fnorm_loss:0.0486P:0.26, R:0.96
 32%|███▏      | 32/100 [07:47<14:57, 13.19s/it]epoch [32/100], focal_loss:0.0074	, anomaly_loss:0.1047	fnorm_loss:0.0112, a_fnorm_loss:0.0505P:0.31, R:0.95
 33%|███▎      | 33/100 [07:59<14:20, 12.84s/it]epoch [33/100], focal_loss:0.0088	, anomaly_loss:0.1031	fnorm_loss:0.0111, a_fnorm_loss:0.0491P:0.30, R:0.96
 34%|███▍      | 34/100 [08:09<13:22, 12.16s/it]epoch [34/100], focal_loss:0.0071	, anomaly_loss:0.0978	fnorm_loss:0.0107, a_fnorm_loss:0.0509P:0.35, R:0.96
 35%|███▌      | 35/100 [08:37<18:13, 16.83s/it]epoch [35/100], focal_loss:0.0075	, anomaly_loss:0.1113	fnorm_loss:0.0106, a_fnorm_loss:0.0507P:0.29, R:0.96
normal: 0.1324 0.5957  anomaly: 0.1879 0.7832	P:0.07, R:0.27
Pixel Auroc:0.987, Sample Auroc0.675, Pixel Aupro0.0
test_fnorm_loss: 0.0111 test_afnorm_loss: 0.0348
 36%|███▌      | 36/100 [08:47<15:43, 14.75s/it]epoch [36/100], focal_loss:0.0079	, anomaly_loss:0.1009	fnorm_loss:0.0104, a_fnorm_loss:0.0508P:0.31, R:0.97
 37%|███▋      | 37/100 [08:57<14:07, 13.44s/it]epoch [37/100], focal_loss:0.0071	, anomaly_loss:0.0992	fnorm_loss:0.0102, a_fnorm_loss:0.0515P:0.33, R:0.96
 38%|███▊      | 38/100 [09:08<12:59, 12.58s/it]epoch [38/100], focal_loss:0.0072	, anomaly_loss:0.0942	fnorm_loss:0.0100, a_fnorm_loss:0.0521P:0.34, R:0.97
 39%|███▉      | 39/100 [09:18<12:04, 11.87s/it]epoch [39/100], focal_loss:0.0066	, anomaly_loss:0.0899	fnorm_loss:0.0098, a_fnorm_loss:0.0512P:0.37, R:0.98
 40%|████      | 40/100 [09:47<17:03, 17.06s/it]epoch [40/100], focal_loss:0.0062	, anomaly_loss:0.1048	fnorm_loss:0.0096, a_fnorm_loss:0.0510P:0.36, R:0.96
normal: 0.0404 0.2154  anomaly: 0.0393 0.5833	P:0.09, R:0.11
Pixel Auroc:0.985, Sample Auroc0.700, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0196
 41%|████      | 41/100 [09:57<14:46, 15.03s/it]epoch [41/100], focal_loss:0.0068	, anomaly_loss:0.0986	fnorm_loss:0.0095, a_fnorm_loss:0.0508P:0.38, R:0.95
 42%|████▏     | 42/100 [10:07<12:59, 13.44s/it]epoch [42/100], focal_loss:0.0061	, anomaly_loss:0.0871	fnorm_loss:0.0095, a_fnorm_loss:0.0497P:0.35, R:0.97
 43%|████▎     | 43/100 [10:17<11:52, 12.50s/it]epoch [43/100], focal_loss:0.0065	, anomaly_loss:0.1024	fnorm_loss:0.0093, a_fnorm_loss:0.0512P:0.38, R:0.96
 44%|████▍     | 44/100 [10:28<11:06, 11.89s/it]epoch [44/100], focal_loss:0.0069	, anomaly_loss:0.0875	fnorm_loss:0.0092, a_fnorm_loss:0.0512P:0.39, R:0.97
 45%|████▌     | 45/100 [10:57<15:31, 16.93s/it]epoch [45/100], focal_loss:0.0056	, anomaly_loss:0.0922	fnorm_loss:0.0089, a_fnorm_loss:0.0526P:0.37, R:0.98
normal: 0.0637 0.5798  anomaly: 0.1051 0.7838	P:0.09, R:0.21
Pixel Auroc:0.983, Sample Auroc0.663, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0310
 46%|████▌     | 46/100 [11:07<13:26, 14.93s/it]epoch [46/100], focal_loss:0.0062	, anomaly_loss:0.0839	fnorm_loss:0.0088, a_fnorm_loss:0.0516P:0.31, R:0.97
 47%|████▋     | 47/100 [11:17<12:01, 13.61s/it]epoch [47/100], focal_loss:0.0068	, anomaly_loss:0.0989	fnorm_loss:0.0089, a_fnorm_loss:0.0520P:0.31, R:0.96
 48%|████▊     | 48/100 [11:28<11:03, 12.76s/it]epoch [48/100], focal_loss:0.0082	, anomaly_loss:0.1041	fnorm_loss:0.0089, a_fnorm_loss:0.0514P:0.35, R:0.96
 49%|████▉     | 49/100 [11:38<10:09, 11.95s/it]epoch [49/100], focal_loss:0.0069	, anomaly_loss:0.1128	fnorm_loss:0.0089, a_fnorm_loss:0.0496P:0.30, R:0.94
 50%|█████     | 50/100 [12:06<13:59, 16.79s/it]epoch [50/100], focal_loss:0.0066	, anomaly_loss:0.0930	fnorm_loss:0.0086, a_fnorm_loss:0.0508P:0.32, R:0.97
normal: 0.0290 0.1953  anomaly: 0.0318 0.5547	P:0.06, R:0.08
Pixel Auroc:0.981, Sample Auroc0.655, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0201
 51%|█████     | 51/100 [12:17<12:12, 14.95s/it]epoch [51/100], focal_loss:0.0055	, anomaly_loss:0.0889	fnorm_loss:0.0083, a_fnorm_loss:0.0543P:0.37, R:0.98
 52%|█████▏    | 52/100 [12:28<10:54, 13.63s/it]epoch [52/100], focal_loss:0.0062	, anomaly_loss:0.1002	fnorm_loss:0.0084, a_fnorm_loss:0.0522P:0.39, R:0.95
 53%|█████▎    | 53/100 [12:37<09:41, 12.36s/it]epoch [53/100], focal_loss:0.0070	, anomaly_loss:0.1001	fnorm_loss:0.0086, a_fnorm_loss:0.0510P:0.31, R:0.96
 54%|█████▍    | 54/100 [12:48<09:05, 11.85s/it]epoch [54/100], focal_loss:0.0057	, anomaly_loss:0.0879	fnorm_loss:0.0081, a_fnorm_loss:0.0533P:0.36, R:0.97
 55%|█████▌    | 55/100 [13:17<12:50, 17.12s/it]epoch [55/100], focal_loss:0.0066	, anomaly_loss:0.0992	fnorm_loss:0.0082, a_fnorm_loss:0.0507P:0.36, R:0.96
normal: 0.0403 0.3614  anomaly: 0.0685 0.6129	P:0.11, R:0.17
Pixel Auroc:0.986, Sample Auroc0.717, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0270
 56%|█████▌    | 56/100 [13:27<10:59, 14.99s/it]epoch [56/100], focal_loss:0.0054	, anomaly_loss:0.0848	fnorm_loss:0.0080, a_fnorm_loss:0.0537P:0.34, R:0.97
 57%|█████▋    | 57/100 [13:37<09:46, 13.64s/it]epoch [57/100], focal_loss:0.0056	, anomaly_loss:0.1049	fnorm_loss:0.0079, a_fnorm_loss:0.0528P:0.41, R:0.95
 58%|█████▊    | 58/100 [13:48<08:56, 12.78s/it]epoch [58/100], focal_loss:0.0052	, anomaly_loss:0.0881	fnorm_loss:0.0078, a_fnorm_loss:0.0543P:0.42, R:0.97
 59%|█████▉    | 59/100 [13:58<08:10, 11.95s/it]epoch [59/100], focal_loss:0.0055	, anomaly_loss:0.0886	fnorm_loss:0.0078, a_fnorm_loss:0.0533P:0.41, R:0.97
 60%|██████    | 60/100 [14:34<12:40, 19.01s/it]epoch [60/100], focal_loss:0.0050	, anomaly_loss:0.0953	fnorm_loss:0.0077, a_fnorm_loss:0.0539P:0.42, R:0.97
normal: 0.0828 0.4606  anomaly: 0.0665 0.7328	P:0.12, R:0.20
Pixel Auroc:0.986, Sample Auroc0.729, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0300
 61%|██████    | 61/100 [14:44<10:34, 16.26s/it]epoch [61/100], focal_loss:0.0058	, anomaly_loss:0.0786	fnorm_loss:0.0077, a_fnorm_loss:0.0535P:0.39, R:0.98
 62%|██████▏   | 62/100 [14:54<09:14, 14.60s/it]epoch [62/100], focal_loss:0.0052	, anomaly_loss:0.0889	fnorm_loss:0.0076, a_fnorm_loss:0.0545P:0.36, R:0.97
 63%|██████▎   | 63/100 [15:04<08:06, 13.14s/it]epoch [63/100], focal_loss:0.0057	, anomaly_loss:0.0969	fnorm_loss:0.0076, a_fnorm_loss:0.0513P:0.37, R:0.95
 64%|██████▍   | 64/100 [15:15<07:30, 12.51s/it]epoch [64/100], focal_loss:0.0055	, anomaly_loss:0.0829	fnorm_loss:0.0075, a_fnorm_loss:0.0535P:0.35, R:0.98
 65%|██████▌   | 65/100 [15:48<10:54, 18.70s/it]epoch [65/100], focal_loss:0.0056	, anomaly_loss:0.0832	fnorm_loss:0.0075, a_fnorm_loss:0.0538P:0.40, R:0.97
normal: 0.0341 0.4305  anomaly: 0.0642 0.6188	P:0.12, R:0.20
Pixel Auroc:0.987, Sample Auroc0.715, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0281
 66%|██████▌   | 66/100 [15:58<09:05, 16.03s/it]epoch [66/100], focal_loss:0.0046	, anomaly_loss:0.0887	fnorm_loss:0.0074, a_fnorm_loss:0.0528P:0.38, R:0.98
 67%|██████▋   | 67/100 [16:08<07:48, 14.19s/it]epoch [67/100], focal_loss:0.0060	, anomaly_loss:0.0848	fnorm_loss:0.0075, a_fnorm_loss:0.0537P:0.35, R:0.98
 68%|██████▊   | 68/100 [16:19<07:00, 13.13s/it]epoch [68/100], focal_loss:0.0053	, anomaly_loss:0.0955	fnorm_loss:0.0073, a_fnorm_loss:0.0531P:0.37, R:0.97
 69%|██████▉   | 69/100 [16:29<06:20, 12.28s/it]epoch [69/100], focal_loss:0.0054	, anomaly_loss:0.0904	fnorm_loss:0.0073, a_fnorm_loss:0.0544P:0.44, R:0.97
 70%|███████   | 70/100 [17:03<09:26, 18.87s/it]epoch [70/100], focal_loss:0.0049	, anomaly_loss:0.0744	fnorm_loss:0.0072, a_fnorm_loss:0.0532P:0.42, R:0.98
normal: 0.0354 0.4322  anomaly: 0.0549 0.6493	P:0.12, R:0.21
Pixel Auroc:0.985, Sample Auroc0.712, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0297
 71%|███████   | 71/100 [17:13<07:48, 16.17s/it]epoch [71/100], focal_loss:0.0054	, anomaly_loss:0.0868	fnorm_loss:0.0073, a_fnorm_loss:0.0537P:0.33, R:0.97
 72%|███████▏  | 72/100 [17:23<06:42, 14.37s/it]epoch [72/100], focal_loss:0.0049	, anomaly_loss:0.0796	fnorm_loss:0.0071, a_fnorm_loss:0.0548P:0.39, R:0.98
 73%|███████▎  | 73/100 [17:33<05:49, 12.93s/it]epoch [73/100], focal_loss:0.0043	, anomaly_loss:0.0775	fnorm_loss:0.0070, a_fnorm_loss:0.0549P:0.37, R:0.98
 74%|███████▍  | 74/100 [17:43<05:12, 12.02s/it]epoch [74/100], focal_loss:0.0041	, anomaly_loss:0.0714	fnorm_loss:0.0070, a_fnorm_loss:0.0569P:0.40, R:0.98
 75%|███████▌  | 75/100 [18:12<07:12, 17.32s/it]epoch [75/100], focal_loss:0.0056	, anomaly_loss:0.0824	fnorm_loss:0.0072, a_fnorm_loss:0.0541P:0.38, R:0.97
normal: 0.0257 0.2507  anomaly: 0.0291 0.5435	P:0.09, R:0.11
Pixel Auroc:0.984, Sample Auroc0.732, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0171
 76%|███████▌  | 76/100 [18:23<06:05, 15.23s/it]epoch [76/100], focal_loss:0.0045	, anomaly_loss:0.0700	fnorm_loss:0.0070, a_fnorm_loss:0.0549P:0.38, R:0.98
 77%|███████▋  | 77/100 [18:33<05:18, 13.86s/it]epoch [77/100], focal_loss:0.0055	, anomaly_loss:0.0738	fnorm_loss:0.0070, a_fnorm_loss:0.0537P:0.38, R:0.98
 78%|███████▊  | 78/100 [18:43<04:37, 12.62s/it]epoch [78/100], focal_loss:0.0054	, anomaly_loss:0.0721	fnorm_loss:0.0070, a_fnorm_loss:0.0546P:0.34, R:0.97
 79%|███████▉  | 79/100 [18:53<04:06, 11.74s/it]epoch [79/100], focal_loss:0.0056	, anomaly_loss:0.0912	fnorm_loss:0.0071, a_fnorm_loss:0.0532P:0.41, R:0.95
 80%|████████  | 80/100 [19:21<05:34, 16.73s/it]epoch [80/100], focal_loss:0.0045	, anomaly_loss:0.0791	fnorm_loss:0.0069, a_fnorm_loss:0.0535P:0.43, R:0.99
normal: 0.1019 0.5066  anomaly: 0.1286 0.8137	P:0.11, R:0.24
Pixel Auroc:0.986, Sample Auroc0.729, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0328
 81%|████████  | 81/100 [19:31<04:41, 14.82s/it]epoch [81/100], focal_loss:0.0047	, anomaly_loss:0.0660	fnorm_loss:0.0068, a_fnorm_loss:0.0579P:0.38, R:0.99
 82%|████████▏ | 82/100 [19:42<04:01, 13.41s/it]epoch [82/100], focal_loss:0.0039	, anomaly_loss:0.0720	fnorm_loss:0.0068, a_fnorm_loss:0.0565P:0.44, R:0.98
 83%|████████▎ | 83/100 [19:52<03:33, 12.59s/it]epoch [83/100], focal_loss:0.0047	, anomaly_loss:0.0819	fnorm_loss:0.0069, a_fnorm_loss:0.0561P:0.41, R:0.99
 84%|████████▍ | 84/100 [20:03<03:12, 12.02s/it]epoch [84/100], focal_loss:0.0049	, anomaly_loss:0.0771	fnorm_loss:0.0069, a_fnorm_loss:0.0547P:0.39, R:0.98
 85%|████████▌ | 85/100 [20:36<04:34, 18.31s/it]epoch [85/100], focal_loss:0.0046	, anomaly_loss:0.0752	fnorm_loss:0.0068, a_fnorm_loss:0.0550P:0.43, R:0.99
normal: 0.0245 0.3366  anomaly: 0.0276 0.5818	P:0.14, R:0.18
Pixel Auroc:0.985, Sample Auroc0.730, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0265
 86%|████████▌ | 86/100 [20:46<03:39, 15.70s/it]epoch [86/100], focal_loss:0.0046	, anomaly_loss:0.0856	fnorm_loss:0.0068, a_fnorm_loss:0.0543P:0.37, R:0.98
 87%|████████▋ | 87/100 [20:56<03:02, 14.04s/it]epoch [87/100], focal_loss:0.0042	, anomaly_loss:0.0759	fnorm_loss:0.0068, a_fnorm_loss:0.0581P:0.40, R:0.99
 88%|████████▊ | 88/100 [21:06<02:34, 12.86s/it]epoch [88/100], focal_loss:0.0037	, anomaly_loss:0.0783	fnorm_loss:0.0067, a_fnorm_loss:0.0574P:0.46, R:0.99
 89%|████████▉ | 89/100 [21:16<02:12, 12.02s/it]epoch [89/100], focal_loss:0.0048	, anomaly_loss:0.0951	fnorm_loss:0.0067, a_fnorm_loss:0.0529P:0.40, R:0.96
 90%|█████████ | 90/100 [21:44<02:49, 16.97s/it]epoch [90/100], focal_loss:0.0043	, anomaly_loss:0.0831	fnorm_loss:0.0068, a_fnorm_loss:0.0557P:0.39, R:0.97
normal: 0.0294 0.4976  anomaly: 0.0490 0.6709	P:0.11, R:0.22
Pixel Auroc:0.987, Sample Auroc0.712, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0364
 91%|█████████ | 91/100 [21:55<02:14, 14.97s/it]epoch [91/100], focal_loss:0.0049	, anomaly_loss:0.0748	fnorm_loss:0.0069, a_fnorm_loss:0.0578P:0.39, R:0.99
 92%|█████████▏| 92/100 [22:05<01:47, 13.44s/it]epoch [92/100], focal_loss:0.0044	, anomaly_loss:0.0721	fnorm_loss:0.0068, a_fnorm_loss:0.0535P:0.40, R:0.98
 93%|█████████▎| 93/100 [22:15<01:26, 12.38s/it]epoch [93/100], focal_loss:0.0045	, anomaly_loss:0.0760	fnorm_loss:0.0068, a_fnorm_loss:0.0567P:0.41, R:0.98
 94%|█████████▍| 94/100 [22:25<01:11, 11.92s/it]epoch [94/100], focal_loss:0.0042	, anomaly_loss:0.0650	fnorm_loss:0.0068, a_fnorm_loss:0.0548P:0.40, R:0.93
 95%|█████████▌| 95/100 [22:53<01:23, 16.72s/it]epoch [95/100], focal_loss:0.0040	, anomaly_loss:0.0878	fnorm_loss:0.0068, a_fnorm_loss:0.0549P:0.45, R:0.98
normal: 0.0288 0.4640  anomaly: 0.0405 0.6308	P:0.12, R:0.21
Pixel Auroc:0.986, Sample Auroc0.715, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0329
 96%|█████████▌| 96/100 [23:04<00:59, 14.82s/it]epoch [96/100], focal_loss:0.0044	, anomaly_loss:0.0681	fnorm_loss:0.0068, a_fnorm_loss:0.0556P:0.40, R:0.98
 97%|█████████▋| 97/100 [23:15<00:41, 13.67s/it]epoch [97/100], focal_loss:0.0043	, anomaly_loss:0.0796	fnorm_loss:0.0068, a_fnorm_loss:0.0541P:0.38, R:0.99
 98%|█████████▊| 98/100 [23:25<00:25, 12.57s/it]epoch [98/100], focal_loss:0.0044	, anomaly_loss:0.0888	fnorm_loss:0.0068, a_fnorm_loss:0.0562P:0.41, R:0.98
 99%|█████████▉| 99/100 [23:35<00:12, 12.01s/it]epoch [99/100], focal_loss:0.0043	, anomaly_loss:0.0731	fnorm_loss:0.0068, a_fnorm_loss:0.0556P:0.43, R:0.99
100%|██████████| 100/100 [24:04<00:00, 16.87s/it]100%|██████████| 100/100 [24:04<00:00, 14.44s/it]
epoch [100/100], focal_loss:0.0041	, anomaly_loss:0.0870	fnorm_loss:0.0068, a_fnorm_loss:0.0559P:0.35, R:0.97
normal: 0.0257 0.4104  anomaly: 0.0352 0.5966	P:0.12, R:0.19
Pixel Auroc:0.986, Sample Auroc0.718, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0316
training Stubborn Student...
carrot
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<11:39,  5.88s/it]epoch [1/120], kd_loss:4.4110
  2%|▏         | 2/120 [00:11<11:34,  5.89s/it]epoch [2/120], kd_loss:3.2987
  2%|▎         | 3/120 [00:17<11:28,  5.89s/it]epoch [3/120], kd_loss:2.8557
  3%|▎         | 4/120 [00:23<11:23,  5.89s/it]epoch [4/120], kd_loss:2.4258
  4%|▍         | 5/120 [00:29<11:19,  5.90s/it]epoch [5/120], kd_loss:2.1930
  5%|▌         | 6/120 [00:35<11:17,  5.95s/it]epoch [6/120], kd_loss:1.6636
  6%|▌         | 7/120 [00:41<11:16,  5.99s/it]epoch [7/120], kd_loss:1.4627
  7%|▋         | 8/120 [00:47<11:15,  6.03s/it]epoch [8/120], kd_loss:1.3286
  8%|▊         | 9/120 [00:53<11:07,  6.02s/it]epoch [9/120], kd_loss:1.2186
  8%|▊         | 10/120 [01:17<21:08, 11.53s/it]epoch [10/120], kd_loss:1.6412
normal: 0.8215 1.1582  anomaly: 0.7789 1.9597
thresh: 0.8904147427569504
fpr: 0.6666666666666666 fnr 0.030303030303030304
Pixel Auroc:0.981, Sample Auroc0.828, Pixel Aupro0.0
  9%|▉         | 11/120 [01:23<17:48,  9.80s/it]epoch [11/120], kd_loss:1.2311
 10%|█         | 12/120 [01:29<15:29,  8.60s/it]epoch [12/120], kd_loss:1.6301
 11%|█         | 13/120 [01:35<13:54,  7.80s/it]epoch [13/120], kd_loss:1.3722
 12%|█▏        | 14/120 [01:41<12:51,  7.28s/it]epoch [14/120], kd_loss:1.1796
 12%|█▎        | 15/120 [01:47<12:07,  6.93s/it]epoch [15/120], kd_loss:1.1333
 13%|█▎        | 16/120 [01:53<11:33,  6.67s/it]epoch [16/120], kd_loss:1.0939
 14%|█▍        | 17/120 [01:59<11:08,  6.49s/it]epoch [17/120], kd_loss:1.0809
 15%|█▌        | 18/120 [02:05<10:49,  6.37s/it]epoch [18/120], kd_loss:1.3266
 16%|█▌        | 19/120 [02:11<10:33,  6.27s/it]epoch [19/120], kd_loss:1.2081
 17%|█▋        | 20/120 [02:36<19:45, 11.85s/it]epoch [20/120], kd_loss:1.0731
normal: 0.6885 1.1059  anomaly: 0.6566 1.7574
thresh: 0.7917837049237829
fpr: 0.6666666666666666 fnr 0.03787878787878788
Pixel Auroc:0.982, Sample Auroc0.845, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:42<16:39, 10.10s/it]epoch [21/120], kd_loss:1.1123
 18%|█▊        | 22/120 [02:48<14:25,  8.83s/it]epoch [22/120], kd_loss:1.0136
 19%|█▉        | 23/120 [02:54<12:50,  7.95s/it]epoch [23/120], kd_loss:2.0980
 20%|██        | 24/120 [03:00<11:45,  7.35s/it]epoch [24/120], kd_loss:1.5294
 21%|██        | 25/120 [03:06<11:00,  6.95s/it]epoch [25/120], kd_loss:1.5037
 22%|██▏       | 26/120 [03:12<10:29,  6.69s/it]epoch [26/120], kd_loss:1.5803
 22%|██▎       | 27/120 [03:18<10:03,  6.49s/it]epoch [27/120], kd_loss:1.6656
 23%|██▎       | 28/120 [03:24<09:45,  6.37s/it]epoch [28/120], kd_loss:1.2274
 24%|██▍       | 29/120 [03:30<09:30,  6.27s/it]epoch [29/120], kd_loss:1.1346
 25%|██▌       | 30/120 [03:55<17:36, 11.74s/it]epoch [30/120], kd_loss:1.0907
normal: 0.7652 1.0994  anomaly: 0.6744 1.7557
thresh: 0.8000151528219913
fpr: 0.8518518518518519 fnr 0.015151515151515152
Pixel Auroc:0.981, Sample Auroc0.831, Pixel Aupro0.0
 26%|██▌       | 31/120 [04:01<14:52, 10.03s/it]epoch [31/120], kd_loss:1.1727
 27%|██▋       | 32/120 [04:07<12:54,  8.80s/it]epoch [32/120], kd_loss:1.0486
 28%|██▊       | 33/120 [04:13<11:33,  7.97s/it]epoch [33/120], kd_loss:1.2621
 28%|██▊       | 34/120 [04:19<10:38,  7.43s/it]epoch [34/120], kd_loss:1.0493
 29%|██▉       | 35/120 [04:25<09:56,  7.02s/it]epoch [35/120], kd_loss:1.0961
 30%|███       | 36/120 [04:31<09:28,  6.76s/it]epoch [36/120], kd_loss:1.0352
 31%|███       | 37/120 [04:37<09:00,  6.52s/it]epoch [37/120], kd_loss:1.0586
 32%|███▏      | 38/120 [04:43<08:43,  6.39s/it]epoch [38/120], kd_loss:1.0074
 32%|███▎      | 39/120 [04:49<08:27,  6.27s/it]epoch [39/120], kd_loss:0.9902
 33%|███▎      | 40/120 [05:14<15:44, 11.81s/it]epoch [40/120], kd_loss:0.9753
normal: 0.6176 1.0469  anomaly: 0.6309 1.8092
thresh: 0.774892963000922
fpr: 0.5555555555555556 fnr 0.045454545454545456
Pixel Auroc:0.985, Sample Auroc0.863, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:20<13:13, 10.05s/it]epoch [41/120], kd_loss:0.9686
 35%|███▌      | 42/120 [05:26<11:27,  8.81s/it]epoch [42/120], kd_loss:0.9988
 36%|███▌      | 43/120 [05:32<10:14,  7.98s/it]epoch [43/120], kd_loss:1.0504
 37%|███▋      | 44/120 [05:38<09:19,  7.36s/it]epoch [44/120], kd_loss:1.1031
 38%|███▊      | 45/120 [05:44<08:43,  6.98s/it]epoch [45/120], kd_loss:1.0060
 38%|███▊      | 46/120 [05:50<08:15,  6.70s/it]epoch [46/120], kd_loss:0.9602
 39%|███▉      | 47/120 [05:56<07:56,  6.53s/it]epoch [47/120], kd_loss:1.0042
 40%|████      | 48/120 [06:02<07:41,  6.42s/it]epoch [48/120], kd_loss:0.9685
 41%|████      | 49/120 [06:08<07:27,  6.31s/it]epoch [49/120], kd_loss:0.9565
 42%|████▏     | 50/120 [06:34<14:10, 12.15s/it]epoch [50/120], kd_loss:0.9491
normal: 0.6009 1.0346  anomaly: 0.6024 1.7351
thresh: 0.739627849559247
fpr: 0.5555555555555556 fnr 0.03787878787878788
Pixel Auroc:0.986, Sample Auroc0.872, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:40<11:49, 10.28s/it]epoch [51/120], kd_loss:0.9506
 43%|████▎     | 52/120 [06:46<10:09,  8.96s/it]epoch [52/120], kd_loss:0.9988
 44%|████▍     | 53/120 [06:52<08:59,  8.05s/it]epoch [53/120], kd_loss:0.9472
 45%|████▌     | 54/120 [06:58<08:11,  7.44s/it]epoch [54/120], kd_loss:0.9372
 46%|████▌     | 55/120 [07:04<07:36,  7.02s/it]epoch [55/120], kd_loss:0.9314
 47%|████▋     | 56/120 [07:10<07:10,  6.73s/it]epoch [56/120], kd_loss:0.9382
 48%|████▊     | 57/120 [07:16<06:50,  6.52s/it]epoch [57/120], kd_loss:0.9371
 48%|████▊     | 58/120 [07:22<06:34,  6.37s/it]epoch [58/120], kd_loss:0.9322
 49%|████▉     | 59/120 [07:28<06:23,  6.28s/it]epoch [59/120], kd_loss:1.1744
 50%|█████     | 60/120 [07:51<11:17, 11.29s/it]epoch [60/120], kd_loss:1.0745
normal: 0.6375 1.0191  anomaly: 0.6123 1.7771
thresh: 0.7329610229904773
fpr: 0.6666666666666666 fnr 0.022727272727272728
Pixel Auroc:0.983, Sample Auroc0.865, Pixel Aupro0.0
 51%|█████     | 61/120 [07:57<09:30,  9.67s/it]epoch [61/120], kd_loss:0.9994
 52%|█████▏    | 62/120 [08:02<08:14,  8.52s/it]epoch [62/120], kd_loss:1.5696
 52%|█████▎    | 63/120 [08:08<07:20,  7.74s/it]epoch [63/120], kd_loss:1.2593
 53%|█████▎    | 64/120 [08:14<06:43,  7.21s/it]epoch [64/120], kd_loss:1.1002
 54%|█████▍    | 65/120 [08:20<06:16,  6.85s/it]epoch [65/120], kd_loss:1.0705
 55%|█████▌    | 66/120 [08:26<05:58,  6.63s/it]epoch [66/120], kd_loss:1.0506
 56%|█████▌    | 67/120 [08:32<05:41,  6.44s/it]epoch [67/120], kd_loss:1.0573
 57%|█████▋    | 68/120 [08:39<05:29,  6.34s/it]epoch [68/120], kd_loss:1.0769
 57%|█████▊    | 69/120 [08:45<05:19,  6.27s/it]epoch [69/120], kd_loss:1.0084
 58%|█████▊    | 70/120 [09:08<09:33, 11.46s/it]epoch [70/120], kd_loss:1.0005
normal: 0.6402 1.0743  anomaly: 0.6228 1.7847
thresh: 0.7571419882416646
fpr: 0.5925925925925926 fnr 0.03787878787878788
Pixel Auroc:0.984, Sample Auroc0.866, Pixel Aupro0.0
 59%|█████▉    | 71/120 [09:14<08:00,  9.81s/it]epoch [71/120], kd_loss:0.9741
 60%|██████    | 72/120 [09:20<06:55,  8.66s/it]epoch [72/120], kd_loss:0.9848
 61%|██████    | 73/120 [09:26<06:08,  7.85s/it]epoch [73/120], kd_loss:0.9538
 62%|██████▏   | 74/120 [09:32<05:35,  7.30s/it]epoch [74/120], kd_loss:0.9823
 62%|██████▎   | 75/120 [09:38<05:09,  6.87s/it]epoch [75/120], kd_loss:0.9541
 63%|██████▎   | 76/120 [09:44<04:52,  6.64s/it]epoch [76/120], kd_loss:0.9417
 64%|██████▍   | 77/120 [09:50<04:38,  6.48s/it]epoch [77/120], kd_loss:1.1515
 65%|██████▌   | 78/120 [09:56<04:27,  6.37s/it]epoch [78/120], kd_loss:0.9659
 66%|██████▌   | 79/120 [10:03<04:18,  6.31s/it]epoch [79/120], kd_loss:0.9383
 67%|██████▋   | 80/120 [10:26<07:34, 11.36s/it]epoch [80/120], kd_loss:0.9640
normal: 0.6994 1.1158  anomaly: 0.6629 1.8443
thresh: 0.8125986260048058
fpr: 0.5925925925925926 fnr 0.03787878787878788
Pixel Auroc:0.985, Sample Auroc0.866, Pixel Aupro0.0
 68%|██████▊   | 81/120 [10:32<06:21,  9.79s/it]epoch [81/120], kd_loss:0.9434
 68%|██████▊   | 82/120 [10:38<05:29,  8.66s/it]epoch [82/120], kd_loss:0.9229
 69%|██████▉   | 83/120 [10:44<04:51,  7.87s/it]epoch [83/120], kd_loss:0.9241
 70%|███████   | 84/120 [10:50<04:22,  7.30s/it]epoch [84/120], kd_loss:0.9228
 71%|███████   | 85/120 [10:56<04:01,  6.91s/it]epoch [85/120], kd_loss:0.9117
 72%|███████▏  | 86/120 [11:02<03:45,  6.63s/it]epoch [86/120], kd_loss:0.9883
 72%|███████▎  | 87/120 [11:08<03:32,  6.44s/it]epoch [87/120], kd_loss:0.9347
 73%|███████▎  | 88/120 [11:14<03:21,  6.31s/it]epoch [88/120], kd_loss:0.9139
 74%|███████▍  | 89/120 [11:20<03:13,  6.23s/it]epoch [89/120], kd_loss:0.9073
 75%|███████▌  | 90/120 [11:46<06:05, 12.17s/it]epoch [90/120], kd_loss:0.9244
normal: 0.6081 1.0334  anomaly: 0.5664 1.7590
thresh: 0.7151962276003374
fpr: 0.6296296296296297 fnr 0.030303030303030304
Pixel Auroc:0.987, Sample Auroc0.880, Pixel Aupro0.0
 76%|███████▌  | 91/120 [11:52<04:59, 10.33s/it]epoch [91/120], kd_loss:0.9040
 77%|███████▋  | 92/120 [11:58<04:12,  9.03s/it]epoch [92/120], kd_loss:0.9077
 78%|███████▊  | 93/120 [12:04<03:39,  8.15s/it]epoch [93/120], kd_loss:0.9208
 78%|███████▊  | 94/120 [12:10<03:16,  7.55s/it]epoch [94/120], kd_loss:0.9039
 79%|███████▉  | 95/120 [12:16<02:56,  7.08s/it]epoch [95/120], kd_loss:0.8947
 80%|████████  | 96/120 [12:22<02:42,  6.78s/it]epoch [96/120], kd_loss:0.8910
 81%|████████  | 97/120 [12:28<02:31,  6.58s/it]epoch [97/120], kd_loss:0.8844
 82%|████████▏ | 98/120 [12:35<02:22,  6.47s/it]epoch [98/120], kd_loss:0.8813
 82%|████████▎ | 99/120 [12:41<02:13,  6.37s/it]epoch [99/120], kd_loss:0.8801
 83%|████████▎ | 100/120 [13:06<04:01, 12.07s/it]epoch [100/120], kd_loss:0.8791
normal: 0.5766 0.9942  anomaly: 0.5563 1.7545
thresh: 0.7039695926105675
fpr: 0.6296296296296297 fnr 0.030303030303030304
Pixel Auroc:0.987, Sample Auroc0.885, Pixel Aupro0.0
 84%|████████▍ | 101/120 [13:12<03:14, 10.24s/it]epoch [101/120], kd_loss:0.8785
 85%|████████▌ | 102/120 [13:18<02:41,  8.97s/it]epoch [102/120], kd_loss:0.8781
 86%|████████▌ | 103/120 [13:24<02:17,  8.10s/it]epoch [103/120], kd_loss:0.8771
 87%|████████▋ | 104/120 [13:30<01:59,  7.48s/it]epoch [104/120], kd_loss:0.8765
 88%|████████▊ | 105/120 [13:36<01:45,  7.04s/it]epoch [105/120], kd_loss:0.8767
 88%|████████▊ | 106/120 [13:42<01:34,  6.75s/it]epoch [106/120], kd_loss:0.8788
 89%|████████▉ | 107/120 [13:48<01:25,  6.54s/it]epoch [107/120], kd_loss:0.8749
 90%|█████████ | 108/120 [13:54<01:17,  6.44s/it]epoch [108/120], kd_loss:0.8743
 91%|█████████ | 109/120 [14:01<01:09,  6.33s/it]epoch [109/120], kd_loss:0.8729
 92%|█████████▏| 110/120 [14:24<01:55, 11.56s/it]epoch [110/120], kd_loss:0.8722
normal: 0.5728 1.0411  anomaly: 0.5591 1.7709
thresh: 0.6966411057700597
fpr: 0.6296296296296297 fnr 0.030303030303030304
Pixel Auroc:0.987, Sample Auroc0.888, Pixel Aupro0.0
 92%|█████████▎| 111/120 [14:30<01:29,  9.90s/it]epoch [111/120], kd_loss:0.8719
 93%|█████████▎| 112/120 [14:36<01:09,  8.71s/it]epoch [112/120], kd_loss:0.8718
 94%|█████████▍| 113/120 [14:42<00:55,  7.94s/it]epoch [113/120], kd_loss:0.8715
 95%|█████████▌| 114/120 [14:48<00:44,  7.38s/it]epoch [114/120], kd_loss:0.8714
 96%|█████████▌| 115/120 [14:54<00:34,  6.97s/it]epoch [115/120], kd_loss:0.8713
 97%|█████████▋| 116/120 [15:01<00:26,  6.69s/it]epoch [116/120], kd_loss:0.8713
 98%|█████████▊| 117/120 [15:07<00:19,  6.51s/it]epoch [117/120], kd_loss:0.8709
 98%|█████████▊| 118/120 [15:13<00:12,  6.44s/it]epoch [118/120], kd_loss:0.8705
 99%|█████████▉| 119/120 [15:19<00:06,  6.34s/it]epoch [119/120], kd_loss:0.8707
100%|██████████| 120/120 [15:42<00:00, 11.28s/it]100%|██████████| 120/120 [15:42<00:00,  7.85s/it]
epoch [120/120], kd_loss:0.8706
normal: 0.5741 1.0166  anomaly: 0.5583 1.7611
thresh: 0.6974414974668968
fpr: 0.6296296296296297 fnr 0.030303030303030304
Pixel Auroc:0.987, Sample Auroc0.887, Pixel Aupro0.0
training Advanced Teacher...
cookie
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:26<44:12, 26.80s/it]epoch [1/100], focal_loss:0.0809	, anomaly_loss:0.5650	fnorm_loss:0.0708, a_fnorm_loss:0.0164P:0.00, R:0.05
normal: 0.2559 0.2633  anomaly: 0.2537 0.2641	P:0.00, R:0.00
Pixel Auroc:0.710, Sample Auroc0.574, Pixel Aupro0.0
test_fnorm_loss: 0.0736 test_afnorm_loss: 0.0224
  2%|▏         | 2/100 [00:33<24:02, 14.72s/it]epoch [2/100], focal_loss:0.0728	, anomaly_loss:0.5512	fnorm_loss:0.0684, a_fnorm_loss:0.0157P:0.00, R:0.00
  3%|▎         | 3/100 [00:39<17:22, 10.75s/it]epoch [3/100], focal_loss:0.0632	, anomaly_loss:0.5680	fnorm_loss:0.0624, a_fnorm_loss:0.0143P:0.00, R:0.00
  4%|▍         | 4/100 [00:45<14:13,  8.89s/it]epoch [4/100], focal_loss:0.0628	, anomaly_loss:0.5824	fnorm_loss:0.0572, a_fnorm_loss:0.0132P:0.00, R:0.00
  5%|▌         | 5/100 [01:05<20:25, 12.90s/it]epoch [5/100], focal_loss:0.0564	, anomaly_loss:0.5941	fnorm_loss:0.0536, a_fnorm_loss:0.0123P:0.00, R:0.00
normal: 0.1854 0.1894  anomaly: 0.1845 0.1901	P:0.00, R:0.00
Pixel Auroc:0.726, Sample Auroc0.584, Pixel Aupro0.0
test_fnorm_loss: 0.0531 test_afnorm_loss: 0.0164
  6%|▌         | 6/100 [01:11<16:30, 10.53s/it]epoch [6/100], focal_loss:0.0534	, anomaly_loss:0.6027	fnorm_loss:0.0505, a_fnorm_loss:0.0118P:0.00, R:0.00
  7%|▋         | 7/100 [01:17<14:04,  9.08s/it]epoch [7/100], focal_loss:0.0538	, anomaly_loss:0.5661	fnorm_loss:0.0486, a_fnorm_loss:0.0118P:0.00, R:0.00
  8%|▊         | 8/100 [01:23<12:26,  8.12s/it]epoch [8/100], focal_loss:0.0479	, anomaly_loss:0.6179	fnorm_loss:0.0458, a_fnorm_loss:0.0106P:0.00, R:0.00
  9%|▉         | 9/100 [01:29<11:16,  7.43s/it]epoch [9/100], focal_loss:0.0525	, anomaly_loss:0.6229	fnorm_loss:0.0448, a_fnorm_loss:0.0105P:0.00, R:0.00
 10%|█         | 10/100 [01:51<17:51, 11.90s/it]epoch [10/100], focal_loss:0.0583	, anomaly_loss:0.6011	fnorm_loss:0.0484, a_fnorm_loss:0.0135P:0.00, R:0.02
normal: 0.2111 0.2253  anomaly: 0.2052 0.2307	P:0.03, R:0.01
Pixel Auroc:0.892, Sample Auroc0.480, Pixel Aupro0.0
test_fnorm_loss: 0.0517 test_afnorm_loss: 0.0230
 11%|█         | 11/100 [01:56<14:54, 10.05s/it]epoch [11/100], focal_loss:0.0465	, anomaly_loss:0.5120	fnorm_loss:0.0432, a_fnorm_loss:0.0278P:0.11, R:0.28
 12%|█▏        | 12/100 [02:03<13:01,  8.88s/it]epoch [12/100], focal_loss:0.0478	, anomaly_loss:0.5083	fnorm_loss:0.0393, a_fnorm_loss:0.0312P:0.11, R:0.30
 13%|█▎        | 13/100 [02:10<12:04,  8.32s/it]epoch [13/100], focal_loss:0.0467	, anomaly_loss:0.4933	fnorm_loss:0.0394, a_fnorm_loss:0.0341P:0.12, R:0.34
 14%|█▍        | 14/100 [02:16<10:52,  7.59s/it]epoch [14/100], focal_loss:0.0438	, anomaly_loss:0.4984	fnorm_loss:0.0349, a_fnorm_loss:0.0335P:0.10, R:0.32
 15%|█▌        | 15/100 [02:41<18:26, 13.01s/it]epoch [15/100], focal_loss:0.0390	, anomaly_loss:0.4708	fnorm_loss:0.0327, a_fnorm_loss:0.0355P:0.15, R:0.35
normal: 0.3435 0.4098  anomaly: 0.2977 0.4334	P:0.07, R:0.38
Pixel Auroc:0.926, Sample Auroc0.572, Pixel Aupro0.0
test_fnorm_loss: 0.0334 test_afnorm_loss: 0.0286
 16%|█▌        | 16/100 [02:47<15:18, 10.94s/it]epoch [16/100], focal_loss:0.0385	, anomaly_loss:0.4535	fnorm_loss:0.0308, a_fnorm_loss:0.0370P:0.29, R:0.58
 17%|█▋        | 17/100 [02:53<13:01,  9.42s/it]epoch [17/100], focal_loss:0.0307	, anomaly_loss:0.4315	fnorm_loss:0.0278, a_fnorm_loss:0.0386P:0.28, R:0.69
 18%|█▊        | 18/100 [02:59<11:25,  8.36s/it]epoch [18/100], focal_loss:0.0367	, anomaly_loss:0.4450	fnorm_loss:0.0263, a_fnorm_loss:0.0396P:0.26, R:0.60
 19%|█▉        | 19/100 [03:05<10:17,  7.62s/it]epoch [19/100], focal_loss:0.0286	, anomaly_loss:0.4036	fnorm_loss:0.0245, a_fnorm_loss:0.0410P:0.37, R:0.83
 20%|██        | 20/100 [03:30<17:14, 12.93s/it]epoch [20/100], focal_loss:0.0242	, anomaly_loss:0.3929	fnorm_loss:0.0229, a_fnorm_loss:0.0421P:0.40, R:0.88
normal: 0.0992 0.2102  anomaly: 0.0866 0.3736	P:0.11, R:0.04
Pixel Auroc:0.954, Sample Auroc0.590, Pixel Aupro0.0
test_fnorm_loss: 0.0216 test_afnorm_loss: 0.0114
 21%|██        | 21/100 [03:37<14:29, 11.00s/it]epoch [21/100], focal_loss:0.0305	, anomaly_loss:0.4096	fnorm_loss:0.0220, a_fnorm_loss:0.0410P:0.46, R:0.80
 22%|██▏       | 22/100 [03:43<12:18,  9.47s/it]epoch [22/100], focal_loss:0.0218	, anomaly_loss:0.3681	fnorm_loss:0.0211, a_fnorm_loss:0.0446P:0.39, R:0.93
 23%|██▎       | 23/100 [03:48<10:44,  8.37s/it]epoch [23/100], focal_loss:0.0201	, anomaly_loss:0.3705	fnorm_loss:0.0199, a_fnorm_loss:0.0446P:0.43, R:0.92
 24%|██▍       | 24/100 [03:55<09:43,  7.68s/it]epoch [24/100], focal_loss:0.0223	, anomaly_loss:0.3996	fnorm_loss:0.0194, a_fnorm_loss:0.0409P:0.41, R:0.86
 25%|██▌       | 25/100 [04:14<14:10, 11.34s/it]epoch [25/100], focal_loss:0.0209	, anomaly_loss:0.3648	fnorm_loss:0.0187, a_fnorm_loss:0.0448P:0.45, R:0.93
normal: 0.4748 0.5790  anomaly: 0.4907 0.6758	P:0.06, R:0.67
Pixel Auroc:0.944, Sample Auroc0.658, Pixel Aupro0.0
test_fnorm_loss: 0.0248 test_afnorm_loss: 0.0397
 26%|██▌       | 26/100 [04:21<12:05,  9.81s/it]epoch [26/100], focal_loss:0.0242	, anomaly_loss:0.3849	fnorm_loss:0.0188, a_fnorm_loss:0.0437P:0.41, R:0.89
 27%|██▋       | 27/100 [04:26<10:27,  8.60s/it]epoch [27/100], focal_loss:0.0162	, anomaly_loss:0.3688	fnorm_loss:0.0174, a_fnorm_loss:0.0448P:0.45, R:0.93
 28%|██▊       | 28/100 [04:32<09:23,  7.83s/it]epoch [28/100], focal_loss:0.0156	, anomaly_loss:0.3617	fnorm_loss:0.0167, a_fnorm_loss:0.0493P:0.44, R:0.94
 29%|██▉       | 29/100 [04:38<08:33,  7.23s/it]epoch [29/100], focal_loss:0.0174	, anomaly_loss:0.3436	fnorm_loss:0.0163, a_fnorm_loss:0.0463P:0.46, R:0.85
 30%|███       | 30/100 [05:04<14:49, 12.71s/it]epoch [30/100], focal_loss:0.0150	, anomaly_loss:0.3632	fnorm_loss:0.0157, a_fnorm_loss:0.0464P:0.46, R:0.93
normal: 0.0804 0.3191  anomaly: 0.0761 0.5599	P:0.31, R:0.13
Pixel Auroc:0.973, Sample Auroc0.724, Pixel Aupro0.0
test_fnorm_loss: 0.0148 test_afnorm_loss: 0.0114
 31%|███       | 31/100 [05:10<12:21, 10.74s/it]epoch [31/100], focal_loss:0.0160	, anomaly_loss:0.3595	fnorm_loss:0.0153, a_fnorm_loss:0.0466P:0.53, R:0.92
 32%|███▏      | 32/100 [05:16<10:36,  9.35s/it]epoch [32/100], focal_loss:0.0174	, anomaly_loss:0.3687	fnorm_loss:0.0152, a_fnorm_loss:0.0488P:0.49, R:0.90
 33%|███▎      | 33/100 [05:22<09:26,  8.45s/it]epoch [33/100], focal_loss:0.0181	, anomaly_loss:0.3739	fnorm_loss:0.0147, a_fnorm_loss:0.0465P:0.49, R:0.89
 34%|███▍      | 34/100 [05:29<08:32,  7.77s/it]epoch [34/100], focal_loss:0.0141	, anomaly_loss:0.3675	fnorm_loss:0.0142, a_fnorm_loss:0.0449P:0.43, R:0.89
 35%|███▌      | 35/100 [05:49<12:36, 11.64s/it]epoch [35/100], focal_loss:0.0136	, anomaly_loss:0.3597	fnorm_loss:0.0139, a_fnorm_loss:0.0467P:0.47, R:0.94
normal: 0.0587 0.2685  anomaly: 0.0565 0.5755	P:0.26, R:0.10
Pixel Auroc:0.969, Sample Auroc0.758, Pixel Aupro0.0
test_fnorm_loss: 0.0130 test_afnorm_loss: 0.0097
 36%|███▌      | 36/100 [05:55<10:35,  9.93s/it]epoch [36/100], focal_loss:0.0186	, anomaly_loss:0.3678	fnorm_loss:0.0140, a_fnorm_loss:0.0457P:0.56, R:0.86
 37%|███▋      | 37/100 [06:01<09:15,  8.81s/it]epoch [37/100], focal_loss:0.0157	, anomaly_loss:0.3577	fnorm_loss:0.0135, a_fnorm_loss:0.0451P:0.49, R:0.91
 38%|███▊      | 38/100 [06:07<08:09,  7.90s/it]epoch [38/100], focal_loss:0.0152	, anomaly_loss:0.3512	fnorm_loss:0.0133, a_fnorm_loss:0.0482P:0.51, R:0.92
 39%|███▉      | 39/100 [06:13<07:29,  7.36s/it]epoch [39/100], focal_loss:0.0122	, anomaly_loss:0.3449	fnorm_loss:0.0130, a_fnorm_loss:0.0494P:0.51, R:0.94
 40%|████      | 40/100 [06:33<11:08, 11.14s/it]epoch [40/100], focal_loss:0.0123	, anomaly_loss:0.3556	fnorm_loss:0.0126, a_fnorm_loss:0.0486P:0.50, R:0.94
normal: 0.0537 0.1930  anomaly: 0.0493 0.5395	P:0.23, R:0.08
Pixel Auroc:0.970, Sample Auroc0.762, Pixel Aupro0.0
test_fnorm_loss: 0.0117 test_afnorm_loss: 0.0091
 41%|████      | 41/100 [06:39<09:27,  9.62s/it]epoch [41/100], focal_loss:0.0133	, anomaly_loss:0.3494	fnorm_loss:0.0125, a_fnorm_loss:0.0490P:0.52, R:0.91
 42%|████▏     | 42/100 [06:45<08:14,  8.53s/it]epoch [42/100], focal_loss:0.0125	, anomaly_loss:0.3296	fnorm_loss:0.0123, a_fnorm_loss:0.0479P:0.48, R:0.85
 43%|████▎     | 43/100 [06:51<07:24,  7.80s/it]epoch [43/100], focal_loss:0.0177	, anomaly_loss:0.3659	fnorm_loss:0.0125, a_fnorm_loss:0.0469P:0.53, R:0.88
 44%|████▍     | 44/100 [06:57<06:45,  7.25s/it]epoch [44/100], focal_loss:0.0133	, anomaly_loss:0.3610	fnorm_loss:0.0121, a_fnorm_loss:0.0461P:0.54, R:0.91
 45%|████▌     | 45/100 [07:17<09:56, 10.85s/it]epoch [45/100], focal_loss:0.0122	, anomaly_loss:0.3231	fnorm_loss:0.0118, a_fnorm_loss:0.0486P:0.54, R:0.86
normal: 0.0549 0.2196  anomaly: 0.0476 0.5108	P:0.21, R:0.07
Pixel Auroc:0.972, Sample Auroc0.745, Pixel Aupro0.0
test_fnorm_loss: 0.0107 test_afnorm_loss: 0.0084
 46%|████▌     | 46/100 [07:23<08:30,  9.45s/it]epoch [46/100], focal_loss:0.0221	, anomaly_loss:0.4060	fnorm_loss:0.0125, a_fnorm_loss:0.0413P:0.52, R:0.72
 47%|████▋     | 47/100 [07:29<07:27,  8.44s/it]epoch [47/100], focal_loss:0.0165	, anomaly_loss:0.3938	fnorm_loss:0.0121, a_fnorm_loss:0.0438P:0.45, R:0.76
 48%|████▊     | 48/100 [07:35<06:40,  7.70s/it]epoch [48/100], focal_loss:0.0138	, anomaly_loss:0.3611	fnorm_loss:0.0114, a_fnorm_loss:0.0498P:0.54, R:0.92
 49%|████▉     | 49/100 [07:41<06:09,  7.24s/it]epoch [49/100], focal_loss:0.0174	, anomaly_loss:0.3745	fnorm_loss:0.0116, a_fnorm_loss:0.0475P:0.52, R:0.88
 50%|█████     | 50/100 [08:01<09:08, 10.96s/it]epoch [50/100], focal_loss:0.0147	, anomaly_loss:0.3597	fnorm_loss:0.0110, a_fnorm_loss:0.0473P:0.55, R:0.91
normal: 0.6941 0.8492  anomaly: 0.6890 0.8365	P:0.02, R:0.78
Pixel Auroc:0.875, Sample Auroc0.583, Pixel Aupro0.0
test_fnorm_loss: 0.0438 test_afnorm_loss: 0.0682
 51%|█████     | 51/100 [08:07<07:44,  9.48s/it]epoch [51/100], focal_loss:0.0434	, anomaly_loss:0.4388	fnorm_loss:0.0145, a_fnorm_loss:0.0336P:0.52, R:0.71
 52%|█████▏    | 52/100 [08:13<06:50,  8.54s/it]epoch [52/100], focal_loss:0.0192	, anomaly_loss:0.3712	fnorm_loss:0.0125, a_fnorm_loss:0.0399P:0.48, R:0.86
 53%|█████▎    | 53/100 [08:19<06:04,  7.75s/it]epoch [53/100], focal_loss:0.0118	, anomaly_loss:0.3465	fnorm_loss:0.0111, a_fnorm_loss:0.0490P:0.52, R:0.94
 54%|█████▍    | 54/100 [08:25<05:33,  7.25s/it]epoch [54/100], focal_loss:0.0116	, anomaly_loss:0.3253	fnorm_loss:0.0107, a_fnorm_loss:0.0500P:0.50, R:0.86
 55%|█████▌    | 55/100 [08:50<09:21, 12.47s/it]epoch [55/100], focal_loss:0.0150	, anomaly_loss:0.3553	fnorm_loss:0.0110, a_fnorm_loss:0.0475P:0.51, R:0.90
normal: 0.1415 0.3826  anomaly: 0.1426 0.6275	P:0.32, R:0.22
Pixel Auroc:0.972, Sample Auroc0.716, Pixel Aupro0.0
test_fnorm_loss: 0.0103 test_afnorm_loss: 0.0172
 56%|█████▌    | 56/100 [08:56<07:49, 10.67s/it]epoch [56/100], focal_loss:0.0109	, anomaly_loss:0.3179	fnorm_loss:0.0105, a_fnorm_loss:0.0501P:0.55, R:0.88
 57%|█████▋    | 57/100 [09:02<06:40,  9.32s/it]epoch [57/100], focal_loss:0.0125	, anomaly_loss:0.3436	fnorm_loss:0.0105, a_fnorm_loss:0.0487P:0.49, R:0.92
 58%|█████▊    | 58/100 [09:09<05:53,  8.43s/it]epoch [58/100], focal_loss:0.0138	, anomaly_loss:0.3433	fnorm_loss:0.0105, a_fnorm_loss:0.0469P:0.54, R:0.91
 59%|█████▉    | 59/100 [09:14<05:13,  7.66s/it]epoch [59/100], focal_loss:0.0138	, anomaly_loss:0.3588	fnorm_loss:0.0104, a_fnorm_loss:0.0479P:0.51, R:0.90
 60%|██████    | 60/100 [09:38<08:16, 12.41s/it]epoch [60/100], focal_loss:0.0114	, anomaly_loss:0.3433	fnorm_loss:0.0099, a_fnorm_loss:0.0496P:0.52, R:0.94
normal: 0.1091 0.3613  anomaly: 0.1200 0.6666	P:0.33, R:0.20
Pixel Auroc:0.965, Sample Auroc0.747, Pixel Aupro0.0
test_fnorm_loss: 0.0099 test_afnorm_loss: 0.0193
 61%|██████    | 61/100 [09:44<06:50, 10.52s/it]epoch [61/100], focal_loss:0.0113	, anomaly_loss:0.3464	fnorm_loss:0.0100, a_fnorm_loss:0.0509P:0.59, R:0.95
 62%|██████▏   | 62/100 [09:50<05:49,  9.20s/it]epoch [62/100], focal_loss:0.0150	, anomaly_loss:0.3657	fnorm_loss:0.0101, a_fnorm_loss:0.0479P:0.58, R:0.90
 63%|██████▎   | 63/100 [09:56<05:04,  8.22s/it]epoch [63/100], focal_loss:0.0110	, anomaly_loss:0.3219	fnorm_loss:0.0098, a_fnorm_loss:0.0514P:0.53, R:0.87
 64%|██████▍   | 64/100 [10:02<04:32,  7.56s/it]epoch [64/100], focal_loss:0.0117	, anomaly_loss:0.3447	fnorm_loss:0.0098, a_fnorm_loss:0.0507P:0.58, R:0.93
 65%|██████▌   | 65/100 [10:22<06:35, 11.29s/it]epoch [65/100], focal_loss:0.0125	, anomaly_loss:0.3499	fnorm_loss:0.0098, a_fnorm_loss:0.0499P:0.55, R:0.92
normal: 0.0962 0.3417  anomaly: 0.1247 0.6097	P:0.29, R:0.15
Pixel Auroc:0.966, Sample Auroc0.731, Pixel Aupro0.0
test_fnorm_loss: 0.0093 test_afnorm_loss: 0.0164
 66%|██████▌   | 66/100 [10:28<05:28,  9.65s/it]epoch [66/100], focal_loss:0.0105	, anomaly_loss:0.3385	fnorm_loss:0.0095, a_fnorm_loss:0.0508P:0.51, R:0.94
 67%|██████▋   | 67/100 [10:34<04:46,  8.67s/it]epoch [67/100], focal_loss:0.0094	, anomaly_loss:0.3333	fnorm_loss:0.0093, a_fnorm_loss:0.0515P:0.58, R:0.93
 68%|██████▊   | 68/100 [10:40<04:12,  7.88s/it]epoch [68/100], focal_loss:0.0117	, anomaly_loss:0.3510	fnorm_loss:0.0096, a_fnorm_loss:0.0509P:0.55, R:0.94
 69%|██████▉   | 69/100 [10:46<03:45,  7.27s/it]epoch [69/100], focal_loss:0.0114	, anomaly_loss:0.3234	fnorm_loss:0.0094, a_fnorm_loss:0.0489P:0.49, R:0.83
 70%|███████   | 70/100 [11:05<05:23, 10.80s/it]epoch [70/100], focal_loss:0.0133	, anomaly_loss:0.3496	fnorm_loss:0.0097, a_fnorm_loss:0.0490P:0.53, R:0.91
normal: 0.0426 0.1695  anomaly: 0.0395 0.5035	P:0.15, R:0.05
Pixel Auroc:0.970, Sample Auroc0.742, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0090
 71%|███████   | 71/100 [11:11<04:30,  9.34s/it]epoch [71/100], focal_loss:0.0104	, anomaly_loss:0.3462	fnorm_loss:0.0090, a_fnorm_loss:0.0506P:0.57, R:0.92
 72%|███████▏  | 72/100 [11:17<03:53,  8.35s/it]epoch [72/100], focal_loss:0.0109	, anomaly_loss:0.3449	fnorm_loss:0.0092, a_fnorm_loss:0.0496P:0.55, R:0.91
 73%|███████▎  | 73/100 [11:23<03:26,  7.64s/it]epoch [73/100], focal_loss:0.0099	, anomaly_loss:0.3287	fnorm_loss:0.0089, a_fnorm_loss:0.0531P:0.58, R:0.94
 74%|███████▍  | 74/100 [11:29<03:06,  7.17s/it]epoch [74/100], focal_loss:0.0108	, anomaly_loss:0.3134	fnorm_loss:0.0088, a_fnorm_loss:0.0533P:0.54, R:0.87
 75%|███████▌  | 75/100 [11:54<05:13, 12.54s/it]epoch [75/100], focal_loss:0.0127	, anomaly_loss:0.3594	fnorm_loss:0.0093, a_fnorm_loss:0.0494P:0.54, R:0.87
normal: 0.1124 0.4046  anomaly: 0.0972 0.6463	P:0.34, R:0.22
Pixel Auroc:0.973, Sample Auroc0.752, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0147
 76%|███████▌  | 76/100 [12:01<04:17, 10.72s/it]epoch [76/100], focal_loss:0.0122	, anomaly_loss:0.3364	fnorm_loss:0.0092, a_fnorm_loss:0.0500P:0.56, R:0.94
 77%|███████▋  | 77/100 [12:07<03:33,  9.29s/it]epoch [77/100], focal_loss:0.0100	, anomaly_loss:0.3321	fnorm_loss:0.0088, a_fnorm_loss:0.0516P:0.57, R:0.94
 78%|███████▊  | 78/100 [12:13<03:04,  8.40s/it]epoch [78/100], focal_loss:0.0080	, anomaly_loss:0.3351	fnorm_loss:0.0084, a_fnorm_loss:0.0553P:0.62, R:0.96
 79%|███████▉  | 79/100 [12:19<02:39,  7.61s/it]epoch [79/100], focal_loss:0.0082	, anomaly_loss:0.3375	fnorm_loss:0.0084, a_fnorm_loss:0.0536P:0.59, R:0.96
 80%|████████  | 80/100 [12:38<03:40, 11.01s/it]epoch [80/100], focal_loss:0.0100	, anomaly_loss:0.3422	fnorm_loss:0.0086, a_fnorm_loss:0.0527P:0.57, R:0.94
normal: 0.1801 0.4551  anomaly: 0.1855 0.6860	P:0.25, R:0.25
Pixel Auroc:0.959, Sample Auroc0.698, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0163
 81%|████████  | 81/100 [12:44<03:02,  9.63s/it]epoch [81/100], focal_loss:0.0105	, anomaly_loss:0.3295	fnorm_loss:0.0085, a_fnorm_loss:0.0521P:0.54, R:0.95
 82%|████████▏ | 82/100 [12:50<02:33,  8.54s/it]epoch [82/100], focal_loss:0.0094	, anomaly_loss:0.3390	fnorm_loss:0.0084, a_fnorm_loss:0.0518P:0.57, R:0.94
 83%|████████▎ | 83/100 [12:56<02:12,  7.82s/it]epoch [83/100], focal_loss:0.0098	, anomaly_loss:0.3267	fnorm_loss:0.0088, a_fnorm_loss:0.0544P:0.58, R:0.96
 84%|████████▍ | 84/100 [13:03<01:56,  7.31s/it]epoch [84/100], focal_loss:0.0099	, anomaly_loss:0.3274	fnorm_loss:0.0085, a_fnorm_loss:0.0531P:0.61, R:0.96
 85%|████████▌ | 85/100 [13:27<03:08, 12.55s/it]epoch [85/100], focal_loss:0.0093	, anomaly_loss:0.3420	fnorm_loss:0.0084, a_fnorm_loss:0.0511P:0.58, R:0.95
normal: 0.1053 0.3514  anomaly: 0.0616 0.6823	P:0.35, R:0.18
Pixel Auroc:0.973, Sample Auroc0.738, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0148
 86%|████████▌ | 86/100 [13:34<02:29, 10.65s/it]epoch [86/100], focal_loss:0.0091	, anomaly_loss:0.3248	fnorm_loss:0.0083, a_fnorm_loss:0.0507P:0.54, R:0.85
 87%|████████▋ | 87/100 [13:40<02:00,  9.28s/it]epoch [87/100], focal_loss:0.0083	, anomaly_loss:0.3237	fnorm_loss:0.0085, a_fnorm_loss:0.0538P:0.60, R:0.96
 88%|████████▊ | 88/100 [13:46<01:39,  8.31s/it]epoch [88/100], focal_loss:0.0089	, anomaly_loss:0.3315	fnorm_loss:0.0083, a_fnorm_loss:0.0525P:0.60, R:0.95
 89%|████████▉ | 89/100 [13:52<01:23,  7.58s/it]epoch [89/100], focal_loss:0.0122	, anomaly_loss:0.3328	fnorm_loss:0.0085, a_fnorm_loss:0.0506P:0.54, R:0.93
 90%|█████████ | 90/100 [14:10<01:48, 10.88s/it]epoch [90/100], focal_loss:0.0153	, anomaly_loss:0.3442	fnorm_loss:0.0091, a_fnorm_loss:0.0499P:0.52, R:0.92
normal: 0.1490 0.3636  anomaly: 0.1348 0.6651	P:0.32, R:0.21
Pixel Auroc:0.971, Sample Auroc0.746, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0197
 91%|█████████ | 91/100 [14:16<01:24,  9.36s/it]epoch [91/100], focal_loss:0.0088	, anomaly_loss:0.3286	fnorm_loss:0.0088, a_fnorm_loss:0.0510P:0.61, R:0.96
 92%|█████████▏| 92/100 [14:22<01:06,  8.37s/it]epoch [92/100], focal_loss:0.0102	, anomaly_loss:0.3402	fnorm_loss:0.0087, a_fnorm_loss:0.0502P:0.63, R:0.94
 93%|█████████▎| 93/100 [14:28<00:54,  7.73s/it]epoch [93/100], focal_loss:0.0113	, anomaly_loss:0.3415	fnorm_loss:0.0087, a_fnorm_loss:0.0500P:0.57, R:0.93
 94%|█████████▍| 94/100 [14:34<00:43,  7.21s/it]epoch [94/100], focal_loss:0.0092	, anomaly_loss:0.3343	fnorm_loss:0.0086, a_fnorm_loss:0.0528P:0.57, R:0.95
 95%|█████████▌| 95/100 [14:54<00:54, 10.92s/it]epoch [95/100], focal_loss:0.0085	, anomaly_loss:0.3280	fnorm_loss:0.0084, a_fnorm_loss:0.0526P:0.55, R:0.95
normal: 0.1051 0.3403  anomaly: 0.0859 0.6560	P:0.34, R:0.17
Pixel Auroc:0.973, Sample Auroc0.749, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0148
 96%|█████████▌| 96/100 [15:00<00:37,  9.43s/it]epoch [96/100], focal_loss:0.0102	, anomaly_loss:0.3382	fnorm_loss:0.0085, a_fnorm_loss:0.0527P:0.60, R:0.94
 97%|█████████▋| 97/100 [15:06<00:25,  8.39s/it]epoch [97/100], focal_loss:0.0095	, anomaly_loss:0.3453	fnorm_loss:0.0084, a_fnorm_loss:0.0527P:0.60, R:0.94
 98%|█████████▊| 98/100 [15:12<00:15,  7.64s/it]epoch [98/100], focal_loss:0.0093	, anomaly_loss:0.3293	fnorm_loss:0.0085, a_fnorm_loss:0.0538P:0.58, R:0.96
 99%|█████████▉| 99/100 [15:18<00:07,  7.22s/it]epoch [99/100], focal_loss:0.0090	, anomaly_loss:0.3328	fnorm_loss:0.0084, a_fnorm_loss:0.0524P:0.61, R:0.94
100%|██████████| 100/100 [15:37<00:00, 10.86s/it]100%|██████████| 100/100 [15:37<00:00,  9.38s/it]
epoch [100/100], focal_loss:0.0089	, anomaly_loss:0.3101	fnorm_loss:0.0084, a_fnorm_loss:0.0532P:0.60, R:0.88
normal: 0.0936 0.3377  anomaly: 0.0698 0.6575	P:0.34, R:0.16
Pixel Auroc:0.973, Sample Auroc0.759, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0145
training Stubborn Student...
cookie
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:04<08:42,  4.39s/it]epoch [1/120], kd_loss:4.9756
  2%|▏         | 2/120 [00:08<08:37,  4.39s/it]epoch [2/120], kd_loss:3.8865
  2%|▎         | 3/120 [00:13<08:32,  4.38s/it]epoch [3/120], kd_loss:3.6174
  3%|▎         | 4/120 [00:17<08:31,  4.41s/it]epoch [4/120], kd_loss:3.1256
  4%|▍         | 5/120 [00:22<08:32,  4.45s/it]epoch [5/120], kd_loss:2.6217
  5%|▌         | 6/120 [00:26<08:29,  4.47s/it]epoch [6/120], kd_loss:2.3566
  6%|▌         | 7/120 [00:31<08:27,  4.49s/it]epoch [7/120], kd_loss:2.1634
  7%|▋         | 8/120 [00:35<08:24,  4.50s/it]epoch [8/120], kd_loss:2.0908
  8%|▊         | 9/120 [00:40<08:16,  4.48s/it]epoch [9/120], kd_loss:2.0194
  8%|▊         | 10/120 [00:56<15:05,  8.24s/it]epoch [10/120], kd_loss:2.0936
normal: 1.2076 1.5606  anomaly: 1.2274 2.1104
thresh: 1.2274154448322099
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.965, Sample Auroc0.729, Pixel Aupro0.0
  9%|▉         | 11/120 [01:01<12:51,  7.08s/it]epoch [11/120], kd_loss:1.9351
 10%|█         | 12/120 [01:05<11:19,  6.29s/it]epoch [12/120], kd_loss:2.0200
 11%|█         | 13/120 [01:10<10:13,  5.74s/it]epoch [13/120], kd_loss:1.8435
 12%|█▏        | 14/120 [01:14<09:26,  5.35s/it]epoch [14/120], kd_loss:1.7925
 12%|█▎        | 15/120 [01:19<08:52,  5.07s/it]epoch [15/120], kd_loss:1.6979
 13%|█▎        | 16/120 [01:23<08:28,  4.89s/it]epoch [16/120], kd_loss:1.6662
 14%|█▍        | 17/120 [01:28<08:12,  4.78s/it]epoch [17/120], kd_loss:1.6539
 15%|█▌        | 18/120 [01:32<08:01,  4.72s/it]epoch [18/120], kd_loss:2.0943
 16%|█▌        | 19/120 [01:37<07:52,  4.67s/it]epoch [19/120], kd_loss:2.2404
 17%|█▋        | 20/120 [01:56<15:09,  9.09s/it]epoch [20/120], kd_loss:1.8403
normal: 1.0586 1.4540  anomaly: 1.0845 2.0341
thresh: 1.0845192074075547
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.965, Sample Auroc0.735, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:01<12:43,  7.71s/it]epoch [21/120], kd_loss:1.7648
 18%|█▊        | 22/120 [02:05<11:01,  6.75s/it]epoch [22/120], kd_loss:1.6945
 19%|█▉        | 23/120 [02:10<09:47,  6.06s/it]epoch [23/120], kd_loss:1.6469
 20%|██        | 24/120 [02:14<08:55,  5.58s/it]epoch [24/120], kd_loss:1.6961
 21%|██        | 25/120 [02:19<08:20,  5.27s/it]epoch [25/120], kd_loss:1.6170
 22%|██▏       | 26/120 [02:23<07:55,  5.06s/it]epoch [26/120], kd_loss:1.5727
 22%|██▎       | 27/120 [02:28<07:34,  4.89s/it]epoch [27/120], kd_loss:1.5862
 23%|██▎       | 28/120 [02:32<07:20,  4.79s/it]epoch [28/120], kd_loss:1.5385
 24%|██▍       | 29/120 [02:37<07:10,  4.73s/it]epoch [29/120], kd_loss:1.6237
 25%|██▌       | 30/120 [02:54<12:45,  8.51s/it]epoch [30/120], kd_loss:1.5428
normal: 0.9697 1.4385  anomaly: 0.9842 2.0682
thresh: 0.9841523797184336
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.978, Sample Auroc0.767, Pixel Aupro0.0
 26%|██▌       | 31/120 [02:58<10:47,  7.27s/it]epoch [31/120], kd_loss:1.5967
 27%|██▋       | 32/120 [03:03<09:24,  6.41s/it]epoch [32/120], kd_loss:1.5461
 28%|██▊       | 33/120 [03:07<08:27,  5.83s/it]epoch [33/120], kd_loss:1.6808
 28%|██▊       | 34/120 [03:12<07:44,  5.40s/it]epoch [34/120], kd_loss:1.5314
 29%|██▉       | 35/120 [03:16<07:14,  5.11s/it]epoch [35/120], kd_loss:1.5094
 30%|███       | 36/120 [03:21<06:52,  4.91s/it]epoch [36/120], kd_loss:1.4771
 31%|███       | 37/120 [03:25<06:34,  4.76s/it]epoch [37/120], kd_loss:1.4866
 32%|███▏      | 38/120 [03:30<06:25,  4.70s/it]epoch [38/120], kd_loss:1.5042
 32%|███▎      | 39/120 [03:34<06:15,  4.63s/it]epoch [39/120], kd_loss:1.6123
 33%|███▎      | 40/120 [03:52<11:20,  8.50s/it]epoch [40/120], kd_loss:1.4862
normal: 0.9326 1.3754  anomaly: 0.8955 2.0649
thresh: 0.895482590632132
fpr: 1.0 fnr 0.0
Pixel Auroc:0.976, Sample Auroc0.778, Pixel Aupro0.0
 34%|███▍      | 41/120 [03:56<09:36,  7.29s/it]epoch [41/120], kd_loss:1.4485
 35%|███▌      | 42/120 [04:01<08:22,  6.44s/it]epoch [42/120], kd_loss:1.4390
 36%|███▌      | 43/120 [04:05<07:30,  5.85s/it]epoch [43/120], kd_loss:1.4318
 37%|███▋      | 44/120 [04:10<06:54,  5.46s/it]epoch [44/120], kd_loss:1.4813
 38%|███▊      | 45/120 [04:14<06:30,  5.20s/it]epoch [45/120], kd_loss:2.3945
 38%|███▊      | 46/120 [04:19<06:09,  4.99s/it]epoch [46/120], kd_loss:2.2407
 39%|███▉      | 47/120 [04:23<05:55,  4.87s/it]epoch [47/120], kd_loss:2.3941
 40%|████      | 48/120 [04:28<05:41,  4.74s/it]epoch [48/120], kd_loss:1.9485
 41%|████      | 49/120 [04:32<05:30,  4.65s/it]epoch [49/120], kd_loss:1.9689
 42%|████▏     | 50/120 [04:49<09:34,  8.20s/it]epoch [50/120], kd_loss:1.8253
normal: 1.0166 1.5126  anomaly: 1.0332 2.1671
thresh: 1.0331768183900976
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.963, Sample Auroc0.713, Pixel Aupro0.0
 42%|████▎     | 51/120 [04:53<08:05,  7.04s/it]epoch [51/120], kd_loss:2.0789
 43%|████▎     | 52/120 [04:57<07:06,  6.26s/it]epoch [52/120], kd_loss:1.8058
 44%|████▍     | 53/120 [05:02<06:22,  5.70s/it]epoch [53/120], kd_loss:1.7907
 45%|████▌     | 54/120 [05:06<05:50,  5.31s/it]epoch [54/120], kd_loss:1.8212
 46%|████▌     | 55/120 [05:11<05:28,  5.05s/it]epoch [55/120], kd_loss:1.6430
 47%|████▋     | 56/120 [05:15<05:11,  4.87s/it]epoch [56/120], kd_loss:1.6402
 48%|████▊     | 57/120 [05:20<04:59,  4.75s/it]epoch [57/120], kd_loss:1.6254
 48%|████▊     | 58/120 [05:24<04:49,  4.66s/it]epoch [58/120], kd_loss:1.6258
 49%|████▉     | 59/120 [05:28<04:40,  4.59s/it]epoch [59/120], kd_loss:1.6117
 50%|█████     | 60/120 [05:44<08:02,  8.04s/it]epoch [60/120], kd_loss:1.6119
normal: 1.0096 1.4110  anomaly: 1.0006 2.0802
thresh: 1.031287862420407
fpr: 0.8571428571428571 fnr 0.02912621359223301
Pixel Auroc:0.972, Sample Auroc0.756, Pixel Aupro0.0
 51%|█████     | 61/120 [05:49<06:48,  6.93s/it]epoch [61/120], kd_loss:1.5793
 52%|█████▏    | 62/120 [05:53<05:57,  6.17s/it]epoch [62/120], kd_loss:1.5580
 52%|█████▎    | 63/120 [05:58<05:21,  5.64s/it]epoch [63/120], kd_loss:1.5602
 53%|█████▎    | 64/120 [06:02<04:55,  5.28s/it]epoch [64/120], kd_loss:1.5503
 54%|█████▍    | 65/120 [06:06<04:36,  5.02s/it]epoch [65/120], kd_loss:1.5554
 55%|█████▌    | 66/120 [06:11<04:22,  4.85s/it]epoch [66/120], kd_loss:1.5445
 56%|█████▌    | 67/120 [06:16<04:13,  4.78s/it]epoch [67/120], kd_loss:1.6770
 57%|█████▋    | 68/120 [06:20<04:04,  4.69s/it]epoch [68/120], kd_loss:1.5313
 57%|█████▊    | 69/120 [06:25<03:56,  4.63s/it]epoch [69/120], kd_loss:1.5108
 58%|█████▊    | 70/120 [06:41<06:50,  8.20s/it]epoch [70/120], kd_loss:1.5251
normal: 0.9322 1.3755  anomaly: 0.9538 1.9898
thresh: 0.9537983513256584
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.977, Sample Auroc0.724, Pixel Aupro0.0
 59%|█████▉    | 71/120 [06:45<05:46,  7.07s/it]epoch [71/120], kd_loss:1.4956
 60%|██████    | 72/120 [06:50<05:00,  6.27s/it]epoch [72/120], kd_loss:1.5492
 61%|██████    | 73/120 [06:54<04:28,  5.71s/it]epoch [73/120], kd_loss:1.4800
 62%|██████▏   | 74/120 [06:59<04:04,  5.31s/it]epoch [74/120], kd_loss:1.4754
 62%|██████▎   | 75/120 [07:03<03:47,  5.06s/it]epoch [75/120], kd_loss:1.4882
 63%|██████▎   | 76/120 [07:08<03:35,  4.89s/it]epoch [76/120], kd_loss:1.4619
 64%|██████▍   | 77/120 [07:12<03:25,  4.77s/it]epoch [77/120], kd_loss:1.4632
 65%|██████▌   | 78/120 [07:17<03:16,  4.67s/it]epoch [78/120], kd_loss:1.4531
 66%|██████▌   | 79/120 [07:21<03:09,  4.61s/it]epoch [79/120], kd_loss:1.4558
 67%|██████▋   | 80/120 [07:39<05:48,  8.71s/it]epoch [80/120], kd_loss:1.4396
normal: 0.9179 1.3171  anomaly: 0.8871 1.9681
thresh: 0.9606404949382001
fpr: 0.7142857142857143 fnr 0.05825242718446602
Pixel Auroc:0.973, Sample Auroc0.781, Pixel Aupro0.0
 68%|██████▊   | 81/120 [07:44<04:50,  7.45s/it]epoch [81/120], kd_loss:1.4409
 68%|██████▊   | 82/120 [07:48<04:09,  6.58s/it]epoch [82/120], kd_loss:1.4244
 69%|██████▉   | 83/120 [07:53<03:40,  5.95s/it]epoch [83/120], kd_loss:1.4374
 70%|███████   | 84/120 [07:57<03:18,  5.51s/it]epoch [84/120], kd_loss:1.8396
 71%|███████   | 85/120 [08:02<03:01,  5.20s/it]epoch [85/120], kd_loss:1.8683
 72%|███████▏  | 86/120 [08:06<02:49,  5.00s/it]epoch [86/120], kd_loss:1.5446
 72%|███████▎  | 87/120 [08:11<02:40,  4.85s/it]epoch [87/120], kd_loss:1.4734
 73%|███████▎  | 88/120 [08:15<02:33,  4.79s/it]epoch [88/120], kd_loss:1.4899
 74%|███████▍  | 89/120 [08:20<02:25,  4.68s/it]epoch [89/120], kd_loss:1.4866
 75%|███████▌  | 90/120 [08:37<04:10,  8.35s/it]epoch [90/120], kd_loss:1.4539
normal: 0.9076 1.3432  anomaly: 0.9047 1.9828
thresh: 0.9046597147297182
fpr: 1.0 fnr 0.0
Pixel Auroc:0.976, Sample Auroc0.759, Pixel Aupro0.0
 76%|███████▌  | 91/120 [08:41<03:28,  7.18s/it]epoch [91/120], kd_loss:1.4350
 77%|███████▋  | 92/120 [08:46<02:58,  6.37s/it]epoch [92/120], kd_loss:1.4614
 78%|███████▊  | 93/120 [08:50<02:36,  5.81s/it]epoch [93/120], kd_loss:1.4492
 78%|███████▊  | 94/120 [08:55<02:20,  5.40s/it]epoch [94/120], kd_loss:1.4501
 79%|███████▉  | 95/120 [08:59<02:08,  5.14s/it]epoch [95/120], kd_loss:1.4255
 80%|████████  | 96/120 [09:04<01:58,  4.96s/it]epoch [96/120], kd_loss:1.4204
 81%|████████  | 97/120 [09:08<01:51,  4.83s/it]epoch [97/120], kd_loss:1.4203
 82%|████████▏ | 98/120 [09:13<01:43,  4.72s/it]epoch [98/120], kd_loss:1.4139
 82%|████████▎ | 99/120 [09:17<01:37,  4.66s/it]epoch [99/120], kd_loss:1.4134
 83%|████████▎ | 100/120 [09:34<02:43,  8.20s/it]epoch [100/120], kd_loss:1.4097
normal: 0.8854 1.3436  anomaly: 0.8914 1.9571
thresh: 0.8913614057991405
fpr: 0.9642857142857143 fnr 0.0
Pixel Auroc:0.976, Sample Auroc0.761, Pixel Aupro0.0
 84%|████████▍ | 101/120 [09:38<02:14,  7.09s/it]epoch [101/120], kd_loss:1.4051
 85%|████████▌ | 102/120 [09:43<01:53,  6.29s/it]epoch [102/120], kd_loss:1.4023
 86%|████████▌ | 103/120 [09:47<01:37,  5.73s/it]epoch [103/120], kd_loss:1.4057
 87%|████████▋ | 104/120 [09:52<01:25,  5.36s/it]epoch [104/120], kd_loss:1.3991
 88%|████████▊ | 105/120 [09:56<01:16,  5.11s/it]epoch [105/120], kd_loss:1.3997
 88%|████████▊ | 106/120 [10:01<01:09,  4.93s/it]epoch [106/120], kd_loss:1.4031
 89%|████████▉ | 107/120 [10:05<01:02,  4.83s/it]epoch [107/120], kd_loss:1.3958
 90%|█████████ | 108/120 [10:10<00:56,  4.73s/it]epoch [108/120], kd_loss:1.3977
 91%|█████████ | 109/120 [10:14<00:51,  4.66s/it]epoch [109/120], kd_loss:1.3948
 92%|█████████▏| 110/120 [10:30<01:20,  8.02s/it]epoch [110/120], kd_loss:1.3954
normal: 0.8871 1.3898  anomaly: 0.8789 1.9385
thresh: 0.8789081647429008
fpr: 1.0 fnr 0.0
Pixel Auroc:0.975, Sample Auroc0.759, Pixel Aupro0.0
 92%|█████████▎| 111/120 [10:34<01:02,  6.93s/it]epoch [111/120], kd_loss:1.3948
 93%|█████████▎| 112/120 [10:39<00:49,  6.21s/it]epoch [112/120], kd_loss:1.3920
 94%|█████████▍| 113/120 [10:43<00:39,  5.67s/it]epoch [113/120], kd_loss:1.3953
 95%|█████████▌| 114/120 [10:48<00:31,  5.30s/it]epoch [114/120], kd_loss:1.3961
 96%|█████████▌| 115/120 [10:52<00:25,  5.05s/it]epoch [115/120], kd_loss:1.3899
 97%|█████████▋| 116/120 [10:57<00:19,  4.87s/it]epoch [116/120], kd_loss:1.3924
 98%|█████████▊| 117/120 [11:01<00:14,  4.74s/it]epoch [117/120], kd_loss:1.3901
 98%|█████████▊| 118/120 [11:06<00:09,  4.65s/it]epoch [118/120], kd_loss:1.3897
 99%|█████████▉| 119/120 [11:10<00:04,  4.60s/it]epoch [119/120], kd_loss:1.3863
100%|██████████| 120/120 [11:26<00:00,  8.10s/it]100%|██████████| 120/120 [11:26<00:00,  5.72s/it]
epoch [120/120], kd_loss:1.3904
normal: 0.8920 1.3954  anomaly: 0.8742 1.9362
thresh: 0.874184183577408
fpr: 1.0 fnr 0.0
Pixel Auroc:0.975, Sample Auroc0.761, Pixel Aupro0.0
training Advanced Teacher...
dowel
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:22<37:23, 22.66s/it]epoch [1/100], focal_loss:0.0721	, anomaly_loss:0.4851	fnorm_loss:0.0740, a_fnorm_loss:0.0149P:0.00, R:0.04
normal: 0.2598 0.2660  anomaly: 0.2570 0.2663	P:0.00, R:0.00
Pixel Auroc:0.953, Sample Auroc0.501, Pixel Aupro0.0
test_fnorm_loss: 0.0734 test_afnorm_loss: 0.0143
  2%|▏         | 2/100 [00:30<23:07, 14.15s/it]epoch [2/100], focal_loss:0.0566	, anomaly_loss:0.4901	fnorm_loss:0.0678, a_fnorm_loss:0.0141P:0.00, R:0.00
  3%|▎         | 3/100 [00:39<18:37, 11.52s/it]epoch [3/100], focal_loss:0.0475	, anomaly_loss:0.5166	fnorm_loss:0.0593, a_fnorm_loss:0.0120P:0.00, R:0.00
  4%|▍         | 4/100 [00:46<15:56,  9.97s/it]epoch [4/100], focal_loss:0.0409	, anomaly_loss:0.5419	fnorm_loss:0.0527, a_fnorm_loss:0.0110P:0.00, R:0.00
  5%|▌         | 5/100 [01:07<21:55, 13.85s/it]epoch [5/100], focal_loss:0.0353	, anomaly_loss:0.5621	fnorm_loss:0.0477, a_fnorm_loss:0.0096P:0.00, R:0.00
normal: 0.1646 0.1673  anomaly: 0.1625 0.1674	P:0.00, R:0.00
Pixel Auroc:0.954, Sample Auroc0.504, Pixel Aupro0.0
test_fnorm_loss: 0.0461 test_afnorm_loss: 0.0091
  6%|▌         | 6/100 [01:16<18:58, 12.11s/it]epoch [6/100], focal_loss:0.0327	, anomaly_loss:0.5772	fnorm_loss:0.0439, a_fnorm_loss:0.0090P:0.00, R:0.00
  7%|▋         | 7/100 [01:24<16:42, 10.78s/it]epoch [7/100], focal_loss:0.0311	, anomaly_loss:0.5896	fnorm_loss:0.0411, a_fnorm_loss:0.0085P:0.00, R:0.00
  8%|▊         | 8/100 [01:32<15:23, 10.04s/it]epoch [8/100], focal_loss:0.0316	, anomaly_loss:0.5541	fnorm_loss:0.0421, a_fnorm_loss:0.0142P:0.05, R:0.06
  9%|▉         | 9/100 [01:40<14:20,  9.46s/it]epoch [9/100], focal_loss:0.0286	, anomaly_loss:0.4530	fnorm_loss:0.0364, a_fnorm_loss:0.0298P:0.07, R:0.30
 10%|█         | 10/100 [02:02<19:34, 13.05s/it]epoch [10/100], focal_loss:0.0264	, anomaly_loss:0.4153	fnorm_loss:0.0328, a_fnorm_loss:0.0309P:0.10, R:0.39
normal: 0.2229 0.3084  anomaly: 0.2177 0.3918	P:0.10, R:0.21
Pixel Auroc:0.976, Sample Auroc0.728, Pixel Aupro0.0
test_fnorm_loss: 0.0305 test_afnorm_loss: 0.0199
 11%|█         | 11/100 [02:09<16:58, 11.44s/it]epoch [11/100], focal_loss:0.0247	, anomaly_loss:0.2964	fnorm_loss:0.0292, a_fnorm_loss:0.0356P:0.17, R:0.75
 12%|█▏        | 12/100 [02:17<15:03, 10.27s/it]epoch [12/100], focal_loss:0.0219	, anomaly_loss:0.2440	fnorm_loss:0.0263, a_fnorm_loss:0.0389P:0.22, R:0.86
 13%|█▎        | 13/100 [02:26<14:19,  9.88s/it]epoch [13/100], focal_loss:0.0189	, anomaly_loss:0.2253	fnorm_loss:0.0240, a_fnorm_loss:0.0396P:0.28, R:0.89
 14%|█▍        | 14/100 [02:34<13:21,  9.32s/it]epoch [14/100], focal_loss:0.0157	, anomaly_loss:0.2189	fnorm_loss:0.0221, a_fnorm_loss:0.0410P:0.25, R:0.90
 15%|█▌        | 15/100 [02:59<19:52, 14.03s/it]epoch [15/100], focal_loss:0.0150	, anomaly_loss:0.2071	fnorm_loss:0.0207, a_fnorm_loss:0.0428P:0.32, R:0.93
normal: 0.1707 0.4469  anomaly: 0.1494 0.6125	P:0.19, R:0.27
Pixel Auroc:0.981, Sample Auroc0.752, Pixel Aupro0.0
test_fnorm_loss: 0.0199 test_afnorm_loss: 0.0267
 16%|█▌        | 16/100 [03:07<17:01, 12.16s/it]epoch [16/100], focal_loss:0.0131	, anomaly_loss:0.1998	fnorm_loss:0.0192, a_fnorm_loss:0.0434P:0.34, R:0.93
 17%|█▋        | 17/100 [03:15<15:08, 10.95s/it]epoch [17/100], focal_loss:0.0135	, anomaly_loss:0.1927	fnorm_loss:0.0183, a_fnorm_loss:0.0425P:0.31, R:0.94
 18%|█▊        | 18/100 [03:22<13:35,  9.95s/it]epoch [18/100], focal_loss:0.0127	, anomaly_loss:0.1935	fnorm_loss:0.0174, a_fnorm_loss:0.0438P:0.36, R:0.93
 19%|█▉        | 19/100 [03:30<12:30,  9.26s/it]epoch [19/100], focal_loss:0.0117	, anomaly_loss:0.1892	fnorm_loss:0.0165, a_fnorm_loss:0.0435P:0.30, R:0.93
 20%|██        | 20/100 [03:52<17:13, 12.92s/it]epoch [20/100], focal_loss:0.0110	, anomaly_loss:0.1738	fnorm_loss:0.0157, a_fnorm_loss:0.0445P:0.36, R:0.95
normal: 0.2210 0.5820  anomaly: 0.1845 0.6713	P:0.19, R:0.37
Pixel Auroc:0.983, Sample Auroc0.723, Pixel Aupro0.0
test_fnorm_loss: 0.0155 test_afnorm_loss: 0.0299
 21%|██        | 21/100 [04:00<15:13, 11.56s/it]epoch [21/100], focal_loss:0.0110	, anomaly_loss:0.1750	fnorm_loss:0.0151, a_fnorm_loss:0.0443P:0.32, R:0.95
 22%|██▏       | 22/100 [04:08<13:50, 10.64s/it]epoch [22/100], focal_loss:0.0120	, anomaly_loss:0.1804	fnorm_loss:0.0147, a_fnorm_loss:0.0439P:0.36, R:0.92
 23%|██▎       | 23/100 [04:17<12:57, 10.09s/it]epoch [23/100], focal_loss:0.0105	, anomaly_loss:0.1708	fnorm_loss:0.0141, a_fnorm_loss:0.0462P:0.34, R:0.96
 24%|██▍       | 24/100 [04:25<12:02,  9.51s/it]epoch [24/100], focal_loss:0.0110	, anomaly_loss:0.1771	fnorm_loss:0.0136, a_fnorm_loss:0.0445P:0.30, R:0.94
 25%|██▌       | 25/100 [04:46<16:06, 12.89s/it]epoch [25/100], focal_loss:0.0102	, anomaly_loss:0.1766	fnorm_loss:0.0133, a_fnorm_loss:0.0440P:0.34, R:0.94
normal: 0.0478 0.1311  anomaly: 0.0465 0.5461	P:0.10, R:0.08
Pixel Auroc:0.982, Sample Auroc0.731, Pixel Aupro0.0
test_fnorm_loss: 0.0126 test_afnorm_loss: 0.0111
 26%|██▌       | 26/100 [04:55<14:16, 11.57s/it]epoch [26/100], focal_loss:0.0108	, anomaly_loss:0.1944	fnorm_loss:0.0130, a_fnorm_loss:0.0442P:0.32, R:0.92
 27%|██▋       | 27/100 [05:04<13:16, 10.91s/it]epoch [27/100], focal_loss:0.0099	, anomaly_loss:0.1805	fnorm_loss:0.0127, a_fnorm_loss:0.0453P:0.31, R:0.93
 28%|██▊       | 28/100 [05:13<12:13, 10.18s/it]epoch [28/100], focal_loss:0.0090	, anomaly_loss:0.1532	fnorm_loss:0.0121, a_fnorm_loss:0.0483P:0.33, R:0.97
 29%|██▉       | 29/100 [05:21<11:33,  9.76s/it]epoch [29/100], focal_loss:0.0098	, anomaly_loss:0.1636	fnorm_loss:0.0119, a_fnorm_loss:0.0450P:0.35, R:0.96
 30%|███       | 30/100 [05:42<15:07, 12.97s/it]epoch [30/100], focal_loss:0.0089	, anomaly_loss:0.1772	fnorm_loss:0.0116, a_fnorm_loss:0.0465P:0.33, R:0.94
normal: 0.1026 0.3750  anomaly: 0.0826 0.5519	P:0.15, R:0.21
Pixel Auroc:0.980, Sample Auroc0.699, Pixel Aupro0.0
test_fnorm_loss: 0.0113 test_afnorm_loss: 0.0234
 31%|███       | 31/100 [05:50<13:18, 11.57s/it]epoch [31/100], focal_loss:0.0094	, anomaly_loss:0.1586	fnorm_loss:0.0114, a_fnorm_loss:0.0458P:0.35, R:0.96
 32%|███▏      | 32/100 [05:58<11:54, 10.50s/it]epoch [32/100], focal_loss:0.0082	, anomaly_loss:0.1516	fnorm_loss:0.0110, a_fnorm_loss:0.0467P:0.38, R:0.96
 33%|███▎      | 33/100 [06:07<11:01,  9.87s/it]epoch [33/100], focal_loss:0.0083	, anomaly_loss:0.1619	fnorm_loss:0.0108, a_fnorm_loss:0.0477P:0.37, R:0.96
 34%|███▍      | 34/100 [06:14<10:06,  9.19s/it]epoch [34/100], focal_loss:0.0077	, anomaly_loss:0.1575	fnorm_loss:0.0105, a_fnorm_loss:0.0482P:0.35, R:0.98
 35%|███▌      | 35/100 [06:34<13:17, 12.27s/it]epoch [35/100], focal_loss:0.0085	, anomaly_loss:0.1665	fnorm_loss:0.0104, a_fnorm_loss:0.0460P:0.34, R:0.95
normal: 0.1772 0.3373  anomaly: 0.1264 0.6494	P:0.17, R:0.25
Pixel Auroc:0.978, Sample Auroc0.699, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0205
 36%|███▌      | 36/100 [06:42<11:45, 11.03s/it]epoch [36/100], focal_loss:0.0090	, anomaly_loss:0.1655	fnorm_loss:0.0104, a_fnorm_loss:0.0455P:0.39, R:0.95
 37%|███▋      | 37/100 [06:50<10:39, 10.15s/it]epoch [37/100], focal_loss:0.0091	, anomaly_loss:0.1750	fnorm_loss:0.0102, a_fnorm_loss:0.0456P:0.35, R:0.94
 38%|███▊      | 38/100 [06:59<10:09,  9.83s/it]epoch [38/100], focal_loss:0.0077	, anomaly_loss:0.1508	fnorm_loss:0.0098, a_fnorm_loss:0.0487P:0.34, R:0.97
 39%|███▉      | 39/100 [07:07<09:20,  9.19s/it]epoch [39/100], focal_loss:0.0077	, anomaly_loss:0.1701	fnorm_loss:0.0097, a_fnorm_loss:0.0468P:0.33, R:0.94
 40%|████      | 40/100 [07:32<13:58, 13.97s/it]epoch [40/100], focal_loss:0.0082	, anomaly_loss:0.1722	fnorm_loss:0.0097, a_fnorm_loss:0.0474P:0.34, R:0.95
normal: 0.0904 0.3508  anomaly: 0.0795 0.6312	P:0.20, R:0.22
Pixel Auroc:0.983, Sample Auroc0.752, Pixel Aupro0.0
test_fnorm_loss: 0.0092 test_afnorm_loss: 0.0194
 41%|████      | 41/100 [07:40<12:05, 12.30s/it]epoch [41/100], focal_loss:0.0072	, anomaly_loss:0.1588	fnorm_loss:0.0094, a_fnorm_loss:0.0476P:0.40, R:0.96
 42%|████▏     | 42/100 [07:48<10:43, 11.10s/it]epoch [42/100], focal_loss:0.0089	, anomaly_loss:0.1651	fnorm_loss:0.0094, a_fnorm_loss:0.0472P:0.35, R:0.95
 43%|████▎     | 43/100 [07:57<09:47, 10.31s/it]epoch [43/100], focal_loss:0.0082	, anomaly_loss:0.1563	fnorm_loss:0.0093, a_fnorm_loss:0.0477P:0.38, R:0.96
 44%|████▍     | 44/100 [08:06<09:09,  9.82s/it]epoch [44/100], focal_loss:0.0079	, anomaly_loss:0.1534	fnorm_loss:0.0092, a_fnorm_loss:0.0490P:0.35, R:0.96
 45%|████▌     | 45/100 [08:26<12:02, 13.14s/it]epoch [45/100], focal_loss:0.0072	, anomaly_loss:0.1607	fnorm_loss:0.0090, a_fnorm_loss:0.0481P:0.39, R:0.95
normal: 0.2785 0.5085  anomaly: 0.2550 0.6353	P:0.12, R:0.32
Pixel Auroc:0.979, Sample Auroc0.676, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0266
 46%|████▌     | 46/100 [08:35<10:33, 11.74s/it]epoch [46/100], focal_loss:0.0079	, anomaly_loss:0.1569	fnorm_loss:0.0090, a_fnorm_loss:0.0500P:0.36, R:0.96
 47%|████▋     | 47/100 [08:43<09:28, 10.73s/it]epoch [47/100], focal_loss:0.0086	, anomaly_loss:0.1652	fnorm_loss:0.0090, a_fnorm_loss:0.0478P:0.34, R:0.93
 48%|████▊     | 48/100 [08:52<08:42, 10.06s/it]epoch [48/100], focal_loss:0.0074	, anomaly_loss:0.1580	fnorm_loss:0.0087, a_fnorm_loss:0.0481P:0.30, R:0.94
 49%|████▉     | 49/100 [09:01<08:23,  9.87s/it]epoch [49/100], focal_loss:0.0072	, anomaly_loss:0.1699	fnorm_loss:0.0086, a_fnorm_loss:0.0492P:0.36, R:0.96
 50%|█████     | 50/100 [09:22<10:55, 13.10s/it]epoch [50/100], focal_loss:0.0063	, anomaly_loss:0.1424	fnorm_loss:0.0084, a_fnorm_loss:0.0503P:0.44, R:0.97
normal: 0.1076 0.4443  anomaly: 0.0847 0.5758	P:0.17, R:0.24
Pixel Auroc:0.981, Sample Auroc0.763, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0199
 51%|█████     | 51/100 [09:30<09:30, 11.65s/it]epoch [51/100], focal_loss:0.0072	, anomaly_loss:0.1554	fnorm_loss:0.0084, a_fnorm_loss:0.0494P:0.33, R:0.96
 52%|█████▏    | 52/100 [09:38<08:31, 10.65s/it]epoch [52/100], focal_loss:0.0062	, anomaly_loss:0.1445	fnorm_loss:0.0082, a_fnorm_loss:0.0497P:0.34, R:0.97
 53%|█████▎    | 53/100 [09:47<07:55, 10.11s/it]epoch [53/100], focal_loss:0.0071	, anomaly_loss:0.1519	fnorm_loss:0.0083, a_fnorm_loss:0.0472P:0.43, R:0.95
 54%|█████▍    | 54/100 [09:56<07:30,  9.80s/it]epoch [54/100], focal_loss:0.0061	, anomaly_loss:0.1492	fnorm_loss:0.0081, a_fnorm_loss:0.0501P:0.40, R:0.95
 55%|█████▌    | 55/100 [10:17<09:45, 13.01s/it]epoch [55/100], focal_loss:0.0064	, anomaly_loss:0.1452	fnorm_loss:0.0080, a_fnorm_loss:0.0505P:0.39, R:0.96
normal: 0.0590 0.2929  anomaly: 0.0548 0.5202	P:0.14, R:0.12
Pixel Auroc:0.981, Sample Auroc0.776, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0130
 56%|█████▌    | 56/100 [10:25<08:30, 11.61s/it]epoch [56/100], focal_loss:0.0073	, anomaly_loss:0.1572	fnorm_loss:0.0082, a_fnorm_loss:0.0483P:0.40, R:0.95
 57%|█████▋    | 57/100 [10:34<07:44, 10.80s/it]epoch [57/100], focal_loss:0.0073	, anomaly_loss:0.1562	fnorm_loss:0.0081, a_fnorm_loss:0.0487P:0.37, R:0.95
 58%|█████▊    | 58/100 [10:42<07:02, 10.07s/it]epoch [58/100], focal_loss:0.0066	, anomaly_loss:0.1509	fnorm_loss:0.0080, a_fnorm_loss:0.0495P:0.38, R:0.95
 59%|█████▉    | 59/100 [10:51<06:35,  9.65s/it]epoch [59/100], focal_loss:0.0070	, anomaly_loss:0.1660	fnorm_loss:0.0078, a_fnorm_loss:0.0501P:0.35, R:0.95
 60%|██████    | 60/100 [11:13<08:56, 13.42s/it]epoch [60/100], focal_loss:0.0070	, anomaly_loss:0.1582	fnorm_loss:0.0079, a_fnorm_loss:0.0485P:0.38, R:0.95
normal: 0.1641 0.5339  anomaly: 0.1958 0.5882	P:0.14, R:0.30
Pixel Auroc:0.982, Sample Auroc0.734, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0262
 61%|██████    | 61/100 [11:22<07:48, 12.01s/it]epoch [61/100], focal_loss:0.0083	, anomaly_loss:0.1626	fnorm_loss:0.0080, a_fnorm_loss:0.0477P:0.38, R:0.93
 62%|██████▏   | 62/100 [11:30<06:50, 10.81s/it]epoch [62/100], focal_loss:0.0066	, anomaly_loss:0.1503	fnorm_loss:0.0077, a_fnorm_loss:0.0494P:0.36, R:0.96
 63%|██████▎   | 63/100 [11:38<06:09,  9.98s/it]epoch [63/100], focal_loss:0.0073	, anomaly_loss:0.1632	fnorm_loss:0.0079, a_fnorm_loss:0.0489P:0.35, R:0.94
 64%|██████▍   | 64/100 [11:46<05:39,  9.44s/it]epoch [64/100], focal_loss:0.0055	, anomaly_loss:0.1464	fnorm_loss:0.0075, a_fnorm_loss:0.0514P:0.40, R:0.96
 65%|██████▌   | 65/100 [12:07<07:25, 12.73s/it]epoch [65/100], focal_loss:0.0058	, anomaly_loss:0.1470	fnorm_loss:0.0075, a_fnorm_loss:0.0529P:0.37, R:0.96
normal: 0.0482 0.2830  anomaly: 0.0506 0.4499	P:0.13, R:0.13
Pixel Auroc:0.982, Sample Auroc0.764, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0155
 66%|██████▌   | 66/100 [12:15<06:28, 11.44s/it]epoch [66/100], focal_loss:0.0054	, anomaly_loss:0.1393	fnorm_loss:0.0074, a_fnorm_loss:0.0521P:0.43, R:0.98
 67%|██████▋   | 67/100 [12:24<05:48, 10.55s/it]epoch [67/100], focal_loss:0.0063	, anomaly_loss:0.1426	fnorm_loss:0.0074, a_fnorm_loss:0.0512P:0.39, R:0.97
 68%|██████▊   | 68/100 [12:32<05:14,  9.84s/it]epoch [68/100], focal_loss:0.0084	, anomaly_loss:0.1612	fnorm_loss:0.0075, a_fnorm_loss:0.0482P:0.42, R:0.94
 69%|██████▉   | 69/100 [12:40<04:52,  9.43s/it]epoch [69/100], focal_loss:0.0080	, anomaly_loss:0.1596	fnorm_loss:0.0076, a_fnorm_loss:0.0476P:0.36, R:0.94
 70%|███████   | 70/100 [13:00<06:12, 12.40s/it]epoch [70/100], focal_loss:0.0068	, anomaly_loss:0.1455	fnorm_loss:0.0074, a_fnorm_loss:0.0489P:0.37, R:0.98
normal: 0.0399 0.2504  anomaly: 0.0324 0.4418	P:0.11, R:0.11
Pixel Auroc:0.982, Sample Auroc0.777, Pixel Aupro0.0
test_fnorm_loss: 0.0069 test_afnorm_loss: 0.0144
 71%|███████   | 71/100 [13:07<05:19, 11.00s/it]epoch [71/100], focal_loss:0.0061	, anomaly_loss:0.1534	fnorm_loss:0.0073, a_fnorm_loss:0.0502P:0.41, R:0.95
 72%|███████▏  | 72/100 [13:16<04:45, 10.19s/it]epoch [72/100], focal_loss:0.0070	, anomaly_loss:0.1517	fnorm_loss:0.0075, a_fnorm_loss:0.0495P:0.36, R:0.96
 73%|███████▎  | 73/100 [13:24<04:16,  9.51s/it]epoch [73/100], focal_loss:0.0070	, anomaly_loss:0.1530	fnorm_loss:0.0073, a_fnorm_loss:0.0482P:0.43, R:0.95
 74%|███████▍  | 74/100 [13:33<04:04,  9.42s/it]epoch [74/100], focal_loss:0.0055	, anomaly_loss:0.1466	fnorm_loss:0.0072, a_fnorm_loss:0.0523P:0.44, R:0.97
 75%|███████▌  | 75/100 [13:53<05:19, 12.77s/it]epoch [75/100], focal_loss:0.0062	, anomaly_loss:0.1572	fnorm_loss:0.0072, a_fnorm_loss:0.0485P:0.37, R:0.95
normal: 0.0506 0.3867  anomaly: 0.0366 0.4985	P:0.14, R:0.15
Pixel Auroc:0.981, Sample Auroc0.784, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0164
 76%|███████▌  | 76/100 [14:02<04:39, 11.63s/it]epoch [76/100], focal_loss:0.0059	, anomaly_loss:0.1454	fnorm_loss:0.0071, a_fnorm_loss:0.0499P:0.42, R:0.96
 77%|███████▋  | 77/100 [14:10<04:01, 10.49s/it]epoch [77/100], focal_loss:0.0058	, anomaly_loss:0.1432	fnorm_loss:0.0071, a_fnorm_loss:0.0511P:0.39, R:0.96
 78%|███████▊  | 78/100 [14:19<03:36,  9.85s/it]epoch [78/100], focal_loss:0.0061	, anomaly_loss:0.1568	fnorm_loss:0.0071, a_fnorm_loss:0.0505P:0.45, R:0.95
 79%|███████▉  | 79/100 [14:27<03:17,  9.40s/it]epoch [79/100], focal_loss:0.0056	, anomaly_loss:0.1399	fnorm_loss:0.0070, a_fnorm_loss:0.0494P:0.40, R:0.98
 80%|████████  | 80/100 [14:47<04:12, 12.64s/it]epoch [80/100], focal_loss:0.0061	, anomaly_loss:0.1360	fnorm_loss:0.0070, a_fnorm_loss:0.0513P:0.41, R:0.97
normal: 0.0591 0.2907  anomaly: 0.0360 0.4872	P:0.13, R:0.17
Pixel Auroc:0.981, Sample Auroc0.759, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0191
 81%|████████  | 81/100 [14:55<03:35, 11.36s/it]epoch [81/100], focal_loss:0.0060	, anomaly_loss:0.1472	fnorm_loss:0.0070, a_fnorm_loss:0.0505P:0.40, R:0.96
 82%|████████▏ | 82/100 [15:04<03:07, 10.42s/it]epoch [82/100], focal_loss:0.0060	, anomaly_loss:0.1550	fnorm_loss:0.0070, a_fnorm_loss:0.0502P:0.39, R:0.95
 83%|████████▎ | 83/100 [15:12<02:44,  9.69s/it]epoch [83/100], focal_loss:0.0069	, anomaly_loss:0.1493	fnorm_loss:0.0071, a_fnorm_loss:0.0503P:0.35, R:0.95
 84%|████████▍ | 84/100 [15:20<02:30,  9.38s/it]epoch [84/100], focal_loss:0.0053	, anomaly_loss:0.1530	fnorm_loss:0.0069, a_fnorm_loss:0.0502P:0.40, R:0.96
 85%|████████▌ | 85/100 [15:41<03:11, 12.74s/it]epoch [85/100], focal_loss:0.0055	, anomaly_loss:0.1366	fnorm_loss:0.0069, a_fnorm_loss:0.0510P:0.43, R:0.97
normal: 0.0525 0.3501  anomaly: 0.0480 0.4838	P:0.15, R:0.16
Pixel Auroc:0.981, Sample Auroc0.791, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0172
 86%|████████▌ | 86/100 [15:49<02:38, 11.29s/it]epoch [86/100], focal_loss:0.0056	, anomaly_loss:0.1352	fnorm_loss:0.0069, a_fnorm_loss:0.0502P:0.44, R:0.96
 87%|████████▋ | 87/100 [15:57<02:13, 10.27s/it]epoch [87/100], focal_loss:0.0059	, anomaly_loss:0.1403	fnorm_loss:0.0070, a_fnorm_loss:0.0496P:0.39, R:0.97
 88%|████████▊ | 88/100 [16:05<01:55,  9.63s/it]epoch [88/100], focal_loss:0.0062	, anomaly_loss:0.1558	fnorm_loss:0.0070, a_fnorm_loss:0.0513P:0.38, R:0.96
 89%|████████▉ | 89/100 [16:14<01:43,  9.41s/it]epoch [89/100], focal_loss:0.0054	, anomaly_loss:0.1390	fnorm_loss:0.0068, a_fnorm_loss:0.0500P:0.46, R:0.98
 90%|█████████ | 90/100 [16:35<02:08, 12.89s/it]epoch [90/100], focal_loss:0.0058	, anomaly_loss:0.1508	fnorm_loss:0.0069, a_fnorm_loss:0.0523P:0.42, R:0.96
normal: 0.0532 0.3409  anomaly: 0.0504 0.4765	P:0.15, R:0.15
Pixel Auroc:0.981, Sample Auroc0.795, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0156
 91%|█████████ | 91/100 [16:43<01:43, 11.55s/it]epoch [91/100], focal_loss:0.0054	, anomaly_loss:0.1469	fnorm_loss:0.0068, a_fnorm_loss:0.0492P:0.42, R:0.95
 92%|█████████▏| 92/100 [16:52<01:24, 10.61s/it]epoch [92/100], focal_loss:0.0061	, anomaly_loss:0.1594	fnorm_loss:0.0069, a_fnorm_loss:0.0511P:0.37, R:0.95
 93%|█████████▎| 93/100 [16:59<01:08,  9.80s/it]epoch [93/100], focal_loss:0.0051	, anomaly_loss:0.1376	fnorm_loss:0.0069, a_fnorm_loss:0.0523P:0.37, R:0.98
 94%|█████████▍| 94/100 [17:07<00:54,  9.11s/it]epoch [94/100], focal_loss:0.0056	, anomaly_loss:0.1438	fnorm_loss:0.0069, a_fnorm_loss:0.0527P:0.41, R:0.98
 95%|█████████▌| 95/100 [17:28<01:02, 12.58s/it]epoch [95/100], focal_loss:0.0045	, anomaly_loss:0.1438	fnorm_loss:0.0068, a_fnorm_loss:0.0525P:0.42, R:0.98
normal: 0.0636 0.3611  anomaly: 0.0474 0.5016	P:0.15, R:0.16
Pixel Auroc:0.981, Sample Auroc0.798, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0177
 96%|█████████▌| 96/100 [17:36<00:44, 11.22s/it]epoch [96/100], focal_loss:0.0058	, anomaly_loss:0.1666	fnorm_loss:0.0069, a_fnorm_loss:0.0517P:0.41, R:0.94
 97%|█████████▋| 97/100 [17:45<00:31, 10.54s/it]epoch [97/100], focal_loss:0.0053	, anomaly_loss:0.1483	fnorm_loss:0.0069, a_fnorm_loss:0.0523P:0.41, R:0.97
 98%|█████████▊| 98/100 [17:53<00:19,  9.80s/it]epoch [98/100], focal_loss:0.0053	, anomaly_loss:0.1422	fnorm_loss:0.0069, a_fnorm_loss:0.0512P:0.46, R:0.97
 99%|█████████▉| 99/100 [18:01<00:09,  9.34s/it]epoch [99/100], focal_loss:0.0051	, anomaly_loss:0.1331	fnorm_loss:0.0069, a_fnorm_loss:0.0530P:0.40, R:0.98
100%|██████████| 100/100 [18:23<00:00, 13.22s/it]100%|██████████| 100/100 [18:23<00:00, 11.04s/it]
epoch [100/100], focal_loss:0.0053	, anomaly_loss:0.1534	fnorm_loss:0.0069, a_fnorm_loss:0.0515P:0.43, R:0.97
normal: 0.0720 0.4199  anomaly: 0.0535 0.5224	P:0.16, R:0.18
Pixel Auroc:0.981, Sample Auroc0.804, Pixel Aupro0.0
test_fnorm_loss: 0.0067 test_afnorm_loss: 0.0187
training Stubborn Student...
dowel
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<11:01,  5.56s/it]epoch [1/120], kd_loss:4.2044
  2%|▏         | 2/120 [00:11<10:58,  5.58s/it]epoch [2/120], kd_loss:3.6465
  2%|▎         | 3/120 [00:16<10:56,  5.61s/it]epoch [3/120], kd_loss:3.0878
  3%|▎         | 4/120 [00:22<10:53,  5.63s/it]epoch [4/120], kd_loss:2.4768
  4%|▍         | 5/120 [00:28<10:51,  5.67s/it]epoch [5/120], kd_loss:2.3818
  5%|▌         | 6/120 [00:33<10:46,  5.67s/it]epoch [6/120], kd_loss:1.9005
  6%|▌         | 7/120 [00:39<10:43,  5.70s/it]epoch [7/120], kd_loss:1.8660
  7%|▋         | 8/120 [00:45<10:39,  5.71s/it]epoch [8/120], kd_loss:1.6917
  8%|▊         | 9/120 [00:51<10:35,  5.73s/it]epoch [9/120], kd_loss:1.6502
  8%|▊         | 10/120 [01:08<17:02,  9.30s/it]epoch [10/120], kd_loss:2.5779
normal: 1.3049 1.7859  anomaly: 1.3174 2.2247
thresh: 1.3174416059168272
fpr: 0.9615384615384616 fnr 0.0
Pixel Auroc:0.981, Sample Auroc0.697, Pixel Aupro0.0
  9%|▉         | 11/120 [01:14<14:51,  8.18s/it]epoch [11/120], kd_loss:1.8122
 10%|█         | 12/120 [01:19<13:20,  7.41s/it]epoch [12/120], kd_loss:1.6662
 11%|█         | 13/120 [01:25<12:17,  6.89s/it]epoch [13/120], kd_loss:1.5859
 12%|█▏        | 14/120 [01:31<11:36,  6.57s/it]epoch [14/120], kd_loss:1.5299
 12%|█▎        | 15/120 [01:37<11:08,  6.36s/it]epoch [15/120], kd_loss:1.5067
 13%|█▎        | 16/120 [01:42<10:44,  6.20s/it]epoch [16/120], kd_loss:1.8903
 14%|█▍        | 17/120 [01:48<10:27,  6.09s/it]epoch [17/120], kd_loss:2.0698
 15%|█▌        | 18/120 [01:54<10:13,  6.01s/it]epoch [18/120], kd_loss:1.8052
 16%|█▌        | 19/120 [02:00<10:01,  5.96s/it]epoch [19/120], kd_loss:1.5927
 17%|█▋        | 20/120 [02:18<15:54,  9.55s/it]epoch [20/120], kd_loss:1.5479
normal: 1.1380 1.6108  anomaly: 1.0985 2.0920
thresh: 1.0985225123040236
fpr: 1.0 fnr 0.0
Pixel Auroc:0.983, Sample Auroc0.718, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:23<13:47,  8.36s/it]epoch [21/120], kd_loss:1.5054
 18%|█▊        | 22/120 [02:29<12:18,  7.54s/it]epoch [22/120], kd_loss:1.6456
 19%|█▉        | 23/120 [02:35<11:18,  7.00s/it]epoch [23/120], kd_loss:1.4918
 20%|██        | 24/120 [02:41<10:35,  6.62s/it]epoch [24/120], kd_loss:1.4570
 21%|██        | 25/120 [02:46<10:05,  6.37s/it]epoch [25/120], kd_loss:1.4658
 22%|██▏       | 26/120 [02:52<09:43,  6.21s/it]epoch [26/120], kd_loss:1.4394
 22%|██▎       | 27/120 [02:58<09:27,  6.10s/it]epoch [27/120], kd_loss:1.4076
 23%|██▎       | 28/120 [03:04<09:14,  6.02s/it]epoch [28/120], kd_loss:1.5243
 24%|██▍       | 29/120 [03:10<09:03,  5.98s/it]epoch [29/120], kd_loss:1.4670
 25%|██▌       | 30/120 [03:28<14:35,  9.72s/it]epoch [30/120], kd_loss:1.4230
normal: 1.0236 1.4827  anomaly: 1.0509 1.8784
thresh: 1.0509450184706082
fpr: 0.9230769230769231 fnr 0.0
Pixel Auroc:0.986, Sample Auroc0.760, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:34<12:37,  8.52s/it]epoch [31/120], kd_loss:1.7322
 27%|██▋       | 32/120 [03:39<11:12,  7.64s/it]epoch [32/120], kd_loss:1.4310
 28%|██▊       | 33/120 [03:45<10:14,  7.06s/it]epoch [33/120], kd_loss:1.4116
 28%|██▊       | 34/120 [03:51<09:31,  6.65s/it]epoch [34/120], kd_loss:1.4008
 29%|██▉       | 35/120 [03:57<09:02,  6.39s/it]epoch [35/120], kd_loss:1.8671
 30%|███       | 36/120 [04:02<08:41,  6.21s/it]epoch [36/120], kd_loss:1.5365
 31%|███       | 37/120 [04:08<08:27,  6.11s/it]epoch [37/120], kd_loss:1.4703
 32%|███▏      | 38/120 [04:14<08:15,  6.04s/it]epoch [38/120], kd_loss:1.4444
 32%|███▎      | 39/120 [04:20<08:04,  5.98s/it]epoch [39/120], kd_loss:1.6320
 33%|███▎      | 40/120 [04:38<12:41,  9.52s/it]epoch [40/120], kd_loss:1.5534
normal: 1.0699 1.5719  anomaly: 1.0520 2.0670
thresh: 1.0519781884972612
fpr: 1.0 fnr 0.0
Pixel Auroc:0.984, Sample Auroc0.723, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:44<11:01,  8.38s/it]epoch [41/120], kd_loss:1.5142
 35%|███▌      | 42/120 [04:49<09:49,  7.56s/it]epoch [42/120], kd_loss:1.8071
 36%|███▌      | 43/120 [04:55<08:59,  7.01s/it]epoch [43/120], kd_loss:1.5311
 37%|███▋      | 44/120 [05:01<08:25,  6.65s/it]epoch [44/120], kd_loss:1.4839
 38%|███▊      | 45/120 [05:06<07:58,  6.38s/it]epoch [45/120], kd_loss:1.4724
 38%|███▊      | 46/120 [05:12<07:37,  6.19s/it]epoch [46/120], kd_loss:1.4957
 39%|███▉      | 47/120 [05:18<07:22,  6.06s/it]epoch [47/120], kd_loss:1.7732
 40%|████      | 48/120 [05:24<07:10,  5.97s/it]epoch [48/120], kd_loss:1.4556
 41%|████      | 49/120 [05:30<07:01,  5.93s/it]epoch [49/120], kd_loss:1.4235
 42%|████▏     | 50/120 [05:48<11:11,  9.59s/it]epoch [50/120], kd_loss:1.4184
normal: 1.0164 1.5009  anomaly: 1.0248 1.9201
thresh: 1.0248333354583106
fpr: 0.9230769230769231 fnr 0.0
Pixel Auroc:0.987, Sample Auroc0.757, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:53<09:40,  8.41s/it]epoch [51/120], kd_loss:1.4163
 43%|████▎     | 52/120 [05:59<08:36,  7.59s/it]epoch [52/120], kd_loss:1.4078
 44%|████▍     | 53/120 [06:05<07:52,  7.05s/it]epoch [53/120], kd_loss:1.3918
 45%|████▌     | 54/120 [06:11<07:20,  6.67s/it]epoch [54/120], kd_loss:1.3756
 46%|████▌     | 55/120 [06:16<06:56,  6.41s/it]epoch [55/120], kd_loss:1.3672
 47%|████▋     | 56/120 [06:22<06:38,  6.22s/it]epoch [56/120], kd_loss:1.6336
 48%|████▊     | 57/120 [06:28<06:24,  6.10s/it]epoch [57/120], kd_loss:1.4386
 48%|████▊     | 58/120 [06:34<06:12,  6.01s/it]epoch [58/120], kd_loss:1.3892
 49%|████▉     | 59/120 [06:40<06:02,  5.94s/it]epoch [59/120], kd_loss:1.3697
 50%|█████     | 60/120 [06:55<08:53,  8.90s/it]epoch [60/120], kd_loss:1.3832
normal: 0.9742 1.5866  anomaly: 0.9942 1.8220
thresh: 1.0475142437078013
fpr: 0.7307692307692307 fnr 0.028846153846153848
Pixel Auroc:0.987, Sample Auroc0.758, Pixel Aupro0.0
 51%|█████     | 61/120 [07:01<07:49,  7.95s/it]epoch [61/120], kd_loss:1.4016
 52%|█████▏    | 62/120 [07:07<07:02,  7.29s/it]epoch [62/120], kd_loss:1.3859
 52%|█████▎    | 63/120 [07:13<06:29,  6.82s/it]epoch [63/120], kd_loss:1.3785
 53%|█████▎    | 64/120 [07:19<06:06,  6.54s/it]epoch [64/120], kd_loss:1.3658
 54%|█████▍    | 65/120 [07:24<05:47,  6.32s/it]epoch [65/120], kd_loss:1.3631
 55%|█████▌    | 66/120 [07:30<05:32,  6.16s/it]epoch [66/120], kd_loss:1.3747
 56%|█████▌    | 67/120 [07:36<05:23,  6.10s/it]epoch [67/120], kd_loss:1.3541
 57%|█████▋    | 68/120 [07:42<05:13,  6.02s/it]epoch [68/120], kd_loss:1.3469
 57%|█████▊    | 69/120 [07:48<05:04,  5.96s/it]epoch [69/120], kd_loss:1.3934
 58%|█████▊    | 70/120 [08:05<07:41,  9.22s/it]epoch [70/120], kd_loss:1.5037
normal: 1.0569 1.5882  anomaly: 1.0236 1.9874
thresh: 1.023553816313129
fpr: 1.0 fnr 0.0
Pixel Auroc:0.985, Sample Auroc0.734, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:10<06:38,  8.14s/it]epoch [71/120], kd_loss:1.3823
 60%|██████    | 72/120 [08:16<05:54,  7.38s/it]epoch [72/120], kd_loss:1.3591
 61%|██████    | 73/120 [08:21<05:23,  6.87s/it]epoch [73/120], kd_loss:1.3410
 62%|██████▏   | 74/120 [08:27<05:00,  6.54s/it]epoch [74/120], kd_loss:1.3444
 62%|██████▎   | 75/120 [08:33<04:44,  6.32s/it]epoch [75/120], kd_loss:2.1107
 63%|██████▎   | 76/120 [08:39<04:30,  6.14s/it]epoch [76/120], kd_loss:1.8101
 64%|██████▍   | 77/120 [08:45<04:20,  6.05s/it]epoch [77/120], kd_loss:1.6236
 65%|██████▌   | 78/120 [08:50<04:11,  5.98s/it]epoch [78/120], kd_loss:1.5714
 66%|██████▌   | 79/120 [08:56<04:03,  5.93s/it]epoch [79/120], kd_loss:1.5081
 67%|██████▋   | 80/120 [09:14<06:18,  9.46s/it]epoch [80/120], kd_loss:1.4961
normal: 1.0454 1.5608  anomaly: 1.0785 1.8995
thresh: 1.0785080085788028
fpr: 0.9230769230769231 fnr 0.0
Pixel Auroc:0.986, Sample Auroc0.737, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:20<05:25,  8.33s/it]epoch [81/120], kd_loss:1.4338
 68%|██████▊   | 82/120 [09:25<04:45,  7.52s/it]epoch [82/120], kd_loss:1.4364
 69%|██████▉   | 83/120 [09:31<04:17,  6.97s/it]epoch [83/120], kd_loss:1.3902
 70%|███████   | 84/120 [09:37<03:56,  6.58s/it]epoch [84/120], kd_loss:1.3707
 71%|███████   | 85/120 [09:42<03:41,  6.32s/it]epoch [85/120], kd_loss:1.3630
 72%|███████▏  | 86/120 [09:48<03:28,  6.14s/it]epoch [86/120], kd_loss:1.3741
 72%|███████▎  | 87/120 [09:54<03:18,  6.02s/it]epoch [87/120], kd_loss:1.6203
 73%|███████▎  | 88/120 [10:00<03:10,  5.95s/it]epoch [88/120], kd_loss:1.6713
 74%|███████▍  | 89/120 [10:05<03:02,  5.90s/it]epoch [89/120], kd_loss:1.4294
 75%|███████▌  | 90/120 [10:24<04:56,  9.87s/it]epoch [90/120], kd_loss:1.4146
normal: 0.9870 1.5115  anomaly: 1.0238 1.8665
thresh: 1.0237830589443029
fpr: 0.9230769230769231 fnr 0.0
Pixel Auroc:0.988, Sample Auroc0.774, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:30<04:10,  8.64s/it]epoch [91/120], kd_loss:1.3990
 77%|███████▋  | 92/120 [10:36<03:36,  7.75s/it]epoch [92/120], kd_loss:1.3677
 78%|███████▊  | 93/120 [10:42<03:12,  7.15s/it]epoch [93/120], kd_loss:1.3664
 78%|███████▊  | 94/120 [10:47<02:55,  6.73s/it]epoch [94/120], kd_loss:1.3971
 79%|███████▉  | 95/120 [10:53<02:41,  6.46s/it]epoch [95/120], kd_loss:1.4296
 80%|████████  | 96/120 [10:59<02:30,  6.27s/it]epoch [96/120], kd_loss:1.3838
 81%|████████  | 97/120 [11:05<02:21,  6.15s/it]epoch [97/120], kd_loss:1.3639
 82%|████████▏ | 98/120 [11:11<02:13,  6.05s/it]epoch [98/120], kd_loss:1.3553
 82%|████████▎ | 99/120 [11:17<02:05,  5.97s/it]epoch [99/120], kd_loss:1.3514
 83%|████████▎ | 100/120 [11:34<03:07,  9.38s/it]epoch [100/120], kd_loss:1.3461
normal: 0.9473 1.5220  anomaly: 0.9612 1.8986
thresh: 1.007050320667442
fpr: 0.8461538461538461 fnr 0.019230769230769232
Pixel Auroc:0.988, Sample Auroc0.756, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:40<02:36,  8.25s/it]epoch [101/120], kd_loss:1.3479
 85%|████████▌ | 102/120 [11:45<02:14,  7.50s/it]epoch [102/120], kd_loss:1.3395
 86%|████████▌ | 103/120 [11:51<01:58,  6.97s/it]epoch [103/120], kd_loss:1.3343
 87%|████████▋ | 104/120 [11:57<01:45,  6.60s/it]epoch [104/120], kd_loss:1.3351
 88%|████████▊ | 105/120 [12:03<01:35,  6.37s/it]epoch [105/120], kd_loss:1.3536
 88%|████████▊ | 106/120 [12:08<01:27,  6.22s/it]epoch [106/120], kd_loss:1.3775
 89%|████████▉ | 107/120 [12:14<01:19,  6.12s/it]epoch [107/120], kd_loss:1.3701
 90%|█████████ | 108/120 [12:20<01:12,  6.05s/it]epoch [108/120], kd_loss:1.3547
 91%|█████████ | 109/120 [12:26<01:05,  5.99s/it]epoch [109/120], kd_loss:1.3482
 92%|█████████▏| 110/120 [12:44<01:34,  9.46s/it]epoch [110/120], kd_loss:1.3476
normal: 0.9638 1.5195  anomaly: 0.9627 1.9058
thresh: 0.9912000858269917
fpr: 0.9230769230769231 fnr 0.009615384615384616
Pixel Auroc:0.988, Sample Auroc0.768, Pixel Aupro0.0
 92%|█████████▎| 111/120 [12:49<01:14,  8.31s/it]epoch [111/120], kd_loss:1.3440
 93%|█████████▎| 112/120 [12:55<01:00,  7.55s/it]epoch [112/120], kd_loss:1.3421
 94%|█████████▍| 113/120 [13:01<00:48,  7.00s/it]epoch [113/120], kd_loss:1.3408
 95%|█████████▌| 114/120 [13:07<00:39,  6.65s/it]epoch [114/120], kd_loss:1.3399
 96%|█████████▌| 115/120 [13:12<00:32,  6.40s/it]epoch [115/120], kd_loss:1.3384
 97%|█████████▋| 116/120 [13:18<00:24,  6.22s/it]epoch [116/120], kd_loss:1.3371
 98%|█████████▊| 117/120 [13:24<00:18,  6.10s/it]epoch [117/120], kd_loss:1.3361
 98%|█████████▊| 118/120 [13:30<00:12,  6.02s/it]epoch [118/120], kd_loss:1.3342
 99%|█████████▉| 119/120 [13:36<00:06,  6.01s/it]epoch [119/120], kd_loss:1.3330
100%|██████████| 120/120 [13:52<00:00,  9.20s/it]100%|██████████| 120/120 [13:52<00:00,  6.94s/it]
epoch [120/120], kd_loss:1.3317
normal: 0.9626 1.4984  anomaly: 0.9559 1.8438
thresh: 0.9899432549946858
fpr: 0.8846153846153846 fnr 0.019230769230769232
Pixel Auroc:0.988, Sample Auroc0.769, Pixel Aupro0.0
training Advanced Teacher...
foam
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:23<38:15, 23.19s/it]epoch [1/100], focal_loss:0.0840	, anomaly_loss:0.6110	fnorm_loss:0.0571, a_fnorm_loss:0.0145P:0.00, R:0.01
normal: 0.2529 0.2585  anomaly: 0.2506 0.2618	P:0.00, R:0.00
Pixel Auroc:0.631, Sample Auroc0.436, Pixel Aupro0.0
test_fnorm_loss: 0.0567 test_afnorm_loss: 0.0153
  2%|▏         | 2/100 [00:30<23:04, 14.13s/it]epoch [2/100], focal_loss:0.0724	, anomaly_loss:0.6047	fnorm_loss:0.0542, a_fnorm_loss:0.0139P:0.00, R:0.00
  3%|▎         | 3/100 [00:38<18:05, 11.20s/it]epoch [3/100], focal_loss:0.0702	, anomaly_loss:0.6224	fnorm_loss:0.0494, a_fnorm_loss:0.0125P:0.00, R:0.00
  4%|▍         | 4/100 [00:46<15:40,  9.79s/it]epoch [4/100], focal_loss:0.0668	, anomaly_loss:0.6323	fnorm_loss:0.0459, a_fnorm_loss:0.0117P:0.00, R:0.00
  5%|▌         | 5/100 [01:07<21:50, 13.79s/it]epoch [5/100], focal_loss:0.0657	, anomaly_loss:0.6397	fnorm_loss:0.0434, a_fnorm_loss:0.0112P:0.00, R:0.00
normal: 0.1884 0.1918  anomaly: 0.1871 0.1942	P:0.00, R:0.00
Pixel Auroc:0.617, Sample Auroc0.446, Pixel Aupro0.0
test_fnorm_loss: 0.0423 test_afnorm_loss: 0.0116
  6%|▌         | 6/100 [01:14<18:19, 11.70s/it]epoch [6/100], focal_loss:0.0601	, anomaly_loss:0.6390	fnorm_loss:0.0421, a_fnorm_loss:0.0115P:0.01, R:0.00
  7%|▋         | 7/100 [01:22<16:00, 10.32s/it]epoch [7/100], focal_loss:0.0653	, anomaly_loss:0.6475	fnorm_loss:0.0409, a_fnorm_loss:0.0109P:0.00, R:0.00
  8%|▊         | 8/100 [01:29<14:26,  9.42s/it]epoch [8/100], focal_loss:0.0619	, anomaly_loss:0.6476	fnorm_loss:0.0400, a_fnorm_loss:0.0107P:0.00, R:0.00
  9%|▉         | 9/100 [01:37<13:19,  8.78s/it]epoch [9/100], focal_loss:0.0576	, anomaly_loss:0.5989	fnorm_loss:0.0393, a_fnorm_loss:0.0176P:0.05, R:0.13
 10%|█         | 10/100 [01:57<18:42, 12.47s/it]epoch [10/100], focal_loss:0.0577	, anomaly_loss:0.5532	fnorm_loss:0.0356, a_fnorm_loss:0.0259P:0.11, R:0.26
normal: 0.1628 0.2547  anomaly: 0.1528 0.2803	P:0.01, R:0.05
Pixel Auroc:0.856, Sample Auroc0.757, Pixel Aupro0.0
test_fnorm_loss: 0.0319 test_afnorm_loss: 0.0189
 11%|█         | 11/100 [02:05<16:12, 10.93s/it]epoch [11/100], focal_loss:0.0536	, anomaly_loss:0.5334	fnorm_loss:0.0318, a_fnorm_loss:0.0305P:0.13, R:0.30
 12%|█▏        | 12/100 [02:12<14:32,  9.91s/it]epoch [12/100], focal_loss:0.0542	, anomaly_loss:0.5424	fnorm_loss:0.0305, a_fnorm_loss:0.0287P:0.12, R:0.28
 13%|█▎        | 13/100 [02:20<13:21,  9.21s/it]epoch [13/100], focal_loss:0.0545	, anomaly_loss:0.5230	fnorm_loss:0.0298, a_fnorm_loss:0.0310P:0.12, R:0.32
 14%|█▍        | 14/100 [02:28<12:29,  8.72s/it]epoch [14/100], focal_loss:0.0483	, anomaly_loss:0.5025	fnorm_loss:0.0274, a_fnorm_loss:0.0335P:0.19, R:0.43
 15%|█▌        | 15/100 [02:52<19:03, 13.45s/it]epoch [15/100], focal_loss:0.0394	, anomaly_loss:0.4814	fnorm_loss:0.0244, a_fnorm_loss:0.0349P:0.32, R:0.62
normal: 0.1669 0.2672  anomaly: 0.1607 0.4544	P:0.07, R:0.14
Pixel Auroc:0.898, Sample Auroc0.858, Pixel Aupro0.0
test_fnorm_loss: 0.0219 test_afnorm_loss: 0.0216
 16%|█▌        | 16/100 [03:00<16:18, 11.65s/it]epoch [16/100], focal_loss:0.0370	, anomaly_loss:0.4815	fnorm_loss:0.0220, a_fnorm_loss:0.0353P:0.28, R:0.63
 17%|█▋        | 17/100 [03:07<14:18, 10.34s/it]epoch [17/100], focal_loss:0.0369	, anomaly_loss:0.4686	fnorm_loss:0.0207, a_fnorm_loss:0.0361P:0.38, R:0.67
 18%|█▊        | 18/100 [03:14<12:49,  9.38s/it]epoch [18/100], focal_loss:0.0377	, anomaly_loss:0.4683	fnorm_loss:0.0196, a_fnorm_loss:0.0368P:0.33, R:0.69
 19%|█▉        | 19/100 [03:21<11:48,  8.75s/it]epoch [19/100], focal_loss:0.0337	, anomaly_loss:0.4728	fnorm_loss:0.0183, a_fnorm_loss:0.0361P:0.33, R:0.65
 20%|██        | 20/100 [03:41<16:00, 12.01s/it]epoch [20/100], focal_loss:0.0338	, anomaly_loss:0.4790	fnorm_loss:0.0172, a_fnorm_loss:0.0373P:0.31, R:0.59
normal: 0.1019 0.2525  anomaly: 0.1057 0.4406	P:0.04, R:0.10
Pixel Auroc:0.877, Sample Auroc0.792, Pixel Aupro0.0
test_fnorm_loss: 0.0157 test_afnorm_loss: 0.0217
 21%|██        | 21/100 [03:48<13:59, 10.63s/it]epoch [21/100], focal_loss:0.0325	, anomaly_loss:0.4655	fnorm_loss:0.0163, a_fnorm_loss:0.0395P:0.30, R:0.61
 22%|██▏       | 22/100 [03:56<12:32,  9.64s/it]epoch [22/100], focal_loss:0.0495	, anomaly_loss:0.4993	fnorm_loss:0.0204, a_fnorm_loss:0.0314P:0.43, R:0.59
 23%|██▎       | 23/100 [04:03<11:38,  9.07s/it]epoch [23/100], focal_loss:0.0305	, anomaly_loss:0.4730	fnorm_loss:0.0168, a_fnorm_loss:0.0359P:0.46, R:0.72
 24%|██▍       | 24/100 [04:11<10:51,  8.57s/it]epoch [24/100], focal_loss:0.0263	, anomaly_loss:0.4463	fnorm_loss:0.0158, a_fnorm_loss:0.0379P:0.44, R:0.87
 25%|██▌       | 25/100 [04:36<16:54, 13.52s/it]epoch [25/100], focal_loss:0.0264	, anomaly_loss:0.4427	fnorm_loss:0.0151, a_fnorm_loss:0.0389P:0.48, R:0.86
normal: 0.0995 0.2593  anomaly: 0.1044 0.5305	P:0.07, R:0.13
Pixel Auroc:0.886, Sample Auroc0.846, Pixel Aupro0.0
test_fnorm_loss: 0.0135 test_afnorm_loss: 0.0229
 26%|██▌       | 26/100 [04:43<14:25, 11.70s/it]epoch [26/100], focal_loss:0.0245	, anomaly_loss:0.4367	fnorm_loss:0.0147, a_fnorm_loss:0.0398P:0.45, R:0.89
 27%|██▋       | 27/100 [04:51<12:40, 10.42s/it]epoch [27/100], focal_loss:0.0212	, anomaly_loss:0.4264	fnorm_loss:0.0140, a_fnorm_loss:0.0406P:0.47, R:0.91
 28%|██▊       | 28/100 [04:58<11:32,  9.62s/it]epoch [28/100], focal_loss:0.0208	, anomaly_loss:0.4253	fnorm_loss:0.0136, a_fnorm_loss:0.0405P:0.44, R:0.90
 29%|██▉       | 29/100 [05:06<10:35,  8.95s/it]epoch [29/100], focal_loss:0.0205	, anomaly_loss:0.4219	fnorm_loss:0.0130, a_fnorm_loss:0.0413P:0.46, R:0.90
 30%|███       | 30/100 [05:32<16:22, 14.04s/it]epoch [30/100], focal_loss:0.0215	, anomaly_loss:0.4403	fnorm_loss:0.0129, a_fnorm_loss:0.0386P:0.46, R:0.85
normal: 0.0937 0.2090  anomaly: 0.0858 0.5681	P:0.07, R:0.12
Pixel Auroc:0.910, Sample Auroc0.822, Pixel Aupro0.0
test_fnorm_loss: 0.0116 test_afnorm_loss: 0.0223
 31%|███       | 31/100 [05:40<14:01, 12.19s/it]epoch [31/100], focal_loss:0.0220	, anomaly_loss:0.4353	fnorm_loss:0.0127, a_fnorm_loss:0.0402P:0.48, R:0.87
 32%|███▏      | 32/100 [05:47<12:20, 10.89s/it]epoch [32/100], focal_loss:0.0238	, anomaly_loss:0.4367	fnorm_loss:0.0123, a_fnorm_loss:0.0418P:0.56, R:0.83
 33%|███▎      | 33/100 [05:55<11:04,  9.92s/it]epoch [33/100], focal_loss:0.0223	, anomaly_loss:0.4334	fnorm_loss:0.0127, a_fnorm_loss:0.0413P:0.52, R:0.89
 34%|███▍      | 34/100 [06:02<10:03,  9.14s/it]epoch [34/100], focal_loss:0.0202	, anomaly_loss:0.4344	fnorm_loss:0.0118, a_fnorm_loss:0.0414P:0.50, R:0.89
 35%|███▌      | 35/100 [06:29<15:42, 14.51s/it]epoch [35/100], focal_loss:0.0218	, anomaly_loss:0.4280	fnorm_loss:0.0118, a_fnorm_loss:0.0417P:0.51, R:0.88
normal: 0.0689 0.1735  anomaly: 0.0671 0.5718	P:0.09, R:0.13
Pixel Auroc:0.919, Sample Auroc0.794, Pixel Aupro0.0
test_fnorm_loss: 0.0103 test_afnorm_loss: 0.0223
 36%|███▌      | 36/100 [06:37<13:21, 12.52s/it]epoch [36/100], focal_loss:0.0185	, anomaly_loss:0.4214	fnorm_loss:0.0112, a_fnorm_loss:0.0427P:0.54, R:0.90
 37%|███▋      | 37/100 [06:45<11:39, 11.10s/it]epoch [37/100], focal_loss:0.0202	, anomaly_loss:0.4300	fnorm_loss:0.0113, a_fnorm_loss:0.0420P:0.49, R:0.88
 38%|███▊      | 38/100 [06:53<10:22, 10.03s/it]epoch [38/100], focal_loss:0.0157	, anomaly_loss:0.4129	fnorm_loss:0.0108, a_fnorm_loss:0.0437P:0.54, R:0.92
 39%|███▉      | 39/100 [07:00<09:24,  9.25s/it]epoch [39/100], focal_loss:0.0175	, anomaly_loss:0.4210	fnorm_loss:0.0106, a_fnorm_loss:0.0427P:0.52, R:0.90
 40%|████      | 40/100 [07:20<12:24, 12.41s/it]epoch [40/100], focal_loss:0.0181	, anomaly_loss:0.4208	fnorm_loss:0.0105, a_fnorm_loss:0.0430P:0.54, R:0.89
normal: 0.0839 0.2665  anomaly: 0.0750 0.6160	P:0.08, R:0.14
Pixel Auroc:0.917, Sample Auroc0.811, Pixel Aupro0.0
test_fnorm_loss: 0.0095 test_afnorm_loss: 0.0240
 41%|████      | 41/100 [07:28<10:48, 10.99s/it]epoch [41/100], focal_loss:0.0200	, anomaly_loss:0.4144	fnorm_loss:0.0107, a_fnorm_loss:0.0437P:0.51, R:0.91
 42%|████▏     | 42/100 [07:35<09:42, 10.04s/it]epoch [42/100], focal_loss:0.0194	, anomaly_loss:0.4411	fnorm_loss:0.0103, a_fnorm_loss:0.0412P:0.59, R:0.84
 43%|████▎     | 43/100 [07:43<08:49,  9.29s/it]epoch [43/100], focal_loss:0.0184	, anomaly_loss:0.4228	fnorm_loss:0.0104, a_fnorm_loss:0.0420P:0.52, R:0.91
 44%|████▍     | 44/100 [07:50<08:07,  8.70s/it]epoch [44/100], focal_loss:0.0165	, anomaly_loss:0.4202	fnorm_loss:0.0100, a_fnorm_loss:0.0427P:0.50, R:0.89
 45%|████▌     | 45/100 [08:10<10:55, 11.92s/it]epoch [45/100], focal_loss:0.0173	, anomaly_loss:0.4150	fnorm_loss:0.0099, a_fnorm_loss:0.0436P:0.53, R:0.90
normal: 0.1281 0.2965  anomaly: 0.1427 0.6416	P:0.04, R:0.16
Pixel Auroc:0.905, Sample Auroc0.848, Pixel Aupro0.0
test_fnorm_loss: 0.0091 test_afnorm_loss: 0.0257
 46%|████▌     | 46/100 [08:17<09:30, 10.57s/it]epoch [46/100], focal_loss:0.0219	, anomaly_loss:0.4463	fnorm_loss:0.0104, a_fnorm_loss:0.0407P:0.54, R:0.81
 47%|████▋     | 47/100 [08:24<08:27,  9.58s/it]epoch [47/100], focal_loss:0.0165	, anomaly_loss:0.4185	fnorm_loss:0.0098, a_fnorm_loss:0.0436P:0.53, R:0.92
 48%|████▊     | 48/100 [08:32<07:45,  8.96s/it]epoch [48/100], focal_loss:0.0182	, anomaly_loss:0.4313	fnorm_loss:0.0097, a_fnorm_loss:0.0427P:0.48, R:0.88
 49%|████▉     | 49/100 [08:39<07:14,  8.52s/it]epoch [49/100], focal_loss:0.0164	, anomaly_loss:0.4187	fnorm_loss:0.0095, a_fnorm_loss:0.0450P:0.54, R:0.91
 50%|█████     | 50/100 [08:59<09:49, 11.79s/it]epoch [50/100], focal_loss:0.0200	, anomaly_loss:0.4301	fnorm_loss:0.0097, a_fnorm_loss:0.0421P:0.53, R:0.87
normal: 0.0736 0.1897  anomaly: 0.0724 0.5227	P:0.08, R:0.12
Pixel Auroc:0.912, Sample Auroc0.805, Pixel Aupro0.0
test_fnorm_loss: 0.0084 test_afnorm_loss: 0.0207
 51%|█████     | 51/100 [09:06<08:35, 10.52s/it]epoch [51/100], focal_loss:0.0155	, anomaly_loss:0.4162	fnorm_loss:0.0091, a_fnorm_loss:0.0448P:0.59, R:0.91
 52%|█████▏    | 52/100 [09:14<07:40,  9.58s/it]epoch [52/100], focal_loss:0.0148	, anomaly_loss:0.4114	fnorm_loss:0.0090, a_fnorm_loss:0.0448P:0.52, R:0.91
 53%|█████▎    | 53/100 [09:21<07:02,  8.99s/it]epoch [53/100], focal_loss:0.0164	, anomaly_loss:0.4168	fnorm_loss:0.0093, a_fnorm_loss:0.0436P:0.53, R:0.91
 54%|█████▍    | 54/100 [09:29<06:33,  8.55s/it]epoch [54/100], focal_loss:0.0173	, anomaly_loss:0.4297	fnorm_loss:0.0092, a_fnorm_loss:0.0421P:0.51, R:0.87
 55%|█████▌    | 55/100 [09:49<08:57, 11.95s/it]epoch [55/100], focal_loss:0.0136	, anomaly_loss:0.4083	fnorm_loss:0.0087, a_fnorm_loss:0.0454P:0.54, R:0.92
normal: 0.0669 0.1816  anomaly: 0.0644 0.6350	P:0.08, R:0.13
Pixel Auroc:0.904, Sample Auroc0.777, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0225
 56%|█████▌    | 56/100 [09:56<07:49, 10.66s/it]epoch [56/100], focal_loss:0.0136	, anomaly_loss:0.4072	fnorm_loss:0.0086, a_fnorm_loss:0.0443P:0.52, R:0.92
 57%|█████▋    | 57/100 [10:04<06:59,  9.76s/it]epoch [57/100], focal_loss:0.0163	, anomaly_loss:0.4106	fnorm_loss:0.0087, a_fnorm_loss:0.0442P:0.57, R:0.90
 58%|█████▊    | 58/100 [10:12<06:25,  9.19s/it]epoch [58/100], focal_loss:0.0137	, anomaly_loss:0.4088	fnorm_loss:0.0084, a_fnorm_loss:0.0461P:0.53, R:0.92
 59%|█████▉    | 59/100 [10:20<05:59,  8.76s/it]epoch [59/100], focal_loss:0.0174	, anomaly_loss:0.4221	fnorm_loss:0.0089, a_fnorm_loss:0.0430P:0.53, R:0.88
 60%|██████    | 60/100 [10:39<08:01, 12.03s/it]epoch [60/100], focal_loss:0.0130	, anomaly_loss:0.4045	fnorm_loss:0.0081, a_fnorm_loss:0.0457P:0.56, R:0.92
normal: 0.1175 0.3313  anomaly: 0.1139 0.6484	P:0.06, R:0.15
Pixel Auroc:0.909, Sample Auroc0.819, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0271
 61%|██████    | 61/100 [10:47<07:02, 10.84s/it]epoch [61/100], focal_loss:0.0160	, anomaly_loss:0.4124	fnorm_loss:0.0084, a_fnorm_loss:0.0445P:0.58, R:0.90
 62%|██████▏   | 62/100 [10:55<06:09,  9.72s/it]epoch [62/100], focal_loss:0.0136	, anomaly_loss:0.4082	fnorm_loss:0.0081, a_fnorm_loss:0.0456P:0.55, R:0.92
 63%|██████▎   | 63/100 [11:02<05:33,  9.01s/it]epoch [63/100], focal_loss:0.0191	, anomaly_loss:0.4267	fnorm_loss:0.0083, a_fnorm_loss:0.0442P:0.58, R:0.85
 64%|██████▍   | 64/100 [11:10<05:09,  8.60s/it]epoch [64/100], focal_loss:0.0145	, anomaly_loss:0.4119	fnorm_loss:0.0080, a_fnorm_loss:0.0442P:0.54, R:0.92
 65%|██████▌   | 65/100 [11:34<07:44, 13.27s/it]epoch [65/100], focal_loss:0.0136	, anomaly_loss:0.4057	fnorm_loss:0.0079, a_fnorm_loss:0.0467P:0.57, R:0.93
normal: 0.0592 0.1644  anomaly: 0.0703 0.6111	P:0.10, R:0.13
Pixel Auroc:0.907, Sample Auroc0.789, Pixel Aupro0.0
test_fnorm_loss: 0.0068 test_afnorm_loss: 0.0203
 66%|██████▌   | 66/100 [11:41<06:33, 11.59s/it]epoch [66/100], focal_loss:0.0138	, anomaly_loss:0.4094	fnorm_loss:0.0079, a_fnorm_loss:0.0453P:0.56, R:0.91
 67%|██████▋   | 67/100 [11:49<05:42, 10.39s/it]epoch [67/100], focal_loss:0.0175	, anomaly_loss:0.4207	fnorm_loss:0.0080, a_fnorm_loss:0.0449P:0.60, R:0.88
 68%|██████▊   | 68/100 [11:57<05:09,  9.68s/it]epoch [68/100], focal_loss:0.0143	, anomaly_loss:0.4127	fnorm_loss:0.0079, a_fnorm_loss:0.0445P:0.56, R:0.90
 69%|██████▉   | 69/100 [12:05<04:41,  9.09s/it]epoch [69/100], focal_loss:0.0147	, anomaly_loss:0.4078	fnorm_loss:0.0079, a_fnorm_loss:0.0445P:0.55, R:0.91
 70%|███████   | 70/100 [12:24<06:05, 12.18s/it]epoch [70/100], focal_loss:0.0214	, anomaly_loss:0.4332	fnorm_loss:0.0082, a_fnorm_loss:0.0440P:0.56, R:0.85
normal: 0.0549 0.1885  anomaly: 0.0671 0.5704	P:0.09, R:0.13
Pixel Auroc:0.917, Sample Auroc0.808, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0197
 71%|███████   | 71/100 [12:32<05:12, 10.77s/it]epoch [71/100], focal_loss:0.0165	, anomaly_loss:0.4197	fnorm_loss:0.0081, a_fnorm_loss:0.0432P:0.56, R:0.91
 72%|███████▏  | 72/100 [12:39<04:34,  9.79s/it]epoch [72/100], focal_loss:0.0151	, anomaly_loss:0.4155	fnorm_loss:0.0079, a_fnorm_loss:0.0451P:0.53, R:0.91
 73%|███████▎  | 73/100 [12:47<04:07,  9.15s/it]epoch [73/100], focal_loss:0.0140	, anomaly_loss:0.4034	fnorm_loss:0.0076, a_fnorm_loss:0.0469P:0.60, R:0.92
 74%|███████▍  | 74/100 [12:54<03:45,  8.68s/it]epoch [74/100], focal_loss:0.0153	, anomaly_loss:0.4100	fnorm_loss:0.0077, a_fnorm_loss:0.0445P:0.59, R:0.90
 75%|███████▌  | 75/100 [13:15<05:05, 12.23s/it]epoch [75/100], focal_loss:0.0121	, anomaly_loss:0.4022	fnorm_loss:0.0075, a_fnorm_loss:0.0479P:0.59, R:0.94
normal: 0.0494 0.1659  anomaly: 0.0533 0.6062	P:0.09, R:0.12
Pixel Auroc:0.892, Sample Auroc0.797, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0202
 76%|███████▌  | 76/100 [13:22<04:19, 10.83s/it]epoch [76/100], focal_loss:0.0140	, anomaly_loss:0.4063	fnorm_loss:0.0075, a_fnorm_loss:0.0447P:0.54, R:0.90
 77%|███████▋  | 77/100 [13:30<03:46,  9.85s/it]epoch [77/100], focal_loss:0.0144	, anomaly_loss:0.4061	fnorm_loss:0.0078, a_fnorm_loss:0.0457P:0.61, R:0.92
 78%|███████▊  | 78/100 [13:38<03:21,  9.18s/it]epoch [78/100], focal_loss:0.0187	, anomaly_loss:0.4143	fnorm_loss:0.0078, a_fnorm_loss:0.0439P:0.60, R:0.89
 79%|███████▉  | 79/100 [13:45<03:02,  8.70s/it]epoch [79/100], focal_loss:0.0129	, anomaly_loss:0.4061	fnorm_loss:0.0073, a_fnorm_loss:0.0472P:0.60, R:0.93
 80%|████████  | 80/100 [14:05<03:59, 11.97s/it]epoch [80/100], focal_loss:0.0143	, anomaly_loss:0.4041	fnorm_loss:0.0073, a_fnorm_loss:0.0467P:0.59, R:0.92
normal: 0.0405 0.1643  anomaly: 0.0419 0.6407	P:0.10, R:0.13
Pixel Auroc:0.921, Sample Auroc0.799, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0226
 81%|████████  | 81/100 [14:12<03:22, 10.68s/it]epoch [81/100], focal_loss:0.0124	, anomaly_loss:0.4021	fnorm_loss:0.0072, a_fnorm_loss:0.0472P:0.62, R:0.93
 82%|████████▏ | 82/100 [14:20<02:55,  9.74s/it]epoch [82/100], focal_loss:0.0134	, anomaly_loss:0.4079	fnorm_loss:0.0071, a_fnorm_loss:0.0456P:0.58, R:0.91
 83%|████████▎ | 83/100 [14:27<02:34,  9.08s/it]epoch [83/100], focal_loss:0.0134	, anomaly_loss:0.4032	fnorm_loss:0.0074, a_fnorm_loss:0.0459P:0.58, R:0.93
 84%|████████▍ | 84/100 [14:35<02:16,  8.53s/it]epoch [84/100], focal_loss:0.0138	, anomaly_loss:0.4080	fnorm_loss:0.0072, a_fnorm_loss:0.0453P:0.57, R:0.90
 85%|████████▌ | 85/100 [14:54<02:57, 11.85s/it]epoch [85/100], focal_loss:0.0129	, anomaly_loss:0.4068	fnorm_loss:0.0074, a_fnorm_loss:0.0470P:0.64, R:0.94
normal: 0.0445 0.2250  anomaly: 0.0513 0.6370	P:0.09, R:0.13
Pixel Auroc:0.926, Sample Auroc0.807, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0235
 86%|████████▌ | 86/100 [15:02<02:27, 10.56s/it]epoch [86/100], focal_loss:0.0148	, anomaly_loss:0.4161	fnorm_loss:0.0072, a_fnorm_loss:0.0457P:0.60, R:0.91
 87%|████████▋ | 87/100 [15:10<02:06,  9.75s/it]epoch [87/100], focal_loss:0.0140	, anomaly_loss:0.4102	fnorm_loss:0.0074, a_fnorm_loss:0.0450P:0.59, R:0.91
 88%|████████▊ | 88/100 [15:18<01:50,  9.21s/it]epoch [88/100], focal_loss:0.0130	, anomaly_loss:0.4030	fnorm_loss:0.0072, a_fnorm_loss:0.0475P:0.62, R:0.92
 89%|████████▉ | 89/100 [15:25<01:35,  8.66s/it]epoch [89/100], focal_loss:0.0155	, anomaly_loss:0.4096	fnorm_loss:0.0074, a_fnorm_loss:0.0453P:0.59, R:0.90
 90%|█████████ | 90/100 [15:50<02:15, 13.54s/it]epoch [90/100], focal_loss:0.0138	, anomaly_loss:0.4032	fnorm_loss:0.0073, a_fnorm_loss:0.0465P:0.65, R:0.91
normal: 0.0507 0.2286  anomaly: 0.0609 0.6328	P:0.10, R:0.13
Pixel Auroc:0.935, Sample Auroc0.813, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0236
 91%|█████████ | 91/100 [15:58<01:45, 11.78s/it]epoch [91/100], focal_loss:0.0122	, anomaly_loss:0.4013	fnorm_loss:0.0071, a_fnorm_loss:0.0469P:0.60, R:0.91
 92%|█████████▏| 92/100 [16:05<01:24, 10.56s/it]epoch [92/100], focal_loss:0.0123	, anomaly_loss:0.4053	fnorm_loss:0.0071, a_fnorm_loss:0.0462P:0.61, R:0.90
 93%|█████████▎| 93/100 [16:13<01:07,  9.62s/it]epoch [93/100], focal_loss:0.0127	, anomaly_loss:0.4009	fnorm_loss:0.0072, a_fnorm_loss:0.0473P:0.59, R:0.92
 94%|█████████▍| 94/100 [16:20<00:53,  8.94s/it]epoch [94/100], focal_loss:0.0119	, anomaly_loss:0.4001	fnorm_loss:0.0072, a_fnorm_loss:0.0480P:0.63, R:0.93
 95%|█████████▌| 95/100 [16:40<01:01, 12.26s/it]epoch [95/100], focal_loss:0.0112	, anomaly_loss:0.3936	fnorm_loss:0.0071, a_fnorm_loss:0.0487P:0.62, R:0.94
normal: 0.0459 0.2168  anomaly: 0.0592 0.6401	P:0.10, R:0.14
Pixel Auroc:0.931, Sample Auroc0.811, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0236
 96%|█████████▌| 96/100 [16:48<00:43, 10.98s/it]epoch [96/100], focal_loss:0.0128	, anomaly_loss:0.4035	fnorm_loss:0.0072, a_fnorm_loss:0.0463P:0.62, R:0.93
 97%|█████████▋| 97/100 [16:56<00:29,  9.98s/it]epoch [97/100], focal_loss:0.0123	, anomaly_loss:0.4065	fnorm_loss:0.0070, a_fnorm_loss:0.0467P:0.64, R:0.91
 98%|█████████▊| 98/100 [17:03<00:18,  9.25s/it]epoch [98/100], focal_loss:0.0130	, anomaly_loss:0.4033	fnorm_loss:0.0072, a_fnorm_loss:0.0468P:0.57, R:0.91
 99%|█████████▉| 99/100 [17:11<00:08,  8.85s/it]epoch [99/100], focal_loss:0.0128	, anomaly_loss:0.4003	fnorm_loss:0.0072, a_fnorm_loss:0.0471P:0.61, R:0.92
100%|██████████| 100/100 [17:31<00:00, 12.12s/it]100%|██████████| 100/100 [17:31<00:00, 10.52s/it]
epoch [100/100], focal_loss:0.0120	, anomaly_loss:0.3996	fnorm_loss:0.0071, a_fnorm_loss:0.0474P:0.61, R:0.92
normal: 0.0494 0.2363  anomaly: 0.0636 0.6437	P:0.09, R:0.14
Pixel Auroc:0.928, Sample Auroc0.811, Pixel Aupro0.0
test_fnorm_loss: 0.0063 test_afnorm_loss: 0.0241
training Stubborn Student...
foam
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:05<10:10,  5.13s/it]epoch [1/120], kd_loss:4.7749
  2%|▏         | 2/120 [00:10<10:04,  5.12s/it]epoch [2/120], kd_loss:3.9592
  2%|▎         | 3/120 [00:15<10:05,  5.17s/it]epoch [3/120], kd_loss:3.6988
  3%|▎         | 4/120 [00:20<10:00,  5.18s/it]epoch [4/120], kd_loss:3.5137
  4%|▍         | 5/120 [00:25<09:57,  5.20s/it]epoch [5/120], kd_loss:3.0969
  5%|▌         | 6/120 [00:31<09:54,  5.21s/it]epoch [6/120], kd_loss:2.5138
  6%|▌         | 7/120 [00:36<09:52,  5.25s/it]epoch [7/120], kd_loss:2.3637
  7%|▋         | 8/120 [00:41<09:49,  5.27s/it]epoch [8/120], kd_loss:2.7672
  8%|▊         | 9/120 [00:47<09:46,  5.29s/it]epoch [9/120], kd_loss:2.3484
  8%|▊         | 10/120 [01:04<16:27,  8.97s/it]epoch [10/120], kd_loss:2.5546
normal: 1.5743 1.7648  anomaly: 1.5976 2.4619
thresh: 1.5976144245562494
fpr: 0.9 fnr 0.0
Pixel Auroc:0.751, Sample Auroc0.814, Pixel Aupro0.0
  9%|▉         | 11/120 [01:09<14:12,  7.82s/it]epoch [11/120], kd_loss:2.5540
 10%|█         | 12/120 [01:14<12:38,  7.02s/it]epoch [12/120], kd_loss:2.3452
 11%|█         | 13/120 [01:19<11:29,  6.45s/it]epoch [13/120], kd_loss:2.2378
 12%|█▏        | 14/120 [01:25<10:44,  6.08s/it]epoch [14/120], kd_loss:2.1096
 12%|█▎        | 15/120 [01:30<10:12,  5.84s/it]epoch [15/120], kd_loss:2.4130
 13%|█▎        | 16/120 [01:35<09:49,  5.67s/it]epoch [16/120], kd_loss:2.0922
 14%|█▍        | 17/120 [01:40<09:32,  5.55s/it]epoch [17/120], kd_loss:2.0003
 15%|█▌        | 18/120 [01:46<09:15,  5.45s/it]epoch [18/120], kd_loss:2.0195
 16%|█▌        | 19/120 [01:51<09:06,  5.41s/it]epoch [19/120], kd_loss:2.0020
 17%|█▋        | 20/120 [02:09<15:11,  9.11s/it]epoch [20/120], kd_loss:1.9595
normal: 1.2117 1.4841  anomaly: 1.2468 2.4177
thresh: 1.2900498727095655
fpr: 0.6 fnr 0.0625
Pixel Auroc:0.888, Sample Auroc0.831, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:14<13:07,  7.96s/it]epoch [21/120], kd_loss:1.9382
 18%|█▊        | 22/120 [02:19<11:36,  7.11s/it]epoch [22/120], kd_loss:1.9172
 19%|█▉        | 23/120 [02:24<10:34,  6.54s/it]epoch [23/120], kd_loss:1.9702
 20%|██        | 24/120 [02:29<09:49,  6.14s/it]epoch [24/120], kd_loss:1.9221
 21%|██        | 25/120 [02:35<09:15,  5.84s/it]epoch [25/120], kd_loss:1.8198
 22%|██▏       | 26/120 [02:40<08:49,  5.64s/it]epoch [26/120], kd_loss:2.3841
 22%|██▎       | 27/120 [02:45<08:33,  5.52s/it]epoch [27/120], kd_loss:1.9776
 23%|██▎       | 28/120 [02:50<08:22,  5.46s/it]epoch [28/120], kd_loss:1.9107
 24%|██▍       | 29/120 [02:56<08:09,  5.38s/it]epoch [29/120], kd_loss:1.8236
 25%|██▌       | 30/120 [03:12<13:09,  8.77s/it]epoch [30/120], kd_loss:1.7638
normal: 1.0968 1.3673  anomaly: 1.1204 2.4806
thresh: 1.1582455923352297
fpr: 0.75 fnr 0.0375
Pixel Auroc:0.865, Sample Auroc0.812, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:17<11:24,  7.69s/it]epoch [31/120], kd_loss:1.7308
 27%|██▋       | 32/120 [03:23<10:11,  6.94s/it]epoch [32/120], kd_loss:1.7144
 28%|██▊       | 33/120 [03:28<09:19,  6.43s/it]epoch [33/120], kd_loss:1.6973
 28%|██▊       | 34/120 [03:33<08:41,  6.06s/it]epoch [34/120], kd_loss:1.7356
 29%|██▉       | 35/120 [03:38<08:12,  5.80s/it]epoch [35/120], kd_loss:1.6848
 30%|███       | 36/120 [03:43<07:52,  5.63s/it]epoch [36/120], kd_loss:1.6692
 31%|███       | 37/120 [03:49<07:38,  5.53s/it]epoch [37/120], kd_loss:1.6321
 32%|███▏      | 38/120 [03:54<07:29,  5.48s/it]epoch [38/120], kd_loss:1.6062
 32%|███▎      | 39/120 [03:59<07:19,  5.42s/it]epoch [39/120], kd_loss:1.8238
 33%|███▎      | 40/120 [04:17<12:17,  9.21s/it]epoch [40/120], kd_loss:1.6236
normal: 1.0208 1.2866  anomaly: 1.0350 2.3686
thresh: 1.0349816387352446
fpr: 0.9 fnr 0.0
Pixel Auroc:0.854, Sample Auroc0.846, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:23<10:30,  7.98s/it]epoch [41/120], kd_loss:1.7578
 35%|███▌      | 42/120 [04:28<09:17,  7.15s/it]epoch [42/120], kd_loss:1.8144
 36%|███▌      | 43/120 [04:33<08:25,  6.56s/it]epoch [43/120], kd_loss:1.9139
 37%|███▋      | 44/120 [04:38<07:47,  6.15s/it]epoch [44/120], kd_loss:1.7224
 38%|███▊      | 45/120 [04:43<07:20,  5.87s/it]epoch [45/120], kd_loss:1.7018
 38%|███▊      | 46/120 [04:49<07:00,  5.68s/it]epoch [46/120], kd_loss:1.6529
 39%|███▉      | 47/120 [04:54<06:46,  5.57s/it]epoch [47/120], kd_loss:1.6160
 40%|████      | 48/120 [04:59<06:34,  5.48s/it]epoch [48/120], kd_loss:1.6020
 41%|████      | 49/120 [05:04<06:24,  5.42s/it]epoch [49/120], kd_loss:1.7013
 42%|████▏     | 50/120 [05:23<11:04,  9.49s/it]epoch [50/120], kd_loss:1.5985
normal: 0.9835 1.2774  anomaly: 0.9492 2.3962
thresh: 1.060196249162562
fpr: 0.65 fnr 0.05
Pixel Auroc:0.905, Sample Auroc0.861, Pixel Aupro0.0
 42%|████▎     | 51/120 [05:29<09:23,  8.17s/it]epoch [51/120], kd_loss:1.5835
 43%|████▎     | 52/120 [05:34<08:15,  7.29s/it]epoch [52/120], kd_loss:1.5666
 44%|████▍     | 53/120 [05:39<07:28,  6.69s/it]epoch [53/120], kd_loss:1.6543
 45%|████▌     | 54/120 [05:44<06:52,  6.25s/it]epoch [54/120], kd_loss:1.5850
 46%|████▌     | 55/120 [05:50<06:26,  5.94s/it]epoch [55/120], kd_loss:1.6690
 47%|████▋     | 56/120 [05:55<06:09,  5.77s/it]epoch [56/120], kd_loss:1.5889
 48%|████▊     | 57/120 [06:00<05:54,  5.62s/it]epoch [57/120], kd_loss:1.6019
 48%|████▊     | 58/120 [06:05<05:41,  5.50s/it]epoch [58/120], kd_loss:1.5877
 49%|████▉     | 59/120 [06:11<05:30,  5.41s/it]epoch [59/120], kd_loss:1.6321
 50%|█████     | 60/120 [06:28<09:00,  9.00s/it]epoch [60/120], kd_loss:1.5564
normal: 0.9410 1.2282  anomaly: 0.8943 2.3453
thresh: 1.003577558902748
fpr: 0.75 fnr 0.025
Pixel Auroc:0.878, Sample Auroc0.847, Pixel Aupro0.0
 51%|█████     | 61/120 [06:33<07:42,  7.84s/it]epoch [61/120], kd_loss:1.5457
 52%|█████▏    | 62/120 [06:38<06:47,  7.03s/it]epoch [62/120], kd_loss:1.5703
 52%|█████▎    | 63/120 [06:43<06:09,  6.48s/it]epoch [63/120], kd_loss:1.5463
 53%|█████▎    | 64/120 [06:49<05:41,  6.10s/it]epoch [64/120], kd_loss:1.5370
 54%|█████▍    | 65/120 [06:54<05:20,  5.83s/it]epoch [65/120], kd_loss:1.6171
 55%|█████▌    | 66/120 [06:59<05:05,  5.65s/it]epoch [66/120], kd_loss:1.5774
 56%|█████▌    | 67/120 [07:04<04:52,  5.53s/it]epoch [67/120], kd_loss:2.4378
 57%|█████▋    | 68/120 [07:10<04:43,  5.45s/it]epoch [68/120], kd_loss:2.0064
 57%|█████▊    | 69/120 [07:15<04:35,  5.41s/it]epoch [69/120], kd_loss:1.7836
 58%|█████▊    | 70/120 [07:31<07:14,  8.68s/it]epoch [70/120], kd_loss:1.6671
normal: 1.0007 1.2377  anomaly: 0.9969 2.3821
thresh: 1.035279501281328
fpr: 0.65 fnr 0.0375
Pixel Auroc:0.892, Sample Auroc0.856, Pixel Aupro0.0
 59%|█████▉    | 71/120 [07:36<06:14,  7.64s/it]epoch [71/120], kd_loss:1.5945
 60%|██████    | 72/120 [07:42<05:33,  6.94s/it]epoch [72/120], kd_loss:1.5675
 61%|██████    | 73/120 [07:47<05:03,  6.45s/it]epoch [73/120], kd_loss:1.5831
 62%|██████▏   | 74/120 [07:52<04:40,  6.10s/it]epoch [74/120], kd_loss:3.3612
 62%|██████▎   | 75/120 [07:58<04:23,  5.86s/it]epoch [75/120], kd_loss:2.6854
 63%|██████▎   | 76/120 [08:03<04:10,  5.70s/it]epoch [76/120], kd_loss:2.0229
 64%|██████▍   | 77/120 [08:08<04:00,  5.59s/it]epoch [77/120], kd_loss:1.8966
 65%|██████▌   | 78/120 [08:14<03:50,  5.49s/it]epoch [78/120], kd_loss:1.9757
 66%|██████▌   | 79/120 [08:19<03:43,  5.44s/it]epoch [79/120], kd_loss:1.9079
 67%|██████▋   | 80/120 [08:36<05:55,  8.88s/it]epoch [80/120], kd_loss:1.7933
normal: 1.0810 1.3350  anomaly: 1.0935 2.4168
thresh: 1.0934546600847281
fpr: 0.95 fnr 0.0
Pixel Auroc:0.859, Sample Auroc0.825, Pixel Aupro0.0
 68%|██████▊   | 81/120 [08:41<05:02,  7.74s/it]epoch [81/120], kd_loss:1.6989
 68%|██████▊   | 82/120 [08:46<04:25,  6.98s/it]epoch [82/120], kd_loss:1.9573
 69%|██████▉   | 83/120 [08:51<03:58,  6.44s/it]epoch [83/120], kd_loss:2.0610
 70%|███████   | 84/120 [08:56<03:37,  6.06s/it]epoch [84/120], kd_loss:1.9032
 71%|███████   | 85/120 [09:02<03:22,  5.79s/it]epoch [85/120], kd_loss:1.8563
 72%|███████▏  | 86/120 [09:07<03:10,  5.61s/it]epoch [86/120], kd_loss:1.9157
 72%|███████▎  | 87/120 [09:12<03:01,  5.50s/it]epoch [87/120], kd_loss:1.7506
 73%|███████▎  | 88/120 [09:17<02:54,  5.44s/it]epoch [88/120], kd_loss:1.7236
 74%|███████▍  | 89/120 [09:23<02:47,  5.40s/it]epoch [89/120], kd_loss:1.9409
 75%|███████▌  | 90/120 [09:39<04:23,  8.78s/it]epoch [90/120], kd_loss:1.7129
normal: 1.0304 1.2906  anomaly: 1.0232 2.3073
thresh: 1.0921475944509362
fpr: 0.75 fnr 0.0125
Pixel Auroc:0.895, Sample Auroc0.854, Pixel Aupro0.0
 76%|███████▌  | 91/120 [09:44<03:43,  7.69s/it]epoch [91/120], kd_loss:1.6785
 77%|███████▋  | 92/120 [09:50<03:14,  6.94s/it]epoch [92/120], kd_loss:1.6333
 78%|███████▊  | 93/120 [09:55<02:53,  6.41s/it]epoch [93/120], kd_loss:1.6462
 78%|███████▊  | 94/120 [10:00<02:36,  6.03s/it]epoch [94/120], kd_loss:1.6299
 79%|███████▉  | 95/120 [10:05<02:24,  5.77s/it]epoch [95/120], kd_loss:1.6146
 80%|████████  | 96/120 [10:10<02:14,  5.62s/it]epoch [96/120], kd_loss:1.5937
 81%|████████  | 97/120 [10:16<02:06,  5.52s/it]epoch [97/120], kd_loss:1.5812
 82%|████████▏ | 98/120 [10:21<01:59,  5.43s/it]epoch [98/120], kd_loss:1.5768
 82%|████████▎ | 99/120 [10:26<01:52,  5.37s/it]epoch [99/120], kd_loss:1.5723
 83%|████████▎ | 100/120 [10:44<03:01,  9.09s/it]epoch [100/120], kd_loss:1.5697
normal: 0.9681 1.2825  anomaly: 0.9141 2.2603
thresh: 1.0528646974594522
fpr: 0.5 fnr 0.075
Pixel Auroc:0.861, Sample Auroc0.869, Pixel Aupro0.0
 84%|████████▍ | 101/120 [10:49<02:30,  7.92s/it]epoch [101/120], kd_loss:1.5660
 85%|████████▌ | 102/120 [10:54<02:08,  7.12s/it]epoch [102/120], kd_loss:1.5632
 86%|████████▌ | 103/120 [11:00<01:51,  6.53s/it]epoch [103/120], kd_loss:1.5612
 87%|████████▋ | 104/120 [11:05<01:38,  6.15s/it]epoch [104/120], kd_loss:1.5593
 88%|████████▊ | 105/120 [11:10<01:27,  5.86s/it]epoch [105/120], kd_loss:1.5567
 88%|████████▊ | 106/120 [11:15<01:19,  5.68s/it]epoch [106/120], kd_loss:1.5565
 89%|████████▉ | 107/120 [11:21<01:12,  5.57s/it]epoch [107/120], kd_loss:1.5537
 90%|█████████ | 108/120 [11:26<01:05,  5.47s/it]epoch [108/120], kd_loss:1.5561
 91%|█████████ | 109/120 [11:31<00:59,  5.42s/it]epoch [109/120], kd_loss:1.5501
 92%|█████████▏| 110/120 [11:48<01:29,  8.98s/it]epoch [110/120], kd_loss:1.5486
normal: 0.9739 1.2860  anomaly: 0.9007 2.2568
thresh: 1.032192085151831
fpr: 0.55 fnr 0.0625
Pixel Auroc:0.864, Sample Auroc0.879, Pixel Aupro0.0
 92%|█████████▎| 111/120 [11:53<01:10,  7.82s/it]epoch [111/120], kd_loss:1.5479
 93%|█████████▎| 112/120 [11:59<00:56,  7.02s/it]epoch [112/120], kd_loss:1.5469
 94%|█████████▍| 113/120 [12:04<00:45,  6.48s/it]epoch [113/120], kd_loss:1.5465
 95%|█████████▌| 114/120 [12:09<00:36,  6.09s/it]epoch [114/120], kd_loss:1.5455
 96%|█████████▌| 115/120 [12:14<00:29,  5.83s/it]epoch [115/120], kd_loss:1.5453
 97%|█████████▋| 116/120 [12:19<00:22,  5.64s/it]epoch [116/120], kd_loss:1.5453
 98%|█████████▊| 117/120 [12:25<00:16,  5.52s/it]epoch [117/120], kd_loss:1.5447
 98%|█████████▊| 118/120 [12:30<00:10,  5.44s/it]epoch [118/120], kd_loss:1.5446
 99%|█████████▉| 119/120 [12:35<00:05,  5.38s/it]epoch [119/120], kd_loss:1.5443
100%|██████████| 120/120 [12:52<00:00,  8.86s/it]100%|██████████| 120/120 [12:52<00:00,  6.44s/it]
epoch [120/120], kd_loss:1.5445
normal: 0.9692 1.2812  anomaly: 0.8906 2.2489
thresh: 1.0321485775832542
fpr: 0.45 fnr 0.0625
Pixel Auroc:0.865, Sample Auroc0.874, Pixel Aupro0.0
training Advanced Teacher...
peach
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:25<41:56, 25.42s/it]epoch [1/100], focal_loss:0.0718	, anomaly_loss:0.5409	fnorm_loss:0.0674, a_fnorm_loss:0.0141P:0.00, R:0.03
normal: 0.2298 0.2440  anomaly: 0.2277 0.2457	P:0.00, R:0.00
Pixel Auroc:0.815, Sample Auroc0.512, Pixel Aupro0.0
test_fnorm_loss: 0.0651 test_afnorm_loss: 0.0163
  2%|▏         | 2/100 [00:35<26:51, 16.44s/it]epoch [2/100], focal_loss:0.0564	, anomaly_loss:0.5613	fnorm_loss:0.0589, a_fnorm_loss:0.0126P:0.00, R:0.00
  3%|▎         | 3/100 [00:45<21:42, 13.42s/it]epoch [3/100], focal_loss:0.0470	, anomaly_loss:0.5860	fnorm_loss:0.0506, a_fnorm_loss:0.0110P:0.00, R:0.00
  4%|▍         | 4/100 [00:55<19:23, 12.12s/it]epoch [4/100], focal_loss:0.0418	, anomaly_loss:0.6072	fnorm_loss:0.0448, a_fnorm_loss:0.0098P:0.00, R:0.00
  5%|▌         | 5/100 [01:18<25:31, 16.12s/it]epoch [5/100], focal_loss:0.0343	, anomaly_loss:0.6169	fnorm_loss:0.0404, a_fnorm_loss:0.0087P:0.00, R:0.00
normal: 0.1464 0.1528  anomaly: 0.1445 0.1533	P:0.00, R:0.00
Pixel Auroc:0.866, Sample Auroc0.480, Pixel Aupro0.0
test_fnorm_loss: 0.0399 test_afnorm_loss: 0.0110
  6%|▌         | 6/100 [01:28<21:47, 13.91s/it]epoch [6/100], focal_loss:0.0372	, anomaly_loss:0.6290	fnorm_loss:0.0388, a_fnorm_loss:0.0087P:0.00, R:0.01
  7%|▋         | 7/100 [01:38<19:32, 12.60s/it]epoch [7/100], focal_loss:0.0340	, anomaly_loss:0.6309	fnorm_loss:0.0363, a_fnorm_loss:0.0084P:0.00, R:0.01
  8%|▊         | 8/100 [01:48<18:21, 11.98s/it]epoch [8/100], focal_loss:0.0352	, anomaly_loss:0.5618	fnorm_loss:0.0358, a_fnorm_loss:0.0185P:0.04, R:0.14
  9%|▉         | 9/100 [01:58<17:06, 11.28s/it]epoch [9/100], focal_loss:0.0310	, anomaly_loss:0.4763	fnorm_loss:0.0304, a_fnorm_loss:0.0318P:0.10, R:0.36
 10%|█         | 10/100 [02:24<23:28, 15.65s/it]epoch [10/100], focal_loss:0.0296	, anomaly_loss:0.4434	fnorm_loss:0.0279, a_fnorm_loss:0.0345P:0.20, R:0.53
normal: 0.1447 0.3136  anomaly: 0.1469 0.3214	P:0.07, R:0.14
Pixel Auroc:0.965, Sample Auroc0.681, Pixel Aupro0.0
test_fnorm_loss: 0.0265 test_afnorm_loss: 0.0176
 11%|█         | 11/100 [02:34<20:54, 14.10s/it]epoch [11/100], focal_loss:0.0284	, anomaly_loss:0.4477	fnorm_loss:0.0262, a_fnorm_loss:0.0332P:0.20, R:0.56
 12%|█▏        | 12/100 [02:45<19:11, 13.08s/it]epoch [12/100], focal_loss:0.0239	, anomaly_loss:0.4216	fnorm_loss:0.0251, a_fnorm_loss:0.0365P:0.22, R:0.61
 13%|█▎        | 13/100 [02:55<17:41, 12.20s/it]epoch [13/100], focal_loss:0.0240	, anomaly_loss:0.4176	fnorm_loss:0.0239, a_fnorm_loss:0.0370P:0.24, R:0.62
 14%|█▍        | 14/100 [03:05<16:42, 11.65s/it]epoch [14/100], focal_loss:0.0214	, anomaly_loss:0.4076	fnorm_loss:0.0229, a_fnorm_loss:0.0375P:0.23, R:0.63
 15%|█▌        | 15/100 [03:29<21:36, 15.25s/it]epoch [15/100], focal_loss:0.0203	, anomaly_loss:0.4142	fnorm_loss:0.0220, a_fnorm_loss:0.0378P:0.23, R:0.61
normal: 0.0795 0.2659  anomaly: 0.0784 0.2808	P:0.05, R:0.05
Pixel Auroc:0.956, Sample Auroc0.699, Pixel Aupro0.0
test_fnorm_loss: 0.0213 test_afnorm_loss: 0.0109
 16%|█▌        | 16/100 [03:39<18:55, 13.52s/it]epoch [16/100], focal_loss:0.0194	, anomaly_loss:0.4056	fnorm_loss:0.0211, a_fnorm_loss:0.0393P:0.24, R:0.61
 17%|█▋        | 17/100 [03:50<17:39, 12.76s/it]epoch [17/100], focal_loss:0.0235	, anomaly_loss:0.4235	fnorm_loss:0.0213, a_fnorm_loss:0.0372P:0.25, R:0.60
 18%|█▊        | 18/100 [03:59<16:06, 11.78s/it]epoch [18/100], focal_loss:0.0182	, anomaly_loss:0.4003	fnorm_loss:0.0205, a_fnorm_loss:0.0394P:0.24, R:0.63
 19%|█▉        | 19/100 [04:09<15:07, 11.21s/it]epoch [19/100], focal_loss:0.0203	, anomaly_loss:0.4081	fnorm_loss:0.0201, a_fnorm_loss:0.0390P:0.26, R:0.63
 20%|██        | 20/100 [04:33<19:57, 14.97s/it]epoch [20/100], focal_loss:0.0190	, anomaly_loss:0.4033	fnorm_loss:0.0200, a_fnorm_loss:0.0391P:0.25, R:0.63
normal: 0.0714 0.2807  anomaly: 0.0715 0.3326	P:0.05, R:0.07
Pixel Auroc:0.958, Sample Auroc0.695, Pixel Aupro0.0
test_fnorm_loss: 0.0195 test_afnorm_loss: 0.0131
 21%|██        | 21/100 [04:43<18:02, 13.70s/it]epoch [21/100], focal_loss:0.0186	, anomaly_loss:0.4098	fnorm_loss:0.0196, a_fnorm_loss:0.0391P:0.24, R:0.61
 22%|██▏       | 22/100 [04:54<16:32, 12.72s/it]epoch [22/100], focal_loss:0.0177	, anomaly_loss:0.4020	fnorm_loss:0.0190, a_fnorm_loss:0.0406P:0.26, R:0.62
 23%|██▎       | 23/100 [05:03<15:07, 11.79s/it]epoch [23/100], focal_loss:0.0184	, anomaly_loss:0.4055	fnorm_loss:0.0190, a_fnorm_loss:0.0405P:0.28, R:0.63
 24%|██▍       | 24/100 [05:13<14:08, 11.17s/it]epoch [24/100], focal_loss:0.0187	, anomaly_loss:0.3741	fnorm_loss:0.0189, a_fnorm_loss:0.0392P:0.31, R:0.73
 25%|██▌       | 25/100 [05:37<18:37, 14.90s/it]epoch [25/100], focal_loss:0.0153	, anomaly_loss:0.3286	fnorm_loss:0.0165, a_fnorm_loss:0.0429P:0.36, R:0.88
normal: 0.0597 0.2682  anomaly: 0.0585 0.3487	P:0.04, R:0.04
Pixel Auroc:0.967, Sample Auroc0.687, Pixel Aupro0.0
test_fnorm_loss: 0.0148 test_afnorm_loss: 0.0100
 26%|██▌       | 26/100 [05:47<16:48, 13.63s/it]epoch [26/100], focal_loss:0.0126	, anomaly_loss:0.3152	fnorm_loss:0.0146, a_fnorm_loss:0.0454P:0.43, R:0.93
 27%|██▋       | 27/100 [05:59<15:49, 13.01s/it]epoch [27/100], focal_loss:0.0120	, anomaly_loss:0.3255	fnorm_loss:0.0136, a_fnorm_loss:0.0451P:0.42, R:0.92
 28%|██▊       | 28/100 [06:09<14:33, 12.13s/it]epoch [28/100], focal_loss:0.0121	, anomaly_loss:0.3144	fnorm_loss:0.0130, a_fnorm_loss:0.0461P:0.43, R:0.92
 29%|██▉       | 29/100 [06:19<13:33, 11.46s/it]epoch [29/100], focal_loss:0.0101	, anomaly_loss:0.3040	fnorm_loss:0.0122, a_fnorm_loss:0.0455P:0.40, R:0.93
 30%|███       | 30/100 [06:42<17:32, 15.03s/it]epoch [30/100], focal_loss:0.0107	, anomaly_loss:0.3135	fnorm_loss:0.0116, a_fnorm_loss:0.0459P:0.46, R:0.92
normal: 0.0526 0.3198  anomaly: 0.0640 0.4069	P:0.06, R:0.09
Pixel Auroc:0.970, Sample Auroc0.695, Pixel Aupro0.0
test_fnorm_loss: 0.0112 test_afnorm_loss: 0.0172
 31%|███       | 31/100 [06:53<15:36, 13.58s/it]epoch [31/100], focal_loss:0.0116	, anomaly_loss:0.3132	fnorm_loss:0.0113, a_fnorm_loss:0.0451P:0.47, R:0.93
 32%|███▏      | 32/100 [07:03<14:22, 12.69s/it]epoch [32/100], focal_loss:0.0096	, anomaly_loss:0.3119	fnorm_loss:0.0108, a_fnorm_loss:0.0460P:0.44, R:0.94
 33%|███▎      | 33/100 [07:13<13:21, 11.96s/it]epoch [33/100], focal_loss:0.0103	, anomaly_loss:0.3151	fnorm_loss:0.0106, a_fnorm_loss:0.0467P:0.49, R:0.92
 34%|███▍      | 34/100 [07:24<12:37, 11.48s/it]epoch [34/100], focal_loss:0.0096	, anomaly_loss:0.2975	fnorm_loss:0.0102, a_fnorm_loss:0.0466P:0.50, R:0.94
 35%|███▌      | 35/100 [07:48<16:32, 15.27s/it]epoch [35/100], focal_loss:0.0083	, anomaly_loss:0.2950	fnorm_loss:0.0098, a_fnorm_loss:0.0480P:0.46, R:0.95
normal: 0.0404 0.3800  anomaly: 0.0491 0.4550	P:0.06, R:0.08
Pixel Auroc:0.965, Sample Auroc0.711, Pixel Aupro0.0
test_fnorm_loss: 0.0094 test_afnorm_loss: 0.0139
 36%|███▌      | 36/100 [07:58<14:29, 13.59s/it]epoch [36/100], focal_loss:0.0123	, anomaly_loss:0.3146	fnorm_loss:0.0097, a_fnorm_loss:0.0465P:0.48, R:0.91
 37%|███▋      | 37/100 [08:07<13:06, 12.48s/it]epoch [37/100], focal_loss:0.0109	, anomaly_loss:0.3171	fnorm_loss:0.0101, a_fnorm_loss:0.0451P:0.44, R:0.94
 38%|███▊      | 38/100 [08:17<11:54, 11.53s/it]epoch [38/100], focal_loss:0.0082	, anomaly_loss:0.3046	fnorm_loss:0.0092, a_fnorm_loss:0.0463P:0.48, R:0.93
 39%|███▉      | 39/100 [08:27<11:16, 11.09s/it]epoch [39/100], focal_loss:0.0082	, anomaly_loss:0.2969	fnorm_loss:0.0089, a_fnorm_loss:0.0480P:0.51, R:0.95
 40%|████      | 40/100 [08:56<16:26, 16.44s/it]epoch [40/100], focal_loss:0.0086	, anomaly_loss:0.3037	fnorm_loss:0.0089, a_fnorm_loss:0.0480P:0.50, R:0.92
normal: 0.0519 0.5061  anomaly: 0.0618 0.5379	P:0.11, R:0.15
Pixel Auroc:0.970, Sample Auroc0.687, Pixel Aupro0.0
test_fnorm_loss: 0.0086 test_afnorm_loss: 0.0189
 41%|████      | 41/100 [09:06<14:13, 14.46s/it]epoch [41/100], focal_loss:0.0088	, anomaly_loss:0.2912	fnorm_loss:0.0088, a_fnorm_loss:0.0474P:0.48, R:0.94
 42%|████▏     | 42/100 [09:15<12:31, 12.95s/it]epoch [42/100], focal_loss:0.0078	, anomaly_loss:0.2921	fnorm_loss:0.0085, a_fnorm_loss:0.0484P:0.50, R:0.95
 43%|████▎     | 43/100 [09:25<11:20, 11.95s/it]epoch [43/100], focal_loss:0.0090	, anomaly_loss:0.3037	fnorm_loss:0.0084, a_fnorm_loss:0.0472P:0.44, R:0.92
 44%|████▍     | 44/100 [09:35<10:41, 11.45s/it]epoch [44/100], focal_loss:0.0085	, anomaly_loss:0.2963	fnorm_loss:0.0083, a_fnorm_loss:0.0475P:0.50, R:0.94
 45%|████▌     | 45/100 [09:58<13:49, 15.08s/it]epoch [45/100], focal_loss:0.0115	, anomaly_loss:0.3179	fnorm_loss:0.0087, a_fnorm_loss:0.0444P:0.48, R:0.87
normal: 0.0386 0.3729  anomaly: 0.0510 0.4119	P:0.07, R:0.09
Pixel Auroc:0.972, Sample Auroc0.720, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0141
 46%|████▌     | 46/100 [10:10<12:29, 13.89s/it]epoch [46/100], focal_loss:0.0094	, anomaly_loss:0.2945	fnorm_loss:0.0082, a_fnorm_loss:0.0476P:0.46, R:0.93
 47%|████▋     | 47/100 [10:20<11:19, 12.83s/it]epoch [47/100], focal_loss:0.0082	, anomaly_loss:0.2970	fnorm_loss:0.0081, a_fnorm_loss:0.0478P:0.46, R:0.95
 48%|████▊     | 48/100 [10:30<10:20, 11.93s/it]epoch [48/100], focal_loss:0.0076	, anomaly_loss:0.3011	fnorm_loss:0.0078, a_fnorm_loss:0.0486P:0.52, R:0.94
 49%|████▉     | 49/100 [10:40<09:49, 11.56s/it]epoch [49/100], focal_loss:0.0075	, anomaly_loss:0.2944	fnorm_loss:0.0077, a_fnorm_loss:0.0490P:0.50, R:0.95
 50%|█████     | 50/100 [11:04<12:30, 15.01s/it]epoch [50/100], focal_loss:0.0084	, anomaly_loss:0.2918	fnorm_loss:0.0077, a_fnorm_loss:0.0490P:0.50, R:0.95
normal: 0.0320 0.3091  anomaly: 0.0362 0.3833	P:0.05, R:0.07
Pixel Auroc:0.968, Sample Auroc0.725, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0130
 51%|█████     | 51/100 [11:13<10:58, 13.44s/it]epoch [51/100], focal_loss:0.0068	, anomaly_loss:0.2943	fnorm_loss:0.0075, a_fnorm_loss:0.0493P:0.50, R:0.96
 52%|█████▏    | 52/100 [11:24<10:02, 12.55s/it]epoch [52/100], focal_loss:0.0079	, anomaly_loss:0.2927	fnorm_loss:0.0075, a_fnorm_loss:0.0483P:0.51, R:0.94
 53%|█████▎    | 53/100 [11:34<09:17, 11.85s/it]epoch [53/100], focal_loss:0.0072	, anomaly_loss:0.3024	fnorm_loss:0.0074, a_fnorm_loss:0.0480P:0.52, R:0.93
 54%|█████▍    | 54/100 [11:44<08:46, 11.44s/it]epoch [54/100], focal_loss:0.0079	, anomaly_loss:0.3026	fnorm_loss:0.0074, a_fnorm_loss:0.0477P:0.50, R:0.93
 55%|█████▌    | 55/100 [12:08<11:20, 15.12s/it]epoch [55/100], focal_loss:0.0071	, anomaly_loss:0.2946	fnorm_loss:0.0072, a_fnorm_loss:0.0493P:0.56, R:0.95
normal: 0.0591 0.3746  anomaly: 0.0720 0.5444	P:0.10, R:0.16
Pixel Auroc:0.970, Sample Auroc0.752, Pixel Aupro0.0
test_fnorm_loss: 0.0072 test_afnorm_loss: 0.0229
 56%|█████▌    | 56/100 [12:17<09:47, 13.35s/it]epoch [56/100], focal_loss:0.0071	, anomaly_loss:0.2884	fnorm_loss:0.0072, a_fnorm_loss:0.0495P:0.54, R:0.96
 57%|█████▋    | 57/100 [12:27<08:40, 12.11s/it]epoch [57/100], focal_loss:0.0066	, anomaly_loss:0.2878	fnorm_loss:0.0071, a_fnorm_loss:0.0489P:0.52, R:0.96
 58%|█████▊    | 58/100 [12:37<08:04, 11.53s/it]epoch [58/100], focal_loss:0.0071	, anomaly_loss:0.2883	fnorm_loss:0.0071, a_fnorm_loss:0.0488P:0.51, R:0.93
 59%|█████▉    | 59/100 [12:46<07:27, 10.90s/it]epoch [59/100], focal_loss:0.0079	, anomaly_loss:0.2939	fnorm_loss:0.0071, a_fnorm_loss:0.0489P:0.51, R:0.93
 60%|██████    | 60/100 [13:11<09:56, 14.91s/it]epoch [60/100], focal_loss:0.0062	, anomaly_loss:0.2775	fnorm_loss:0.0069, a_fnorm_loss:0.0507P:0.49, R:0.96
normal: 0.0342 0.3063  anomaly: 0.0392 0.5001	P:0.10, R:0.12
Pixel Auroc:0.972, Sample Auroc0.716, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0169
 61%|██████    | 61/100 [13:21<08:46, 13.50s/it]epoch [61/100], focal_loss:0.0077	, anomaly_loss:0.2878	fnorm_loss:0.0070, a_fnorm_loss:0.0485P:0.48, R:0.94
 62%|██████▏   | 62/100 [13:31<07:53, 12.47s/it]epoch [62/100], focal_loss:0.0076	, anomaly_loss:0.2887	fnorm_loss:0.0069, a_fnorm_loss:0.0480P:0.55, R:0.95
 63%|██████▎   | 63/100 [13:41<07:11, 11.67s/it]epoch [63/100], focal_loss:0.0076	, anomaly_loss:0.2891	fnorm_loss:0.0069, a_fnorm_loss:0.0487P:0.50, R:0.95
 64%|██████▍   | 64/100 [13:51<06:42, 11.19s/it]epoch [64/100], focal_loss:0.0066	, anomaly_loss:0.2851	fnorm_loss:0.0068, a_fnorm_loss:0.0498P:0.52, R:0.94
 65%|██████▌   | 65/100 [14:14<08:37, 14.78s/it]epoch [65/100], focal_loss:0.0075	, anomaly_loss:0.3029	fnorm_loss:0.0068, a_fnorm_loss:0.0497P:0.53, R:0.94
normal: 0.0289 0.2841  anomaly: 0.0385 0.4091	P:0.07, R:0.09
Pixel Auroc:0.971, Sample Auroc0.737, Pixel Aupro0.0
test_fnorm_loss: 0.0064 test_afnorm_loss: 0.0153
 66%|██████▌   | 66/100 [14:23<07:28, 13.18s/it]epoch [66/100], focal_loss:0.0071	, anomaly_loss:0.2891	fnorm_loss:0.0067, a_fnorm_loss:0.0487P:0.50, R:0.94
 67%|██████▋   | 67/100 [14:33<06:42, 12.21s/it]epoch [67/100], focal_loss:0.0072	, anomaly_loss:0.2878	fnorm_loss:0.0068, a_fnorm_loss:0.0491P:0.50, R:0.95
 68%|██████▊   | 68/100 [14:43<06:06, 11.47s/it]epoch [68/100], focal_loss:0.0079	, anomaly_loss:0.2962	fnorm_loss:0.0067, a_fnorm_loss:0.0490P:0.53, R:0.93
 69%|██████▉   | 69/100 [14:52<05:36, 10.85s/it]epoch [69/100], focal_loss:0.0129	, anomaly_loss:0.3451	fnorm_loss:0.0070, a_fnorm_loss:0.0455P:0.48, R:0.85
 70%|███████   | 70/100 [15:15<07:13, 14.45s/it]epoch [70/100], focal_loss:0.0081	, anomaly_loss:0.2885	fnorm_loss:0.0068, a_fnorm_loss:0.0483P:0.47, R:0.95
normal: 0.0270 0.3155  anomaly: 0.0315 0.4677	P:0.09, R:0.11
Pixel Auroc:0.974, Sample Auroc0.731, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0163
 71%|███████   | 71/100 [15:25<06:18, 13.04s/it]epoch [71/100], focal_loss:0.0071	, anomaly_loss:0.2833	fnorm_loss:0.0065, a_fnorm_loss:0.0497P:0.53, R:0.96
 72%|███████▏  | 72/100 [15:35<05:39, 12.14s/it]epoch [72/100], focal_loss:0.0105	, anomaly_loss:0.3121	fnorm_loss:0.0067, a_fnorm_loss:0.0476P:0.50, R:0.89
 73%|███████▎  | 73/100 [15:45<05:08, 11.41s/it]epoch [73/100], focal_loss:0.0067	, anomaly_loss:0.2936	fnorm_loss:0.0066, a_fnorm_loss:0.0491P:0.49, R:0.95
 74%|███████▍  | 74/100 [15:54<04:41, 10.84s/it]epoch [74/100], focal_loss:0.0074	, anomaly_loss:0.2867	fnorm_loss:0.0065, a_fnorm_loss:0.0489P:0.44, R:0.94
 75%|███████▌  | 75/100 [16:23<06:42, 16.10s/it]epoch [75/100], focal_loss:0.0072	, anomaly_loss:0.2886	fnorm_loss:0.0066, a_fnorm_loss:0.0491P:0.49, R:0.95
normal: 0.0723 0.4557  anomaly: 0.0821 0.6122	P:0.11, R:0.20
Pixel Auroc:0.963, Sample Auroc0.696, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0224
 76%|███████▌  | 76/100 [16:33<05:42, 14.27s/it]epoch [76/100], focal_loss:0.0066	, anomaly_loss:0.2924	fnorm_loss:0.0065, a_fnorm_loss:0.0497P:0.51, R:0.95
 77%|███████▋  | 77/100 [16:42<04:56, 12.87s/it]epoch [77/100], focal_loss:0.0074	, anomaly_loss:0.3018	fnorm_loss:0.0065, a_fnorm_loss:0.0489P:0.49, R:0.94
 78%|███████▊  | 78/100 [16:52<04:24, 12.00s/it]epoch [78/100], focal_loss:0.0064	, anomaly_loss:0.2796	fnorm_loss:0.0064, a_fnorm_loss:0.0492P:0.57, R:0.95
 79%|███████▉  | 79/100 [17:03<04:02, 11.57s/it]epoch [79/100], focal_loss:0.0083	, anomaly_loss:0.2958	fnorm_loss:0.0066, a_fnorm_loss:0.0479P:0.47, R:0.93
 80%|████████  | 80/100 [17:31<05:33, 16.67s/it]epoch [80/100], focal_loss:0.0056	, anomaly_loss:0.2913	fnorm_loss:0.0063, a_fnorm_loss:0.0519P:0.57, R:0.96
normal: 0.0362 0.3939  anomaly: 0.0382 0.4889	P:0.12, R:0.14
Pixel Auroc:0.971, Sample Auroc0.713, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0158
 81%|████████  | 81/100 [17:41<04:37, 14.62s/it]epoch [81/100], focal_loss:0.0057	, anomaly_loss:0.2732	fnorm_loss:0.0062, a_fnorm_loss:0.0523P:0.58, R:0.97
 82%|████████▏ | 82/100 [17:51<03:56, 13.12s/it]epoch [82/100], focal_loss:0.0056	, anomaly_loss:0.2809	fnorm_loss:0.0062, a_fnorm_loss:0.0509P:0.56, R:0.96
 83%|████████▎ | 83/100 [18:01<03:28, 12.25s/it]epoch [83/100], focal_loss:0.0060	, anomaly_loss:0.2768	fnorm_loss:0.0062, a_fnorm_loss:0.0507P:0.56, R:0.95
 84%|████████▍ | 84/100 [18:11<03:03, 11.50s/it]epoch [84/100], focal_loss:0.0055	, anomaly_loss:0.2700	fnorm_loss:0.0063, a_fnorm_loss:0.0508P:0.53, R:0.97
 85%|████████▌ | 85/100 [18:35<03:47, 15.20s/it]epoch [85/100], focal_loss:0.0060	, anomaly_loss:0.2775	fnorm_loss:0.0063, a_fnorm_loss:0.0519P:0.54, R:0.96
normal: 0.0434 0.3518  anomaly: 0.0441 0.5016	P:0.12, R:0.14
Pixel Auroc:0.972, Sample Auroc0.740, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0184
 86%|████████▌ | 86/100 [18:44<03:09, 13.53s/it]epoch [86/100], focal_loss:0.0059	, anomaly_loss:0.2837	fnorm_loss:0.0062, a_fnorm_loss:0.0512P:0.57, R:0.97
 87%|████████▋ | 87/100 [18:54<02:41, 12.42s/it]epoch [87/100], focal_loss:0.0059	, anomaly_loss:0.2788	fnorm_loss:0.0062, a_fnorm_loss:0.0513P:0.57, R:0.96
 88%|████████▊ | 88/100 [19:04<02:19, 11.66s/it]epoch [88/100], focal_loss:0.0060	, anomaly_loss:0.2874	fnorm_loss:0.0062, a_fnorm_loss:0.0503P:0.54, R:0.96
 89%|████████▉ | 89/100 [19:13<02:01, 11.04s/it]epoch [89/100], focal_loss:0.0066	, anomaly_loss:0.2790	fnorm_loss:0.0064, a_fnorm_loss:0.0502P:0.57, R:0.96
 90%|█████████ | 90/100 [19:35<02:21, 14.14s/it]epoch [90/100], focal_loss:0.0054	, anomaly_loss:0.2829	fnorm_loss:0.0062, a_fnorm_loss:0.0507P:0.56, R:0.97
normal: 0.0323 0.2638  anomaly: 0.0357 0.4641	P:0.10, R:0.11
Pixel Auroc:0.972, Sample Auroc0.722, Pixel Aupro0.0
test_fnorm_loss: 0.0059 test_afnorm_loss: 0.0146
 91%|█████████ | 91/100 [19:45<01:55, 12.84s/it]epoch [91/100], focal_loss:0.0068	, anomaly_loss:0.2878	fnorm_loss:0.0062, a_fnorm_loss:0.0508P:0.59, R:0.95
 92%|█████████▏| 92/100 [19:54<01:34, 11.85s/it]epoch [92/100], focal_loss:0.0057	, anomaly_loss:0.2706	fnorm_loss:0.0062, a_fnorm_loss:0.0506P:0.54, R:0.96
 93%|█████████▎| 93/100 [20:04<01:19, 11.36s/it]epoch [93/100], focal_loss:0.0061	, anomaly_loss:0.2743	fnorm_loss:0.0062, a_fnorm_loss:0.0506P:0.54, R:0.97
 94%|█████████▍| 94/100 [20:14<01:04, 10.83s/it]epoch [94/100], focal_loss:0.0057	, anomaly_loss:0.2765	fnorm_loss:0.0062, a_fnorm_loss:0.0502P:0.56, R:0.96
 95%|█████████▌| 95/100 [20:43<01:21, 16.25s/it]epoch [95/100], focal_loss:0.0063	, anomaly_loss:0.2854	fnorm_loss:0.0062, a_fnorm_loss:0.0503P:0.51, R:0.95
normal: 0.0471 0.3678  anomaly: 0.0534 0.5379	P:0.13, R:0.16
Pixel Auroc:0.972, Sample Auroc0.736, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0202
 96%|█████████▌| 96/100 [20:52<00:56, 14.21s/it]epoch [96/100], focal_loss:0.0066	, anomaly_loss:0.2937	fnorm_loss:0.0063, a_fnorm_loss:0.0511P:0.55, R:0.95
 97%|█████████▋| 97/100 [21:02<00:38, 12.96s/it]epoch [97/100], focal_loss:0.0064	, anomaly_loss:0.2809	fnorm_loss:0.0063, a_fnorm_loss:0.0514P:0.52, R:0.95
 98%|█████████▊| 98/100 [21:12<00:23, 11.90s/it]epoch [98/100], focal_loss:0.0065	, anomaly_loss:0.2835	fnorm_loss:0.0062, a_fnorm_loss:0.0491P:0.56, R:0.95
 99%|█████████▉| 99/100 [21:22<00:11, 11.30s/it]epoch [99/100], focal_loss:0.0059	, anomaly_loss:0.2819	fnorm_loss:0.0063, a_fnorm_loss:0.0512P:0.47, R:0.96
100%|██████████| 100/100 [21:44<00:00, 14.62s/it]100%|██████████| 100/100 [21:44<00:00, 13.05s/it]
epoch [100/100], focal_loss:0.0054	, anomaly_loss:0.2719	fnorm_loss:0.0062, a_fnorm_loss:0.0526P:0.56, R:0.97
normal: 0.0391 0.3220  anomaly: 0.0422 0.4921	P:0.13, R:0.14
Pixel Auroc:0.973, Sample Auroc0.733, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0178
training Stubborn Student...
peach
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<13:46,  6.94s/it]epoch [1/120], kd_loss:4.4533
  2%|▏         | 2/120 [00:13<13:46,  7.01s/it]epoch [2/120], kd_loss:3.6704
  2%|▎         | 3/120 [00:21<13:42,  7.03s/it]epoch [3/120], kd_loss:2.9733
  3%|▎         | 4/120 [00:28<13:36,  7.04s/it]epoch [4/120], kd_loss:2.4240
  4%|▍         | 5/120 [00:35<13:32,  7.06s/it]epoch [5/120], kd_loss:1.9114
  5%|▌         | 6/120 [00:42<13:31,  7.12s/it]epoch [6/120], kd_loss:1.8812
  6%|▌         | 7/120 [00:49<13:29,  7.17s/it]epoch [7/120], kd_loss:2.1827
  7%|▋         | 8/120 [00:56<13:26,  7.20s/it]epoch [8/120], kd_loss:1.7508
  8%|▊         | 9/120 [01:04<13:22,  7.23s/it]epoch [9/120], kd_loss:1.7085
  8%|▊         | 10/120 [01:25<21:06, 11.51s/it]epoch [10/120], kd_loss:1.7758
normal: 1.2353 1.7485  anomaly: 1.2976 2.0246
thresh: 1.297567750545351
fpr: 0.8461538461538461 fnr 0.0
Pixel Auroc:0.963, Sample Auroc0.767, Pixel Aupro0.0
  9%|▉         | 11/120 [01:32<18:25, 10.14s/it]epoch [11/120], kd_loss:1.7233
 10%|█         | 12/120 [01:39<16:34,  9.21s/it]epoch [12/120], kd_loss:1.6481
 11%|█         | 13/120 [01:46<15:18,  8.58s/it]epoch [13/120], kd_loss:1.7919
 12%|█▏        | 14/120 [01:53<14:24,  8.15s/it]epoch [14/120], kd_loss:1.7487
 12%|█▎        | 15/120 [02:00<13:45,  7.87s/it]epoch [15/120], kd_loss:1.6009
 13%|█▎        | 16/120 [02:08<13:17,  7.67s/it]epoch [16/120], kd_loss:1.5613
 14%|█▍        | 17/120 [02:15<12:57,  7.55s/it]epoch [17/120], kd_loss:1.5331
 15%|█▌        | 18/120 [02:22<12:41,  7.47s/it]epoch [18/120], kd_loss:1.5701
 16%|█▌        | 19/120 [02:30<12:28,  7.41s/it]epoch [19/120], kd_loss:1.8287
 17%|█▋        | 20/120 [02:51<19:10, 11.50s/it]epoch [20/120], kd_loss:1.5822
normal: 0.9579 1.5357  anomaly: 0.9992 2.0157
thresh: 1.1405144426802518
fpr: 0.5769230769230769 fnr 0.018867924528301886
Pixel Auroc:0.988, Sample Auroc0.846, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:58<16:46, 10.16s/it]epoch [21/120], kd_loss:1.6480
 18%|█▊        | 22/120 [03:05<15:09,  9.28s/it]epoch [22/120], kd_loss:1.5705
 19%|█▉        | 23/120 [03:12<13:57,  8.63s/it]epoch [23/120], kd_loss:1.5257
 20%|██        | 24/120 [03:19<13:05,  8.18s/it]epoch [24/120], kd_loss:1.5683
 21%|██        | 25/120 [03:26<12:28,  7.88s/it]epoch [25/120], kd_loss:1.5303
 22%|██▏       | 26/120 [03:33<12:02,  7.69s/it]epoch [26/120], kd_loss:1.6003
 22%|██▎       | 27/120 [03:41<11:42,  7.55s/it]epoch [27/120], kd_loss:1.5339
 23%|██▎       | 28/120 [03:48<11:25,  7.45s/it]epoch [28/120], kd_loss:1.5846
 24%|██▍       | 29/120 [03:55<11:12,  7.38s/it]epoch [29/120], kd_loss:1.9525
 25%|██▌       | 30/120 [04:15<16:45, 11.17s/it]epoch [30/120], kd_loss:2.1896
normal: 1.4057 1.8123  anomaly: 1.4190 2.0440
thresh: 1.4605369026057238
fpr: 0.5769230769230769 fnr 0.03773584905660377
Pixel Auroc:0.969, Sample Auroc0.782, Pixel Aupro0.0
 26%|██▌       | 31/120 [04:22<14:42,  9.92s/it]epoch [31/120], kd_loss:2.5912
 27%|██▋       | 32/120 [04:29<13:17,  9.06s/it]epoch [32/120], kd_loss:1.7736
 28%|██▊       | 33/120 [04:36<12:17,  8.48s/it]epoch [33/120], kd_loss:1.6235
 28%|██▊       | 34/120 [04:44<11:34,  8.08s/it]epoch [34/120], kd_loss:1.7763
 29%|██▉       | 35/120 [04:51<11:06,  7.84s/it]epoch [35/120], kd_loss:1.6275
 30%|███       | 36/120 [04:58<10:42,  7.65s/it]epoch [36/120], kd_loss:1.5560
 31%|███       | 37/120 [05:05<10:26,  7.54s/it]epoch [37/120], kd_loss:1.9254
 32%|███▏      | 38/120 [05:13<10:12,  7.47s/it]epoch [38/120], kd_loss:2.2088
 32%|███▎      | 39/120 [05:20<10:01,  7.42s/it]epoch [39/120], kd_loss:1.6777
 33%|███▎      | 40/120 [05:40<15:09, 11.37s/it]epoch [40/120], kd_loss:1.6429
normal: 0.9554 1.5694  anomaly: 0.9888 1.9730
thresh: 1.086928401914854
fpr: 0.6538461538461539 fnr 0.009433962264150943
Pixel Auroc:0.985, Sample Auroc0.810, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:48<13:15, 10.07s/it]epoch [41/120], kd_loss:1.5501
 35%|███▌      | 42/120 [05:55<11:54,  9.16s/it]epoch [42/120], kd_loss:1.5620
 36%|███▌      | 43/120 [06:02<10:59,  8.56s/it]epoch [43/120], kd_loss:1.5367
 37%|███▋      | 44/120 [06:09<10:18,  8.13s/it]epoch [44/120], kd_loss:1.4739
 38%|███▊      | 45/120 [06:16<09:50,  7.87s/it]epoch [45/120], kd_loss:1.4747
 38%|███▊      | 46/120 [06:23<09:29,  7.70s/it]epoch [46/120], kd_loss:1.6113
 39%|███▉      | 47/120 [06:31<09:12,  7.57s/it]epoch [47/120], kd_loss:1.5484
 40%|████      | 48/120 [06:38<08:58,  7.47s/it]epoch [48/120], kd_loss:1.5216
 41%|████      | 49/120 [06:45<08:46,  7.41s/it]epoch [49/120], kd_loss:1.4688
 42%|████▏     | 50/120 [07:05<12:55, 11.08s/it]epoch [50/120], kd_loss:1.5222
normal: 1.1296 1.5545  anomaly: 1.1567 1.8951
thresh: 1.2299010105696753
fpr: 0.7692307692307693 fnr 0.018867924528301886
Pixel Auroc:0.963, Sample Auroc0.749, Pixel Aupro0.0
 42%|████▎     | 51/120 [07:12<11:21,  9.87s/it]epoch [51/120], kd_loss:1.6410
 43%|████▎     | 52/120 [07:19<10:13,  9.02s/it]epoch [52/120], kd_loss:1.6425
 44%|████▍     | 53/120 [07:26<09:28,  8.49s/it]epoch [53/120], kd_loss:1.4742
 45%|████▌     | 54/120 [07:33<08:55,  8.12s/it]epoch [54/120], kd_loss:1.4840
 46%|████▌     | 55/120 [07:41<08:30,  7.85s/it]epoch [55/120], kd_loss:1.4555
 47%|████▋     | 56/120 [07:48<08:11,  7.69s/it]epoch [56/120], kd_loss:1.5256
 48%|████▊     | 57/120 [07:55<07:58,  7.59s/it]epoch [57/120], kd_loss:1.4483
 48%|████▊     | 58/120 [08:03<07:46,  7.52s/it]epoch [58/120], kd_loss:1.4598
 49%|████▉     | 59/120 [08:10<07:35,  7.48s/it]epoch [59/120], kd_loss:1.4940
 50%|█████     | 60/120 [08:31<11:36, 11.61s/it]epoch [60/120], kd_loss:1.4126
normal: 0.8847 1.4101  anomaly: 0.9502 1.9237
thresh: 1.0449311926439084
fpr: 0.5769230769230769 fnr 0.009433962264150943
Pixel Auroc:0.989, Sample Auroc0.854, Pixel Aupro0.0
 51%|█████     | 61/120 [08:38<10:03, 10.23s/it]epoch [61/120], kd_loss:1.4036
 52%|█████▏    | 62/120 [08:45<08:58,  9.28s/it]epoch [62/120], kd_loss:1.6407
 52%|█████▎    | 63/120 [08:53<08:12,  8.65s/it]epoch [63/120], kd_loss:1.4710
 53%|█████▎    | 64/120 [09:00<07:41,  8.25s/it]epoch [64/120], kd_loss:1.4143
 54%|█████▍    | 65/120 [09:07<07:16,  7.93s/it]epoch [65/120], kd_loss:1.3905
 55%|█████▌    | 66/120 [09:14<06:56,  7.72s/it]epoch [66/120], kd_loss:1.4428
 56%|█████▌    | 67/120 [09:22<06:42,  7.59s/it]epoch [67/120], kd_loss:1.4075
 57%|█████▋    | 68/120 [09:29<06:29,  7.49s/it]epoch [68/120], kd_loss:1.7499
 57%|█████▊    | 69/120 [09:36<06:18,  7.43s/it]epoch [69/120], kd_loss:1.8110
 58%|█████▊    | 70/120 [09:56<09:17, 11.16s/it]epoch [70/120], kd_loss:2.0573
normal: 1.0356 1.4801  anomaly: 1.0882 1.9976
thresh: 1.1347587042571077
fpr: 0.7307692307692307 fnr 0.009433962264150943
Pixel Auroc:0.985, Sample Auroc0.808, Pixel Aupro0.0
 59%|█████▉    | 71/120 [10:03<08:07,  9.94s/it]epoch [71/120], kd_loss:1.7795
 60%|██████    | 72/120 [10:10<07:16,  9.09s/it]epoch [72/120], kd_loss:1.6847
 61%|██████    | 73/120 [10:17<06:40,  8.53s/it]epoch [73/120], kd_loss:1.5927
 62%|██████▏   | 74/120 [10:25<06:14,  8.14s/it]epoch [74/120], kd_loss:1.5477
 62%|██████▎   | 75/120 [10:32<05:54,  7.87s/it]epoch [75/120], kd_loss:1.4900
 63%|██████▎   | 76/120 [10:39<05:38,  7.68s/it]epoch [76/120], kd_loss:1.4570
 64%|██████▍   | 77/120 [10:47<05:26,  7.59s/it]epoch [77/120], kd_loss:1.5289
 65%|██████▌   | 78/120 [10:54<05:14,  7.49s/it]epoch [78/120], kd_loss:1.4564
 66%|██████▌   | 79/120 [11:01<05:04,  7.44s/it]epoch [79/120], kd_loss:1.4551
 67%|██████▋   | 80/120 [11:22<07:33, 11.33s/it]epoch [80/120], kd_loss:1.4177
normal: 0.9015 1.3676  anomaly: 0.9676 2.1431
thresh: 1.0403873924422389
fpr: 0.5769230769230769 fnr 0.009433962264150943
Pixel Auroc:0.989, Sample Auroc0.852, Pixel Aupro0.0
 68%|██████▊   | 81/120 [11:29<06:32, 10.06s/it]epoch [81/120], kd_loss:1.4145
 68%|██████▊   | 82/120 [11:36<05:50,  9.23s/it]epoch [82/120], kd_loss:1.4967
 69%|██████▉   | 83/120 [11:43<05:19,  8.65s/it]epoch [83/120], kd_loss:1.4601
 70%|███████   | 84/120 [11:51<04:57,  8.25s/it]epoch [84/120], kd_loss:1.9592
 71%|███████   | 85/120 [11:58<04:39,  7.97s/it]epoch [85/120], kd_loss:1.6198
 72%|███████▏  | 86/120 [12:05<04:25,  7.80s/it]epoch [86/120], kd_loss:1.5364
 72%|███████▎  | 87/120 [12:13<04:12,  7.66s/it]epoch [87/120], kd_loss:1.6404
 73%|███████▎  | 88/120 [12:20<04:02,  7.57s/it]epoch [88/120], kd_loss:1.5836
 74%|███████▍  | 89/120 [12:27<03:53,  7.53s/it]epoch [89/120], kd_loss:1.4923
 75%|███████▌  | 90/120 [12:48<05:40, 11.37s/it]epoch [90/120], kd_loss:1.4978
normal: 0.9876 1.4465  anomaly: 1.0157 2.0849
thresh: 1.075300384095989
fpr: 0.6538461538461539 fnr 0.009433962264150943
Pixel Auroc:0.981, Sample Auroc0.832, Pixel Aupro0.0
 76%|███████▌  | 91/120 [12:55<04:52, 10.08s/it]epoch [91/120], kd_loss:1.4737
 77%|███████▋  | 92/120 [13:02<04:17,  9.21s/it]epoch [92/120], kd_loss:1.5214
 78%|███████▊  | 93/120 [13:09<03:52,  8.62s/it]epoch [93/120], kd_loss:1.6389
 78%|███████▊  | 94/120 [13:16<03:33,  8.21s/it]epoch [94/120], kd_loss:1.4750
 79%|███████▉  | 95/120 [13:24<03:18,  7.93s/it]epoch [95/120], kd_loss:1.4722
 80%|████████  | 96/120 [13:31<03:06,  7.77s/it]epoch [96/120], kd_loss:1.4437
 81%|████████  | 97/120 [13:39<02:56,  7.66s/it]epoch [97/120], kd_loss:1.4190
 82%|████████▏ | 98/120 [13:46<02:46,  7.57s/it]epoch [98/120], kd_loss:1.4144
 82%|████████▎ | 99/120 [13:53<02:37,  7.51s/it]epoch [99/120], kd_loss:1.4121
 83%|████████▎ | 100/120 [14:14<03:49, 11.50s/it]epoch [100/120], kd_loss:1.4086
normal: 0.8822 1.4195  anomaly: 0.9415 1.8614
thresh: 1.0066200996116643
fpr: 0.6153846153846154 fnr 0.009433962264150943
Pixel Auroc:0.988, Sample Auroc0.834, Pixel Aupro0.0
 84%|████████▍ | 101/120 [14:21<03:13, 10.19s/it]epoch [101/120], kd_loss:1.4081
 85%|████████▌ | 102/120 [14:28<02:47,  9.30s/it]epoch [102/120], kd_loss:1.4066
 86%|████████▌ | 103/120 [14:36<02:27,  8.70s/it]epoch [103/120], kd_loss:1.4204
 87%|████████▋ | 104/120 [14:43<02:12,  8.27s/it]epoch [104/120], kd_loss:1.4070
 88%|████████▊ | 105/120 [14:50<02:00,  8.01s/it]epoch [105/120], kd_loss:1.4063
 88%|████████▊ | 106/120 [14:58<01:49,  7.80s/it]epoch [106/120], kd_loss:1.4030
 89%|████████▉ | 107/120 [15:05<01:39,  7.66s/it]epoch [107/120], kd_loss:1.4008
 90%|█████████ | 108/120 [15:12<01:30,  7.55s/it]epoch [108/120], kd_loss:1.3991
 91%|█████████ | 109/120 [15:20<01:22,  7.47s/it]epoch [109/120], kd_loss:1.3945
 92%|█████████▏| 110/120 [15:39<01:49, 10.99s/it]epoch [110/120], kd_loss:1.3922
normal: 0.8861 1.4079  anomaly: 0.9116 1.8696
thresh: 1.0069248124523047
fpr: 0.6153846153846154 fnr 0.009433962264150943
Pixel Auroc:0.988, Sample Auroc0.822, Pixel Aupro0.0
 92%|█████████▎| 111/120 [15:46<01:28,  9.81s/it]epoch [111/120], kd_loss:1.3919
 93%|█████████▎| 112/120 [15:53<01:11,  9.00s/it]epoch [112/120], kd_loss:1.3909
 94%|█████████▍| 113/120 [16:00<00:59,  8.46s/it]epoch [113/120], kd_loss:1.3906
 95%|█████████▌| 114/120 [16:07<00:48,  8.09s/it]epoch [114/120], kd_loss:1.3903
 96%|█████████▌| 115/120 [16:15<00:39,  7.83s/it]epoch [115/120], kd_loss:1.3895
 97%|█████████▋| 116/120 [16:22<00:30,  7.64s/it]epoch [116/120], kd_loss:1.3891
 98%|█████████▊| 117/120 [16:29<00:22,  7.51s/it]epoch [117/120], kd_loss:1.3883
 98%|█████████▊| 118/120 [16:36<00:14,  7.43s/it]epoch [118/120], kd_loss:1.3871
 99%|█████████▉| 119/120 [16:44<00:07,  7.39s/it]epoch [119/120], kd_loss:1.3868
100%|██████████| 120/120 [17:04<00:00, 11.20s/it]100%|██████████| 120/120 [17:04<00:00,  8.53s/it]
epoch [120/120], kd_loss:1.3880
normal: 0.8776 1.4075  anomaly: 0.9363 1.8528
thresh: 1.0056858357683867
fpr: 0.6153846153846154 fnr 0.009433962264150943
Pixel Auroc:0.988, Sample Auroc0.831, Pixel Aupro0.0
training Advanced Teacher...
potato
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:23<39:05, 23.69s/it]epoch [1/100], focal_loss:0.0722	, anomaly_loss:0.5069	fnorm_loss:0.0674, a_fnorm_loss:0.0145P:0.00, R:0.03
normal: 0.2504 0.2612  anomaly: 0.2499 0.2630	P:0.00, R:0.00
Pixel Auroc:0.941, Sample Auroc0.461, Pixel Aupro0.0
test_fnorm_loss: 0.0665 test_afnorm_loss: 0.0158
  2%|▏         | 2/100 [00:33<24:58, 15.29s/it]epoch [2/100], focal_loss:0.0566	, anomaly_loss:0.5060	fnorm_loss:0.0610, a_fnorm_loss:0.0133P:0.00, R:0.00
  3%|▎         | 3/100 [00:44<21:29, 13.29s/it]epoch [3/100], focal_loss:0.0466	, anomaly_loss:0.5401	fnorm_loss:0.0531, a_fnorm_loss:0.0113P:0.00, R:0.00
  4%|▍         | 4/100 [00:55<19:52, 12.43s/it]epoch [4/100], focal_loss:0.0404	, anomaly_loss:0.5634	fnorm_loss:0.0469, a_fnorm_loss:0.0102P:0.00, R:0.00
  5%|▌         | 5/100 [01:18<26:07, 16.50s/it]epoch [5/100], focal_loss:0.0365	, anomaly_loss:0.5802	fnorm_loss:0.0426, a_fnorm_loss:0.0095P:0.00, R:0.00
normal: 0.1569 0.1634  anomaly: 0.1572 0.1640	P:0.00, R:0.00
Pixel Auroc:0.945, Sample Auroc0.495, Pixel Aupro0.0
test_fnorm_loss: 0.0413 test_afnorm_loss: 0.0099
  6%|▌         | 6/100 [01:29<22:58, 14.66s/it]epoch [6/100], focal_loss:0.0323	, anomaly_loss:0.5909	fnorm_loss:0.0393, a_fnorm_loss:0.0086P:0.00, R:0.00
  7%|▋         | 7/100 [01:40<20:53, 13.48s/it]epoch [7/100], focal_loss:0.0342	, anomaly_loss:0.5845	fnorm_loss:0.0393, a_fnorm_loss:0.0104P:0.01, R:0.04
  8%|▊         | 8/100 [01:51<19:13, 12.53s/it]epoch [8/100], focal_loss:0.0387	, anomaly_loss:0.4573	fnorm_loss:0.0378, a_fnorm_loss:0.0285P:0.08, R:0.36
  9%|▉         | 9/100 [02:01<17:59, 11.87s/it]epoch [9/100], focal_loss:0.0286	, anomaly_loss:0.4257	fnorm_loss:0.0315, a_fnorm_loss:0.0325P:0.11, R:0.43
 10%|█         | 10/100 [02:25<23:18, 15.54s/it]epoch [10/100], focal_loss:0.0263	, anomaly_loss:0.3643	fnorm_loss:0.0289, a_fnorm_loss:0.0364P:0.15, R:0.64
normal: 0.1106 0.2432  anomaly: 0.1114 0.3131	P:0.07, R:0.06
Pixel Auroc:0.988, Sample Auroc0.716, Pixel Aupro0.0
test_fnorm_loss: 0.0273 test_afnorm_loss: 0.0152
 11%|█         | 11/100 [02:37<21:13, 14.31s/it]epoch [11/100], focal_loss:0.0229	, anomaly_loss:0.3615	fnorm_loss:0.0259, a_fnorm_loss:0.0383P:0.19, R:0.63
 12%|█▏        | 12/100 [02:47<19:01, 12.97s/it]epoch [12/100], focal_loss:0.0200	, anomaly_loss:0.2766	fnorm_loss:0.0234, a_fnorm_loss:0.0426P:0.27, R:0.91
 13%|█▎        | 13/100 [02:58<18:02, 12.44s/it]epoch [13/100], focal_loss:0.0178	, anomaly_loss:0.2611	fnorm_loss:0.0215, a_fnorm_loss:0.0417P:0.35, R:0.91
 14%|█▍        | 14/100 [03:08<17:01, 11.87s/it]epoch [14/100], focal_loss:0.0163	, anomaly_loss:0.2409	fnorm_loss:0.0199, a_fnorm_loss:0.0447P:0.37, R:0.95
 15%|█▌        | 15/100 [03:38<24:22, 17.20s/it]epoch [15/100], focal_loss:0.0149	, anomaly_loss:0.2430	fnorm_loss:0.0185, a_fnorm_loss:0.0451P:0.36, R:0.93
normal: 0.1743 0.5529  anomaly: 0.2101 0.5934	P:0.11, R:0.27
Pixel Auroc:0.991, Sample Auroc0.691, Pixel Aupro0.0
test_fnorm_loss: 0.0183 test_afnorm_loss: 0.0364
 16%|█▌        | 16/100 [03:49<21:29, 15.36s/it]epoch [16/100], focal_loss:0.0132	, anomaly_loss:0.2267	fnorm_loss:0.0174, a_fnorm_loss:0.0461P:0.36, R:0.96
 17%|█▋        | 17/100 [04:00<19:20, 13.98s/it]epoch [17/100], focal_loss:0.0117	, anomaly_loss:0.2161	fnorm_loss:0.0163, a_fnorm_loss:0.0470P:0.39, R:0.97
 18%|█▊        | 18/100 [04:09<17:17, 12.65s/it]epoch [18/100], focal_loss:0.0116	, anomaly_loss:0.2089	fnorm_loss:0.0155, a_fnorm_loss:0.0475P:0.33, R:0.96
 19%|█▉        | 19/100 [04:20<16:16, 12.06s/it]epoch [19/100], focal_loss:0.0110	, anomaly_loss:0.2250	fnorm_loss:0.0148, a_fnorm_loss:0.0469P:0.37, R:0.96
 20%|██        | 20/100 [04:47<22:02, 16.53s/it]epoch [20/100], focal_loss:0.0105	, anomaly_loss:0.2195	fnorm_loss:0.0142, a_fnorm_loss:0.0492P:0.34, R:0.97
normal: 0.0563 0.2813  anomaly: 0.0538 0.4457	P:0.12, R:0.12
Pixel Auroc:0.988, Sample Auroc0.697, Pixel Aupro0.0
test_fnorm_loss: 0.0135 test_afnorm_loss: 0.0137
 21%|██        | 21/100 [04:58<19:32, 14.85s/it]epoch [21/100], focal_loss:0.0101	, anomaly_loss:0.2127	fnorm_loss:0.0136, a_fnorm_loss:0.0486P:0.35, R:0.96
 22%|██▏       | 22/100 [05:09<17:53, 13.77s/it]epoch [22/100], focal_loss:0.0106	, anomaly_loss:0.2164	fnorm_loss:0.0131, a_fnorm_loss:0.0481P:0.37, R:0.94
 23%|██▎       | 23/100 [05:21<16:45, 13.06s/it]epoch [23/100], focal_loss:0.0100	, anomaly_loss:0.2154	fnorm_loss:0.0127, a_fnorm_loss:0.0482P:0.35, R:0.95
 24%|██▍       | 24/100 [05:32<15:46, 12.45s/it]epoch [24/100], focal_loss:0.0098	, anomaly_loss:0.2138	fnorm_loss:0.0122, a_fnorm_loss:0.0483P:0.44, R:0.95
 25%|██▌       | 25/100 [05:56<20:10, 16.14s/it]epoch [25/100], focal_loss:0.0097	, anomaly_loss:0.2207	fnorm_loss:0.0119, a_fnorm_loss:0.0480P:0.44, R:0.96
normal: 0.0504 0.3042  anomaly: 0.0487 0.4689	P:0.11, R:0.13
Pixel Auroc:0.989, Sample Auroc0.698, Pixel Aupro0.0
test_fnorm_loss: 0.0114 test_afnorm_loss: 0.0239
 26%|██▌       | 26/100 [06:07<17:43, 14.37s/it]epoch [26/100], focal_loss:0.0086	, anomaly_loss:0.1979	fnorm_loss:0.0115, a_fnorm_loss:0.0497P:0.36, R:0.96
 27%|██▋       | 27/100 [06:18<16:19, 13.42s/it]epoch [27/100], focal_loss:0.0097	, anomaly_loss:0.2093	fnorm_loss:0.0113, a_fnorm_loss:0.0484P:0.40, R:0.95
 28%|██▊       | 28/100 [06:30<15:30, 12.92s/it]epoch [28/100], focal_loss:0.0087	, anomaly_loss:0.2109	fnorm_loss:0.0110, a_fnorm_loss:0.0489P:0.43, R:0.96
 29%|██▉       | 29/100 [06:41<14:41, 12.41s/it]epoch [29/100], focal_loss:0.0089	, anomaly_loss:0.2169	fnorm_loss:0.0107, a_fnorm_loss:0.0500P:0.42, R:0.97
 30%|███       | 30/100 [07:11<20:51, 17.87s/it]epoch [30/100], focal_loss:0.0083	, anomaly_loss:0.2062	fnorm_loss:0.0103, a_fnorm_loss:0.0494P:0.49, R:0.96
normal: 0.0691 0.4576  anomaly: 0.0496 0.6005	P:0.15, R:0.19
Pixel Auroc:0.989, Sample Auroc0.672, Pixel Aupro0.0
test_fnorm_loss: 0.0101 test_afnorm_loss: 0.0295
 31%|███       | 31/100 [07:22<17:59, 15.65s/it]epoch [31/100], focal_loss:0.0091	, anomaly_loss:0.2092	fnorm_loss:0.0104, a_fnorm_loss:0.0490P:0.40, R:0.94
 32%|███▏      | 32/100 [07:32<15:56, 14.07s/it]epoch [32/100], focal_loss:0.0079	, anomaly_loss:0.2136	fnorm_loss:0.0101, a_fnorm_loss:0.0475P:0.40, R:0.97
 33%|███▎      | 33/100 [07:43<14:30, 12.99s/it]epoch [33/100], focal_loss:0.0113	, anomaly_loss:0.2281	fnorm_loss:0.0102, a_fnorm_loss:0.0474P:0.42, R:0.92
 34%|███▍      | 34/100 [07:53<13:34, 12.34s/it]epoch [34/100], focal_loss:0.0075	, anomaly_loss:0.1961	fnorm_loss:0.0095, a_fnorm_loss:0.0527P:0.43, R:0.97
 35%|███▌      | 35/100 [08:15<16:25, 15.17s/it]epoch [35/100], focal_loss:0.0067	, anomaly_loss:0.2061	fnorm_loss:0.0092, a_fnorm_loss:0.0513P:0.43, R:0.98
normal: 0.0462 0.3887  anomaly: 0.0393 0.5204	P:0.12, R:0.14
Pixel Auroc:0.988, Sample Auroc0.668, Pixel Aupro0.0
test_fnorm_loss: 0.0090 test_afnorm_loss: 0.0244
 36%|███▌      | 36/100 [08:25<14:27, 13.55s/it]epoch [36/100], focal_loss:0.0063	, anomaly_loss:0.1902	fnorm_loss:0.0091, a_fnorm_loss:0.0523P:0.45, R:0.98
 37%|███▋      | 37/100 [08:36<13:18, 12.67s/it]epoch [37/100], focal_loss:0.0079	, anomaly_loss:0.2049	fnorm_loss:0.0092, a_fnorm_loss:0.0507P:0.37, R:0.95
 38%|███▊      | 38/100 [08:46<12:23, 12.00s/it]epoch [38/100], focal_loss:0.0084	, anomaly_loss:0.2076	fnorm_loss:0.0091, a_fnorm_loss:0.0518P:0.39, R:0.94
 39%|███▉      | 39/100 [08:56<11:31, 11.34s/it]epoch [39/100], focal_loss:0.0074	, anomaly_loss:0.2020	fnorm_loss:0.0088, a_fnorm_loss:0.0514P:0.45, R:0.96
 40%|████      | 40/100 [09:20<15:08, 15.14s/it]epoch [40/100], focal_loss:0.0070	, anomaly_loss:0.1958	fnorm_loss:0.0086, a_fnorm_loss:0.0517P:0.48, R:0.96
normal: 0.0675 0.3814  anomaly: 0.0417 0.5505	P:0.13, R:0.14
Pixel Auroc:0.989, Sample Auroc0.634, Pixel Aupro0.0
test_fnorm_loss: 0.0083 test_afnorm_loss: 0.0225
 41%|████      | 41/100 [09:30<13:19, 13.55s/it]epoch [41/100], focal_loss:0.0069	, anomaly_loss:0.1939	fnorm_loss:0.0084, a_fnorm_loss:0.0515P:0.44, R:0.97
 42%|████▏     | 42/100 [09:40<12:12, 12.64s/it]epoch [42/100], focal_loss:0.0065	, anomaly_loss:0.1901	fnorm_loss:0.0083, a_fnorm_loss:0.0518P:0.45, R:0.96
 43%|████▎     | 43/100 [09:51<11:25, 12.02s/it]epoch [43/100], focal_loss:0.0065	, anomaly_loss:0.1966	fnorm_loss:0.0082, a_fnorm_loss:0.0531P:0.49, R:0.98
 44%|████▍     | 44/100 [10:02<10:52, 11.64s/it]epoch [44/100], focal_loss:0.0058	, anomaly_loss:0.1866	fnorm_loss:0.0081, a_fnorm_loss:0.0524P:0.44, R:0.98
 45%|████▌     | 45/100 [10:26<14:15, 15.55s/it]epoch [45/100], focal_loss:0.0064	, anomaly_loss:0.1992	fnorm_loss:0.0080, a_fnorm_loss:0.0518P:0.46, R:0.96
normal: 0.0529 0.4450  anomaly: 0.0358 0.6084	P:0.14, R:0.15
Pixel Auroc:0.989, Sample Auroc0.654, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0221
 46%|████▌     | 46/100 [10:37<12:39, 14.06s/it]epoch [46/100], focal_loss:0.0064	, anomaly_loss:0.1853	fnorm_loss:0.0079, a_fnorm_loss:0.0523P:0.43, R:0.96
 47%|████▋     | 47/100 [10:47<11:19, 12.82s/it]epoch [47/100], focal_loss:0.0058	, anomaly_loss:0.1869	fnorm_loss:0.0078, a_fnorm_loss:0.0523P:0.50, R:0.97
 48%|████▊     | 48/100 [10:57<10:22, 11.96s/it]epoch [48/100], focal_loss:0.0070	, anomaly_loss:0.2051	fnorm_loss:0.0078, a_fnorm_loss:0.0503P:0.45, R:0.93
 49%|████▉     | 49/100 [11:07<09:49, 11.56s/it]epoch [49/100], focal_loss:0.0083	, anomaly_loss:0.1958	fnorm_loss:0.0078, a_fnorm_loss:0.0512P:0.42, R:0.95
 50%|█████     | 50/100 [11:31<12:43, 15.27s/it]epoch [50/100], focal_loss:0.0064	, anomaly_loss:0.1794	fnorm_loss:0.0076, a_fnorm_loss:0.0534P:0.44, R:0.98
normal: 0.0318 0.2332  anomaly: 0.0296 0.4645	P:0.07, R:0.06
Pixel Auroc:0.988, Sample Auroc0.662, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0126
 51%|█████     | 51/100 [11:42<11:15, 13.79s/it]epoch [51/100], focal_loss:0.0058	, anomaly_loss:0.1919	fnorm_loss:0.0074, a_fnorm_loss:0.0541P:0.46, R:0.98
 52%|█████▏    | 52/100 [11:52<10:09, 12.70s/it]epoch [52/100], focal_loss:0.0061	, anomaly_loss:0.1843	fnorm_loss:0.0073, a_fnorm_loss:0.0518P:0.45, R:0.97
 53%|█████▎    | 53/100 [12:03<09:38, 12.32s/it]epoch [53/100], focal_loss:0.0060	, anomaly_loss:0.1796	fnorm_loss:0.0073, a_fnorm_loss:0.0521P:0.41, R:0.97
 54%|█████▍    | 54/100 [12:13<08:55, 11.64s/it]epoch [54/100], focal_loss:0.0078	, anomaly_loss:0.2183	fnorm_loss:0.0077, a_fnorm_loss:0.0475P:0.45, R:0.94
 55%|█████▌    | 55/100 [12:37<11:21, 15.15s/it]epoch [55/100], focal_loss:0.0061	, anomaly_loss:0.2029	fnorm_loss:0.0072, a_fnorm_loss:0.0531P:0.48, R:0.97
normal: 0.1711 0.5974  anomaly: 0.0800 0.6661	P:0.13, R:0.25
Pixel Auroc:0.989, Sample Auroc0.595, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0335
 56%|█████▌    | 56/100 [12:47<10:07, 13.80s/it]epoch [56/100], focal_loss:0.0066	, anomaly_loss:0.1894	fnorm_loss:0.0072, a_fnorm_loss:0.0525P:0.47, R:0.96
 57%|█████▋    | 57/100 [12:57<09:05, 12.68s/it]epoch [57/100], focal_loss:0.0070	, anomaly_loss:0.1983	fnorm_loss:0.0072, a_fnorm_loss:0.0533P:0.45, R:0.96
 58%|█████▊    | 58/100 [13:07<08:19, 11.89s/it]epoch [58/100], focal_loss:0.0056	, anomaly_loss:0.1849	fnorm_loss:0.0070, a_fnorm_loss:0.0525P:0.48, R:0.98
 59%|█████▉    | 59/100 [13:17<07:35, 11.10s/it]epoch [59/100], focal_loss:0.0054	, anomaly_loss:0.1905	fnorm_loss:0.0069, a_fnorm_loss:0.0545P:0.48, R:0.98
 60%|██████    | 60/100 [13:40<09:50, 14.75s/it]epoch [60/100], focal_loss:0.0061	, anomaly_loss:0.1785	fnorm_loss:0.0069, a_fnorm_loss:0.0541P:0.45, R:0.97
normal: 0.0320 0.3769  anomaly: 0.0267 0.5333	P:0.12, R:0.12
Pixel Auroc:0.987, Sample Auroc0.670, Pixel Aupro0.0
test_fnorm_loss: 0.0066 test_afnorm_loss: 0.0192
 61%|██████    | 61/100 [13:50<08:41, 13.38s/it]epoch [61/100], focal_loss:0.0068	, anomaly_loss:0.2042	fnorm_loss:0.0070, a_fnorm_loss:0.0518P:0.47, R:0.95
 62%|██████▏   | 62/100 [14:00<07:49, 12.34s/it]epoch [62/100], focal_loss:0.0057	, anomaly_loss:0.1845	fnorm_loss:0.0068, a_fnorm_loss:0.0540P:0.44, R:0.98
 63%|██████▎   | 63/100 [14:11<07:27, 12.09s/it]epoch [63/100], focal_loss:0.0073	, anomaly_loss:0.2034	fnorm_loss:0.0069, a_fnorm_loss:0.0518P:0.48, R:0.95
 64%|██████▍   | 64/100 [14:21<06:52, 11.45s/it]epoch [64/100], focal_loss:0.0058	, anomaly_loss:0.1876	fnorm_loss:0.0069, a_fnorm_loss:0.0530P:0.47, R:0.98
 65%|██████▌   | 65/100 [14:44<08:37, 14.78s/it]epoch [65/100], focal_loss:0.0071	, anomaly_loss:0.1910	fnorm_loss:0.0067, a_fnorm_loss:0.0525P:0.44, R:0.95
normal: 0.1609 0.4666  anomaly: 0.0962 0.5540	P:0.10, R:0.18
Pixel Auroc:0.988, Sample Auroc0.619, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0372
 66%|██████▌   | 66/100 [14:54<07:30, 13.25s/it]epoch [66/100], focal_loss:0.0055	, anomaly_loss:0.1880	fnorm_loss:0.0067, a_fnorm_loss:0.0543P:0.49, R:0.97
 67%|██████▋   | 67/100 [15:04<06:44, 12.25s/it]epoch [67/100], focal_loss:0.0055	, anomaly_loss:0.1920	fnorm_loss:0.0066, a_fnorm_loss:0.0537P:0.52, R:0.97
 68%|██████▊   | 68/100 [15:15<06:20, 11.90s/it]epoch [68/100], focal_loss:0.0058	, anomaly_loss:0.1746	fnorm_loss:0.0066, a_fnorm_loss:0.0539P:0.49, R:0.98
 69%|██████▉   | 69/100 [15:25<05:58, 11.57s/it]epoch [69/100], focal_loss:0.0051	, anomaly_loss:0.1840	fnorm_loss:0.0064, a_fnorm_loss:0.0545P:0.56, R:0.98
 70%|███████   | 70/100 [15:48<07:29, 14.99s/it]epoch [70/100], focal_loss:0.0057	, anomaly_loss:0.1944	fnorm_loss:0.0065, a_fnorm_loss:0.0540P:0.50, R:0.97
normal: 0.0421 0.3176  anomaly: 0.0284 0.4866	P:0.10, R:0.08
Pixel Auroc:0.987, Sample Auroc0.644, Pixel Aupro0.0
test_fnorm_loss: 0.0062 test_afnorm_loss: 0.0125
 71%|███████   | 71/100 [15:59<06:37, 13.69s/it]epoch [71/100], focal_loss:0.0052	, anomaly_loss:0.1866	fnorm_loss:0.0065, a_fnorm_loss:0.0525P:0.48, R:0.96
 72%|███████▏  | 72/100 [16:10<06:02, 12.96s/it]epoch [72/100], focal_loss:0.0060	, anomaly_loss:0.1822	fnorm_loss:0.0065, a_fnorm_loss:0.0526P:0.45, R:0.97
 73%|███████▎  | 73/100 [16:21<05:31, 12.26s/it]epoch [73/100], focal_loss:0.0052	, anomaly_loss:0.1863	fnorm_loss:0.0064, a_fnorm_loss:0.0542P:0.48, R:0.97
 74%|███████▍  | 74/100 [16:31<05:02, 11.65s/it]epoch [74/100], focal_loss:0.0065	, anomaly_loss:0.1852	fnorm_loss:0.0065, a_fnorm_loss:0.0525P:0.46, R:0.96
 75%|███████▌  | 75/100 [16:54<06:17, 15.10s/it]epoch [75/100], focal_loss:0.0050	, anomaly_loss:0.1797	fnorm_loss:0.0064, a_fnorm_loss:0.0542P:0.46, R:0.97
normal: 0.0399 0.4495  anomaly: 0.0268 0.5897	P:0.14, R:0.14
Pixel Auroc:0.988, Sample Auroc0.658, Pixel Aupro0.0
test_fnorm_loss: 0.0061 test_afnorm_loss: 0.0222
 76%|███████▌  | 76/100 [17:06<05:38, 14.12s/it]epoch [76/100], focal_loss:0.0056	, anomaly_loss:0.1948	fnorm_loss:0.0064, a_fnorm_loss:0.0534P:0.47, R:0.98
 77%|███████▋  | 77/100 [17:17<05:02, 13.13s/it]epoch [77/100], focal_loss:0.0053	, anomaly_loss:0.1983	fnorm_loss:0.0063, a_fnorm_loss:0.0543P:0.53, R:0.97
 78%|███████▊  | 78/100 [17:27<04:30, 12.31s/it]epoch [78/100], focal_loss:0.0043	, anomaly_loss:0.1714	fnorm_loss:0.0062, a_fnorm_loss:0.0552P:0.56, R:0.98
 79%|███████▉  | 79/100 [17:38<04:09, 11.86s/it]epoch [79/100], focal_loss:0.0053	, anomaly_loss:0.1955	fnorm_loss:0.0063, a_fnorm_loss:0.0542P:0.50, R:0.96
 80%|████████  | 80/100 [18:01<05:03, 15.15s/it]epoch [80/100], focal_loss:0.0057	, anomaly_loss:0.1836	fnorm_loss:0.0062, a_fnorm_loss:0.0531P:0.46, R:0.97
normal: 0.0460 0.4367  anomaly: 0.0280 0.5745	P:0.14, R:0.14
Pixel Auroc:0.988, Sample Auroc0.652, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0246
 81%|████████  | 81/100 [18:11<04:15, 13.46s/it]epoch [81/100], focal_loss:0.0051	, anomaly_loss:0.1762	fnorm_loss:0.0062, a_fnorm_loss:0.0555P:0.48, R:0.97
 82%|████████▏ | 82/100 [18:22<03:49, 12.73s/it]epoch [82/100], focal_loss:0.0051	, anomaly_loss:0.1743	fnorm_loss:0.0062, a_fnorm_loss:0.0540P:0.52, R:0.98
 83%|████████▎ | 83/100 [18:32<03:25, 12.11s/it]epoch [83/100], focal_loss:0.0052	, anomaly_loss:0.1880	fnorm_loss:0.0062, a_fnorm_loss:0.0530P:0.45, R:0.97
 84%|████████▍ | 84/100 [18:43<03:07, 11.73s/it]epoch [84/100], focal_loss:0.0051	, anomaly_loss:0.1781	fnorm_loss:0.0062, a_fnorm_loss:0.0546P:0.50, R:0.97
 85%|████████▌ | 85/100 [19:12<04:15, 17.01s/it]epoch [85/100], focal_loss:0.0050	, anomaly_loss:0.1816	fnorm_loss:0.0062, a_fnorm_loss:0.0535P:0.49, R:0.98
normal: 0.0537 0.4888  anomaly: 0.0313 0.5850	P:0.16, R:0.17
Pixel Auroc:0.989, Sample Auroc0.640, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0256
 86%|████████▌ | 86/100 [19:23<03:29, 14.97s/it]epoch [86/100], focal_loss:0.0044	, anomaly_loss:0.1840	fnorm_loss:0.0061, a_fnorm_loss:0.0545P:0.56, R:0.98
 87%|████████▋ | 87/100 [19:33<02:57, 13.68s/it]epoch [87/100], focal_loss:0.0051	, anomaly_loss:0.1854	fnorm_loss:0.0061, a_fnorm_loss:0.0546P:0.50, R:0.97
 88%|████████▊ | 88/100 [19:44<02:31, 12.66s/it]epoch [88/100], focal_loss:0.0049	, anomaly_loss:0.1757	fnorm_loss:0.0061, a_fnorm_loss:0.0529P:0.49, R:0.97
 89%|████████▉ | 89/100 [19:53<02:08, 11.64s/it]epoch [89/100], focal_loss:0.0059	, anomaly_loss:0.1874	fnorm_loss:0.0062, a_fnorm_loss:0.0535P:0.49, R:0.96
 90%|█████████ | 90/100 [20:16<02:30, 15.04s/it]epoch [90/100], focal_loss:0.0055	, anomaly_loss:0.1992	fnorm_loss:0.0062, a_fnorm_loss:0.0547P:0.51, R:0.96
normal: 0.0667 0.4567  anomaly: 0.0341 0.5721	P:0.15, R:0.15
Pixel Auroc:0.988, Sample Auroc0.615, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0228
 91%|█████████ | 91/100 [20:26<02:03, 13.70s/it]epoch [91/100], focal_loss:0.0047	, anomaly_loss:0.1744	fnorm_loss:0.0061, a_fnorm_loss:0.0545P:0.49, R:0.98
 92%|█████████▏| 92/100 [20:37<01:42, 12.78s/it]epoch [92/100], focal_loss:0.0046	, anomaly_loss:0.1887	fnorm_loss:0.0061, a_fnorm_loss:0.0537P:0.51, R:0.98
 93%|█████████▎| 93/100 [20:47<01:24, 12.03s/it]epoch [93/100], focal_loss:0.0050	, anomaly_loss:0.1701	fnorm_loss:0.0062, a_fnorm_loss:0.0539P:0.46, R:0.97
 94%|█████████▍| 94/100 [20:57<01:07, 11.31s/it]epoch [94/100], focal_loss:0.0046	, anomaly_loss:0.1674	fnorm_loss:0.0061, a_fnorm_loss:0.0551P:0.48, R:0.98
 95%|█████████▌| 95/100 [21:20<01:14, 14.82s/it]epoch [95/100], focal_loss:0.0047	, anomaly_loss:0.1801	fnorm_loss:0.0061, a_fnorm_loss:0.0553P:0.49, R:0.98
normal: 0.0580 0.4658  anomaly: 0.0293 0.5790	P:0.15, R:0.15
Pixel Auroc:0.988, Sample Auroc0.624, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0231
 96%|█████████▌| 96/100 [21:30<00:53, 13.40s/it]epoch [96/100], focal_loss:0.0046	, anomaly_loss:0.1758	fnorm_loss:0.0061, a_fnorm_loss:0.0542P:0.44, R:0.99
 97%|█████████▋| 97/100 [21:40<00:37, 12.34s/it]epoch [97/100], focal_loss:0.0050	, anomaly_loss:0.1913	fnorm_loss:0.0061, a_fnorm_loss:0.0534P:0.55, R:0.96
 98%|█████████▊| 98/100 [21:50<00:23, 11.80s/it]epoch [98/100], focal_loss:0.0044	, anomaly_loss:0.1711	fnorm_loss:0.0061, a_fnorm_loss:0.0551P:0.45, R:0.98
 99%|█████████▉| 99/100 [22:01<00:11, 11.42s/it]epoch [99/100], focal_loss:0.0046	, anomaly_loss:0.1893	fnorm_loss:0.0061, a_fnorm_loss:0.0542P:0.53, R:0.98
100%|██████████| 100/100 [22:23<00:00, 14.60s/it]100%|██████████| 100/100 [22:23<00:00, 13.43s/it]
epoch [100/100], focal_loss:0.0054	, anomaly_loss:0.1924	fnorm_loss:0.0061, a_fnorm_loss:0.0540P:0.51, R:0.97
normal: 0.0563 0.4733  anomaly: 0.0285 0.5856	P:0.15, R:0.16
Pixel Auroc:0.988, Sample Auroc0.628, Pixel Aupro0.0
test_fnorm_loss: 0.0060 test_afnorm_loss: 0.0240
training Stubborn Student...
potato
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<12:03,  6.08s/it]epoch [1/120], kd_loss:4.2864
  2%|▏         | 2/120 [00:12<12:00,  6.11s/it]epoch [2/120], kd_loss:3.5381
  2%|▎         | 3/120 [00:18<11:53,  6.10s/it]epoch [3/120], kd_loss:3.5223
  3%|▎         | 4/120 [00:24<11:47,  6.10s/it]epoch [4/120], kd_loss:3.4936
  4%|▍         | 5/120 [00:30<11:44,  6.12s/it]epoch [5/120], kd_loss:3.4888
  5%|▌         | 6/120 [00:36<11:44,  6.18s/it]epoch [6/120], kd_loss:3.4881
  6%|▌         | 7/120 [00:43<11:41,  6.21s/it]epoch [7/120], kd_loss:3.4818
  7%|▋         | 8/120 [00:49<11:36,  6.22s/it]epoch [8/120], kd_loss:3.0488
  8%|▊         | 9/120 [00:55<11:29,  6.22s/it]epoch [9/120], kd_loss:2.5262
  8%|▊         | 10/120 [01:13<18:17,  9.98s/it]epoch [10/120], kd_loss:2.2401
normal: 1.3457 2.0056  anomaly: 1.3519 2.2001
thresh: 1.3518634039099218
fpr: 0.9545454545454546 fnr 0.0
Pixel Auroc:0.979, Sample Auroc0.717, Pixel Aupro0.0
  9%|▉         | 11/120 [01:20<15:58,  8.79s/it]epoch [11/120], kd_loss:1.9678
 10%|█         | 12/120 [01:26<14:23,  8.00s/it]epoch [12/120], kd_loss:1.6410
 11%|█         | 13/120 [01:32<13:19,  7.47s/it]epoch [13/120], kd_loss:1.5252
 12%|█▏        | 14/120 [01:38<12:31,  7.09s/it]epoch [14/120], kd_loss:1.4504
 12%|█▎        | 15/120 [01:44<11:58,  6.84s/it]epoch [15/120], kd_loss:1.8593
 13%|█▎        | 16/120 [01:51<11:32,  6.66s/it]epoch [16/120], kd_loss:1.4763
 14%|█▍        | 17/120 [01:57<11:15,  6.56s/it]epoch [17/120], kd_loss:1.4179
 15%|█▌        | 18/120 [02:03<11:01,  6.48s/it]epoch [18/120], kd_loss:1.3603
 16%|█▌        | 19/120 [02:10<10:46,  6.40s/it]epoch [19/120], kd_loss:1.3275
 17%|█▋        | 20/120 [02:29<17:06, 10.27s/it]epoch [20/120], kd_loss:1.3428
normal: 0.8146 1.5685  anomaly: 0.8563 2.0783
thresh: 0.9379226559869731
fpr: 0.7727272727272727 fnr 0.010869565217391304
Pixel Auroc:0.983, Sample Auroc0.725, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:35<14:54,  9.04s/it]epoch [21/120], kd_loss:1.4171
 18%|█▊        | 22/120 [02:41<13:20,  8.17s/it]epoch [22/120], kd_loss:1.3009
 19%|█▉        | 23/120 [02:47<12:17,  7.60s/it]epoch [23/120], kd_loss:1.5716
 20%|██        | 24/120 [02:54<11:35,  7.24s/it]epoch [24/120], kd_loss:1.4772
 21%|██        | 25/120 [03:00<10:59,  6.95s/it]epoch [25/120], kd_loss:1.2896
 22%|██▏       | 26/120 [03:06<10:31,  6.72s/it]epoch [26/120], kd_loss:1.2973
 22%|██▎       | 27/120 [03:13<10:12,  6.58s/it]epoch [27/120], kd_loss:1.2481
 23%|██▎       | 28/120 [03:19<09:59,  6.51s/it]epoch [28/120], kd_loss:1.6595
 24%|██▍       | 29/120 [03:25<09:45,  6.44s/it]epoch [29/120], kd_loss:1.4605
 25%|██▌       | 30/120 [03:43<14:47,  9.87s/it]epoch [30/120], kd_loss:1.4703
normal: 0.9135 1.7094  anomaly: 0.9258 1.9724
thresh: 0.9532927037851456
fpr: 0.8181818181818182 fnr 0.010869565217391304
Pixel Auroc:0.984, Sample Auroc0.717, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:49<12:58,  8.74s/it]epoch [31/120], kd_loss:1.3544
 27%|██▋       | 32/120 [03:55<11:41,  7.97s/it]epoch [32/120], kd_loss:1.2754
 28%|██▊       | 33/120 [04:02<10:47,  7.44s/it]epoch [33/120], kd_loss:1.2593
 28%|██▊       | 34/120 [04:08<10:07,  7.07s/it]epoch [34/120], kd_loss:1.2839
 29%|██▉       | 35/120 [04:14<09:39,  6.81s/it]epoch [35/120], kd_loss:1.2478
 30%|███       | 36/120 [04:20<09:18,  6.65s/it]epoch [36/120], kd_loss:1.2239
 31%|███       | 37/120 [04:26<09:02,  6.54s/it]epoch [37/120], kd_loss:1.2370
 32%|███▏      | 38/120 [04:33<08:49,  6.46s/it]epoch [38/120], kd_loss:1.2105
 32%|███▎      | 39/120 [04:39<08:40,  6.43s/it]epoch [39/120], kd_loss:1.2044
 33%|███▎      | 40/120 [04:57<13:16,  9.96s/it]epoch [40/120], kd_loss:1.1990
normal: 0.7418 1.3179  anomaly: 0.7968 1.6349
thresh: 0.796780637909778
fpr: 0.9090909090909091 fnr 0.0
Pixel Auroc:0.982, Sample Auroc0.657, Pixel Aupro0.0
 34%|███▍      | 41/120 [05:03<11:37,  8.83s/it]epoch [41/120], kd_loss:1.1940
 35%|███▌      | 42/120 [05:10<10:24,  8.00s/it]epoch [42/120], kd_loss:1.1835
 36%|███▌      | 43/120 [05:16<09:32,  7.43s/it]epoch [43/120], kd_loss:1.2033
 37%|███▋      | 44/120 [05:22<09:00,  7.11s/it]epoch [44/120], kd_loss:1.1741
 38%|███▊      | 45/120 [05:28<08:33,  6.85s/it]epoch [45/120], kd_loss:1.1732
 38%|███▊      | 46/120 [05:35<08:15,  6.69s/it]epoch [46/120], kd_loss:1.1706
 39%|███▉      | 47/120 [05:41<07:59,  6.57s/it]epoch [47/120], kd_loss:1.3064
 40%|████      | 48/120 [05:47<07:45,  6.47s/it]epoch [48/120], kd_loss:1.1681
 41%|████      | 49/120 [05:53<07:35,  6.42s/it]epoch [49/120], kd_loss:1.1606
 42%|████▏     | 50/120 [06:13<11:59, 10.28s/it]epoch [50/120], kd_loss:1.1544
normal: 0.7158 1.3254  anomaly: 0.7663 1.5677
thresh: 0.7662695954945541
fpr: 0.9090909090909091 fnr 0.0
Pixel Auroc:0.983, Sample Auroc0.656, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:19<10:23,  9.03s/it]epoch [51/120], kd_loss:1.1521
 43%|████▎     | 52/120 [06:25<09:13,  8.14s/it]epoch [52/120], kd_loss:1.1521
 44%|████▍     | 53/120 [06:31<08:27,  7.57s/it]epoch [53/120], kd_loss:1.2074
 45%|████▌     | 54/120 [06:37<07:55,  7.20s/it]epoch [54/120], kd_loss:1.1271
 46%|████▌     | 55/120 [06:44<07:28,  6.91s/it]epoch [55/120], kd_loss:1.3821
 47%|████▋     | 56/120 [06:50<07:09,  6.71s/it]epoch [56/120], kd_loss:1.5992
 48%|████▊     | 57/120 [06:56<06:58,  6.64s/it]epoch [57/120], kd_loss:1.3125
 48%|████▊     | 58/120 [07:03<06:46,  6.56s/it]epoch [58/120], kd_loss:1.1927
 49%|████▉     | 59/120 [07:09<06:36,  6.49s/it]epoch [59/120], kd_loss:1.1617
 50%|█████     | 60/120 [07:28<10:09, 10.16s/it]epoch [60/120], kd_loss:1.2620
normal: 0.7093 1.4986  anomaly: 0.7939 1.9075
thresh: 0.8667750978069892
fpr: 0.7727272727272727 fnr 0.010869565217391304
Pixel Auroc:0.985, Sample Auroc0.696, Pixel Aupro0.0
 51%|█████     | 61/120 [07:34<08:50,  8.99s/it]epoch [61/120], kd_loss:1.1410
 52%|█████▏    | 62/120 [07:40<07:53,  8.17s/it]epoch [62/120], kd_loss:1.1367
 52%|█████▎    | 63/120 [07:47<07:12,  7.59s/it]epoch [63/120], kd_loss:1.1401
 53%|█████▎    | 64/120 [07:53<06:44,  7.23s/it]epoch [64/120], kd_loss:1.0984
 54%|█████▍    | 65/120 [07:59<06:24,  6.98s/it]epoch [65/120], kd_loss:1.0903
 55%|█████▌    | 66/120 [08:06<06:05,  6.78s/it]epoch [66/120], kd_loss:1.2568
 56%|█████▌    | 67/120 [08:12<05:51,  6.64s/it]epoch [67/120], kd_loss:1.1564
 57%|█████▋    | 68/120 [08:18<05:42,  6.58s/it]epoch [68/120], kd_loss:1.0922
 57%|█████▊    | 69/120 [08:25<05:32,  6.51s/it]epoch [69/120], kd_loss:1.0796
 58%|█████▊    | 70/120 [08:44<08:36, 10.33s/it]epoch [70/120], kd_loss:1.0715
normal: 0.6490 1.3572  anomaly: 0.7314 1.5831
thresh: 0.7626291947727833
fpr: 0.8181818181818182 fnr 0.010869565217391304
Pixel Auroc:0.985, Sample Auroc0.661, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:50<07:25,  9.10s/it]epoch [71/120], kd_loss:1.0658
 60%|██████    | 72/120 [08:56<06:34,  8.22s/it]epoch [72/120], kd_loss:1.0568
 61%|██████    | 73/120 [09:03<05:57,  7.61s/it]epoch [73/120], kd_loss:1.0683
 62%|██████▏   | 74/120 [09:09<05:30,  7.19s/it]epoch [74/120], kd_loss:1.0682
 62%|██████▎   | 75/120 [09:15<05:11,  6.92s/it]epoch [75/120], kd_loss:1.0455
 63%|██████▎   | 76/120 [09:21<04:55,  6.71s/it]epoch [76/120], kd_loss:1.0694
 64%|██████▍   | 77/120 [09:28<04:43,  6.60s/it]epoch [77/120], kd_loss:1.0913
 65%|██████▌   | 78/120 [09:34<04:33,  6.50s/it]epoch [78/120], kd_loss:1.6314
 66%|██████▌   | 79/120 [09:40<04:24,  6.45s/it]epoch [79/120], kd_loss:1.5509
 67%|██████▋   | 80/120 [09:58<06:36,  9.90s/it]epoch [80/120], kd_loss:1.4614
normal: 0.7755 1.4167  anomaly: 0.8614 1.9190
thresh: 0.8614361190601704
fpr: 0.8636363636363636 fnr 0.0
Pixel Auroc:0.983, Sample Auroc0.697, Pixel Aupro0.0
 68%|██████▊   | 81/120 [10:04<05:42,  8.78s/it]epoch [81/120], kd_loss:1.2659
 68%|██████▊   | 82/120 [10:11<05:04,  8.02s/it]epoch [82/120], kd_loss:1.2224
 69%|██████▉   | 83/120 [10:17<04:36,  7.47s/it]epoch [83/120], kd_loss:1.2060
 70%|███████   | 84/120 [10:23<04:15,  7.10s/it]epoch [84/120], kd_loss:1.1460
 71%|███████   | 85/120 [10:29<03:59,  6.84s/it]epoch [85/120], kd_loss:1.1435
 72%|███████▏  | 86/120 [10:36<03:47,  6.69s/it]epoch [86/120], kd_loss:1.1403
 72%|███████▎  | 87/120 [10:42<03:36,  6.55s/it]epoch [87/120], kd_loss:1.1325
 73%|███████▎  | 88/120 [10:48<03:27,  6.48s/it]epoch [88/120], kd_loss:1.2440
 74%|███████▍  | 89/120 [10:54<03:19,  6.42s/it]epoch [89/120], kd_loss:1.1152
 75%|███████▌  | 90/120 [11:13<05:01, 10.05s/it]epoch [90/120], kd_loss:1.0822
normal: 0.7210 1.2824  anomaly: 0.6940 1.6073
thresh: 0.7664522964265502
fpr: 0.8181818181818182 fnr 0.010869565217391304
Pixel Auroc:0.985, Sample Auroc0.621, Pixel Aupro0.0
 76%|███████▌  | 91/120 [11:19<04:17,  8.87s/it]epoch [91/120], kd_loss:1.0968
 77%|███████▋  | 92/120 [11:25<03:46,  8.08s/it]epoch [92/120], kd_loss:1.0688
 78%|███████▊  | 93/120 [11:32<03:23,  7.55s/it]epoch [93/120], kd_loss:1.0707
 78%|███████▊  | 94/120 [11:38<03:06,  7.18s/it]epoch [94/120], kd_loss:1.1169
 79%|███████▉  | 95/120 [11:44<02:53,  6.93s/it]epoch [95/120], kd_loss:1.0684
 80%|████████  | 96/120 [11:51<02:42,  6.76s/it]epoch [96/120], kd_loss:1.0728
 81%|████████  | 97/120 [11:57<02:31,  6.59s/it]epoch [97/120], kd_loss:1.0460
 82%|████████▏ | 98/120 [12:03<02:22,  6.50s/it]epoch [98/120], kd_loss:1.0347
 82%|████████▎ | 99/120 [12:09<02:15,  6.45s/it]epoch [99/120], kd_loss:1.0306
 83%|████████▎ | 100/120 [12:28<03:23, 10.20s/it]epoch [100/120], kd_loss:1.0290
normal: 0.6398 1.2531  anomaly: 0.6793 1.5198
thresh: 0.6793431349905605
fpr: 0.9090909090909091 fnr 0.0
Pixel Auroc:0.985, Sample Auroc0.635, Pixel Aupro0.0
 84%|████████▍ | 101/120 [12:35<02:51,  9.02s/it]epoch [101/120], kd_loss:1.0230
 85%|████████▌ | 102/120 [12:41<02:27,  8.18s/it]epoch [102/120], kd_loss:1.0204
 86%|████████▌ | 103/120 [12:47<02:09,  7.61s/it]epoch [103/120], kd_loss:1.0191
 87%|████████▋ | 104/120 [12:54<01:55,  7.23s/it]epoch [104/120], kd_loss:1.0175
 88%|████████▊ | 105/120 [13:00<01:44,  6.96s/it]epoch [105/120], kd_loss:1.0163
 88%|████████▊ | 106/120 [13:06<01:34,  6.76s/it]epoch [106/120], kd_loss:1.0128
 89%|████████▉ | 107/120 [13:12<01:25,  6.60s/it]epoch [107/120], kd_loss:1.0091
 90%|█████████ | 108/120 [13:19<01:18,  6.51s/it]epoch [108/120], kd_loss:1.0079
 91%|█████████ | 109/120 [13:25<01:10,  6.45s/it]epoch [109/120], kd_loss:1.0036
 92%|█████████▏| 110/120 [13:44<01:41, 10.17s/it]epoch [110/120], kd_loss:1.0025
normal: 0.5942 1.2357  anomaly: 0.6862 1.5034
thresh: 0.703266367123614
fpr: 0.8181818181818182 fnr 0.010869565217391304
Pixel Auroc:0.985, Sample Auroc0.648, Pixel Aupro0.0
 92%|█████████▎| 111/120 [13:50<01:20,  8.98s/it]epoch [111/120], kd_loss:1.0026
 93%|█████████▎| 112/120 [13:56<01:05,  8.17s/it]epoch [112/120], kd_loss:1.0012
 94%|█████████▍| 113/120 [14:03<00:53,  7.60s/it]epoch [113/120], kd_loss:1.0010
 95%|█████████▌| 114/120 [14:09<00:43,  7.19s/it]epoch [114/120], kd_loss:1.0009
 96%|█████████▌| 115/120 [14:15<00:34,  6.94s/it]epoch [115/120], kd_loss:1.0000
 97%|█████████▋| 116/120 [14:22<00:27,  6.76s/it]epoch [116/120], kd_loss:0.9988
 98%|█████████▊| 117/120 [14:28<00:19,  6.62s/it]epoch [117/120], kd_loss:0.9986
 98%|█████████▊| 118/120 [14:34<00:13,  6.52s/it]epoch [118/120], kd_loss:0.9978
 99%|█████████▉| 119/120 [14:40<00:06,  6.44s/it]epoch [119/120], kd_loss:0.9970
100%|██████████| 120/120 [14:59<00:00, 10.08s/it]100%|██████████| 120/120 [14:59<00:00,  7.50s/it]
epoch [120/120], kd_loss:0.9966
normal: 0.5963 1.2212  anomaly: 0.6884 1.4959
thresh: 0.6884385014353078
fpr: 0.9090909090909091 fnr 0.0
Pixel Auroc:0.985, Sample Auroc0.654, Pixel Aupro0.0
training Advanced Teacher...
rope
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:20<34:29, 20.90s/it]epoch [1/100], focal_loss:0.0740	, anomaly_loss:0.5491	fnorm_loss:0.0745, a_fnorm_loss:0.0140P:0.00, R:0.02
normal: 0.2616 0.2678  anomaly: 0.2587 0.2662	P:0.00, R:0.00
Pixel Auroc:0.800, Sample Auroc0.164, Pixel Aupro0.0
test_fnorm_loss: 0.0735 test_afnorm_loss: 0.0133
  2%|▏         | 2/100 [00:29<21:58, 13.45s/it]epoch [2/100], focal_loss:0.0586	, anomaly_loss:0.5574	fnorm_loss:0.0667, a_fnorm_loss:0.0129P:0.00, R:0.00
  3%|▎         | 3/100 [00:36<17:37, 10.90s/it]epoch [3/100], focal_loss:0.0479	, anomaly_loss:0.5835	fnorm_loss:0.0579, a_fnorm_loss:0.0112P:0.00, R:0.00
  4%|▍         | 4/100 [00:45<15:56,  9.96s/it]epoch [4/100], focal_loss:0.0442	, anomaly_loss:0.6023	fnorm_loss:0.0515, a_fnorm_loss:0.0099P:0.00, R:0.00
  5%|▌         | 5/100 [01:03<20:12, 12.76s/it]epoch [5/100], focal_loss:0.0381	, anomaly_loss:0.6202	fnorm_loss:0.0469, a_fnorm_loss:0.0092P:0.00, R:0.00
normal: 0.1638 0.1654  anomaly: 0.1626 0.1651	P:0.00, R:0.00
Pixel Auroc:0.808, Sample Auroc0.219, Pixel Aupro0.0
test_fnorm_loss: 0.0458 test_afnorm_loss: 0.0084
  6%|▌         | 6/100 [01:11<17:31, 11.19s/it]epoch [6/100], focal_loss:0.0364	, anomaly_loss:0.6315	fnorm_loss:0.0431, a_fnorm_loss:0.0084P:0.00, R:0.00
  7%|▋         | 7/100 [01:19<15:41, 10.13s/it]epoch [7/100], focal_loss:0.0387	, anomaly_loss:0.6339	fnorm_loss:0.0425, a_fnorm_loss:0.0085P:0.00, R:0.00
  8%|▊         | 8/100 [01:27<14:38,  9.54s/it]epoch [8/100], focal_loss:0.0350	, anomaly_loss:0.6167	fnorm_loss:0.0404, a_fnorm_loss:0.0113P:0.03, R:0.05
  9%|▉         | 9/100 [01:35<13:33,  8.94s/it]epoch [9/100], focal_loss:0.0322	, anomaly_loss:0.5442	fnorm_loss:0.0366, a_fnorm_loss:0.0233P:0.08, R:0.23
 10%|█         | 10/100 [01:55<18:29, 12.33s/it]epoch [10/100], focal_loss:0.0342	, anomaly_loss:0.5209	fnorm_loss:0.0336, a_fnorm_loss:0.0276P:0.10, R:0.26
normal: 0.1549 0.2460  anomaly: 0.1650 0.3272	P:0.10, R:0.12
Pixel Auroc:0.988, Sample Auroc0.936, Pixel Aupro0.0
test_fnorm_loss: 0.0326 test_afnorm_loss: 0.0246
 11%|█         | 11/100 [02:03<16:17, 10.98s/it]epoch [11/100], focal_loss:0.0313	, anomaly_loss:0.4863	fnorm_loss:0.0313, a_fnorm_loss:0.0316P:0.13, R:0.34
 12%|█▏        | 12/100 [02:11<15:00, 10.23s/it]epoch [12/100], focal_loss:0.0277	, anomaly_loss:0.4716	fnorm_loss:0.0294, a_fnorm_loss:0.0313P:0.17, R:0.43
 13%|█▎        | 13/100 [02:19<14:00,  9.66s/it]epoch [13/100], focal_loss:0.0257	, anomaly_loss:0.4865	fnorm_loss:0.0268, a_fnorm_loss:0.0316P:0.15, R:0.39
 14%|█▍        | 14/100 [02:27<13:03,  9.11s/it]epoch [14/100], focal_loss:0.0269	, anomaly_loss:0.5129	fnorm_loss:0.0262, a_fnorm_loss:0.0323P:0.09, R:0.31
 15%|█▌        | 15/100 [02:45<16:46, 11.85s/it]epoch [15/100], focal_loss:0.0253	, anomaly_loss:0.4803	fnorm_loss:0.0249, a_fnorm_loss:0.0343P:0.20, R:0.43
normal: 0.1550 0.2861  anomaly: 0.1840 0.3311	P:0.06, R:0.16
Pixel Auroc:0.989, Sample Auroc0.894, Pixel Aupro0.0
test_fnorm_loss: 0.0242 test_afnorm_loss: 0.0305
 16%|█▌        | 16/100 [02:53<14:58, 10.70s/it]epoch [16/100], focal_loss:0.0298	, anomaly_loss:0.4973	fnorm_loss:0.0246, a_fnorm_loss:0.0333P:0.14, R:0.33
 17%|█▋        | 17/100 [03:01<13:36,  9.83s/it]epoch [17/100], focal_loss:0.0256	, anomaly_loss:0.4622	fnorm_loss:0.0231, a_fnorm_loss:0.0353P:0.22, R:0.47
 18%|█▊        | 18/100 [03:09<12:36,  9.23s/it]epoch [18/100], focal_loss:0.0230	, anomaly_loss:0.4175	fnorm_loss:0.0212, a_fnorm_loss:0.0365P:0.24, R:0.61
 19%|█▉        | 19/100 [03:17<11:56,  8.84s/it]epoch [19/100], focal_loss:0.0188	, anomaly_loss:0.3594	fnorm_loss:0.0196, a_fnorm_loss:0.0398P:0.38, R:0.79
 20%|██        | 20/100 [03:41<17:54, 13.43s/it]epoch [20/100], focal_loss:0.0197	, anomaly_loss:0.3704	fnorm_loss:0.0188, a_fnorm_loss:0.0366P:0.36, R:0.77
normal: 0.3523 0.5772  anomaly: 0.3989 0.6590	P:0.12, R:0.49
Pixel Auroc:0.989, Sample Auroc0.909, Pixel Aupro0.0
test_fnorm_loss: 0.0197 test_afnorm_loss: 0.0375
 21%|██        | 21/100 [03:49<15:25, 11.72s/it]epoch [21/100], focal_loss:0.0187	, anomaly_loss:0.3549	fnorm_loss:0.0180, a_fnorm_loss:0.0388P:0.32, R:0.80
 22%|██▏       | 22/100 [03:57<13:38, 10.50s/it]epoch [22/100], focal_loss:0.0171	, anomaly_loss:0.3415	fnorm_loss:0.0172, a_fnorm_loss:0.0390P:0.38, R:0.82
 23%|██▎       | 23/100 [04:05<12:29,  9.73s/it]epoch [23/100], focal_loss:0.0179	, anomaly_loss:0.3472	fnorm_loss:0.0166, a_fnorm_loss:0.0382P:0.32, R:0.79
 24%|██▍       | 24/100 [04:12<11:36,  9.16s/it]epoch [24/100], focal_loss:0.0163	, anomaly_loss:0.3264	fnorm_loss:0.0158, a_fnorm_loss:0.0415P:0.37, R:0.86
 25%|██▌       | 25/100 [04:36<16:58, 13.58s/it]epoch [25/100], focal_loss:0.0156	, anomaly_loss:0.3266	fnorm_loss:0.0153, a_fnorm_loss:0.0413P:0.40, R:0.86
normal: 0.1216 0.3941  anomaly: 0.1496 0.6483	P:0.31, R:0.40
Pixel Auroc:0.992, Sample Auroc0.937, Pixel Aupro0.0
test_fnorm_loss: 0.0147 test_afnorm_loss: 0.0351
 26%|██▌       | 26/100 [04:45<14:48, 12.01s/it]epoch [26/100], focal_loss:0.0154	, anomaly_loss:0.3296	fnorm_loss:0.0148, a_fnorm_loss:0.0408P:0.38, R:0.85
 27%|██▋       | 27/100 [04:53<13:12, 10.86s/it]epoch [27/100], focal_loss:0.0140	, anomaly_loss:0.3208	fnorm_loss:0.0142, a_fnorm_loss:0.0420P:0.38, R:0.87
 28%|██▊       | 28/100 [05:01<11:57,  9.96s/it]epoch [28/100], focal_loss:0.0145	, anomaly_loss:0.3118	fnorm_loss:0.0140, a_fnorm_loss:0.0407P:0.34, R:0.84
 29%|██▉       | 29/100 [05:09<11:05,  9.38s/it]epoch [29/100], focal_loss:0.0136	, anomaly_loss:0.3074	fnorm_loss:0.0134, a_fnorm_loss:0.0421P:0.38, R:0.88
 30%|███       | 30/100 [05:32<15:46, 13.52s/it]epoch [30/100], focal_loss:0.0145	, anomaly_loss:0.3335	fnorm_loss:0.0132, a_fnorm_loss:0.0418P:0.38, R:0.83
normal: 0.1090 0.3148  anomaly: 0.1227 0.6425	P:0.33, R:0.37
Pixel Auroc:0.992, Sample Auroc0.949, Pixel Aupro0.0
test_fnorm_loss: 0.0124 test_afnorm_loss: 0.0292
 31%|███       | 31/100 [05:40<13:45, 11.96s/it]epoch [31/100], focal_loss:0.0138	, anomaly_loss:0.3147	fnorm_loss:0.0128, a_fnorm_loss:0.0416P:0.39, R:0.86
 32%|███▏      | 32/100 [05:49<12:19, 10.88s/it]epoch [32/100], focal_loss:0.0132	, anomaly_loss:0.3042	fnorm_loss:0.0125, a_fnorm_loss:0.0438P:0.39, R:0.88
 33%|███▎      | 33/100 [05:57<11:14, 10.07s/it]epoch [33/100], focal_loss:0.0139	, anomaly_loss:0.3206	fnorm_loss:0.0123, a_fnorm_loss:0.0419P:0.39, R:0.86
 34%|███▍      | 34/100 [06:05<10:20,  9.41s/it]epoch [34/100], focal_loss:0.0124	, anomaly_loss:0.3023	fnorm_loss:0.0120, a_fnorm_loss:0.0436P:0.37, R:0.90
 35%|███▌      | 35/100 [06:24<13:29, 12.45s/it]epoch [35/100], focal_loss:0.0127	, anomaly_loss:0.3041	fnorm_loss:0.0116, a_fnorm_loss:0.0444P:0.40, R:0.91
normal: 0.1289 0.4225  anomaly: 0.2025 0.6658	P:0.29, R:0.40
Pixel Auroc:0.992, Sample Auroc0.967, Pixel Aupro0.0
test_fnorm_loss: 0.0115 test_afnorm_loss: 0.0361
 36%|███▌      | 36/100 [06:32<11:48, 11.07s/it]epoch [36/100], focal_loss:0.0122	, anomaly_loss:0.3230	fnorm_loss:0.0115, a_fnorm_loss:0.0436P:0.39, R:0.88
 37%|███▋      | 37/100 [06:40<10:36, 10.11s/it]epoch [37/100], focal_loss:0.0114	, anomaly_loss:0.3026	fnorm_loss:0.0112, a_fnorm_loss:0.0441P:0.42, R:0.91
 38%|███▊      | 38/100 [06:47<09:38,  9.34s/it]epoch [38/100], focal_loss:0.0128	, anomaly_loss:0.2950	fnorm_loss:0.0111, a_fnorm_loss:0.0421P:0.39, R:0.88
 39%|███▉      | 39/100 [06:55<09:03,  8.91s/it]epoch [39/100], focal_loss:0.0127	, anomaly_loss:0.3032	fnorm_loss:0.0109, a_fnorm_loss:0.0439P:0.41, R:0.89
 40%|████      | 40/100 [07:13<11:40, 11.67s/it]epoch [40/100], focal_loss:0.0115	, anomaly_loss:0.2977	fnorm_loss:0.0107, a_fnorm_loss:0.0433P:0.45, R:0.87
normal: 0.3638 0.6632  anomaly: 0.4230 0.7656	P:0.12, R:0.49
Pixel Auroc:0.988, Sample Auroc0.894, Pixel Aupro0.0
test_fnorm_loss: 0.0116 test_afnorm_loss: 0.0418
 41%|████      | 41/100 [07:21<10:24, 10.58s/it]epoch [41/100], focal_loss:0.0108	, anomaly_loss:0.2916	fnorm_loss:0.0104, a_fnorm_loss:0.0437P:0.42, R:0.90
 42%|████▏     | 42/100 [07:29<09:29,  9.81s/it]epoch [42/100], focal_loss:0.0114	, anomaly_loss:0.3023	fnorm_loss:0.0103, a_fnorm_loss:0.0422P:0.35, R:0.88
 43%|████▎     | 43/100 [07:37<08:42,  9.17s/it]epoch [43/100], focal_loss:0.0133	, anomaly_loss:0.3133	fnorm_loss:0.0105, a_fnorm_loss:0.0430P:0.43, R:0.88
 44%|████▍     | 44/100 [07:45<08:07,  8.71s/it]epoch [44/100], focal_loss:0.0105	, anomaly_loss:0.2974	fnorm_loss:0.0100, a_fnorm_loss:0.0443P:0.39, R:0.91
 45%|████▌     | 45/100 [08:03<10:36, 11.56s/it]epoch [45/100], focal_loss:0.0103	, anomaly_loss:0.2866	fnorm_loss:0.0098, a_fnorm_loss:0.0444P:0.44, R:0.91
normal: 0.2722 0.5830  anomaly: 0.2983 0.7419	P:0.18, R:0.48
Pixel Auroc:0.990, Sample Auroc0.894, Pixel Aupro0.0
test_fnorm_loss: 0.0101 test_afnorm_loss: 0.0405
 46%|████▌     | 46/100 [08:10<09:19, 10.36s/it]epoch [46/100], focal_loss:0.0123	, anomaly_loss:0.2969	fnorm_loss:0.0099, a_fnorm_loss:0.0446P:0.42, R:0.89
 47%|████▋     | 47/100 [08:19<08:34,  9.71s/it]epoch [47/100], focal_loss:0.0119	, anomaly_loss:0.3019	fnorm_loss:0.0097, a_fnorm_loss:0.0444P:0.43, R:0.89
 48%|████▊     | 48/100 [08:26<07:52,  9.08s/it]epoch [48/100], focal_loss:0.0104	, anomaly_loss:0.2921	fnorm_loss:0.0095, a_fnorm_loss:0.0439P:0.39, R:0.89
 49%|████▉     | 49/100 [08:34<07:25,  8.73s/it]epoch [49/100], focal_loss:0.0123	, anomaly_loss:0.2907	fnorm_loss:0.0095, a_fnorm_loss:0.0449P:0.38, R:0.91
 50%|█████     | 50/100 [08:52<09:30, 11.42s/it]epoch [50/100], focal_loss:0.0113	, anomaly_loss:0.2931	fnorm_loss:0.0094, a_fnorm_loss:0.0435P:0.42, R:0.88
normal: 0.4496 0.7191  anomaly: 0.4586 0.7974	P:0.08, R:0.52
Pixel Auroc:0.987, Sample Auroc0.856, Pixel Aupro0.0
test_fnorm_loss: 0.0110 test_afnorm_loss: 0.0435
 51%|█████     | 51/100 [09:00<08:27, 10.35s/it]epoch [51/100], focal_loss:0.0111	, anomaly_loss:0.3049	fnorm_loss:0.0093, a_fnorm_loss:0.0456P:0.43, R:0.89
 52%|█████▏    | 52/100 [09:08<07:41,  9.62s/it]epoch [52/100], focal_loss:0.0107	, anomaly_loss:0.2942	fnorm_loss:0.0091, a_fnorm_loss:0.0440P:0.39, R:0.90
 53%|█████▎    | 53/100 [09:15<07:04,  9.03s/it]epoch [53/100], focal_loss:0.0103	, anomaly_loss:0.2911	fnorm_loss:0.0090, a_fnorm_loss:0.0454P:0.37, R:0.91
 54%|█████▍    | 54/100 [09:23<06:36,  8.62s/it]epoch [54/100], focal_loss:0.0112	, anomaly_loss:0.2949	fnorm_loss:0.0091, a_fnorm_loss:0.0429P:0.40, R:0.89
 55%|█████▌    | 55/100 [09:41<08:36, 11.47s/it]epoch [55/100], focal_loss:0.0108	, anomaly_loss:0.2933	fnorm_loss:0.0088, a_fnorm_loss:0.0447P:0.39, R:0.91
normal: 0.3291 0.6211  anomaly: 0.3875 0.7592	P:0.15, R:0.48
Pixel Auroc:0.988, Sample Auroc0.892, Pixel Aupro0.0
test_fnorm_loss: 0.0098 test_afnorm_loss: 0.0405
 56%|█████▌    | 56/100 [09:49<07:36, 10.37s/it]epoch [56/100], focal_loss:0.0110	, anomaly_loss:0.2765	fnorm_loss:0.0089, a_fnorm_loss:0.0432P:0.41, R:0.90
 57%|█████▋    | 57/100 [09:57<06:51,  9.56s/it]epoch [57/100], focal_loss:0.0099	, anomaly_loss:0.2888	fnorm_loss:0.0087, a_fnorm_loss:0.0445P:0.40, R:0.92
 58%|█████▊    | 58/100 [10:04<06:20,  9.06s/it]epoch [58/100], focal_loss:0.0097	, anomaly_loss:0.2792	fnorm_loss:0.0086, a_fnorm_loss:0.0449P:0.40, R:0.91
 59%|█████▉    | 59/100 [10:12<05:57,  8.71s/it]epoch [59/100], focal_loss:0.0099	, anomaly_loss:0.2814	fnorm_loss:0.0085, a_fnorm_loss:0.0445P:0.39, R:0.91
 60%|██████    | 60/100 [10:30<07:40, 11.51s/it]epoch [60/100], focal_loss:0.0099	, anomaly_loss:0.2951	fnorm_loss:0.0084, a_fnorm_loss:0.0433P:0.41, R:0.89
normal: 0.3497 0.6626  anomaly: 0.4269 0.8098	P:0.11, R:0.51
Pixel Auroc:0.990, Sample Auroc0.900, Pixel Aupro0.0
test_fnorm_loss: 0.0097 test_afnorm_loss: 0.0447
 61%|██████    | 61/100 [10:38<06:45, 10.40s/it]epoch [61/100], focal_loss:0.0116	, anomaly_loss:0.3077	fnorm_loss:0.0087, a_fnorm_loss:0.0441P:0.40, R:0.87
 62%|██████▏   | 62/100 [10:46<06:07,  9.66s/it]epoch [62/100], focal_loss:0.0111	, anomaly_loss:0.2926	fnorm_loss:0.0087, a_fnorm_loss:0.0452P:0.43, R:0.90
 63%|██████▎   | 63/100 [10:55<05:44,  9.30s/it]epoch [63/100], focal_loss:0.0098	, anomaly_loss:0.2889	fnorm_loss:0.0084, a_fnorm_loss:0.0454P:0.41, R:0.89
 64%|██████▍   | 64/100 [11:03<05:20,  8.91s/it]epoch [64/100], focal_loss:0.0094	, anomaly_loss:0.2869	fnorm_loss:0.0083, a_fnorm_loss:0.0473P:0.41, R:0.92
 65%|██████▌   | 65/100 [11:20<06:43, 11.54s/it]epoch [65/100], focal_loss:0.0107	, anomaly_loss:0.3086	fnorm_loss:0.0084, a_fnorm_loss:0.0433P:0.40, R:0.87
normal: 0.0933 0.4868  anomaly: 0.1301 0.7101	P:0.29, R:0.43
Pixel Auroc:0.993, Sample Auroc0.946, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0353
 66%|██████▌   | 66/100 [11:28<05:55, 10.45s/it]epoch [66/100], focal_loss:0.0096	, anomaly_loss:0.2861	fnorm_loss:0.0082, a_fnorm_loss:0.0442P:0.42, R:0.91
 67%|██████▋   | 67/100 [11:36<05:23,  9.79s/it]epoch [67/100], focal_loss:0.0113	, anomaly_loss:0.2899	fnorm_loss:0.0083, a_fnorm_loss:0.0458P:0.45, R:0.91
 68%|██████▊   | 68/100 [11:44<04:54,  9.19s/it]epoch [68/100], focal_loss:0.0127	, anomaly_loss:0.2888	fnorm_loss:0.0083, a_fnorm_loss:0.0452P:0.48, R:0.89
 69%|██████▉   | 69/100 [11:52<04:30,  8.73s/it]epoch [69/100], focal_loss:0.0097	, anomaly_loss:0.3001	fnorm_loss:0.0080, a_fnorm_loss:0.0460P:0.45, R:0.91
 70%|███████   | 70/100 [12:11<05:52, 11.74s/it]epoch [70/100], focal_loss:0.0104	, anomaly_loss:0.3006	fnorm_loss:0.0081, a_fnorm_loss:0.0438P:0.38, R:0.90
normal: 0.1195 0.4944  anomaly: 0.1578 0.6990	P:0.27, R:0.45
Pixel Auroc:0.994, Sample Auroc0.917, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0378
 71%|███████   | 71/100 [12:19<05:08, 10.62s/it]epoch [71/100], focal_loss:0.0086	, anomaly_loss:0.2838	fnorm_loss:0.0078, a_fnorm_loss:0.0462P:0.42, R:0.91
 72%|███████▏  | 72/100 [12:26<04:31,  9.69s/it]epoch [72/100], focal_loss:0.0103	, anomaly_loss:0.2776	fnorm_loss:0.0080, a_fnorm_loss:0.0450P:0.44, R:0.91
 73%|███████▎  | 73/100 [12:35<04:10,  9.27s/it]epoch [73/100], focal_loss:0.0107	, anomaly_loss:0.2964	fnorm_loss:0.0079, a_fnorm_loss:0.0439P:0.44, R:0.88
 74%|███████▍  | 74/100 [12:42<03:47,  8.76s/it]epoch [74/100], focal_loss:0.0105	, anomaly_loss:0.2852	fnorm_loss:0.0079, a_fnorm_loss:0.0451P:0.45, R:0.91
 75%|███████▌  | 75/100 [13:00<04:48, 11.54s/it]epoch [75/100], focal_loss:0.0102	, anomaly_loss:0.2817	fnorm_loss:0.0079, a_fnorm_loss:0.0465P:0.44, R:0.91
normal: 0.1205 0.3937  anomaly: 0.1508 0.6927	P:0.31, R:0.39
Pixel Auroc:0.993, Sample Auroc0.924, Pixel Aupro0.0
test_fnorm_loss: 0.0079 test_afnorm_loss: 0.0363
 76%|███████▌  | 76/100 [13:08<04:10, 10.42s/it]epoch [76/100], focal_loss:0.0096	, anomaly_loss:0.3022	fnorm_loss:0.0078, a_fnorm_loss:0.0449P:0.43, R:0.90
 77%|███████▋  | 77/100 [13:15<03:39,  9.56s/it]epoch [77/100], focal_loss:0.0096	, anomaly_loss:0.2817	fnorm_loss:0.0078, a_fnorm_loss:0.0457P:0.45, R:0.91
 78%|███████▊  | 78/100 [13:23<03:18,  9.01s/it]epoch [78/100], focal_loss:0.0099	, anomaly_loss:0.2877	fnorm_loss:0.0076, a_fnorm_loss:0.0474P:0.43, R:0.90
 79%|███████▉  | 79/100 [13:31<03:01,  8.62s/it]epoch [79/100], focal_loss:0.0085	, anomaly_loss:0.2893	fnorm_loss:0.0075, a_fnorm_loss:0.0471P:0.49, R:0.91
 80%|████████  | 80/100 [13:49<03:49, 11.48s/it]epoch [80/100], focal_loss:0.0090	, anomaly_loss:0.2866	fnorm_loss:0.0075, a_fnorm_loss:0.0469P:0.47, R:0.91
normal: 0.1769 0.5256  anomaly: 0.1996 0.7464	P:0.23, R:0.47
Pixel Auroc:0.993, Sample Auroc0.931, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0390
 81%|████████  | 81/100 [13:57<03:17, 10.39s/it]epoch [81/100], focal_loss:0.0085	, anomaly_loss:0.2926	fnorm_loss:0.0076, a_fnorm_loss:0.0461P:0.39, R:0.90
 82%|████████▏ | 82/100 [14:04<02:51,  9.55s/it]epoch [82/100], focal_loss:0.0082	, anomaly_loss:0.2827	fnorm_loss:0.0075, a_fnorm_loss:0.0465P:0.43, R:0.93
 83%|████████▎ | 83/100 [14:13<02:34,  9.10s/it]epoch [83/100], focal_loss:0.0090	, anomaly_loss:0.2725	fnorm_loss:0.0076, a_fnorm_loss:0.0466P:0.45, R:0.92
 84%|████████▍ | 84/100 [14:21<02:20,  8.77s/it]epoch [84/100], focal_loss:0.0079	, anomaly_loss:0.2699	fnorm_loss:0.0074, a_fnorm_loss:0.0471P:0.48, R:0.93
 85%|████████▌ | 85/100 [14:38<02:52, 11.50s/it]epoch [85/100], focal_loss:0.0083	, anomaly_loss:0.2856	fnorm_loss:0.0074, a_fnorm_loss:0.0472P:0.41, R:0.93
normal: 0.0943 0.5274  anomaly: 0.1885 0.7366	P:0.26, R:0.46
Pixel Auroc:0.994, Sample Auroc0.940, Pixel Aupro0.0
test_fnorm_loss: 0.0074 test_afnorm_loss: 0.0404
 86%|████████▌ | 86/100 [14:46<02:26, 10.47s/it]epoch [86/100], focal_loss:0.0085	, anomaly_loss:0.2770	fnorm_loss:0.0074, a_fnorm_loss:0.0477P:0.44, R:0.93
 87%|████████▋ | 87/100 [14:54<02:06,  9.72s/it]epoch [87/100], focal_loss:0.0090	, anomaly_loss:0.2708	fnorm_loss:0.0075, a_fnorm_loss:0.0461P:0.40, R:0.92
 88%|████████▊ | 88/100 [15:02<01:48,  9.06s/it]epoch [88/100], focal_loss:0.0094	, anomaly_loss:0.2779	fnorm_loss:0.0074, a_fnorm_loss:0.0470P:0.43, R:0.92
 89%|████████▉ | 89/100 [15:10<01:35,  8.65s/it]epoch [89/100], focal_loss:0.0076	, anomaly_loss:0.2741	fnorm_loss:0.0073, a_fnorm_loss:0.0481P:0.41, R:0.94
 90%|█████████ | 90/100 [15:28<01:56, 11.67s/it]epoch [90/100], focal_loss:0.0083	, anomaly_loss:0.2722	fnorm_loss:0.0074, a_fnorm_loss:0.0469P:0.41, R:0.92
normal: 0.1797 0.5561  anomaly: 0.2137 0.7702	P:0.20, R:0.48
Pixel Auroc:0.993, Sample Auroc0.916, Pixel Aupro0.0
test_fnorm_loss: 0.0078 test_afnorm_loss: 0.0418
 91%|█████████ | 91/100 [15:37<01:36, 10.67s/it]epoch [91/100], focal_loss:0.0088	, anomaly_loss:0.2711	fnorm_loss:0.0075, a_fnorm_loss:0.0461P:0.40, R:0.93
 92%|█████████▏| 92/100 [15:45<01:18,  9.82s/it]epoch [92/100], focal_loss:0.0077	, anomaly_loss:0.2777	fnorm_loss:0.0073, a_fnorm_loss:0.0462P:0.45, R:0.92
 93%|█████████▎| 93/100 [15:53<01:05,  9.32s/it]epoch [93/100], focal_loss:0.0093	, anomaly_loss:0.2755	fnorm_loss:0.0075, a_fnorm_loss:0.0470P:0.42, R:0.92
 94%|█████████▍| 94/100 [16:00<00:53,  8.85s/it]epoch [94/100], focal_loss:0.0083	, anomaly_loss:0.2742	fnorm_loss:0.0074, a_fnorm_loss:0.0463P:0.41, R:0.92
 95%|█████████▌| 95/100 [16:19<00:59, 11.82s/it]epoch [95/100], focal_loss:0.0078	, anomaly_loss:0.2581	fnorm_loss:0.0073, a_fnorm_loss:0.0481P:0.44, R:0.94
normal: 0.1295 0.5429  anomaly: 0.2039 0.7654	P:0.22, R:0.47
Pixel Auroc:0.994, Sample Auroc0.919, Pixel Aupro0.0
test_fnorm_loss: 0.0076 test_afnorm_loss: 0.0409
 96%|█████████▌| 96/100 [16:27<00:42, 10.58s/it]epoch [96/100], focal_loss:0.0081	, anomaly_loss:0.2674	fnorm_loss:0.0073, a_fnorm_loss:0.0462P:0.45, R:0.93
 97%|█████████▋| 97/100 [16:34<00:28,  9.66s/it]epoch [97/100], focal_loss:0.0094	, anomaly_loss:0.2778	fnorm_loss:0.0074, a_fnorm_loss:0.0453P:0.44, R:0.91
 98%|█████████▊| 98/100 [16:42<00:18,  9.18s/it]epoch [98/100], focal_loss:0.0090	, anomaly_loss:0.2769	fnorm_loss:0.0074, a_fnorm_loss:0.0474P:0.43, R:0.93
 99%|█████████▉| 99/100 [16:51<00:08,  8.88s/it]epoch [99/100], focal_loss:0.0087	, anomaly_loss:0.2644	fnorm_loss:0.0075, a_fnorm_loss:0.0468P:0.42, R:0.94
100%|██████████| 100/100 [17:09<00:00, 11.86s/it]100%|██████████| 100/100 [17:09<00:00, 10.30s/it]
epoch [100/100], focal_loss:0.0076	, anomaly_loss:0.2718	fnorm_loss:0.0073, a_fnorm_loss:0.0475P:0.46, R:0.94
normal: 0.1262 0.5321  anomaly: 0.1999 0.7622	P:0.22, R:0.47
Pixel Auroc:0.994, Sample Auroc0.922, Pixel Aupro0.0
test_fnorm_loss: 0.0075 test_afnorm_loss: 0.0406
training Stubborn Student...
rope
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<11:54,  6.00s/it]epoch [1/120], kd_loss:4.5448
  2%|▏         | 2/120 [00:11<11:46,  5.98s/it]epoch [2/120], kd_loss:3.6362
  2%|▎         | 3/120 [00:18<11:45,  6.03s/it]epoch [3/120], kd_loss:3.5912
  3%|▎         | 4/120 [00:24<11:40,  6.04s/it]epoch [4/120], kd_loss:2.7549
  4%|▍         | 5/120 [00:30<11:41,  6.10s/it]epoch [5/120], kd_loss:2.1852
  5%|▌         | 6/120 [00:36<11:33,  6.08s/it]epoch [6/120], kd_loss:2.3980
  6%|▌         | 7/120 [00:42<11:29,  6.10s/it]epoch [7/120], kd_loss:2.0152
  7%|▋         | 8/120 [00:48<11:23,  6.10s/it]epoch [8/120], kd_loss:1.9182
  8%|▊         | 9/120 [00:54<11:17,  6.10s/it]epoch [9/120], kd_loss:1.7898
  8%|▊         | 10/120 [01:10<16:42,  9.11s/it]epoch [10/120], kd_loss:1.8766
normal: 1.1010 1.3175  anomaly: 1.1641 2.3579
thresh: 1.2964743671949468
fpr: 0.03125 fnr 0.07246376811594203
Pixel Auroc:0.993, Sample Auroc0.977, Pixel Aupro0.0
  9%|▉         | 11/120 [01:16<14:45,  8.12s/it]epoch [11/120], kd_loss:1.6745
 10%|█         | 12/120 [01:22<13:28,  7.48s/it]epoch [12/120], kd_loss:1.8946
 11%|█         | 13/120 [01:28<12:31,  7.02s/it]epoch [13/120], kd_loss:2.6002
 12%|█▏        | 14/120 [01:34<11:53,  6.73s/it]epoch [14/120], kd_loss:2.0048
 12%|█▎        | 15/120 [01:40<11:25,  6.53s/it]epoch [15/120], kd_loss:1.7621
 13%|█▎        | 16/120 [01:46<11:08,  6.42s/it]epoch [16/120], kd_loss:1.6845
 14%|█▍        | 17/120 [01:52<10:51,  6.33s/it]epoch [17/120], kd_loss:1.6139
 15%|█▌        | 18/120 [01:58<10:38,  6.26s/it]epoch [18/120], kd_loss:2.3834
 16%|█▌        | 19/120 [02:05<10:30,  6.24s/it]epoch [19/120], kd_loss:1.7832
 17%|█▋        | 20/120 [02:21<15:21,  9.21s/it]epoch [20/120], kd_loss:1.6454
normal: 1.0279 1.2917  anomaly: 1.0576 2.2866
thresh: 1.198807025418189
fpr: 0.09375 fnr 0.07246376811594203
Pixel Auroc:0.991, Sample Auroc0.968, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:27<13:38,  8.27s/it]epoch [21/120], kd_loss:1.5692
 18%|█▊        | 22/120 [02:33<12:24,  7.60s/it]epoch [22/120], kd_loss:1.5545
 19%|█▉        | 23/120 [02:39<11:30,  7.12s/it]epoch [23/120], kd_loss:1.5133
 20%|██        | 24/120 [02:45<10:54,  6.82s/it]epoch [24/120], kd_loss:1.5025
 21%|██        | 25/120 [02:51<10:25,  6.59s/it]epoch [25/120], kd_loss:1.4748
 22%|██▏       | 26/120 [02:57<10:05,  6.44s/it]epoch [26/120], kd_loss:1.4981
 22%|██▎       | 27/120 [03:03<09:49,  6.33s/it]epoch [27/120], kd_loss:1.4699
 23%|██▎       | 28/120 [03:09<09:36,  6.27s/it]epoch [28/120], kd_loss:1.4353
 24%|██▍       | 29/120 [03:15<09:25,  6.22s/it]epoch [29/120], kd_loss:1.4237
 25%|██▌       | 30/120 [03:32<13:58,  9.32s/it]epoch [30/120], kd_loss:1.6846
normal: 1.0276 1.2823  anomaly: 1.0302 2.3006
thresh: 1.3808766576502856
fpr: 0.0 fnr 0.11594202898550725
Pixel Auroc:0.983, Sample Auroc0.954, Pixel Aupro0.0
 26%|██▌       | 31/120 [03:38<12:22,  8.34s/it]epoch [31/120], kd_loss:1.5378
 27%|██▋       | 32/120 [03:44<11:15,  7.68s/it]epoch [32/120], kd_loss:1.5597
 28%|██▊       | 33/120 [03:50<10:26,  7.20s/it]epoch [33/120], kd_loss:1.4732
 28%|██▊       | 34/120 [03:56<09:50,  6.87s/it]epoch [34/120], kd_loss:1.4521
 29%|██▉       | 35/120 [04:03<09:27,  6.67s/it]epoch [35/120], kd_loss:1.4713
 30%|███       | 36/120 [04:09<09:05,  6.49s/it]epoch [36/120], kd_loss:1.4220
 31%|███       | 37/120 [04:15<08:49,  6.38s/it]epoch [37/120], kd_loss:1.5757
 32%|███▏      | 38/120 [04:21<08:36,  6.30s/it]epoch [38/120], kd_loss:1.4055
 32%|███▎      | 39/120 [04:27<08:26,  6.25s/it]epoch [39/120], kd_loss:1.3929
 33%|███▎      | 40/120 [04:43<12:08,  9.11s/it]epoch [40/120], kd_loss:1.3703
normal: 1.0402 1.3371  anomaly: 1.1923 2.3983
thresh: 1.3069178379598565
fpr: 0.0625 fnr 0.10144927536231885
Pixel Auroc:0.990, Sample Auroc0.953, Pixel Aupro0.0
 34%|███▍      | 41/120 [04:49<10:45,  8.17s/it]epoch [41/120], kd_loss:1.3888
 35%|███▌      | 42/120 [04:55<09:46,  7.53s/it]epoch [42/120], kd_loss:1.3521
 36%|███▌      | 43/120 [05:01<09:06,  7.10s/it]epoch [43/120], kd_loss:1.4181
 37%|███▋      | 44/120 [05:07<08:37,  6.81s/it]epoch [44/120], kd_loss:1.3388
 38%|███▊      | 45/120 [05:13<08:15,  6.60s/it]epoch [45/120], kd_loss:1.3409
 38%|███▊      | 46/120 [05:19<07:58,  6.47s/it]epoch [46/120], kd_loss:1.3316
 39%|███▉      | 47/120 [05:25<07:44,  6.36s/it]epoch [47/120], kd_loss:1.4699
 40%|████      | 48/120 [05:32<07:33,  6.30s/it]epoch [48/120], kd_loss:1.4918
 41%|████      | 49/120 [05:38<07:25,  6.27s/it]epoch [49/120], kd_loss:1.5857
 42%|████▏     | 50/120 [05:54<10:40,  9.15s/it]epoch [50/120], kd_loss:1.4252
normal: 0.8534 1.1781  anomaly: 0.8897 2.2966
thresh: 1.0802000606877682
fpr: 0.0625 fnr 0.08695652173913043
Pixel Auroc:0.988, Sample Auroc0.954, Pixel Aupro0.0
 42%|████▎     | 51/120 [06:00<09:26,  8.21s/it]epoch [51/120], kd_loss:1.3460
 43%|████▎     | 52/120 [06:06<08:34,  7.56s/it]epoch [52/120], kd_loss:1.3520
 44%|████▍     | 53/120 [06:12<07:57,  7.13s/it]epoch [53/120], kd_loss:1.3461
 45%|████▌     | 54/120 [06:18<07:30,  6.83s/it]epoch [54/120], kd_loss:1.3298
 46%|████▌     | 55/120 [06:24<07:09,  6.61s/it]epoch [55/120], kd_loss:1.5977
 47%|████▋     | 56/120 [06:30<06:55,  6.49s/it]epoch [56/120], kd_loss:1.4261
 48%|████▊     | 57/120 [06:36<06:41,  6.38s/it]epoch [57/120], kd_loss:1.3455
 48%|████▊     | 58/120 [06:43<06:31,  6.31s/it]epoch [58/120], kd_loss:1.3270
 49%|████▉     | 59/120 [06:49<06:23,  6.28s/it]epoch [59/120], kd_loss:1.5993
 50%|█████     | 60/120 [07:05<09:07,  9.13s/it]epoch [60/120], kd_loss:1.4488
normal: 0.8803 1.2546  anomaly: 0.9132 2.3591
thresh: 1.267021475640154
fpr: 0.0 fnr 0.11594202898550725
Pixel Auroc:0.987, Sample Auroc0.949, Pixel Aupro0.0
 51%|█████     | 61/120 [07:11<08:04,  8.20s/it]epoch [61/120], kd_loss:1.3964
 52%|█████▏    | 62/120 [07:17<07:17,  7.55s/it]epoch [62/120], kd_loss:1.6358
 52%|█████▎    | 63/120 [07:23<06:45,  7.11s/it]epoch [63/120], kd_loss:1.4142
 53%|█████▎    | 64/120 [07:29<06:22,  6.84s/it]epoch [64/120], kd_loss:1.7107
 54%|█████▍    | 65/120 [07:35<06:06,  6.66s/it]epoch [65/120], kd_loss:1.4417
 55%|█████▌    | 66/120 [07:41<05:52,  6.53s/it]epoch [66/120], kd_loss:1.3927
 56%|█████▌    | 67/120 [07:47<05:39,  6.40s/it]epoch [67/120], kd_loss:1.3142
 57%|█████▋    | 68/120 [07:54<05:30,  6.35s/it]epoch [68/120], kd_loss:1.2960
 57%|█████▊    | 69/120 [08:00<05:23,  6.34s/it]epoch [69/120], kd_loss:1.2841
 58%|█████▊    | 70/120 [08:15<07:29,  8.99s/it]epoch [70/120], kd_loss:1.2850
normal: 0.8142 1.1614  anomaly: 0.8596 2.3132
thresh: 1.1118769288213648
fpr: 0.03125 fnr 0.10144927536231885
Pixel Auroc:0.990, Sample Auroc0.962, Pixel Aupro0.0
 59%|█████▉    | 71/120 [08:21<06:36,  8.09s/it]epoch [71/120], kd_loss:1.3140
 60%|██████    | 72/120 [08:27<05:58,  7.46s/it]epoch [72/120], kd_loss:1.2675
 61%|██████    | 73/120 [08:33<05:31,  7.06s/it]epoch [73/120], kd_loss:1.3279
 62%|██████▏   | 74/120 [08:39<05:11,  6.78s/it]epoch [74/120], kd_loss:1.2495
 62%|██████▎   | 75/120 [08:46<04:57,  6.60s/it]epoch [75/120], kd_loss:1.2548
 63%|██████▎   | 76/120 [08:52<04:44,  6.46s/it]epoch [76/120], kd_loss:1.2397
 64%|██████▍   | 77/120 [08:58<04:33,  6.36s/it]epoch [77/120], kd_loss:1.2311
 65%|██████▌   | 78/120 [09:04<04:24,  6.30s/it]epoch [78/120], kd_loss:1.3477
 66%|██████▌   | 79/120 [09:10<04:16,  6.25s/it]epoch [79/120], kd_loss:1.4833
 67%|██████▋   | 80/120 [09:26<06:03,  9.08s/it]epoch [80/120], kd_loss:1.4202
normal: 0.8177 1.1595  anomaly: 0.8520 2.3367
thresh: 0.9960570947699164
fpr: 0.125 fnr 0.057971014492753624
Pixel Auroc:0.990, Sample Auroc0.955, Pixel Aupro0.0
 68%|██████▊   | 81/120 [09:32<05:17,  8.15s/it]epoch [81/120], kd_loss:1.2614
 68%|██████▊   | 82/120 [09:38<04:46,  7.53s/it]epoch [82/120], kd_loss:1.2515
 69%|██████▉   | 83/120 [09:44<04:23,  7.11s/it]epoch [83/120], kd_loss:1.2867
 70%|███████   | 84/120 [09:50<04:05,  6.81s/it]epoch [84/120], kd_loss:1.3569
 71%|███████   | 85/120 [09:56<03:51,  6.63s/it]epoch [85/120], kd_loss:1.2820
 72%|███████▏  | 86/120 [10:03<03:40,  6.50s/it]epoch [86/120], kd_loss:1.2109
 72%|███████▎  | 87/120 [10:09<03:30,  6.39s/it]epoch [87/120], kd_loss:1.2127
 73%|███████▎  | 88/120 [10:15<03:22,  6.32s/it]epoch [88/120], kd_loss:1.2176
 74%|███████▍  | 89/120 [10:21<03:14,  6.26s/it]epoch [89/120], kd_loss:1.3403
 75%|███████▌  | 90/120 [10:36<04:25,  8.84s/it]epoch [90/120], kd_loss:1.5333
normal: 0.8365 1.1909  anomaly: 0.8892 2.3451
thresh: 1.0925760287480575
fpr: 0.0625 fnr 0.08695652173913043
Pixel Auroc:0.989, Sample Auroc0.956, Pixel Aupro0.0
 76%|███████▌  | 91/120 [10:42<03:50,  7.97s/it]epoch [91/120], kd_loss:1.3362
 77%|███████▋  | 92/120 [10:48<03:26,  7.37s/it]epoch [92/120], kd_loss:1.2811
 78%|███████▊  | 93/120 [10:54<03:08,  7.00s/it]epoch [93/120], kd_loss:1.2177
 78%|███████▊  | 94/120 [11:00<02:55,  6.73s/it]epoch [94/120], kd_loss:1.2067
 79%|███████▉  | 95/120 [11:06<02:43,  6.55s/it]epoch [95/120], kd_loss:1.2098
 80%|████████  | 96/120 [11:12<02:34,  6.43s/it]epoch [96/120], kd_loss:1.1968
 81%|████████  | 97/120 [11:18<02:25,  6.34s/it]epoch [97/120], kd_loss:1.1813
 82%|████████▏ | 98/120 [11:25<02:18,  6.30s/it]epoch [98/120], kd_loss:1.1751
 82%|████████▎ | 99/120 [11:31<02:11,  6.26s/it]epoch [99/120], kd_loss:1.1728
 83%|████████▎ | 100/120 [11:47<03:04,  9.24s/it]epoch [100/120], kd_loss:1.1729
normal: 0.7567 1.0853  anomaly: 0.7772 2.2958
thresh: 1.1138508983490663
fpr: 0.0 fnr 0.11594202898550725
Pixel Auroc:0.989, Sample Auroc0.942, Pixel Aupro0.0
 84%|████████▍ | 101/120 [11:53<02:37,  8.29s/it]epoch [101/120], kd_loss:1.1706
 85%|████████▌ | 102/120 [11:59<02:17,  7.65s/it]epoch [102/120], kd_loss:1.1692
 86%|████████▌ | 103/120 [12:05<02:02,  7.19s/it]epoch [103/120], kd_loss:1.1667
 87%|████████▋ | 104/120 [12:11<01:50,  6.88s/it]epoch [104/120], kd_loss:1.1642
 88%|████████▊ | 105/120 [12:18<01:40,  6.68s/it]epoch [105/120], kd_loss:1.1632
 88%|████████▊ | 106/120 [12:24<01:32,  6.58s/it]epoch [106/120], kd_loss:1.1621
 89%|████████▉ | 107/120 [12:30<01:24,  6.46s/it]epoch [107/120], kd_loss:1.1575
 90%|█████████ | 108/120 [12:36<01:16,  6.38s/it]epoch [108/120], kd_loss:1.1556
 91%|█████████ | 109/120 [12:43<01:09,  6.32s/it]epoch [109/120], kd_loss:1.1531
 92%|█████████▏| 110/120 [12:59<01:33,  9.37s/it]epoch [110/120], kd_loss:1.1519
normal: 0.7468 1.0479  anomaly: 0.7722 2.2794
thresh: 1.088622522692396
fpr: 0.0 fnr 0.11594202898550725
Pixel Auroc:0.989, Sample Auroc0.936, Pixel Aupro0.0
 92%|█████████▎| 111/120 [13:05<01:15,  8.37s/it]epoch [111/120], kd_loss:1.1515
 93%|█████████▎| 112/120 [13:11<01:01,  7.69s/it]epoch [112/120], kd_loss:1.1511
 94%|█████████▍| 113/120 [13:17<00:50,  7.19s/it]epoch [113/120], kd_loss:1.1510
 95%|█████████▌| 114/120 [13:23<00:41,  6.86s/it]epoch [114/120], kd_loss:1.1498
 96%|█████████▌| 115/120 [13:29<00:33,  6.65s/it]epoch [115/120], kd_loss:1.1499
 97%|█████████▋| 116/120 [13:36<00:26,  6.52s/it]epoch [116/120], kd_loss:1.1491
 98%|█████████▊| 117/120 [13:42<00:19,  6.40s/it]epoch [117/120], kd_loss:1.1488
 98%|█████████▊| 118/120 [13:48<00:12,  6.33s/it]epoch [118/120], kd_loss:1.1481
 99%|█████████▉| 119/120 [13:54<00:06,  6.29s/it]epoch [119/120], kd_loss:1.1481
100%|██████████| 120/120 [14:10<00:00,  9.21s/it]100%|██████████| 120/120 [14:10<00:00,  7.09s/it]
epoch [120/120], kd_loss:1.1475
normal: 0.7533 1.0477  anomaly: 0.7637 2.2799
thresh: 1.088133627782861
fpr: 0.0 fnr 0.11594202898550725
Pixel Auroc:0.989, Sample Auroc0.935, Pixel Aupro0.0
training Advanced Teacher...
tire
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:19<32:46, 19.87s/it]epoch [1/100], focal_loss:0.0873	, anomaly_loss:0.6291	fnorm_loss:0.0610, a_fnorm_loss:0.0149P:0.00, R:0.05
normal: 0.2464 0.2551  anomaly: 0.2483 0.2573	P:0.00, R:0.00
Pixel Auroc:0.607, Sample Auroc0.507, Pixel Aupro0.0
test_fnorm_loss: 0.0665 test_afnorm_loss: 0.0158
  2%|▏         | 2/100 [00:26<19:32, 11.96s/it]epoch [2/100], focal_loss:0.0746	, anomaly_loss:0.6203	fnorm_loss:0.0595, a_fnorm_loss:0.0147P:0.00, R:0.00
  3%|▎         | 3/100 [00:33<15:35,  9.64s/it]epoch [3/100], focal_loss:0.0709	, anomaly_loss:0.6360	fnorm_loss:0.0542, a_fnorm_loss:0.0132P:0.00, R:0.00
  4%|▍         | 4/100 [00:39<13:30,  8.45s/it]epoch [4/100], focal_loss:0.0632	, anomaly_loss:0.6444	fnorm_loss:0.0494, a_fnorm_loss:0.0126P:0.00, R:0.00
  5%|▌         | 5/100 [00:59<19:43, 12.46s/it]epoch [5/100], focal_loss:0.0662	, anomaly_loss:0.6559	fnorm_loss:0.0462, a_fnorm_loss:0.0115P:0.00, R:0.00
normal: 0.1812 0.1868  anomaly: 0.1822 0.1877	P:0.00, R:0.00
Pixel Auroc:0.634, Sample Auroc0.509, Pixel Aupro0.0
test_fnorm_loss: 0.0484 test_afnorm_loss: 0.0117
  6%|▌         | 6/100 [01:05<16:21, 10.44s/it]epoch [6/100], focal_loss:0.0604	, anomaly_loss:0.6591	fnorm_loss:0.0449, a_fnorm_loss:0.0113P:0.00, R:0.00
  7%|▋         | 7/100 [01:12<14:15,  9.20s/it]epoch [7/100], focal_loss:0.0624	, anomaly_loss:0.6660	fnorm_loss:0.0432, a_fnorm_loss:0.0109P:0.00, R:0.00
  8%|▊         | 8/100 [01:18<12:40,  8.27s/it]epoch [8/100], focal_loss:0.0627	, anomaly_loss:0.6641	fnorm_loss:0.0431, a_fnorm_loss:0.0110P:0.00, R:0.00
  9%|▉         | 9/100 [01:25<11:37,  7.66s/it]epoch [9/100], focal_loss:0.0658	, anomaly_loss:0.6332	fnorm_loss:0.0448, a_fnorm_loss:0.0153P:0.03, R:0.06
 10%|█         | 10/100 [01:45<17:30, 11.67s/it]epoch [10/100], focal_loss:0.0562	, anomaly_loss:0.5857	fnorm_loss:0.0391, a_fnorm_loss:0.0238P:0.10, R:0.27
normal: 0.1490 0.1532  anomaly: 0.1489 0.1535	P:0.00, R:0.00
Pixel Auroc:0.671, Sample Auroc0.469, Pixel Aupro0.0
test_fnorm_loss: 0.0380 test_afnorm_loss: 0.0088
 11%|█         | 11/100 [01:52<14:51, 10.01s/it]epoch [11/100], focal_loss:0.0554	, anomaly_loss:0.5681	fnorm_loss:0.0357, a_fnorm_loss:0.0276P:0.12, R:0.27
 12%|█▏        | 12/100 [01:58<13:12,  9.00s/it]epoch [12/100], focal_loss:0.0565	, anomaly_loss:0.5488	fnorm_loss:0.0346, a_fnorm_loss:0.0309P:0.12, R:0.30
 13%|█▎        | 13/100 [02:04<11:49,  8.16s/it]epoch [13/100], focal_loss:0.0488	, anomaly_loss:0.5582	fnorm_loss:0.0319, a_fnorm_loss:0.0312P:0.11, R:0.29
 14%|█▍        | 14/100 [02:11<10:50,  7.56s/it]epoch [14/100], focal_loss:0.0492	, anomaly_loss:0.5507	fnorm_loss:0.0302, a_fnorm_loss:0.0325P:0.12, R:0.31
 15%|█▌        | 15/100 [02:35<17:44, 12.52s/it]epoch [15/100], focal_loss:0.0494	, anomaly_loss:0.5453	fnorm_loss:0.0290, a_fnorm_loss:0.0330P:0.12, R:0.31
normal: 0.1719 0.2704  anomaly: 0.1402 0.2910	P:0.03, R:0.06
Pixel Auroc:0.959, Sample Auroc0.506, Pixel Aupro0.0
test_fnorm_loss: 0.0292 test_afnorm_loss: 0.0182
 16%|█▌        | 16/100 [02:41<14:52, 10.63s/it]epoch [16/100], focal_loss:0.0469	, anomaly_loss:0.5339	fnorm_loss:0.0281, a_fnorm_loss:0.0350P:0.16, R:0.34
 17%|█▋        | 17/100 [02:47<12:55,  9.34s/it]epoch [17/100], focal_loss:0.0429	, anomaly_loss:0.5168	fnorm_loss:0.0268, a_fnorm_loss:0.0358P:0.21, R:0.47
 18%|█▊        | 18/100 [02:54<11:39,  8.53s/it]epoch [18/100], focal_loss:0.0423	, anomaly_loss:0.5227	fnorm_loss:0.0265, a_fnorm_loss:0.0350P:0.27, R:0.56
 19%|█▉        | 19/100 [03:00<10:40,  7.91s/it]epoch [19/100], focal_loss:0.0379	, anomaly_loss:0.5158	fnorm_loss:0.0252, a_fnorm_loss:0.0362P:0.35, R:0.59
 20%|██        | 20/100 [03:25<17:16, 12.95s/it]epoch [20/100], focal_loss:0.0358	, anomaly_loss:0.5025	fnorm_loss:0.0231, a_fnorm_loss:0.0375P:0.44, R:0.83
normal: 0.2140 0.4276  anomaly: 0.1629 0.4649	P:0.04, R:0.16
Pixel Auroc:0.939, Sample Auroc0.512, Pixel Aupro0.0
test_fnorm_loss: 0.0231 test_afnorm_loss: 0.0284
 21%|██        | 21/100 [03:31<14:24, 10.95s/it]epoch [21/100], focal_loss:0.0336	, anomaly_loss:0.4915	fnorm_loss:0.0221, a_fnorm_loss:0.0375P:0.38, R:0.86
 22%|██▏       | 22/100 [03:38<12:30,  9.62s/it]epoch [22/100], focal_loss:0.0275	, anomaly_loss:0.4771	fnorm_loss:0.0201, a_fnorm_loss:0.0404P:0.45, R:0.88
 23%|██▎       | 23/100 [03:44<10:56,  8.53s/it]epoch [23/100], focal_loss:0.0243	, anomaly_loss:0.4746	fnorm_loss:0.0190, a_fnorm_loss:0.0386P:0.42, R:0.88
 24%|██▍       | 24/100 [03:50<09:53,  7.81s/it]epoch [24/100], focal_loss:0.0220	, anomaly_loss:0.4675	fnorm_loss:0.0179, a_fnorm_loss:0.0425P:0.45, R:0.90
 25%|██▌       | 25/100 [04:13<15:38, 12.51s/it]epoch [25/100], focal_loss:0.0225	, anomaly_loss:0.4715	fnorm_loss:0.0169, a_fnorm_loss:0.0415P:0.51, R:0.87
normal: 0.1692 0.4208  anomaly: 0.1509 0.4798	P:0.06, R:0.14
Pixel Auroc:0.975, Sample Auroc0.540, Pixel Aupro0.0
test_fnorm_loss: 0.0166 test_afnorm_loss: 0.0188
 26%|██▌       | 26/100 [04:20<13:12, 10.71s/it]epoch [26/100], focal_loss:0.0232	, anomaly_loss:0.4664	fnorm_loss:0.0164, a_fnorm_loss:0.0415P:0.46, R:0.90
 27%|██▋       | 27/100 [04:26<11:26,  9.40s/it]epoch [27/100], focal_loss:0.0277	, anomaly_loss:0.4796	fnorm_loss:0.0163, a_fnorm_loss:0.0393P:0.47, R:0.84
 28%|██▊       | 28/100 [04:32<10:07,  8.44s/it]epoch [28/100], focal_loss:0.0218	, anomaly_loss:0.4680	fnorm_loss:0.0155, a_fnorm_loss:0.0407P:0.45, R:0.89
 29%|██▉       | 29/100 [04:39<09:19,  7.88s/it]epoch [29/100], focal_loss:0.0188	, anomaly_loss:0.4575	fnorm_loss:0.0149, a_fnorm_loss:0.0419P:0.53, R:0.92
 30%|███       | 30/100 [04:58<13:03, 11.19s/it]epoch [30/100], focal_loss:0.0235	, anomaly_loss:0.4677	fnorm_loss:0.0147, a_fnorm_loss:0.0437P:0.53, R:0.87
normal: 0.0857 0.3033  anomaly: 0.0910 0.3745	P:0.05, R:0.06
Pixel Auroc:0.973, Sample Auroc0.526, Pixel Aupro0.0
test_fnorm_loss: 0.0139 test_afnorm_loss: 0.0109
 31%|███       | 31/100 [05:05<11:21,  9.88s/it]epoch [31/100], focal_loss:0.0180	, anomaly_loss:0.4650	fnorm_loss:0.0140, a_fnorm_loss:0.0428P:0.50, R:0.90
 32%|███▏      | 32/100 [05:12<10:11,  8.99s/it]epoch [32/100], focal_loss:0.0201	, anomaly_loss:0.4607	fnorm_loss:0.0137, a_fnorm_loss:0.0434P:0.55, R:0.91
 33%|███▎      | 33/100 [05:18<09:15,  8.29s/it]epoch [33/100], focal_loss:0.0248	, anomaly_loss:0.4744	fnorm_loss:0.0135, a_fnorm_loss:0.0424P:0.48, R:0.84
 34%|███▍      | 34/100 [05:25<08:32,  7.77s/it]epoch [34/100], focal_loss:0.0224	, anomaly_loss:0.4641	fnorm_loss:0.0134, a_fnorm_loss:0.0431P:0.47, R:0.90
 35%|███▌      | 35/100 [05:44<12:09, 11.23s/it]epoch [35/100], focal_loss:0.0164	, anomaly_loss:0.4567	fnorm_loss:0.0127, a_fnorm_loss:0.0432P:0.50, R:0.91
normal: 0.0574 0.2328  anomaly: 0.0598 0.2864	P:0.02, R:0.03
Pixel Auroc:0.963, Sample Auroc0.536, Pixel Aupro0.0
test_fnorm_loss: 0.0121 test_afnorm_loss: 0.0088
 36%|███▌      | 36/100 [05:51<10:28,  9.82s/it]epoch [36/100], focal_loss:0.0183	, anomaly_loss:0.4532	fnorm_loss:0.0126, a_fnorm_loss:0.0439P:0.53, R:0.91
 37%|███▋      | 37/100 [05:57<09:20,  8.89s/it]epoch [37/100], focal_loss:0.0196	, anomaly_loss:0.4690	fnorm_loss:0.0125, a_fnorm_loss:0.0409P:0.55, R:0.87
 38%|███▊      | 38/100 [06:04<08:19,  8.06s/it]epoch [38/100], focal_loss:0.0167	, anomaly_loss:0.4526	fnorm_loss:0.0121, a_fnorm_loss:0.0440P:0.53, R:0.90
 39%|███▉      | 39/100 [06:10<07:42,  7.57s/it]epoch [39/100], focal_loss:0.0186	, anomaly_loss:0.4561	fnorm_loss:0.0122, a_fnorm_loss:0.0434P:0.51, R:0.91
 40%|████      | 40/100 [06:29<10:53, 10.89s/it]epoch [40/100], focal_loss:0.0161	, anomaly_loss:0.4546	fnorm_loss:0.0117, a_fnorm_loss:0.0432P:0.52, R:0.90
normal: 0.0795 0.2711  anomaly: 0.0687 0.4364	P:0.05, R:0.07
Pixel Auroc:0.970, Sample Auroc0.519, Pixel Aupro0.0
test_fnorm_loss: 0.0111 test_afnorm_loss: 0.0165
 41%|████      | 41/100 [06:35<09:25,  9.58s/it]epoch [41/100], focal_loss:0.0179	, anomaly_loss:0.4606	fnorm_loss:0.0116, a_fnorm_loss:0.0417P:0.50, R:0.88
 42%|████▏     | 42/100 [06:42<08:19,  8.62s/it]epoch [42/100], focal_loss:0.0178	, anomaly_loss:0.4558	fnorm_loss:0.0113, a_fnorm_loss:0.0442P:0.55, R:0.90
 43%|████▎     | 43/100 [06:48<07:37,  8.03s/it]epoch [43/100], focal_loss:0.0152	, anomaly_loss:0.4536	fnorm_loss:0.0110, a_fnorm_loss:0.0454P:0.58, R:0.91
 44%|████▍     | 44/100 [06:55<07:09,  7.67s/it]epoch [44/100], focal_loss:0.0159	, anomaly_loss:0.4499	fnorm_loss:0.0109, a_fnorm_loss:0.0448P:0.57, R:0.91
 45%|████▌     | 45/100 [07:13<09:59, 10.90s/it]epoch [45/100], focal_loss:0.0159	, anomaly_loss:0.4581	fnorm_loss:0.0108, a_fnorm_loss:0.0442P:0.56, R:0.90
normal: 0.0701 0.3372  anomaly: 0.0804 0.4952	P:0.04, R:0.08
Pixel Auroc:0.969, Sample Auroc0.531, Pixel Aupro0.0
test_fnorm_loss: 0.0100 test_afnorm_loss: 0.0102
 46%|████▌     | 46/100 [07:20<08:38,  9.60s/it]epoch [46/100], focal_loss:0.0153	, anomaly_loss:0.4509	fnorm_loss:0.0106, a_fnorm_loss:0.0459P:0.56, R:0.92
 47%|████▋     | 47/100 [07:26<07:32,  8.54s/it]epoch [47/100], focal_loss:0.0149	, anomaly_loss:0.4188	fnorm_loss:0.0103, a_fnorm_loss:0.0452P:0.54, R:0.82
 48%|████▊     | 48/100 [07:33<06:53,  7.95s/it]epoch [48/100], focal_loss:0.0138	, anomaly_loss:0.4602	fnorm_loss:0.0101, a_fnorm_loss:0.0420P:0.55, R:0.87
 49%|████▉     | 49/100 [07:39<06:19,  7.45s/it]epoch [49/100], focal_loss:0.0147	, anomaly_loss:0.4466	fnorm_loss:0.0103, a_fnorm_loss:0.0447P:0.52, R:0.92
 50%|█████     | 50/100 [07:58<09:07, 10.95s/it]epoch [50/100], focal_loss:0.0161	, anomaly_loss:0.4527	fnorm_loss:0.0101, a_fnorm_loss:0.0432P:0.57, R:0.90
normal: 0.1635 0.3157  anomaly: 0.1607 0.5240	P:0.04, R:0.10
Pixel Auroc:0.912, Sample Auroc0.525, Pixel Aupro0.0
test_fnorm_loss: 0.0125 test_afnorm_loss: 0.0221
 51%|█████     | 51/100 [08:05<07:50,  9.61s/it]epoch [51/100], focal_loss:0.0142	, anomaly_loss:0.4465	fnorm_loss:0.0101, a_fnorm_loss:0.0456P:0.58, R:0.93
 52%|█████▏    | 52/100 [08:11<06:56,  8.68s/it]epoch [52/100], focal_loss:0.0134	, anomaly_loss:0.4425	fnorm_loss:0.0097, a_fnorm_loss:0.0463P:0.59, R:0.92
 53%|█████▎    | 53/100 [08:17<06:12,  7.92s/it]epoch [53/100], focal_loss:0.0127	, anomaly_loss:0.4466	fnorm_loss:0.0095, a_fnorm_loss:0.0451P:0.55, R:0.93
 54%|█████▍    | 54/100 [08:23<05:39,  7.38s/it]epoch [54/100], focal_loss:0.0134	, anomaly_loss:0.4172	fnorm_loss:0.0096, a_fnorm_loss:0.0450P:0.49, R:0.85
 55%|█████▌    | 55/100 [08:42<08:06, 10.80s/it]epoch [55/100], focal_loss:0.0146	, anomaly_loss:0.4555	fnorm_loss:0.0094, a_fnorm_loss:0.0445P:0.57, R:0.89
normal: 0.1314 0.3501  anomaly: 0.1308 0.4989	P:0.05, R:0.13
Pixel Auroc:0.975, Sample Auroc0.522, Pixel Aupro0.0
test_fnorm_loss: 0.0089 test_afnorm_loss: 0.0146
 56%|█████▌    | 56/100 [08:49<06:56,  9.47s/it]epoch [56/100], focal_loss:0.0158	, anomaly_loss:0.4522	fnorm_loss:0.0094, a_fnorm_loss:0.0451P:0.56, R:0.90
 57%|█████▋    | 57/100 [08:55<06:04,  8.48s/it]epoch [57/100], focal_loss:0.0140	, anomaly_loss:0.4478	fnorm_loss:0.0092, a_fnorm_loss:0.0450P:0.57, R:0.90
 58%|█████▊    | 58/100 [09:01<05:32,  7.92s/it]epoch [58/100], focal_loss:0.0134	, anomaly_loss:0.4443	fnorm_loss:0.0091, a_fnorm_loss:0.0477P:0.63, R:0.93
 59%|█████▉    | 59/100 [09:08<05:06,  7.47s/it]epoch [59/100], focal_loss:0.0129	, anomaly_loss:0.4198	fnorm_loss:0.0090, a_fnorm_loss:0.0459P:0.54, R:0.84
 60%|██████    | 60/100 [09:27<07:16, 10.92s/it]epoch [60/100], focal_loss:0.0136	, anomaly_loss:0.4445	fnorm_loss:0.0090, a_fnorm_loss:0.0460P:0.57, R:0.92
normal: 0.0407 0.2024  anomaly: 0.0443 0.4393	P:0.03, R:0.03
Pixel Auroc:0.964, Sample Auroc0.511, Pixel Aupro0.0
test_fnorm_loss: 0.0082 test_afnorm_loss: 0.0099
 61%|██████    | 61/100 [09:33<06:10,  9.51s/it]epoch [61/100], focal_loss:0.0131	, anomaly_loss:0.4454	fnorm_loss:0.0087, a_fnorm_loss:0.0458P:0.59, R:0.90
 62%|██████▏   | 62/100 [09:39<05:27,  8.61s/it]epoch [62/100], focal_loss:0.0124	, anomaly_loss:0.4401	fnorm_loss:0.0087, a_fnorm_loss:0.0464P:0.59, R:0.93
 63%|██████▎   | 63/100 [09:46<04:58,  8.06s/it]epoch [63/100], focal_loss:0.0154	, anomaly_loss:0.4606	fnorm_loss:0.0087, a_fnorm_loss:0.0433P:0.55, R:0.85
 64%|██████▍   | 64/100 [09:53<04:35,  7.65s/it]epoch [64/100], focal_loss:0.0129	, anomaly_loss:0.4392	fnorm_loss:0.0089, a_fnorm_loss:0.0465P:0.57, R:0.93
 65%|██████▌   | 65/100 [10:11<06:22, 10.92s/it]epoch [65/100], focal_loss:0.0132	, anomaly_loss:0.4425	fnorm_loss:0.0087, a_fnorm_loss:0.0458P:0.54, R:0.92
normal: 0.0352 0.1757  anomaly: 0.0352 0.4369	P:0.03, R:0.03
Pixel Auroc:0.962, Sample Auroc0.532, Pixel Aupro0.0
test_fnorm_loss: 0.0077 test_afnorm_loss: 0.0087
 66%|██████▌   | 66/100 [10:18<05:24,  9.55s/it]epoch [66/100], focal_loss:0.0135	, anomaly_loss:0.4434	fnorm_loss:0.0086, a_fnorm_loss:0.0460P:0.60, R:0.90
 67%|██████▋   | 67/100 [10:24<04:42,  8.55s/it]epoch [67/100], focal_loss:0.0137	, anomaly_loss:0.4435	fnorm_loss:0.0085, a_fnorm_loss:0.0453P:0.58, R:0.90
 68%|██████▊   | 68/100 [10:30<04:11,  7.86s/it]epoch [68/100], focal_loss:0.0123	, anomaly_loss:0.4441	fnorm_loss:0.0084, a_fnorm_loss:0.0473P:0.61, R:0.92
 69%|██████▉   | 69/100 [10:37<03:54,  7.56s/it]epoch [69/100], focal_loss:0.0133	, anomaly_loss:0.4529	fnorm_loss:0.0083, a_fnorm_loss:0.0476P:0.63, R:0.91
 70%|███████   | 70/100 [10:56<05:26, 10.88s/it]epoch [70/100], focal_loss:0.0132	, anomaly_loss:0.4356	fnorm_loss:0.0082, a_fnorm_loss:0.0478P:0.60, R:0.92
normal: 0.0755 0.2443  anomaly: 0.0648 0.4725	P:0.05, R:0.06
Pixel Auroc:0.971, Sample Auroc0.548, Pixel Aupro0.0
test_fnorm_loss: 0.0075 test_afnorm_loss: 0.0100
 71%|███████   | 71/100 [11:02<04:37,  9.58s/it]epoch [71/100], focal_loss:0.0243	, anomaly_loss:0.4405	fnorm_loss:0.0085, a_fnorm_loss:0.0448P:0.39, R:0.65
 72%|███████▏  | 72/100 [11:09<04:05,  8.76s/it]epoch [72/100], focal_loss:0.0171	, anomaly_loss:0.4605	fnorm_loss:0.0082, a_fnorm_loss:0.0462P:0.60, R:0.85
 73%|███████▎  | 73/100 [11:16<03:37,  8.05s/it]epoch [73/100], focal_loss:0.0144	, anomaly_loss:0.4512	fnorm_loss:0.0081, a_fnorm_loss:0.0458P:0.58, R:0.93
 74%|███████▍  | 74/100 [11:23<03:21,  7.76s/it]epoch [74/100], focal_loss:0.0127	, anomaly_loss:0.4379	fnorm_loss:0.0079, a_fnorm_loss:0.0479P:0.57, R:0.94
 75%|███████▌  | 75/100 [11:42<04:41, 11.25s/it]epoch [75/100], focal_loss:0.0135	, anomaly_loss:0.4207	fnorm_loss:0.0080, a_fnorm_loss:0.0468P:0.53, R:0.85
normal: 0.0474 0.2187  anomaly: 0.0502 0.4735	P:0.04, R:0.04
Pixel Auroc:0.967, Sample Auroc0.536, Pixel Aupro0.0
test_fnorm_loss: 0.0073 test_afnorm_loss: 0.0120
 76%|███████▌  | 76/100 [11:49<03:58,  9.94s/it]epoch [76/100], focal_loss:0.0122	, anomaly_loss:0.4421	fnorm_loss:0.0078, a_fnorm_loss:0.0476P:0.59, R:0.92
 77%|███████▋  | 77/100 [11:55<03:25,  8.92s/it]epoch [77/100], focal_loss:0.0149	, anomaly_loss:0.4468	fnorm_loss:0.0079, a_fnorm_loss:0.0454P:0.60, R:0.91
 78%|███████▊  | 78/100 [12:02<02:59,  8.16s/it]epoch [78/100], focal_loss:0.0114	, anomaly_loss:0.4454	fnorm_loss:0.0076, a_fnorm_loss:0.0470P:0.60, R:0.92
 79%|███████▉  | 79/100 [12:08<02:40,  7.63s/it]epoch [79/100], focal_loss:0.0162	, anomaly_loss:0.4535	fnorm_loss:0.0083, a_fnorm_loss:0.0464P:0.58, R:0.88
 80%|████████  | 80/100 [12:27<03:39, 10.98s/it]epoch [80/100], focal_loss:0.0172	, anomaly_loss:0.4498	fnorm_loss:0.0082, a_fnorm_loss:0.0460P:0.57, R:0.90
normal: 0.0385 0.1313  anomaly: 0.0427 0.4007	P:0.02, R:0.02
Pixel Auroc:0.974, Sample Auroc0.577, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0075
 81%|████████  | 81/100 [12:33<03:02,  9.63s/it]epoch [81/100], focal_loss:0.0143	, anomaly_loss:0.4621	fnorm_loss:0.0079, a_fnorm_loss:0.0439P:0.59, R:0.87
 82%|████████▏ | 82/100 [12:40<02:35,  8.64s/it]epoch [82/100], focal_loss:0.0132	, anomaly_loss:0.4517	fnorm_loss:0.0077, a_fnorm_loss:0.0471P:0.64, R:0.92
 83%|████████▎ | 83/100 [12:47<02:17,  8.11s/it]epoch [83/100], focal_loss:0.0135	, anomaly_loss:0.4379	fnorm_loss:0.0081, a_fnorm_loss:0.0486P:0.59, R:0.94
 84%|████████▍ | 84/100 [12:53<02:02,  7.65s/it]epoch [84/100], focal_loss:0.0124	, anomaly_loss:0.4395	fnorm_loss:0.0079, a_fnorm_loss:0.0470P:0.61, R:0.93
 85%|████████▌ | 85/100 [13:11<02:41, 10.80s/it]epoch [85/100], focal_loss:0.0124	, anomaly_loss:0.4446	fnorm_loss:0.0077, a_fnorm_loss:0.0478P:0.61, R:0.91
normal: 0.0565 0.3013  anomaly: 0.0650 0.5526	P:0.05, R:0.07
Pixel Auroc:0.976, Sample Auroc0.566, Pixel Aupro0.0
test_fnorm_loss: 0.0071 test_afnorm_loss: 0.0151
 86%|████████▌ | 86/100 [13:18<02:11,  9.42s/it]epoch [86/100], focal_loss:0.0117	, anomaly_loss:0.4380	fnorm_loss:0.0077, a_fnorm_loss:0.0485P:0.53, R:0.92
 87%|████████▋ | 87/100 [13:24<01:50,  8.51s/it]epoch [87/100], focal_loss:0.0107	, anomaly_loss:0.4333	fnorm_loss:0.0076, a_fnorm_loss:0.0483P:0.64, R:0.94
 88%|████████▊ | 88/100 [13:31<01:35,  7.95s/it]epoch [88/100], focal_loss:0.0115	, anomaly_loss:0.4334	fnorm_loss:0.0076, a_fnorm_loss:0.0489P:0.61, R:0.94
 89%|████████▉ | 89/100 [13:37<01:21,  7.42s/it]epoch [89/100], focal_loss:0.0113	, anomaly_loss:0.4409	fnorm_loss:0.0077, a_fnorm_loss:0.0485P:0.62, R:0.93
 90%|█████████ | 90/100 [13:56<01:50, 11.01s/it]epoch [90/100], focal_loss:0.0119	, anomaly_loss:0.4612	fnorm_loss:0.0077, a_fnorm_loss:0.0450P:0.56, R:0.87
normal: 0.0511 0.2541  anomaly: 0.0563 0.5317	P:0.04, R:0.06
Pixel Auroc:0.975, Sample Auroc0.566, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0128
 91%|█████████ | 91/100 [14:03<01:26,  9.64s/it]epoch [91/100], focal_loss:0.0115	, anomaly_loss:0.4385	fnorm_loss:0.0076, a_fnorm_loss:0.0467P:0.60, R:0.93
 92%|█████████▏| 92/100 [14:09<01:09,  8.68s/it]epoch [92/100], focal_loss:0.0122	, anomaly_loss:0.4365	fnorm_loss:0.0077, a_fnorm_loss:0.0466P:0.59, R:0.92
 93%|█████████▎| 93/100 [14:16<00:56,  8.05s/it]epoch [93/100], focal_loss:0.0116	, anomaly_loss:0.4290	fnorm_loss:0.0077, a_fnorm_loss:0.0488P:0.59, R:0.95
 94%|█████████▍| 94/100 [14:22<00:45,  7.54s/it]epoch [94/100], focal_loss:0.0123	, anomaly_loss:0.4503	fnorm_loss:0.0077, a_fnorm_loss:0.0467P:0.56, R:0.90
 95%|█████████▌| 95/100 [14:41<00:54, 10.90s/it]epoch [95/100], focal_loss:0.0117	, anomaly_loss:0.4473	fnorm_loss:0.0075, a_fnorm_loss:0.0481P:0.62, R:0.91
normal: 0.0523 0.2658  anomaly: 0.0590 0.5401	P:0.04, R:0.06
Pixel Auroc:0.976, Sample Auroc0.563, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0136
 96%|█████████▌| 96/100 [14:47<00:38,  9.54s/it]epoch [96/100], focal_loss:0.0106	, anomaly_loss:0.4305	fnorm_loss:0.0076, a_fnorm_loss:0.0487P:0.61, R:0.94
 97%|█████████▋| 97/100 [14:54<00:26,  8.67s/it]epoch [97/100], focal_loss:0.0122	, anomaly_loss:0.4394	fnorm_loss:0.0077, a_fnorm_loss:0.0470P:0.60, R:0.93
 98%|█████████▊| 98/100 [15:00<00:15,  7.98s/it]epoch [98/100], focal_loss:0.0137	, anomaly_loss:0.4482	fnorm_loss:0.0075, a_fnorm_loss:0.0468P:0.60, R:0.90
 99%|█████████▉| 99/100 [15:06<00:07,  7.46s/it]epoch [99/100], focal_loss:0.0108	, anomaly_loss:0.4370	fnorm_loss:0.0075, a_fnorm_loss:0.0476P:0.57, R:0.93
100%|██████████| 100/100 [15:24<00:00, 10.56s/it]100%|██████████| 100/100 [15:24<00:00,  9.25s/it]
epoch [100/100], focal_loss:0.0117	, anomaly_loss:0.4420	fnorm_loss:0.0076, a_fnorm_loss:0.0484P:0.61, R:0.92
normal: 0.0477 0.2513  anomaly: 0.0532 0.5349	P:0.04, R:0.06
Pixel Auroc:0.975, Sample Auroc0.565, Pixel Aupro0.0
test_fnorm_loss: 0.0070 test_afnorm_loss: 0.0129
training Stubborn Student...
tire
cuda
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
Resizing position embedding grid-size from %s to %s (14, 14) (16, 16)
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:04<09:13,  4.65s/it]epoch [1/120], kd_loss:5.0535
  2%|▏         | 2/120 [00:09<09:10,  4.67s/it]epoch [2/120], kd_loss:4.1415
  2%|▎         | 3/120 [00:13<09:05,  4.66s/it]epoch [3/120], kd_loss:3.9794
  3%|▎         | 4/120 [00:18<08:58,  4.64s/it]epoch [4/120], kd_loss:3.8312
  4%|▍         | 5/120 [00:23<08:51,  4.62s/it]epoch [5/120], kd_loss:3.4980
  5%|▌         | 6/120 [00:27<08:52,  4.67s/it]epoch [6/120], kd_loss:3.3628
  6%|▌         | 7/120 [00:32<08:47,  4.67s/it]epoch [7/120], kd_loss:2.7153
  7%|▋         | 8/120 [00:37<08:43,  4.68s/it]epoch [8/120], kd_loss:2.4151
  8%|▊         | 9/120 [00:41<08:37,  4.67s/it]epoch [9/120], kd_loss:2.1830
  8%|▊         | 10/120 [00:57<14:58,  8.17s/it]epoch [10/120], kd_loss:1.9874
normal: 1.4476 1.8423  anomaly: 1.4677 1.8958
thresh: 1.4676652712752465
fpr: 0.96 fnr 0.0
Pixel Auroc:0.798, Sample Auroc0.478, Pixel Aupro0.0
  9%|▉         | 11/120 [01:02<12:51,  7.08s/it]epoch [11/120], kd_loss:2.3759
 10%|█         | 12/120 [01:07<11:25,  6.35s/it]epoch [12/120], kd_loss:2.8219
 11%|█         | 13/120 [01:11<10:25,  5.85s/it]epoch [13/120], kd_loss:2.3842
 12%|█▏        | 14/120 [01:16<09:41,  5.49s/it]epoch [14/120], kd_loss:2.0473
 12%|█▎        | 15/120 [01:21<09:09,  5.23s/it]epoch [15/120], kd_loss:1.9846
 13%|█▎        | 16/120 [01:25<08:46,  5.07s/it]epoch [16/120], kd_loss:1.9399
 14%|█▍        | 17/120 [01:30<08:33,  4.99s/it]epoch [17/120], kd_loss:1.8703
 15%|█▌        | 18/120 [01:35<08:20,  4.90s/it]epoch [18/120], kd_loss:1.8756
 16%|█▌        | 19/120 [01:40<08:11,  4.86s/it]epoch [19/120], kd_loss:1.8494
 17%|█▋        | 20/120 [01:57<14:10,  8.50s/it]epoch [20/120], kd_loss:2.1963
normal: 1.2621 1.5903  anomaly: 1.1999 1.7265
thresh: 1.1998544763636603
fpr: 1.0 fnr 0.0
Pixel Auroc:0.919, Sample Auroc0.494, Pixel Aupro0.0
 18%|█▊        | 21/120 [02:01<12:06,  7.34s/it]epoch [21/120], kd_loss:1.8822
 18%|█▊        | 22/120 [02:06<10:38,  6.51s/it]epoch [22/120], kd_loss:1.8611
 19%|█▉        | 23/120 [02:10<09:34,  5.92s/it]epoch [23/120], kd_loss:3.5072
 20%|██        | 24/120 [02:15<08:47,  5.50s/it]epoch [24/120], kd_loss:2.9140
 21%|██        | 25/120 [02:20<08:20,  5.27s/it]epoch [25/120], kd_loss:2.4757
 22%|██▏       | 26/120 [02:24<08:00,  5.11s/it]epoch [26/120], kd_loss:2.2043
 22%|██▎       | 27/120 [02:29<07:43,  4.99s/it]epoch [27/120], kd_loss:2.3306
 23%|██▎       | 28/120 [02:34<07:29,  4.89s/it]epoch [28/120], kd_loss:1.9209
 24%|██▍       | 29/120 [02:38<07:17,  4.80s/it]epoch [29/120], kd_loss:2.5594
 25%|██▌       | 30/120 [02:55<12:25,  8.29s/it]epoch [30/120], kd_loss:1.9425
normal: 1.1691 1.5606  anomaly: 1.1370 1.8453
thresh: 1.1370098553783667
fpr: 1.0 fnr 0.0
Pixel Auroc:0.945, Sample Auroc0.483, Pixel Aupro0.0
 26%|██▌       | 31/120 [02:59<10:40,  7.20s/it]epoch [31/120], kd_loss:2.7087
 27%|██▋       | 32/120 [03:04<09:28,  6.45s/it]epoch [32/120], kd_loss:3.3872
 28%|██▊       | 33/120 [03:09<08:32,  5.90s/it]epoch [33/120], kd_loss:2.6103
 28%|██▊       | 34/120 [03:13<07:53,  5.51s/it]epoch [34/120], kd_loss:2.0466
 29%|██▉       | 35/120 [03:18<07:27,  5.27s/it]epoch [35/120], kd_loss:2.0664
 30%|███       | 36/120 [03:23<07:08,  5.10s/it]epoch [36/120], kd_loss:1.9561
 31%|███       | 37/120 [03:28<06:54,  4.99s/it]epoch [37/120], kd_loss:1.8639
 32%|███▏      | 38/120 [03:32<06:42,  4.91s/it]epoch [38/120], kd_loss:1.8305
 32%|███▎      | 39/120 [03:37<06:34,  4.87s/it]epoch [39/120], kd_loss:1.8098
 33%|███▎      | 40/120 [03:54<11:30,  8.63s/it]epoch [40/120], kd_loss:1.8006
normal: 1.1720 1.4680  anomaly: 1.1465 1.7641
thresh: 1.1464539109406409
fpr: 1.0 fnr 0.0
Pixel Auroc:0.943, Sample Auroc0.498, Pixel Aupro0.0
 34%|███▍      | 41/120 [03:59<09:46,  7.42s/it]epoch [41/120], kd_loss:1.7800
 35%|███▌      | 42/120 [04:04<08:33,  6.59s/it]epoch [42/120], kd_loss:1.7728
 36%|███▌      | 43/120 [04:08<07:43,  6.02s/it]epoch [43/120], kd_loss:1.7508
 37%|███▋      | 44/120 [04:13<07:06,  5.62s/it]epoch [44/120], kd_loss:1.7469
 38%|███▊      | 45/120 [04:18<06:41,  5.35s/it]epoch [45/120], kd_loss:2.1666
 38%|███▊      | 46/120 [04:23<06:23,  5.18s/it]epoch [46/120], kd_loss:1.8601
 39%|███▉      | 47/120 [04:27<06:09,  5.06s/it]epoch [47/120], kd_loss:1.8325
 40%|████      | 48/120 [04:32<05:55,  4.94s/it]epoch [48/120], kd_loss:1.7498
 41%|████      | 49/120 [04:37<05:45,  4.87s/it]epoch [49/120], kd_loss:1.7132
 42%|████▏     | 50/120 [04:54<09:53,  8.47s/it]epoch [50/120], kd_loss:2.3935
normal: 1.2471 1.6595  anomaly: 1.1960 1.9852
thresh: 1.1960094073614225
fpr: 1.0 fnr 0.0
Pixel Auroc:0.941, Sample Auroc0.548, Pixel Aupro0.0
 42%|████▎     | 51/120 [04:58<08:25,  7.32s/it]epoch [51/120], kd_loss:1.8748
 43%|████▎     | 52/120 [05:03<07:23,  6.52s/it]epoch [52/120], kd_loss:1.7853
 44%|████▍     | 53/120 [05:08<06:40,  5.98s/it]epoch [53/120], kd_loss:1.7610
 45%|████▌     | 54/120 [05:12<06:07,  5.57s/it]epoch [54/120], kd_loss:1.7501
 46%|████▌     | 55/120 [05:17<05:43,  5.29s/it]epoch [55/120], kd_loss:1.7314
 47%|████▋     | 56/120 [05:22<05:28,  5.14s/it]epoch [56/120], kd_loss:1.7068
 48%|████▊     | 57/120 [05:26<05:14,  4.99s/it]epoch [57/120], kd_loss:1.7504
 48%|████▊     | 58/120 [05:31<05:04,  4.92s/it]epoch [58/120], kd_loss:1.7790
 49%|████▉     | 59/120 [05:36<04:57,  4.88s/it]epoch [59/120], kd_loss:1.7504
 50%|█████     | 60/120 [05:52<08:21,  8.36s/it]epoch [60/120], kd_loss:1.7151
normal: 1.1671 1.5272  anomaly: 1.1250 1.7246
thresh: 1.1249722992760562
fpr: 1.0 fnr 0.0
Pixel Auroc:0.913, Sample Auroc0.520, Pixel Aupro0.0
 51%|█████     | 61/120 [05:57<07:07,  7.24s/it]epoch [61/120], kd_loss:1.7448
 52%|█████▏    | 62/120 [06:02<06:15,  6.47s/it]epoch [62/120], kd_loss:1.6735
 52%|█████▎    | 63/120 [06:06<05:36,  5.91s/it]epoch [63/120], kd_loss:1.6640
 53%|█████▎    | 64/120 [06:11<05:09,  5.52s/it]epoch [64/120], kd_loss:1.6558
 54%|█████▍    | 65/120 [06:15<04:49,  5.27s/it]epoch [65/120], kd_loss:1.6234
 55%|█████▌    | 66/120 [06:20<04:35,  5.10s/it]epoch [66/120], kd_loss:1.6054
 56%|█████▌    | 67/120 [06:25<04:23,  4.97s/it]epoch [67/120], kd_loss:1.6426
 57%|█████▋    | 68/120 [06:30<04:15,  4.91s/it]epoch [68/120], kd_loss:1.6162
 57%|█████▊    | 69/120 [06:34<04:06,  4.84s/it]epoch [69/120], kd_loss:1.6204
 58%|█████▊    | 70/120 [06:50<06:49,  8.19s/it]epoch [70/120], kd_loss:1.8731
normal: 1.2079 1.5842  anomaly: 1.1916 1.8197
thresh: 1.191583169785934
fpr: 1.0 fnr 0.0
Pixel Auroc:0.903, Sample Auroc0.516, Pixel Aupro0.0
 59%|█████▉    | 71/120 [06:55<05:47,  7.09s/it]epoch [71/120], kd_loss:1.7257
 60%|██████    | 72/120 [06:59<05:04,  6.34s/it]epoch [72/120], kd_loss:1.6475
 61%|██████    | 73/120 [07:04<04:34,  5.84s/it]epoch [73/120], kd_loss:1.6307
 62%|██████▏   | 74/120 [07:09<04:12,  5.50s/it]epoch [74/120], kd_loss:1.7030
 62%|██████▎   | 75/120 [07:13<03:56,  5.26s/it]epoch [75/120], kd_loss:1.6064
 63%|██████▎   | 76/120 [07:18<03:44,  5.11s/it]epoch [76/120], kd_loss:1.5789
 64%|██████▍   | 77/120 [07:23<03:33,  4.97s/it]epoch [77/120], kd_loss:1.7849
 65%|██████▌   | 78/120 [07:28<03:26,  4.91s/it]epoch [78/120], kd_loss:1.6236
 66%|██████▌   | 79/120 [07:32<03:18,  4.83s/it]epoch [79/120], kd_loss:1.5693
 67%|██████▋   | 80/120 [07:48<05:26,  8.15s/it]epoch [80/120], kd_loss:1.5676
normal: 1.0724 1.3538  anomaly: 1.0610 1.7685
thresh: 1.0609964339822788
fpr: 1.0 fnr 0.0
Pixel Auroc:0.884, Sample Auroc0.526, Pixel Aupro0.0
 68%|██████▊   | 81/120 [07:53<04:38,  7.14s/it]epoch [81/120], kd_loss:1.6006
 68%|██████▊   | 82/120 [07:58<04:03,  6.40s/it]epoch [82/120], kd_loss:1.5518
 69%|██████▉   | 83/120 [08:02<03:36,  5.86s/it]epoch [83/120], kd_loss:1.5341
 70%|███████   | 84/120 [08:07<03:18,  5.51s/it]epoch [84/120], kd_loss:1.5240
 71%|███████   | 85/120 [08:12<03:04,  5.26s/it]epoch [85/120], kd_loss:1.5400
 72%|███████▏  | 86/120 [08:16<02:52,  5.09s/it]epoch [86/120], kd_loss:1.5499
 72%|███████▎  | 87/120 [08:21<02:44,  4.99s/it]epoch [87/120], kd_loss:1.5603
 73%|███████▎  | 88/120 [08:26<02:37,  4.91s/it]epoch [88/120], kd_loss:1.6592
 74%|███████▍  | 89/120 [08:31<02:30,  4.85s/it]epoch [89/120], kd_loss:1.5726
 75%|███████▌  | 90/120 [08:48<04:22,  8.74s/it]epoch [90/120], kd_loss:1.5425
normal: 0.9703 1.3739  anomaly: 0.9405 1.9088
thresh: 0.992583317943804
fpr: 0.88 fnr 0.011494252873563218
Pixel Auroc:0.940, Sample Auroc0.570, Pixel Aupro0.0
 76%|███████▌  | 91/120 [08:53<03:37,  7.52s/it]epoch [91/120], kd_loss:1.5916
 77%|███████▋  | 92/120 [08:58<03:06,  6.65s/it]epoch [92/120], kd_loss:1.6943
 78%|███████▊  | 93/120 [09:02<02:42,  6.04s/it]epoch [93/120], kd_loss:1.5622
 78%|███████▊  | 94/120 [09:07<02:26,  5.63s/it]epoch [94/120], kd_loss:1.5591
 79%|███████▉  | 95/120 [09:12<02:13,  5.36s/it]epoch [95/120], kd_loss:1.5522
 80%|████████  | 96/120 [09:16<02:03,  5.17s/it]epoch [96/120], kd_loss:1.5399
 81%|████████  | 97/120 [09:21<01:55,  5.03s/it]epoch [97/120], kd_loss:1.5184
 82%|████████▏ | 98/120 [09:26<01:48,  4.92s/it]epoch [98/120], kd_loss:1.5084
 82%|████████▎ | 99/120 [09:30<01:41,  4.85s/it]epoch [99/120], kd_loss:1.5124
 83%|████████▎ | 100/120 [09:48<02:51,  8.56s/it]epoch [100/120], kd_loss:1.5074
normal: 0.9446 1.3193  anomaly: 0.9322 1.8552
thresh: 0.9679861364784536
fpr: 0.88 fnr 0.011494252873563218
Pixel Auroc:0.954, Sample Auroc0.589, Pixel Aupro0.0
 84%|████████▍ | 101/120 [09:52<02:20,  7.37s/it]epoch [101/120], kd_loss:1.4999
 85%|████████▌ | 102/120 [09:57<01:57,  6.53s/it]epoch [102/120], kd_loss:1.5006
 86%|████████▌ | 103/120 [10:01<01:41,  5.98s/it]epoch [103/120], kd_loss:1.4973
 87%|████████▋ | 104/120 [10:06<01:29,  5.59s/it]epoch [104/120], kd_loss:1.4953
 88%|████████▊ | 105/120 [10:11<01:19,  5.31s/it]epoch [105/120], kd_loss:1.4942
 88%|████████▊ | 106/120 [10:16<01:11,  5.13s/it]epoch [106/120], kd_loss:1.4919
 89%|████████▉ | 107/120 [10:20<01:04,  4.99s/it]epoch [107/120], kd_loss:1.4890
 90%|█████████ | 108/120 [10:25<00:59,  4.92s/it]epoch [108/120], kd_loss:1.4918
 91%|█████████ | 109/120 [10:30<00:53,  4.87s/it]epoch [109/120], kd_loss:1.4892
 92%|█████████▏| 110/120 [10:46<01:24,  8.42s/it]epoch [110/120], kd_loss:1.4857
normal: 0.9380 1.3218  anomaly: 0.9214 1.8072
thresh: 0.9214156429978984
fpr: 1.0 fnr 0.0
Pixel Auroc:0.954, Sample Auroc0.590, Pixel Aupro0.0
 92%|█████████▎| 111/120 [10:51<01:05,  7.28s/it]epoch [111/120], kd_loss:1.4856
 93%|█████████▎| 112/120 [10:56<00:51,  6.50s/it]epoch [112/120], kd_loss:1.4849
 94%|█████████▍| 113/120 [11:00<00:41,  5.93s/it]epoch [113/120], kd_loss:1.4853
 95%|█████████▌| 114/120 [11:05<00:33,  5.54s/it]epoch [114/120], kd_loss:1.4839
 96%|█████████▌| 115/120 [11:10<00:26,  5.27s/it]epoch [115/120], kd_loss:1.4854
 97%|█████████▋| 116/120 [11:14<00:20,  5.10s/it]epoch [116/120], kd_loss:1.4852
 98%|█████████▊| 117/120 [11:19<00:14,  4.98s/it]epoch [117/120], kd_loss:1.4817
 98%|█████████▊| 118/120 [11:24<00:09,  4.93s/it]epoch [118/120], kd_loss:1.4840
 99%|█████████▉| 119/120 [11:29<00:04,  4.88s/it]epoch [119/120], kd_loss:1.4818
100%|██████████| 120/120 [11:44<00:00,  7.99s/it]100%|██████████| 120/120 [11:44<00:00,  5.87s/it]
epoch [120/120], kd_loss:1.4812
normal: 0.9618 1.3167  anomaly: 0.9156 1.8215
thresh: 0.9155818058796807
fpr: 1.0 fnr 0.0
Pixel Auroc:0.954, Sample Auroc0.584, Pixel Aupro0.0
